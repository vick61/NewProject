function yT(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Gn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function My(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function wT(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var By={exports:{}},_d={},Uy={exports:{}},it={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nu=Symbol.for("react.element"),_T=Symbol.for("react.portal"),ST=Symbol.for("react.fragment"),kT=Symbol.for("react.strict_mode"),bT=Symbol.for("react.profiler"),ET=Symbol.for("react.provider"),TT=Symbol.for("react.context"),CT=Symbol.for("react.forward_ref"),NT=Symbol.for("react.suspense"),AT=Symbol.for("react.memo"),jT=Symbol.for("react.lazy"),yg=Symbol.iterator;function DT(e){return e===null||typeof e!="object"?null:(e=yg&&e[yg]||e["@@iterator"],typeof e=="function"?e:null)}var $y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zy=Object.assign,Wy={};function cl(e,t,r){this.props=e,this.context=t,this.refs=Wy,this.updater=r||$y}cl.prototype.isReactComponent={};cl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};cl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Vy(){}Vy.prototype=cl.prototype;function em(e,t,r){this.props=e,this.context=t,this.refs=Wy,this.updater=r||$y}var tm=em.prototype=new Vy;tm.constructor=em;zy(tm,cl.prototype);tm.isPureReactComponent=!0;var wg=Array.isArray,Hy=Object.prototype.hasOwnProperty,rm={current:null},Gy={key:!0,ref:!0,__self:!0,__source:!0};function Xy(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)Hy.call(t,n)&&!Gy.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:nu,type:e,key:a,ref:i,props:s,_owner:rm.current}}function FT(e,t){return{$$typeof:nu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function nm(e){return typeof e=="object"&&e!==null&&e.$$typeof===nu}function RT(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var _g=/\/+/g;function m0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?RT(""+e.key):t.toString(36)}function df(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case nu:case _T:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+m0(i,0):n,wg(s)?(r="",e!=null&&(r=e.replace(_g,"$&/")+"/"),df(s,t,r,"",function(u){return u})):s!=null&&(nm(s)&&(s=FT(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(_g,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",wg(e))for(var o=0;o<e.length;o++){a=e[o];var c=n+m0(a,o);i+=df(a,t,r,c,s)}else if(c=DT(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=n+m0(a,o++),i+=df(a,t,r,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Tu(e,t,r){if(e==null)return e;var n=[],s=0;return df(e,n,"","",function(a){return t.call(r,a,s++)}),n}function PT(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var sn={current:null},hf={transition:null},IT={ReactCurrentDispatcher:sn,ReactCurrentBatchConfig:hf,ReactCurrentOwner:rm};function Ky(){throw Error("act(...) is not supported in production builds of React.")}it.Children={map:Tu,forEach:function(e,t,r){Tu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Tu(e,function(){t++}),t},toArray:function(e){return Tu(e,function(t){return t})||[]},only:function(e){if(!nm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};it.Component=cl;it.Fragment=ST;it.Profiler=bT;it.PureComponent=em;it.StrictMode=kT;it.Suspense=NT;it.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IT;it.act=Ky;it.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=zy({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=rm.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Hy.call(t,c)&&!Gy.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:nu,type:e.type,key:s,ref:a,props:n,_owner:i}};it.createContext=function(e){return e={$$typeof:TT,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ET,_context:e},e.Consumer=e};it.createElement=Xy;it.createFactory=function(e){var t=Xy.bind(null,e);return t.type=e,t};it.createRef=function(){return{current:null}};it.forwardRef=function(e){return{$$typeof:CT,render:e}};it.isValidElement=nm;it.lazy=function(e){return{$$typeof:jT,_payload:{_status:-1,_result:e},_init:PT}};it.memo=function(e,t){return{$$typeof:AT,type:e,compare:t===void 0?null:t}};it.startTransition=function(e){var t=hf.transition;hf.transition={};try{e()}finally{hf.transition=t}};it.unstable_act=Ky;it.useCallback=function(e,t){return sn.current.useCallback(e,t)};it.useContext=function(e){return sn.current.useContext(e)};it.useDebugValue=function(){};it.useDeferredValue=function(e){return sn.current.useDeferredValue(e)};it.useEffect=function(e,t){return sn.current.useEffect(e,t)};it.useId=function(){return sn.current.useId()};it.useImperativeHandle=function(e,t,r){return sn.current.useImperativeHandle(e,t,r)};it.useInsertionEffect=function(e,t){return sn.current.useInsertionEffect(e,t)};it.useLayoutEffect=function(e,t){return sn.current.useLayoutEffect(e,t)};it.useMemo=function(e,t){return sn.current.useMemo(e,t)};it.useReducer=function(e,t,r){return sn.current.useReducer(e,t,r)};it.useRef=function(e){return sn.current.useRef(e)};it.useState=function(e){return sn.current.useState(e)};it.useSyncExternalStore=function(e,t,r){return sn.current.useSyncExternalStore(e,t,r)};it.useTransition=function(){return sn.current.useTransition()};it.version="18.3.1";Uy.exports=it;var T=Uy.exports;const ye=My(T),qy=yT({__proto__:null,default:ye},[T]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OT=T,LT=Symbol.for("react.element"),MT=Symbol.for("react.fragment"),BT=Object.prototype.hasOwnProperty,UT=OT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$T={key:!0,ref:!0,__self:!0,__source:!0};function Yy(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)BT.call(t,n)&&!$T.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:LT,type:e,key:a,ref:i,props:s,_owner:UT.current}}_d.Fragment=MT;_d.jsx=Yy;_d.jsxs=Yy;By.exports=_d;var l=By.exports,bh={},Jy={exports:{}},Dn={},Qy={exports:{}},Zy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(te,z){var K=te.length;te.push(z);e:for(;0<K;){var se=K-1>>>1,P=te[se];if(0<s(P,z))te[se]=z,te[K]=P,K=se;else break e}}function r(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var z=te[0],K=te.pop();if(K!==z){te[0]=K;e:for(var se=0,P=te.length,b=P>>>1;se<b;){var D=2*(se+1)-1,R=te[D],W=D+1,q=te[W];if(0>s(R,K))W<P&&0>s(q,R)?(te[se]=q,te[W]=K,se=W):(te[se]=R,te[D]=K,se=D);else if(W<P&&0>s(q,K))te[se]=q,te[W]=K,se=W;else break e}}return z}function s(te,z){var K=te.sortIndex-z.sortIndex;return K!==0?K:te.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],f=1,d=null,h=3,p=!1,x=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(te){for(var z=r(u);z!==null;){if(z.callback===null)n(u);else if(z.startTime<=te)n(u),z.sortIndex=z.expirationTime,t(c,z);else break;z=r(u)}}function k(te){if(m=!1,y(te),!x)if(r(c)!==null)x=!0,Z(E);else{var z=r(u);z!==null&&re(k,z.startTime-te)}}function E(te,z){x=!1,m&&(m=!1,g(A),A=-1),p=!0;var K=h;try{for(y(z),d=r(c);d!==null&&(!(d.expirationTime>z)||te&&!V());){var se=d.callback;if(typeof se=="function"){d.callback=null,h=d.priorityLevel;var P=se(d.expirationTime<=z);z=e.unstable_now(),typeof P=="function"?d.callback=P:d===r(c)&&n(c),y(z)}else n(c);d=r(c)}if(d!==null)var b=!0;else{var D=r(u);D!==null&&re(k,D.startTime-z),b=!1}return b}finally{d=null,h=K,p=!1}}var S=!1,_=null,A=-1,F=5,U=-1;function V(){return!(e.unstable_now()-U<F)}function N(){if(_!==null){var te=e.unstable_now();U=te;var z=!0;try{z=_(!0,te)}finally{z?X():(S=!1,_=null)}}else S=!1}var X;if(typeof w=="function")X=function(){w(N)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,J=le.port2;le.port1.onmessage=N,X=function(){J.postMessage(null)}}else X=function(){v(N,0)};function Z(te){_=te,S||(S=!0,X())}function re(te,z){A=v(function(){te(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,Z(E))},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(te){switch(h){case 1:case 2:case 3:var z=3;break;default:z=h}var K=h;h=z;try{return te()}finally{h=K}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(te,z){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var K=h;h=te;try{return z()}finally{h=K}},e.unstable_scheduleCallback=function(te,z,K){var se=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?se+K:se):K=se,te){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=K+P,te={id:f++,callback:z,priorityLevel:te,startTime:K,expirationTime:P,sortIndex:-1},K>se?(te.sortIndex=K,t(u,te),r(c)===null&&te===r(u)&&(m?(g(A),A=-1):m=!0,re(k,K-se))):(te.sortIndex=P,t(c,te),x||p||(x=!0,Z(E))),te},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(te){var z=h;return function(){var K=h;h=z;try{return te.apply(this,arguments)}finally{h=K}}}})(Zy);Qy.exports=Zy;var zT=Qy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WT=T,Nn=zT;function ve(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ew=new Set,xc={};function zi(e,t){Ko(e,t),Ko(e+"Capture",t)}function Ko(e,t){for(xc[e]=t,e=0;e<t.length;e++)ew.add(t[e])}var Zs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Eh=Object.prototype.hasOwnProperty,VT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Sg={},kg={};function HT(e){return Eh.call(kg,e)?!0:Eh.call(Sg,e)?!1:VT.test(e)?kg[e]=!0:(Sg[e]=!0,!1)}function GT(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function XT(e,t,r,n){if(t===null||typeof t>"u"||GT(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function an(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Pr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Pr[e]=new an(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Pr[t]=new an(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Pr[e]=new an(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Pr[e]=new an(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Pr[e]=new an(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Pr[e]=new an(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Pr[e]=new an(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Pr[e]=new an(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Pr[e]=new an(e,5,!1,e.toLowerCase(),null,!1,!1)});var sm=/[\-:]([a-z])/g;function am(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(sm,am);Pr[t]=new an(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(sm,am);Pr[t]=new an(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(sm,am);Pr[t]=new an(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Pr[e]=new an(e,1,!1,e.toLowerCase(),null,!1,!1)});Pr.xlinkHref=new an("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Pr[e]=new an(e,1,!1,e.toLowerCase(),null,!0,!0)});function im(e,t,r,n){var s=Pr.hasOwnProperty(t)?Pr[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(XT(t,r,s,n)&&(r=null),n||s===null?HT(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ia=WT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Cu=Symbol.for("react.element"),wo=Symbol.for("react.portal"),_o=Symbol.for("react.fragment"),om=Symbol.for("react.strict_mode"),Th=Symbol.for("react.profiler"),tw=Symbol.for("react.provider"),rw=Symbol.for("react.context"),lm=Symbol.for("react.forward_ref"),Ch=Symbol.for("react.suspense"),Nh=Symbol.for("react.suspense_list"),cm=Symbol.for("react.memo"),va=Symbol.for("react.lazy"),nw=Symbol.for("react.offscreen"),bg=Symbol.iterator;function Nl(e){return e===null||typeof e!="object"?null:(e=bg&&e[bg]||e["@@iterator"],typeof e=="function"?e:null)}var Ht=Object.assign,x0;function Ul(e){if(x0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);x0=t&&t[1]||""}return`
`+x0+e}var g0=!1;function v0(e,t){if(!e||g0)return"";g0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{g0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ul(e):""}function KT(e){switch(e.tag){case 5:return Ul(e.type);case 16:return Ul("Lazy");case 13:return Ul("Suspense");case 19:return Ul("SuspenseList");case 0:case 2:case 15:return e=v0(e.type,!1),e;case 11:return e=v0(e.type.render,!1),e;case 1:return e=v0(e.type,!0),e;default:return""}}function Ah(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case _o:return"Fragment";case wo:return"Portal";case Th:return"Profiler";case om:return"StrictMode";case Ch:return"Suspense";case Nh:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case rw:return(e.displayName||"Context")+".Consumer";case tw:return(e._context.displayName||"Context")+".Provider";case lm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case cm:return t=e.displayName||null,t!==null?t:Ah(e.type)||"Memo";case va:t=e._payload,e=e._init;try{return Ah(e(t))}catch{}}return null}function qT(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ah(t);case 8:return t===om?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ba(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function sw(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function YT(e){var t=sw(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Nu(e){e._valueTracker||(e._valueTracker=YT(e))}function aw(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=sw(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Af(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function jh(e,t){var r=t.checked;return Ht({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Eg(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ba(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function iw(e,t){t=t.checked,t!=null&&im(e,"checked",t,!1)}function Dh(e,t){iw(e,t);var r=Ba(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Fh(e,t.type,r):t.hasOwnProperty("defaultValue")&&Fh(e,t.type,Ba(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Tg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Fh(e,t,r){(t!=="number"||Af(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var $l=Array.isArray;function Io(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ba(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Rh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ve(91));return Ht({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Cg(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ve(92));if($l(r)){if(1<r.length)throw Error(ve(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ba(r)}}function ow(e,t){var r=Ba(t.value),n=Ba(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Ng(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function lw(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ph(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?lw(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Au,cw=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Au=Au||document.createElement("div"),Au.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Au.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function gc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ql={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},JT=["Webkit","ms","Moz","O"];Object.keys(ql).forEach(function(e){JT.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ql[t]=ql[e]})});function uw(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ql.hasOwnProperty(e)&&ql[e]?(""+t).trim():t+"px"}function fw(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=uw(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var QT=Ht({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ih(e,t){if(t){if(QT[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ve(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ve(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ve(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ve(62))}}function Oh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lh=null;function um(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Mh=null,Oo=null,Lo=null;function Ag(e){if(e=iu(e)){if(typeof Mh!="function")throw Error(ve(280));var t=e.stateNode;t&&(t=Td(t),Mh(e.stateNode,e.type,t))}}function dw(e){Oo?Lo?Lo.push(e):Lo=[e]:Oo=e}function hw(){if(Oo){var e=Oo,t=Lo;if(Lo=Oo=null,Ag(e),t)for(e=0;e<t.length;e++)Ag(t[e])}}function pw(e,t){return e(t)}function mw(){}var y0=!1;function xw(e,t,r){if(y0)return e(t,r);y0=!0;try{return pw(e,t,r)}finally{y0=!1,(Oo!==null||Lo!==null)&&(mw(),hw())}}function vc(e,t){var r=e.stateNode;if(r===null)return null;var n=Td(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ve(231,t,typeof r));return r}var Bh=!1;if(Zs)try{var Al={};Object.defineProperty(Al,"passive",{get:function(){Bh=!0}}),window.addEventListener("test",Al,Al),window.removeEventListener("test",Al,Al)}catch{Bh=!1}function ZT(e,t,r,n,s,a,i,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var Yl=!1,jf=null,Df=!1,Uh=null,e4={onError:function(e){Yl=!0,jf=e}};function t4(e,t,r,n,s,a,i,o,c){Yl=!1,jf=null,ZT.apply(e4,arguments)}function r4(e,t,r,n,s,a,i,o,c){if(t4.apply(this,arguments),Yl){if(Yl){var u=jf;Yl=!1,jf=null}else throw Error(ve(198));Df||(Df=!0,Uh=u)}}function Wi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function gw(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function jg(e){if(Wi(e)!==e)throw Error(ve(188))}function n4(e){var t=e.alternate;if(!t){if(t=Wi(e),t===null)throw Error(ve(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return jg(s),e;if(a===n)return jg(s),t;a=a.sibling}throw Error(ve(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(ve(189))}}if(r.alternate!==n)throw Error(ve(190))}if(r.tag!==3)throw Error(ve(188));return r.stateNode.current===r?e:t}function vw(e){return e=n4(e),e!==null?yw(e):null}function yw(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yw(e);if(t!==null)return t;e=e.sibling}return null}var ww=Nn.unstable_scheduleCallback,Dg=Nn.unstable_cancelCallback,s4=Nn.unstable_shouldYield,a4=Nn.unstable_requestPaint,sr=Nn.unstable_now,i4=Nn.unstable_getCurrentPriorityLevel,fm=Nn.unstable_ImmediatePriority,_w=Nn.unstable_UserBlockingPriority,Ff=Nn.unstable_NormalPriority,o4=Nn.unstable_LowPriority,Sw=Nn.unstable_IdlePriority,Sd=null,Ns=null;function l4(e){if(Ns&&typeof Ns.onCommitFiberRoot=="function")try{Ns.onCommitFiberRoot(Sd,e,void 0,(e.current.flags&128)===128)}catch{}}var ls=Math.clz32?Math.clz32:f4,c4=Math.log,u4=Math.LN2;function f4(e){return e>>>=0,e===0?32:31-(c4(e)/u4|0)|0}var ju=64,Du=4194304;function zl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Rf(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=zl(o):(a&=i,a!==0&&(n=zl(a)))}else i=r&~s,i!==0?n=zl(i):a!==0&&(n=zl(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ls(t),s=1<<r,n|=e[r],t&=~s;return n}function d4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function h4(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-ls(a),o=1<<i,c=s[i];c===-1?(!(o&r)||o&n)&&(s[i]=d4(o,t)):c<=t&&(e.expiredLanes|=o),a&=~o}}function $h(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function kw(){var e=ju;return ju<<=1,!(ju&4194240)&&(ju=64),e}function w0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function su(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ls(t),e[t]=r}function p4(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-ls(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function dm(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ls(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var _t=0;function bw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ew,hm,Tw,Cw,Nw,zh=!1,Fu=[],Aa=null,ja=null,Da=null,yc=new Map,wc=new Map,wa=[],m4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fg(e,t){switch(e){case"focusin":case"focusout":Aa=null;break;case"dragenter":case"dragleave":ja=null;break;case"mouseover":case"mouseout":Da=null;break;case"pointerover":case"pointerout":yc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":wc.delete(t.pointerId)}}function jl(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=iu(t),t!==null&&hm(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function x4(e,t,r,n,s){switch(t){case"focusin":return Aa=jl(Aa,e,t,r,n,s),!0;case"dragenter":return ja=jl(ja,e,t,r,n,s),!0;case"mouseover":return Da=jl(Da,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return yc.set(a,jl(yc.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,wc.set(a,jl(wc.get(a)||null,e,t,r,n,s)),!0}return!1}function Aw(e){var t=di(e.target);if(t!==null){var r=Wi(t);if(r!==null){if(t=r.tag,t===13){if(t=gw(r),t!==null){e.blockedOn=t,Nw(e.priority,function(){Tw(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function pf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Wh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Lh=n,r.target.dispatchEvent(n),Lh=null}else return t=iu(r),t!==null&&hm(t),e.blockedOn=r,!1;t.shift()}return!0}function Rg(e,t,r){pf(e)&&r.delete(t)}function g4(){zh=!1,Aa!==null&&pf(Aa)&&(Aa=null),ja!==null&&pf(ja)&&(ja=null),Da!==null&&pf(Da)&&(Da=null),yc.forEach(Rg),wc.forEach(Rg)}function Dl(e,t){e.blockedOn===t&&(e.blockedOn=null,zh||(zh=!0,Nn.unstable_scheduleCallback(Nn.unstable_NormalPriority,g4)))}function _c(e){function t(s){return Dl(s,e)}if(0<Fu.length){Dl(Fu[0],e);for(var r=1;r<Fu.length;r++){var n=Fu[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Aa!==null&&Dl(Aa,e),ja!==null&&Dl(ja,e),Da!==null&&Dl(Da,e),yc.forEach(t),wc.forEach(t),r=0;r<wa.length;r++)n=wa[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<wa.length&&(r=wa[0],r.blockedOn===null);)Aw(r),r.blockedOn===null&&wa.shift()}var Mo=ia.ReactCurrentBatchConfig,Pf=!0;function v4(e,t,r,n){var s=_t,a=Mo.transition;Mo.transition=null;try{_t=1,pm(e,t,r,n)}finally{_t=s,Mo.transition=a}}function y4(e,t,r,n){var s=_t,a=Mo.transition;Mo.transition=null;try{_t=4,pm(e,t,r,n)}finally{_t=s,Mo.transition=a}}function pm(e,t,r,n){if(Pf){var s=Wh(e,t,r,n);if(s===null)j0(e,t,n,If,r),Fg(e,n);else if(x4(s,e,t,r,n))n.stopPropagation();else if(Fg(e,n),t&4&&-1<m4.indexOf(e)){for(;s!==null;){var a=iu(s);if(a!==null&&Ew(a),a=Wh(e,t,r,n),a===null&&j0(e,t,n,If,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else j0(e,t,n,null,r)}}var If=null;function Wh(e,t,r,n){if(If=null,e=um(n),e=di(e),e!==null)if(t=Wi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=gw(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return If=e,null}function jw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(i4()){case fm:return 1;case _w:return 4;case Ff:case o4:return 16;case Sw:return 536870912;default:return 16}default:return 16}}var ka=null,mm=null,mf=null;function Dw(){if(mf)return mf;var e,t=mm,r=t.length,n,s="value"in ka?ka.value:ka.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return mf=s.slice(e,1<n?1-n:void 0)}function xf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ru(){return!0}function Pg(){return!1}function Fn(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Ru:Pg,this.isPropagationStopped=Pg,this}return Ht(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ru)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ru)},persist:function(){},isPersistent:Ru}),t}var ul={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xm=Fn(ul),au=Ht({},ul,{view:0,detail:0}),w4=Fn(au),_0,S0,Fl,kd=Ht({},au,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Fl&&(Fl&&e.type==="mousemove"?(_0=e.screenX-Fl.screenX,S0=e.screenY-Fl.screenY):S0=_0=0,Fl=e),_0)},movementY:function(e){return"movementY"in e?e.movementY:S0}}),Ig=Fn(kd),_4=Ht({},kd,{dataTransfer:0}),S4=Fn(_4),k4=Ht({},au,{relatedTarget:0}),k0=Fn(k4),b4=Ht({},ul,{animationName:0,elapsedTime:0,pseudoElement:0}),E4=Fn(b4),T4=Ht({},ul,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),C4=Fn(T4),N4=Ht({},ul,{data:0}),Og=Fn(N4),A4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},j4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},D4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function F4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=D4[e])?!!t[e]:!1}function gm(){return F4}var R4=Ht({},au,{key:function(e){if(e.key){var t=A4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?j4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gm,charCode:function(e){return e.type==="keypress"?xf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),P4=Fn(R4),I4=Ht({},kd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lg=Fn(I4),O4=Ht({},au,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gm}),L4=Fn(O4),M4=Ht({},ul,{propertyName:0,elapsedTime:0,pseudoElement:0}),B4=Fn(M4),U4=Ht({},kd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$4=Fn(U4),z4=[9,13,27,32],vm=Zs&&"CompositionEvent"in window,Jl=null;Zs&&"documentMode"in document&&(Jl=document.documentMode);var W4=Zs&&"TextEvent"in window&&!Jl,Fw=Zs&&(!vm||Jl&&8<Jl&&11>=Jl),Mg=" ",Bg=!1;function Rw(e,t){switch(e){case"keyup":return z4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var So=!1;function V4(e,t){switch(e){case"compositionend":return Pw(t);case"keypress":return t.which!==32?null:(Bg=!0,Mg);case"textInput":return e=t.data,e===Mg&&Bg?null:e;default:return null}}function H4(e,t){if(So)return e==="compositionend"||!vm&&Rw(e,t)?(e=Dw(),mf=mm=ka=null,So=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fw&&t.locale!=="ko"?null:t.data;default:return null}}var G4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ug(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!G4[e.type]:t==="textarea"}function Iw(e,t,r,n){dw(n),t=Of(t,"onChange"),0<t.length&&(r=new xm("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ql=null,Sc=null;function X4(e){Gw(e,0)}function bd(e){var t=Eo(e);if(aw(t))return e}function K4(e,t){if(e==="change")return t}var Ow=!1;if(Zs){var b0;if(Zs){var E0="oninput"in document;if(!E0){var $g=document.createElement("div");$g.setAttribute("oninput","return;"),E0=typeof $g.oninput=="function"}b0=E0}else b0=!1;Ow=b0&&(!document.documentMode||9<document.documentMode)}function zg(){Ql&&(Ql.detachEvent("onpropertychange",Lw),Sc=Ql=null)}function Lw(e){if(e.propertyName==="value"&&bd(Sc)){var t=[];Iw(t,Sc,e,um(e)),xw(X4,t)}}function q4(e,t,r){e==="focusin"?(zg(),Ql=t,Sc=r,Ql.attachEvent("onpropertychange",Lw)):e==="focusout"&&zg()}function Y4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return bd(Sc)}function J4(e,t){if(e==="click")return bd(t)}function Q4(e,t){if(e==="input"||e==="change")return bd(t)}function Z4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ds=typeof Object.is=="function"?Object.is:Z4;function kc(e,t){if(ds(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Eh.call(t,s)||!ds(e[s],t[s]))return!1}return!0}function Wg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Vg(e,t){var r=Wg(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Wg(r)}}function Mw(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Mw(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Bw(){for(var e=window,t=Af();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Af(e.document)}return t}function ym(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function eC(e){var t=Bw(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Mw(r.ownerDocument.documentElement,r)){if(n!==null&&ym(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=Vg(r,a);var i=Vg(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var tC=Zs&&"documentMode"in document&&11>=document.documentMode,ko=null,Vh=null,Zl=null,Hh=!1;function Hg(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Hh||ko==null||ko!==Af(n)||(n=ko,"selectionStart"in n&&ym(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Zl&&kc(Zl,n)||(Zl=n,n=Of(Vh,"onSelect"),0<n.length&&(t=new xm("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ko)))}function Pu(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var bo={animationend:Pu("Animation","AnimationEnd"),animationiteration:Pu("Animation","AnimationIteration"),animationstart:Pu("Animation","AnimationStart"),transitionend:Pu("Transition","TransitionEnd")},T0={},Uw={};Zs&&(Uw=document.createElement("div").style,"AnimationEvent"in window||(delete bo.animationend.animation,delete bo.animationiteration.animation,delete bo.animationstart.animation),"TransitionEvent"in window||delete bo.transitionend.transition);function Ed(e){if(T0[e])return T0[e];if(!bo[e])return e;var t=bo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Uw)return T0[e]=t[r];return e}var $w=Ed("animationend"),zw=Ed("animationiteration"),Ww=Ed("animationstart"),Vw=Ed("transitionend"),Hw=new Map,Gg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ka(e,t){Hw.set(e,t),zi(t,[e])}for(var C0=0;C0<Gg.length;C0++){var N0=Gg[C0],rC=N0.toLowerCase(),nC=N0[0].toUpperCase()+N0.slice(1);Ka(rC,"on"+nC)}Ka($w,"onAnimationEnd");Ka(zw,"onAnimationIteration");Ka(Ww,"onAnimationStart");Ka("dblclick","onDoubleClick");Ka("focusin","onFocus");Ka("focusout","onBlur");Ka(Vw,"onTransitionEnd");Ko("onMouseEnter",["mouseout","mouseover"]);Ko("onMouseLeave",["mouseout","mouseover"]);Ko("onPointerEnter",["pointerout","pointerover"]);Ko("onPointerLeave",["pointerout","pointerover"]);zi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));zi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));zi("onBeforeInput",["compositionend","keypress","textInput","paste"]);zi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));zi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));zi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sC=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wl));function Xg(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,r4(n,t,void 0,e),e.currentTarget=null}function Gw(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==a&&s.isPropagationStopped())break e;Xg(s,o,u),a=c}else for(i=0;i<n.length;i++){if(o=n[i],c=o.instance,u=o.currentTarget,o=o.listener,c!==a&&s.isPropagationStopped())break e;Xg(s,o,u),a=c}}}if(Df)throw e=Uh,Df=!1,Uh=null,e}function Rt(e,t){var r=t[Yh];r===void 0&&(r=t[Yh]=new Set);var n=e+"__bubble";r.has(n)||(Xw(t,e,2,!1),r.add(n))}function A0(e,t,r){var n=0;t&&(n|=4),Xw(r,e,n,t)}var Iu="_reactListening"+Math.random().toString(36).slice(2);function bc(e){if(!e[Iu]){e[Iu]=!0,ew.forEach(function(r){r!=="selectionchange"&&(sC.has(r)||A0(r,!1,e),A0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Iu]||(t[Iu]=!0,A0("selectionchange",!1,t))}}function Xw(e,t,r,n){switch(jw(t)){case 1:var s=v4;break;case 4:s=y4;break;default:s=pm}r=s.bind(null,t,r,e),s=void 0,!Bh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function j0(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;o!==null;){if(i=di(o),i===null)return;if(c=i.tag,c===5||c===6){n=a=i;continue e}o=o.parentNode}}n=n.return}xw(function(){var u=a,f=um(r),d=[];e:{var h=Hw.get(e);if(h!==void 0){var p=xm,x=e;switch(e){case"keypress":if(xf(r)===0)break e;case"keydown":case"keyup":p=P4;break;case"focusin":x="focus",p=k0;break;case"focusout":x="blur",p=k0;break;case"beforeblur":case"afterblur":p=k0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Ig;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=S4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=L4;break;case $w:case zw:case Ww:p=E4;break;case Vw:p=B4;break;case"scroll":p=w4;break;case"wheel":p=$4;break;case"copy":case"cut":case"paste":p=C4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Lg}var m=(t&4)!==0,v=!m&&e==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var w=u,y;w!==null;){y=w;var k=y.stateNode;if(y.tag===5&&k!==null&&(y=k,g!==null&&(k=vc(w,g),k!=null&&m.push(Ec(w,k,y)))),v)break;w=w.return}0<m.length&&(h=new p(h,x,null,r,f),d.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Lh&&(x=r.relatedTarget||r.fromElement)&&(di(x)||x[ea]))break e;if((p||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=u,x=x?di(x):null,x!==null&&(v=Wi(x),x!==v||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=u),p!==x)){if(m=Ig,k="onMouseLeave",g="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(m=Lg,k="onPointerLeave",g="onPointerEnter",w="pointer"),v=p==null?h:Eo(p),y=x==null?h:Eo(x),h=new m(k,w+"leave",p,r,f),h.target=v,h.relatedTarget=y,k=null,di(f)===u&&(m=new m(g,w+"enter",x,r,f),m.target=y,m.relatedTarget=v,k=m),v=k,p&&x)t:{for(m=p,g=x,w=0,y=m;y;y=so(y))w++;for(y=0,k=g;k;k=so(k))y++;for(;0<w-y;)m=so(m),w--;for(;0<y-w;)g=so(g),y--;for(;w--;){if(m===g||g!==null&&m===g.alternate)break t;m=so(m),g=so(g)}m=null}else m=null;p!==null&&Kg(d,h,p,m,!1),x!==null&&v!==null&&Kg(d,v,x,m,!0)}}e:{if(h=u?Eo(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var E=K4;else if(Ug(h))if(Ow)E=Q4;else{E=Y4;var S=q4}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(E=J4);if(E&&(E=E(e,u))){Iw(d,E,r,f);break e}S&&S(e,h,u),e==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&Fh(h,"number",h.value)}switch(S=u?Eo(u):window,e){case"focusin":(Ug(S)||S.contentEditable==="true")&&(ko=S,Vh=u,Zl=null);break;case"focusout":Zl=Vh=ko=null;break;case"mousedown":Hh=!0;break;case"contextmenu":case"mouseup":case"dragend":Hh=!1,Hg(d,r,f);break;case"selectionchange":if(tC)break;case"keydown":case"keyup":Hg(d,r,f)}var _;if(vm)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else So?Rw(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(Fw&&r.locale!=="ko"&&(So||A!=="onCompositionStart"?A==="onCompositionEnd"&&So&&(_=Dw()):(ka=f,mm="value"in ka?ka.value:ka.textContent,So=!0)),S=Of(u,A),0<S.length&&(A=new Og(A,e,null,r,f),d.push({event:A,listeners:S}),_?A.data=_:(_=Pw(r),_!==null&&(A.data=_)))),(_=W4?V4(e,r):H4(e,r))&&(u=Of(u,"onBeforeInput"),0<u.length&&(f=new Og("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=_))}Gw(d,t)})}function Ec(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Of(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=vc(e,r),a!=null&&n.unshift(Ec(e,a,s)),a=vc(e,t),a!=null&&n.push(Ec(e,a,s))),e=e.return}return n}function so(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Kg(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,s?(c=vc(r,a),c!=null&&i.unshift(Ec(r,c,o))):s||(c=vc(r,a),c!=null&&i.push(Ec(r,c,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var aC=/\r\n?/g,iC=/\u0000|\uFFFD/g;function qg(e){return(typeof e=="string"?e:""+e).replace(aC,`
`).replace(iC,"")}function Ou(e,t,r){if(t=qg(t),qg(e)!==t&&r)throw Error(ve(425))}function Lf(){}var Gh=null,Xh=null;function Kh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var qh=typeof setTimeout=="function"?setTimeout:void 0,oC=typeof clearTimeout=="function"?clearTimeout:void 0,Yg=typeof Promise=="function"?Promise:void 0,lC=typeof queueMicrotask=="function"?queueMicrotask:typeof Yg<"u"?function(e){return Yg.resolve(null).then(e).catch(cC)}:qh;function cC(e){setTimeout(function(){throw e})}function D0(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),_c(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);_c(t)}function Fa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Jg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var fl=Math.random().toString(36).slice(2),ks="__reactFiber$"+fl,Tc="__reactProps$"+fl,ea="__reactContainer$"+fl,Yh="__reactEvents$"+fl,uC="__reactListeners$"+fl,fC="__reactHandles$"+fl;function di(e){var t=e[ks];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ea]||r[ks]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Jg(e);e!==null;){if(r=e[ks])return r;e=Jg(e)}return t}e=r,r=e.parentNode}return null}function iu(e){return e=e[ks]||e[ea],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Eo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ve(33))}function Td(e){return e[Tc]||null}var Jh=[],To=-1;function qa(e){return{current:e}}function It(e){0>To||(e.current=Jh[To],Jh[To]=null,To--)}function Dt(e,t){To++,Jh[To]=e.current,e.current=t}var Ua={},Xr=qa(Ua),pn=qa(!1),bi=Ua;function qo(e,t){var r=e.type.contextTypes;if(!r)return Ua;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function mn(e){return e=e.childContextTypes,e!=null}function Mf(){It(pn),It(Xr)}function Qg(e,t,r){if(Xr.current!==Ua)throw Error(ve(168));Dt(Xr,t),Dt(pn,r)}function Kw(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(ve(108,qT(e)||"Unknown",s));return Ht({},r,n)}function Bf(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ua,bi=Xr.current,Dt(Xr,e),Dt(pn,pn.current),!0}function Zg(e,t,r){var n=e.stateNode;if(!n)throw Error(ve(169));r?(e=Kw(e,t,bi),n.__reactInternalMemoizedMergedChildContext=e,It(pn),It(Xr),Dt(Xr,e)):It(pn),Dt(pn,r)}var Hs=null,Cd=!1,F0=!1;function qw(e){Hs===null?Hs=[e]:Hs.push(e)}function dC(e){Cd=!0,qw(e)}function Ya(){if(!F0&&Hs!==null){F0=!0;var e=0,t=_t;try{var r=Hs;for(_t=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Hs=null,Cd=!1}catch(s){throw Hs!==null&&(Hs=Hs.slice(e+1)),ww(fm,Ya),s}finally{_t=t,F0=!1}}return null}var Co=[],No=0,Uf=null,$f=0,Bn=[],Un=0,Ei=null,Gs=1,Xs="";function oi(e,t){Co[No++]=$f,Co[No++]=Uf,Uf=e,$f=t}function Yw(e,t,r){Bn[Un++]=Gs,Bn[Un++]=Xs,Bn[Un++]=Ei,Ei=e;var n=Gs;e=Xs;var s=32-ls(n)-1;n&=~(1<<s),r+=1;var a=32-ls(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Gs=1<<32-ls(t)+s|r<<s|n,Xs=a+e}else Gs=1<<a|r<<s|n,Xs=e}function wm(e){e.return!==null&&(oi(e,1),Yw(e,1,0))}function _m(e){for(;e===Uf;)Uf=Co[--No],Co[No]=null,$f=Co[--No],Co[No]=null;for(;e===Ei;)Ei=Bn[--Un],Bn[Un]=null,Xs=Bn[--Un],Bn[Un]=null,Gs=Bn[--Un],Bn[Un]=null}var En=null,bn=null,Bt=!1,as=null;function Jw(e,t){var r=$n(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ev(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,En=e,bn=Fa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,En=e,bn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ei!==null?{id:Gs,overflow:Xs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=$n(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,En=e,bn=null,!0):!1;default:return!1}}function Qh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Zh(e){if(Bt){var t=bn;if(t){var r=t;if(!ev(e,t)){if(Qh(e))throw Error(ve(418));t=Fa(r.nextSibling);var n=En;t&&ev(e,t)?Jw(n,r):(e.flags=e.flags&-4097|2,Bt=!1,En=e)}}else{if(Qh(e))throw Error(ve(418));e.flags=e.flags&-4097|2,Bt=!1,En=e}}}function tv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;En=e}function Lu(e){if(e!==En)return!1;if(!Bt)return tv(e),Bt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Kh(e.type,e.memoizedProps)),t&&(t=bn)){if(Qh(e))throw Qw(),Error(ve(418));for(;t;)Jw(e,t),t=Fa(t.nextSibling)}if(tv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ve(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){bn=Fa(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}bn=null}}else bn=En?Fa(e.stateNode.nextSibling):null;return!0}function Qw(){for(var e=bn;e;)e=Fa(e.nextSibling)}function Yo(){bn=En=null,Bt=!1}function Sm(e){as===null?as=[e]:as.push(e)}var hC=ia.ReactCurrentBatchConfig;function Rl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ve(309));var n=r.stateNode}if(!n)throw Error(ve(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(ve(284));if(!r._owner)throw Error(ve(290,e))}return e}function Mu(e,t){throw e=Object.prototype.toString.call(t),Error(ve(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rv(e){var t=e._init;return t(e._payload)}function Zw(e){function t(g,w){if(e){var y=g.deletions;y===null?(g.deletions=[w],g.flags|=16):y.push(w)}}function r(g,w){if(!e)return null;for(;w!==null;)t(g,w),w=w.sibling;return null}function n(g,w){for(g=new Map;w!==null;)w.key!==null?g.set(w.key,w):g.set(w.index,w),w=w.sibling;return g}function s(g,w){return g=Oa(g,w),g.index=0,g.sibling=null,g}function a(g,w,y){return g.index=y,e?(y=g.alternate,y!==null?(y=y.index,y<w?(g.flags|=2,w):y):(g.flags|=2,w)):(g.flags|=1048576,w)}function i(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,w,y,k){return w===null||w.tag!==6?(w=B0(y,g.mode,k),w.return=g,w):(w=s(w,y),w.return=g,w)}function c(g,w,y,k){var E=y.type;return E===_o?f(g,w,y.props.children,k,y.key):w!==null&&(w.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===va&&rv(E)===w.type)?(k=s(w,y.props),k.ref=Rl(g,w,y),k.return=g,k):(k=kf(y.type,y.key,y.props,null,g.mode,k),k.ref=Rl(g,w,y),k.return=g,k)}function u(g,w,y,k){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=U0(y,g.mode,k),w.return=g,w):(w=s(w,y.children||[]),w.return=g,w)}function f(g,w,y,k,E){return w===null||w.tag!==7?(w=vi(y,g.mode,k,E),w.return=g,w):(w=s(w,y),w.return=g,w)}function d(g,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=B0(""+w,g.mode,y),w.return=g,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Cu:return y=kf(w.type,w.key,w.props,null,g.mode,y),y.ref=Rl(g,null,w),y.return=g,y;case wo:return w=U0(w,g.mode,y),w.return=g,w;case va:var k=w._init;return d(g,k(w._payload),y)}if($l(w)||Nl(w))return w=vi(w,g.mode,y,null),w.return=g,w;Mu(g,w)}return null}function h(g,w,y,k){var E=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return E!==null?null:o(g,w,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Cu:return y.key===E?c(g,w,y,k):null;case wo:return y.key===E?u(g,w,y,k):null;case va:return E=y._init,h(g,w,E(y._payload),k)}if($l(y)||Nl(y))return E!==null?null:f(g,w,y,k,null);Mu(g,y)}return null}function p(g,w,y,k,E){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(y)||null,o(w,g,""+k,E);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Cu:return g=g.get(k.key===null?y:k.key)||null,c(w,g,k,E);case wo:return g=g.get(k.key===null?y:k.key)||null,u(w,g,k,E);case va:var S=k._init;return p(g,w,y,S(k._payload),E)}if($l(k)||Nl(k))return g=g.get(y)||null,f(w,g,k,E,null);Mu(w,k)}return null}function x(g,w,y,k){for(var E=null,S=null,_=w,A=w=0,F=null;_!==null&&A<y.length;A++){_.index>A?(F=_,_=null):F=_.sibling;var U=h(g,_,y[A],k);if(U===null){_===null&&(_=F);break}e&&_&&U.alternate===null&&t(g,_),w=a(U,w,A),S===null?E=U:S.sibling=U,S=U,_=F}if(A===y.length)return r(g,_),Bt&&oi(g,A),E;if(_===null){for(;A<y.length;A++)_=d(g,y[A],k),_!==null&&(w=a(_,w,A),S===null?E=_:S.sibling=_,S=_);return Bt&&oi(g,A),E}for(_=n(g,_);A<y.length;A++)F=p(_,g,A,y[A],k),F!==null&&(e&&F.alternate!==null&&_.delete(F.key===null?A:F.key),w=a(F,w,A),S===null?E=F:S.sibling=F,S=F);return e&&_.forEach(function(V){return t(g,V)}),Bt&&oi(g,A),E}function m(g,w,y,k){var E=Nl(y);if(typeof E!="function")throw Error(ve(150));if(y=E.call(y),y==null)throw Error(ve(151));for(var S=E=null,_=w,A=w=0,F=null,U=y.next();_!==null&&!U.done;A++,U=y.next()){_.index>A?(F=_,_=null):F=_.sibling;var V=h(g,_,U.value,k);if(V===null){_===null&&(_=F);break}e&&_&&V.alternate===null&&t(g,_),w=a(V,w,A),S===null?E=V:S.sibling=V,S=V,_=F}if(U.done)return r(g,_),Bt&&oi(g,A),E;if(_===null){for(;!U.done;A++,U=y.next())U=d(g,U.value,k),U!==null&&(w=a(U,w,A),S===null?E=U:S.sibling=U,S=U);return Bt&&oi(g,A),E}for(_=n(g,_);!U.done;A++,U=y.next())U=p(_,g,A,U.value,k),U!==null&&(e&&U.alternate!==null&&_.delete(U.key===null?A:U.key),w=a(U,w,A),S===null?E=U:S.sibling=U,S=U);return e&&_.forEach(function(N){return t(g,N)}),Bt&&oi(g,A),E}function v(g,w,y,k){if(typeof y=="object"&&y!==null&&y.type===_o&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Cu:e:{for(var E=y.key,S=w;S!==null;){if(S.key===E){if(E=y.type,E===_o){if(S.tag===7){r(g,S.sibling),w=s(S,y.props.children),w.return=g,g=w;break e}}else if(S.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===va&&rv(E)===S.type){r(g,S.sibling),w=s(S,y.props),w.ref=Rl(g,S,y),w.return=g,g=w;break e}r(g,S);break}else t(g,S);S=S.sibling}y.type===_o?(w=vi(y.props.children,g.mode,k,y.key),w.return=g,g=w):(k=kf(y.type,y.key,y.props,null,g.mode,k),k.ref=Rl(g,w,y),k.return=g,g=k)}return i(g);case wo:e:{for(S=y.key;w!==null;){if(w.key===S)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){r(g,w.sibling),w=s(w,y.children||[]),w.return=g,g=w;break e}else{r(g,w);break}else t(g,w);w=w.sibling}w=U0(y,g.mode,k),w.return=g,g=w}return i(g);case va:return S=y._init,v(g,w,S(y._payload),k)}if($l(y))return x(g,w,y,k);if(Nl(y))return m(g,w,y,k);Mu(g,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(r(g,w.sibling),w=s(w,y),w.return=g,g=w):(r(g,w),w=B0(y,g.mode,k),w.return=g,g=w),i(g)):r(g,w)}return v}var Jo=Zw(!0),e2=Zw(!1),zf=qa(null),Wf=null,Ao=null,km=null;function bm(){km=Ao=Wf=null}function Em(e){var t=zf.current;It(zf),e._currentValue=t}function ep(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Bo(e,t){Wf=e,km=Ao=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(hn=!0),e.firstContext=null)}function Xn(e){var t=e._currentValue;if(km!==e)if(e={context:e,memoizedValue:t,next:null},Ao===null){if(Wf===null)throw Error(ve(308));Ao=e,Wf.dependencies={lanes:0,firstContext:e}}else Ao=Ao.next=e;return t}var hi=null;function Tm(e){hi===null?hi=[e]:hi.push(e)}function t2(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Tm(t)):(r.next=s.next,s.next=r),t.interleaved=r,ta(e,n)}function ta(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ya=!1;function Cm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function r2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ra(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,mt&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,ta(e,r)}return s=n.interleaved,s===null?(t.next=t,Tm(n)):(t.next=s.next,s.next=t),n.interleaved=t,ta(e,r)}function gf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,dm(e,r)}}function nv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Vf(e,t,r,n){var s=e.updateQueue;ya=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=c))}if(a!==null){var d=s.baseState;i=0,f=u=c=null,o=a;do{var h=o.lane,p=o.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,m=o;switch(h=t,p=r,m.tag){case 1:if(x=m.payload,typeof x=="function"){d=x.call(p,d,h);break e}d=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=m.payload,h=typeof x=="function"?x.call(p,d,h):x,h==null)break e;d=Ht({},d,h);break e;case 2:ya=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=p,c=d):f=f.next=p,i|=h;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;h=o,o=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(f===null&&(c=d),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Ci|=i,e.lanes=i,e.memoizedState=d}}function sv(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ve(191,s));s.call(n)}}}var ou={},As=qa(ou),Cc=qa(ou),Nc=qa(ou);function pi(e){if(e===ou)throw Error(ve(174));return e}function Nm(e,t){switch(Dt(Nc,t),Dt(Cc,e),Dt(As,ou),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ph(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ph(t,e)}It(As),Dt(As,t)}function Qo(){It(As),It(Cc),It(Nc)}function n2(e){pi(Nc.current);var t=pi(As.current),r=Ph(t,e.type);t!==r&&(Dt(Cc,e),Dt(As,r))}function Am(e){Cc.current===e&&(It(As),It(Cc))}var zt=qa(0);function Hf(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var R0=[];function jm(){for(var e=0;e<R0.length;e++)R0[e]._workInProgressVersionPrimary=null;R0.length=0}var vf=ia.ReactCurrentDispatcher,P0=ia.ReactCurrentBatchConfig,Ti=0,Vt=null,gr=null,kr=null,Gf=!1,ec=!1,Ac=0,pC=0;function Lr(){throw Error(ve(321))}function Dm(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ds(e[r],t[r]))return!1;return!0}function Fm(e,t,r,n,s,a){if(Ti=a,Vt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,vf.current=e===null||e.memoizedState===null?vC:yC,e=r(n,s),ec){a=0;do{if(ec=!1,Ac=0,25<=a)throw Error(ve(301));a+=1,kr=gr=null,t.updateQueue=null,vf.current=wC,e=r(n,s)}while(ec)}if(vf.current=Xf,t=gr!==null&&gr.next!==null,Ti=0,kr=gr=Vt=null,Gf=!1,t)throw Error(ve(300));return e}function Rm(){var e=Ac!==0;return Ac=0,e}function _s(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kr===null?Vt.memoizedState=kr=e:kr=kr.next=e,kr}function Kn(){if(gr===null){var e=Vt.alternate;e=e!==null?e.memoizedState:null}else e=gr.next;var t=kr===null?Vt.memoizedState:kr.next;if(t!==null)kr=t,gr=e;else{if(e===null)throw Error(ve(310));gr=e,e={memoizedState:gr.memoizedState,baseState:gr.baseState,baseQueue:gr.baseQueue,queue:gr.queue,next:null},kr===null?Vt.memoizedState=kr=e:kr=kr.next=e}return kr}function jc(e,t){return typeof t=="function"?t(e):t}function I0(e){var t=Kn(),r=t.queue;if(r===null)throw Error(ve(311));r.lastRenderedReducer=e;var n=gr,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,c=null,u=a;do{var f=u.lane;if((Ti&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=d,i=n):c=c.next=d,Vt.lanes|=f,Ci|=f}u=u.next}while(u!==null&&u!==a);c===null?i=n:c.next=o,ds(n,t.memoizedState)||(hn=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Vt.lanes|=a,Ci|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function O0(e){var t=Kn(),r=t.queue;if(r===null)throw Error(ve(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);ds(a,t.memoizedState)||(hn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function s2(){}function a2(e,t){var r=Vt,n=Kn(),s=t(),a=!ds(n.memoizedState,s);if(a&&(n.memoizedState=s,hn=!0),n=n.queue,Pm(l2.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||kr!==null&&kr.memoizedState.tag&1){if(r.flags|=2048,Dc(9,o2.bind(null,r,n,s,t),void 0,null),Cr===null)throw Error(ve(349));Ti&30||i2(r,t,s)}return s}function i2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Vt.updateQueue,t===null?(t={lastEffect:null,stores:null},Vt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function o2(e,t,r,n){t.value=r,t.getSnapshot=n,c2(t)&&u2(e)}function l2(e,t,r){return r(function(){c2(t)&&u2(e)})}function c2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ds(e,r)}catch{return!0}}function u2(e){var t=ta(e,1);t!==null&&cs(t,e,1,-1)}function av(e){var t=_s();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jc,lastRenderedState:e},t.queue=e,e=e.dispatch=gC.bind(null,Vt,e),[t.memoizedState,e]}function Dc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Vt.updateQueue,t===null?(t={lastEffect:null,stores:null},Vt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function f2(){return Kn().memoizedState}function yf(e,t,r,n){var s=_s();Vt.flags|=e,s.memoizedState=Dc(1|t,r,void 0,n===void 0?null:n)}function Nd(e,t,r,n){var s=Kn();n=n===void 0?null:n;var a=void 0;if(gr!==null){var i=gr.memoizedState;if(a=i.destroy,n!==null&&Dm(n,i.deps)){s.memoizedState=Dc(t,r,a,n);return}}Vt.flags|=e,s.memoizedState=Dc(1|t,r,a,n)}function iv(e,t){return yf(8390656,8,e,t)}function Pm(e,t){return Nd(2048,8,e,t)}function d2(e,t){return Nd(4,2,e,t)}function h2(e,t){return Nd(4,4,e,t)}function p2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function m2(e,t,r){return r=r!=null?r.concat([e]):null,Nd(4,4,p2.bind(null,t,e),r)}function Im(){}function x2(e,t){var r=Kn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Dm(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function g2(e,t){var r=Kn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Dm(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function v2(e,t,r){return Ti&21?(ds(r,t)||(r=kw(),Vt.lanes|=r,Ci|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,hn=!0),e.memoizedState=r)}function mC(e,t){var r=_t;_t=r!==0&&4>r?r:4,e(!0);var n=P0.transition;P0.transition={};try{e(!1),t()}finally{_t=r,P0.transition=n}}function y2(){return Kn().memoizedState}function xC(e,t,r){var n=Ia(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},w2(e))_2(t,r);else if(r=t2(e,t,r,n),r!==null){var s=rn();cs(r,e,n,s),S2(r,t,n)}}function gC(e,t,r){var n=Ia(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(w2(e))_2(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,ds(o,i)){var c=t.interleaved;c===null?(s.next=s,Tm(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=t2(e,t,s,n),r!==null&&(s=rn(),cs(r,e,n,s),S2(r,t,n))}}function w2(e){var t=e.alternate;return e===Vt||t!==null&&t===Vt}function _2(e,t){ec=Gf=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function S2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,dm(e,r)}}var Xf={readContext:Xn,useCallback:Lr,useContext:Lr,useEffect:Lr,useImperativeHandle:Lr,useInsertionEffect:Lr,useLayoutEffect:Lr,useMemo:Lr,useReducer:Lr,useRef:Lr,useState:Lr,useDebugValue:Lr,useDeferredValue:Lr,useTransition:Lr,useMutableSource:Lr,useSyncExternalStore:Lr,useId:Lr,unstable_isNewReconciler:!1},vC={readContext:Xn,useCallback:function(e,t){return _s().memoizedState=[e,t===void 0?null:t],e},useContext:Xn,useEffect:iv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,yf(4194308,4,p2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return yf(4194308,4,e,t)},useInsertionEffect:function(e,t){return yf(4,2,e,t)},useMemo:function(e,t){var r=_s();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=_s();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=xC.bind(null,Vt,e),[n.memoizedState,e]},useRef:function(e){var t=_s();return e={current:e},t.memoizedState=e},useState:av,useDebugValue:Im,useDeferredValue:function(e){return _s().memoizedState=e},useTransition:function(){var e=av(!1),t=e[0];return e=mC.bind(null,e[1]),_s().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Vt,s=_s();if(Bt){if(r===void 0)throw Error(ve(407));r=r()}else{if(r=t(),Cr===null)throw Error(ve(349));Ti&30||i2(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,iv(l2.bind(null,n,a,e),[e]),n.flags|=2048,Dc(9,o2.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=_s(),t=Cr.identifierPrefix;if(Bt){var r=Xs,n=Gs;r=(n&~(1<<32-ls(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ac++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=pC++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},yC={readContext:Xn,useCallback:x2,useContext:Xn,useEffect:Pm,useImperativeHandle:m2,useInsertionEffect:d2,useLayoutEffect:h2,useMemo:g2,useReducer:I0,useRef:f2,useState:function(){return I0(jc)},useDebugValue:Im,useDeferredValue:function(e){var t=Kn();return v2(t,gr.memoizedState,e)},useTransition:function(){var e=I0(jc)[0],t=Kn().memoizedState;return[e,t]},useMutableSource:s2,useSyncExternalStore:a2,useId:y2,unstable_isNewReconciler:!1},wC={readContext:Xn,useCallback:x2,useContext:Xn,useEffect:Pm,useImperativeHandle:m2,useInsertionEffect:d2,useLayoutEffect:h2,useMemo:g2,useReducer:O0,useRef:f2,useState:function(){return O0(jc)},useDebugValue:Im,useDeferredValue:function(e){var t=Kn();return gr===null?t.memoizedState=e:v2(t,gr.memoizedState,e)},useTransition:function(){var e=O0(jc)[0],t=Kn().memoizedState;return[e,t]},useMutableSource:s2,useSyncExternalStore:a2,useId:y2,unstable_isNewReconciler:!1};function rs(e,t){if(e&&e.defaultProps){t=Ht({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function tp(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ht({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Ad={isMounted:function(e){return(e=e._reactInternals)?Wi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=rn(),s=Ia(e),a=qs(n,s);a.payload=t,r!=null&&(a.callback=r),t=Ra(e,a,s),t!==null&&(cs(t,e,s,n),gf(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=rn(),s=Ia(e),a=qs(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Ra(e,a,s),t!==null&&(cs(t,e,s,n),gf(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=rn(),n=Ia(e),s=qs(r,n);s.tag=2,t!=null&&(s.callback=t),t=Ra(e,s,n),t!==null&&(cs(t,e,n,r),gf(t,e,n))}};function ov(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!kc(r,n)||!kc(s,a):!0}function k2(e,t,r){var n=!1,s=Ua,a=t.contextType;return typeof a=="object"&&a!==null?a=Xn(a):(s=mn(t)?bi:Xr.current,n=t.contextTypes,a=(n=n!=null)?qo(e,s):Ua),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ad,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function lv(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Ad.enqueueReplaceState(t,t.state,null)}function rp(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Cm(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Xn(a):(a=mn(t)?bi:Xr.current,s.context=qo(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(tp(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Ad.enqueueReplaceState(s,s.state,null),Vf(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Zo(e,t){try{var r="",n=t;do r+=KT(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function L0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function np(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var _C=typeof WeakMap=="function"?WeakMap:Map;function b2(e,t,r){r=qs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){qf||(qf=!0,hp=n),np(e,t)},r}function E2(e,t,r){r=qs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){np(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){np(e,t),typeof n!="function"&&(Pa===null?Pa=new Set([this]):Pa.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function cv(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new _C;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=IC.bind(null,e,t,r),t.then(e,e))}function uv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function fv(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=qs(-1,1),t.tag=2,Ra(r,t,1))),r.lanes|=1),e)}var SC=ia.ReactCurrentOwner,hn=!1;function Zr(e,t,r,n){t.child=e===null?e2(t,null,r,n):Jo(t,e.child,r,n)}function dv(e,t,r,n,s){r=r.render;var a=t.ref;return Bo(t,s),n=Fm(e,t,r,n,a,s),r=Rm(),e!==null&&!hn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ra(e,t,s)):(Bt&&r&&wm(t),t.flags|=1,Zr(e,t,n,s),t.child)}function hv(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Wm(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,T2(e,t,a,n,s)):(e=kf(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:kc,r(i,n)&&e.ref===t.ref)return ra(e,t,s)}return t.flags|=1,e=Oa(a,n),e.ref=t.ref,e.return=t,t.child=e}function T2(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(kc(a,n)&&e.ref===t.ref)if(hn=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(hn=!0);else return t.lanes=e.lanes,ra(e,t,s)}return sp(e,t,r,n,s)}function C2(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dt(Do,yn),yn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Dt(Do,yn),yn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Dt(Do,yn),yn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Dt(Do,yn),yn|=n;return Zr(e,t,s,r),t.child}function N2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function sp(e,t,r,n,s){var a=mn(r)?bi:Xr.current;return a=qo(t,a),Bo(t,s),r=Fm(e,t,r,n,a,s),n=Rm(),e!==null&&!hn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ra(e,t,s)):(Bt&&n&&wm(t),t.flags|=1,Zr(e,t,r,s),t.child)}function pv(e,t,r,n,s){if(mn(r)){var a=!0;Bf(t)}else a=!1;if(Bo(t,s),t.stateNode===null)wf(e,t),k2(t,r,n),rp(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Xn(u):(u=mn(r)?bi:Xr.current,u=qo(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||c!==u)&&lv(t,i,n,u),ya=!1;var h=t.memoizedState;i.state=h,Vf(t,n,i,s),c=t.memoizedState,o!==n||h!==c||pn.current||ya?(typeof f=="function"&&(tp(t,r,f,n),c=t.memoizedState),(o=ya||ov(t,r,o,n,h,c,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,r2(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:rs(t.type,o),i.props=u,d=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Xn(c):(c=mn(r)?bi:Xr.current,c=qo(t,c));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||h!==c)&&lv(t,i,n,c),ya=!1,h=t.memoizedState,i.state=h,Vf(t,n,i,s);var x=t.memoizedState;o!==d||h!==x||pn.current||ya?(typeof p=="function"&&(tp(t,r,p,n),x=t.memoizedState),(u=ya||ov(t,r,u,n,h,x,c)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),i.props=n,i.state=x,i.context=c,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return ap(e,t,r,n,a,s)}function ap(e,t,r,n,s,a){N2(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&Zg(t,r,!1),ra(e,t,a);n=t.stateNode,SC.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Jo(t,e.child,null,a),t.child=Jo(t,null,o,a)):Zr(e,t,o,a),t.memoizedState=n.state,s&&Zg(t,r,!0),t.child}function A2(e){var t=e.stateNode;t.pendingContext?Qg(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Qg(e,t.context,!1),Nm(e,t.containerInfo)}function mv(e,t,r,n,s){return Yo(),Sm(s),t.flags|=256,Zr(e,t,r,n),t.child}var ip={dehydrated:null,treeContext:null,retryLane:0};function op(e){return{baseLanes:e,cachePool:null,transitions:null}}function j2(e,t,r){var n=t.pendingProps,s=zt.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Dt(zt,s&1),e===null)return Zh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Fd(i,n,0,null),e=vi(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=op(r),t.memoizedState=ip,e):Om(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return kC(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Oa(s,c),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=Oa(o,a):(a=vi(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?op(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=ip,n}return a=e.child,e=a.sibling,n=Oa(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Om(e,t){return t=Fd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Bu(e,t,r,n){return n!==null&&Sm(n),Jo(t,e.child,null,r),e=Om(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function kC(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=L0(Error(ve(422))),Bu(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Fd({mode:"visible",children:n.children},s,0,null),a=vi(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Jo(t,e.child,null,i),t.child.memoizedState=op(i),t.memoizedState=ip,a);if(!(t.mode&1))return Bu(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(ve(419)),n=L0(a,n,void 0),Bu(e,t,i,n)}if(o=(i&e.childLanes)!==0,hn||o){if(n=Cr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,ta(e,s),cs(n,e,s,-1))}return zm(),n=L0(Error(ve(421))),Bu(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=OC.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,bn=Fa(s.nextSibling),En=t,Bt=!0,as=null,e!==null&&(Bn[Un++]=Gs,Bn[Un++]=Xs,Bn[Un++]=Ei,Gs=e.id,Xs=e.overflow,Ei=t),t=Om(t,n.children),t.flags|=4096,t)}function xv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),ep(e.return,t,r)}function M0(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function D2(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(Zr(e,t,n.children,r),n=zt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&xv(e,r,t);else if(e.tag===19)xv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Dt(zt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Hf(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),M0(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Hf(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}M0(t,!0,r,null,a);break;case"together":M0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function wf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ra(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ci|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ve(153));if(t.child!==null){for(e=t.child,r=Oa(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Oa(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function bC(e,t,r){switch(t.tag){case 3:A2(t),Yo();break;case 5:n2(t);break;case 1:mn(t.type)&&Bf(t);break;case 4:Nm(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Dt(zf,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Dt(zt,zt.current&1),t.flags|=128,null):r&t.child.childLanes?j2(e,t,r):(Dt(zt,zt.current&1),e=ra(e,t,r),e!==null?e.sibling:null);Dt(zt,zt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return D2(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Dt(zt,zt.current),n)break;return null;case 22:case 23:return t.lanes=0,C2(e,t,r)}return ra(e,t,r)}var F2,lp,R2,P2;F2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};lp=function(){};R2=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,pi(As.current);var a=null;switch(r){case"input":s=jh(e,s),n=jh(e,n),a=[];break;case"select":s=Ht({},s,{value:void 0}),n=Ht({},n,{value:void 0}),a=[];break;case"textarea":s=Rh(e,s),n=Rh(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Lf)}Ih(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(xc.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(o=s?.[u],n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(xc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Rt("scroll",e),a||o===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};P2=function(e,t,r,n){r!==n&&(t.flags|=4)};function Pl(e,t){if(!Bt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Mr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function EC(e,t,r){var n=t.pendingProps;switch(_m(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mr(t),null;case 1:return mn(t.type)&&Mf(),Mr(t),null;case 3:return n=t.stateNode,Qo(),It(pn),It(Xr),jm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Lu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,as!==null&&(xp(as),as=null))),lp(e,t),Mr(t),null;case 5:Am(t);var s=pi(Nc.current);if(r=t.type,e!==null&&t.stateNode!=null)R2(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ve(166));return Mr(t),null}if(e=pi(As.current),Lu(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[ks]=t,n[Tc]=a,e=(t.mode&1)!==0,r){case"dialog":Rt("cancel",n),Rt("close",n);break;case"iframe":case"object":case"embed":Rt("load",n);break;case"video":case"audio":for(s=0;s<Wl.length;s++)Rt(Wl[s],n);break;case"source":Rt("error",n);break;case"img":case"image":case"link":Rt("error",n),Rt("load",n);break;case"details":Rt("toggle",n);break;case"input":Eg(n,a),Rt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Rt("invalid",n);break;case"textarea":Cg(n,a),Rt("invalid",n)}Ih(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Ou(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Ou(n.textContent,o,e),s=["children",""+o]):xc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Rt("scroll",n)}switch(r){case"input":Nu(n),Tg(n,a,!0);break;case"textarea":Nu(n),Ng(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Lf)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=lw(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[ks]=t,e[Tc]=n,F2(e,t,!1,!1),t.stateNode=e;e:{switch(i=Oh(r,n),r){case"dialog":Rt("cancel",e),Rt("close",e),s=n;break;case"iframe":case"object":case"embed":Rt("load",e),s=n;break;case"video":case"audio":for(s=0;s<Wl.length;s++)Rt(Wl[s],e);s=n;break;case"source":Rt("error",e),s=n;break;case"img":case"image":case"link":Rt("error",e),Rt("load",e),s=n;break;case"details":Rt("toggle",e),s=n;break;case"input":Eg(e,n),s=jh(e,n),Rt("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Ht({},n,{value:void 0}),Rt("invalid",e);break;case"textarea":Cg(e,n),s=Rh(e,n),Rt("invalid",e);break;default:s=n}Ih(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?fw(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&cw(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&gc(e,c):typeof c=="number"&&gc(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(xc.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Rt("scroll",e):c!=null&&im(e,a,c,i))}switch(r){case"input":Nu(e),Tg(e,n,!1);break;case"textarea":Nu(e),Ng(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ba(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Io(e,!!n.multiple,a,!1):n.defaultValue!=null&&Io(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Lf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Mr(t),null;case 6:if(e&&t.stateNode!=null)P2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ve(166));if(r=pi(Nc.current),pi(As.current),Lu(t)){if(n=t.stateNode,r=t.memoizedProps,n[ks]=t,(a=n.nodeValue!==r)&&(e=En,e!==null))switch(e.tag){case 3:Ou(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ou(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ks]=t,t.stateNode=n}return Mr(t),null;case 13:if(It(zt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Bt&&bn!==null&&t.mode&1&&!(t.flags&128))Qw(),Yo(),t.flags|=98560,a=!1;else if(a=Lu(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(ve(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ve(317));a[ks]=t}else Yo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Mr(t),a=!1}else as!==null&&(xp(as),as=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||zt.current&1?yr===0&&(yr=3):zm())),t.updateQueue!==null&&(t.flags|=4),Mr(t),null);case 4:return Qo(),lp(e,t),e===null&&bc(t.stateNode.containerInfo),Mr(t),null;case 10:return Em(t.type._context),Mr(t),null;case 17:return mn(t.type)&&Mf(),Mr(t),null;case 19:if(It(zt),a=t.memoizedState,a===null)return Mr(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)Pl(a,!1);else{if(yr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Hf(e),i!==null){for(t.flags|=128,Pl(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Dt(zt,zt.current&1|2),t.child}e=e.sibling}a.tail!==null&&sr()>el&&(t.flags|=128,n=!0,Pl(a,!1),t.lanes=4194304)}else{if(!n)if(e=Hf(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Pl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Bt)return Mr(t),null}else 2*sr()-a.renderingStartTime>el&&r!==1073741824&&(t.flags|=128,n=!0,Pl(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=sr(),t.sibling=null,r=zt.current,Dt(zt,n?r&1|2:r&1),t):(Mr(t),null);case 22:case 23:return $m(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?yn&1073741824&&(Mr(t),t.subtreeFlags&6&&(t.flags|=8192)):Mr(t),null;case 24:return null;case 25:return null}throw Error(ve(156,t.tag))}function TC(e,t){switch(_m(t),t.tag){case 1:return mn(t.type)&&Mf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Qo(),It(pn),It(Xr),jm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Am(t),null;case 13:if(It(zt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ve(340));Yo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return It(zt),null;case 4:return Qo(),null;case 10:return Em(t.type._context),null;case 22:case 23:return $m(),null;case 24:return null;default:return null}}var Uu=!1,zr=!1,CC=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function jo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Jt(e,t,n)}else r.current=null}function cp(e,t,r){try{r()}catch(n){Jt(e,t,n)}}var gv=!1;function NC(e,t){if(Gh=Pf,e=Bw(),ym(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,c=-1,u=0,f=0,d=e,h=null;t:for(;;){for(var p;d!==r||s!==0&&d.nodeType!==3||(o=i+s),d!==a||n!==0&&d.nodeType!==3||(c=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===e)break t;if(h===r&&++u===s&&(o=i),h===a&&++f===n&&(c=i),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Xh={focusedElem:e,selectionRange:r},Pf=!1,Ne=t;Ne!==null;)if(t=Ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ne=e;else for(;Ne!==null;){t=Ne;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var m=x.memoizedProps,v=x.memoizedState,g=t.stateNode,w=g.getSnapshotBeforeUpdate(t.elementType===t.type?m:rs(t.type,m),v);g.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ve(163))}}catch(k){Jt(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,Ne=e;break}Ne=t.return}return x=gv,gv=!1,x}function tc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&cp(t,r,a)}s=s.next}while(s!==n)}}function jd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function up(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function I2(e){var t=e.alternate;t!==null&&(e.alternate=null,I2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ks],delete t[Tc],delete t[Yh],delete t[uC],delete t[fC])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function O2(e){return e.tag===5||e.tag===3||e.tag===4}function vv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||O2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function fp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Lf));else if(n!==4&&(e=e.child,e!==null))for(fp(e,t,r),e=e.sibling;e!==null;)fp(e,t,r),e=e.sibling}function dp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(dp(e,t,r),e=e.sibling;e!==null;)dp(e,t,r),e=e.sibling}var Ar=null,ns=!1;function da(e,t,r){for(r=r.child;r!==null;)L2(e,t,r),r=r.sibling}function L2(e,t,r){if(Ns&&typeof Ns.onCommitFiberUnmount=="function")try{Ns.onCommitFiberUnmount(Sd,r)}catch{}switch(r.tag){case 5:zr||jo(r,t);case 6:var n=Ar,s=ns;Ar=null,da(e,t,r),Ar=n,ns=s,Ar!==null&&(ns?(e=Ar,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ar.removeChild(r.stateNode));break;case 18:Ar!==null&&(ns?(e=Ar,r=r.stateNode,e.nodeType===8?D0(e.parentNode,r):e.nodeType===1&&D0(e,r),_c(e)):D0(Ar,r.stateNode));break;case 4:n=Ar,s=ns,Ar=r.stateNode.containerInfo,ns=!0,da(e,t,r),Ar=n,ns=s;break;case 0:case 11:case 14:case 15:if(!zr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&cp(r,t,i),s=s.next}while(s!==n)}da(e,t,r);break;case 1:if(!zr&&(jo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Jt(r,t,o)}da(e,t,r);break;case 21:da(e,t,r);break;case 22:r.mode&1?(zr=(n=zr)||r.memoizedState!==null,da(e,t,r),zr=n):da(e,t,r);break;default:da(e,t,r)}}function yv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new CC),t.forEach(function(n){var s=LC.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Jn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Ar=o.stateNode,ns=!1;break e;case 3:Ar=o.stateNode.containerInfo,ns=!0;break e;case 4:Ar=o.stateNode.containerInfo,ns=!0;break e}o=o.return}if(Ar===null)throw Error(ve(160));L2(a,i,s),Ar=null,ns=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Jt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)M2(t,e),t=t.sibling}function M2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Jn(t,e),xs(e),n&4){try{tc(3,e,e.return),jd(3,e)}catch(m){Jt(e,e.return,m)}try{tc(5,e,e.return)}catch(m){Jt(e,e.return,m)}}break;case 1:Jn(t,e),xs(e),n&512&&r!==null&&jo(r,r.return);break;case 5:if(Jn(t,e),xs(e),n&512&&r!==null&&jo(r,r.return),e.flags&32){var s=e.stateNode;try{gc(s,"")}catch(m){Jt(e,e.return,m)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&iw(s,a),Oh(o,i);var u=Oh(o,a);for(i=0;i<c.length;i+=2){var f=c[i],d=c[i+1];f==="style"?fw(s,d):f==="dangerouslySetInnerHTML"?cw(s,d):f==="children"?gc(s,d):im(s,f,d,u)}switch(o){case"input":Dh(s,a);break;case"textarea":ow(s,a);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Io(s,!!a.multiple,p,!1):h!==!!a.multiple&&(a.defaultValue!=null?Io(s,!!a.multiple,a.defaultValue,!0):Io(s,!!a.multiple,a.multiple?[]:"",!1))}s[Tc]=a}catch(m){Jt(e,e.return,m)}}break;case 6:if(Jn(t,e),xs(e),n&4){if(e.stateNode===null)throw Error(ve(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(m){Jt(e,e.return,m)}}break;case 3:if(Jn(t,e),xs(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{_c(t.containerInfo)}catch(m){Jt(e,e.return,m)}break;case 4:Jn(t,e),xs(e);break;case 13:Jn(t,e),xs(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Bm=sr())),n&4&&yv(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(zr=(u=zr)||f,Jn(t,e),zr=u):Jn(t,e),xs(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(Ne=e,f=e.child;f!==null;){for(d=Ne=f;Ne!==null;){switch(h=Ne,p=h.child,h.tag){case 0:case 11:case 14:case 15:tc(4,h,h.return);break;case 1:jo(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(m){Jt(n,r,m)}}break;case 5:jo(h,h.return);break;case 22:if(h.memoizedState!==null){_v(d);continue}}p!==null?(p.return=h,Ne=p):_v(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{s=d.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,c=d.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=uw("display",i))}catch(m){Jt(e,e.return,m)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Jt(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Jn(t,e),xs(e),n&4&&yv(e);break;case 21:break;default:Jn(t,e),xs(e)}}function xs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(O2(r)){var n=r;break e}r=r.return}throw Error(ve(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(gc(s,""),n.flags&=-33);var a=vv(e);dp(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=vv(e);fp(e,o,i);break;default:throw Error(ve(161))}}catch(c){Jt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function AC(e,t,r){Ne=e,B2(e)}function B2(e,t,r){for(var n=(e.mode&1)!==0;Ne!==null;){var s=Ne,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||Uu;if(!i){var o=s.alternate,c=o!==null&&o.memoizedState!==null||zr;o=Uu;var u=zr;if(Uu=i,(zr=c)&&!u)for(Ne=s;Ne!==null;)i=Ne,c=i.child,i.tag===22&&i.memoizedState!==null?Sv(s):c!==null?(c.return=i,Ne=c):Sv(s);for(;a!==null;)Ne=a,B2(a),a=a.sibling;Ne=s,Uu=o,zr=u}wv(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Ne=a):wv(e)}}function wv(e){for(;Ne!==null;){var t=Ne;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:zr||jd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!zr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:rs(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&sv(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}sv(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&_c(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ve(163))}zr||t.flags&512&&up(t)}catch(h){Jt(t,t.return,h)}}if(t===e){Ne=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function _v(e){for(;Ne!==null;){var t=Ne;if(t===e){Ne=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function Sv(e){for(;Ne!==null;){var t=Ne;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{jd(4,t)}catch(c){Jt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){Jt(t,s,c)}}var a=t.return;try{up(t)}catch(c){Jt(t,a,c)}break;case 5:var i=t.return;try{up(t)}catch(c){Jt(t,i,c)}}}catch(c){Jt(t,t.return,c)}if(t===e){Ne=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ne=o;break}Ne=t.return}}var jC=Math.ceil,Kf=ia.ReactCurrentDispatcher,Lm=ia.ReactCurrentOwner,Wn=ia.ReactCurrentBatchConfig,mt=0,Cr=null,fr=null,Rr=0,yn=0,Do=qa(0),yr=0,Fc=null,Ci=0,Dd=0,Mm=0,rc=null,fn=null,Bm=0,el=1/0,Ws=null,qf=!1,hp=null,Pa=null,$u=!1,ba=null,Yf=0,nc=0,pp=null,_f=-1,Sf=0;function rn(){return mt&6?sr():_f!==-1?_f:_f=sr()}function Ia(e){return e.mode&1?mt&2&&Rr!==0?Rr&-Rr:hC.transition!==null?(Sf===0&&(Sf=kw()),Sf):(e=_t,e!==0||(e=window.event,e=e===void 0?16:jw(e.type)),e):1}function cs(e,t,r,n){if(50<nc)throw nc=0,pp=null,Error(ve(185));su(e,r,n),(!(mt&2)||e!==Cr)&&(e===Cr&&(!(mt&2)&&(Dd|=r),yr===4&&_a(e,Rr)),xn(e,n),r===1&&mt===0&&!(t.mode&1)&&(el=sr()+500,Cd&&Ya()))}function xn(e,t){var r=e.callbackNode;h4(e,t);var n=Rf(e,e===Cr?Rr:0);if(n===0)r!==null&&Dg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Dg(r),t===1)e.tag===0?dC(kv.bind(null,e)):qw(kv.bind(null,e)),lC(function(){!(mt&6)&&Ya()}),r=null;else{switch(bw(n)){case 1:r=fm;break;case 4:r=_w;break;case 16:r=Ff;break;case 536870912:r=Sw;break;default:r=Ff}r=X2(r,U2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function U2(e,t){if(_f=-1,Sf=0,mt&6)throw Error(ve(327));var r=e.callbackNode;if(Uo()&&e.callbackNode!==r)return null;var n=Rf(e,e===Cr?Rr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Jf(e,n);else{t=n;var s=mt;mt|=2;var a=z2();(Cr!==e||Rr!==t)&&(Ws=null,el=sr()+500,gi(e,t));do try{RC();break}catch(o){$2(e,o)}while(!0);bm(),Kf.current=a,mt=s,fr!==null?t=0:(Cr=null,Rr=0,t=yr)}if(t!==0){if(t===2&&(s=$h(e),s!==0&&(n=s,t=mp(e,s))),t===1)throw r=Fc,gi(e,0),_a(e,n),xn(e,sr()),r;if(t===6)_a(e,n);else{if(s=e.current.alternate,!(n&30)&&!DC(s)&&(t=Jf(e,n),t===2&&(a=$h(e),a!==0&&(n=a,t=mp(e,a))),t===1))throw r=Fc,gi(e,0),_a(e,n),xn(e,sr()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(ve(345));case 2:li(e,fn,Ws);break;case 3:if(_a(e,n),(n&130023424)===n&&(t=Bm+500-sr(),10<t)){if(Rf(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){rn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=qh(li.bind(null,e,fn,Ws),t);break}li(e,fn,Ws);break;case 4:if(_a(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-ls(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=sr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*jC(n/1960))-n,10<n){e.timeoutHandle=qh(li.bind(null,e,fn,Ws),n);break}li(e,fn,Ws);break;case 5:li(e,fn,Ws);break;default:throw Error(ve(329))}}}return xn(e,sr()),e.callbackNode===r?U2.bind(null,e):null}function mp(e,t){var r=rc;return e.current.memoizedState.isDehydrated&&(gi(e,t).flags|=256),e=Jf(e,t),e!==2&&(t=fn,fn=r,t!==null&&xp(t)),e}function xp(e){fn===null?fn=e:fn.push.apply(fn,e)}function DC(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!ds(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function _a(e,t){for(t&=~Mm,t&=~Dd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ls(t),n=1<<r;e[r]=-1,t&=~n}}function kv(e){if(mt&6)throw Error(ve(327));Uo();var t=Rf(e,0);if(!(t&1))return xn(e,sr()),null;var r=Jf(e,t);if(e.tag!==0&&r===2){var n=$h(e);n!==0&&(t=n,r=mp(e,n))}if(r===1)throw r=Fc,gi(e,0),_a(e,t),xn(e,sr()),r;if(r===6)throw Error(ve(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,li(e,fn,Ws),xn(e,sr()),null}function Um(e,t){var r=mt;mt|=1;try{return e(t)}finally{mt=r,mt===0&&(el=sr()+500,Cd&&Ya())}}function Ni(e){ba!==null&&ba.tag===0&&!(mt&6)&&Uo();var t=mt;mt|=1;var r=Wn.transition,n=_t;try{if(Wn.transition=null,_t=1,e)return e()}finally{_t=n,Wn.transition=r,mt=t,!(mt&6)&&Ya()}}function $m(){yn=Do.current,It(Do)}function gi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,oC(r)),fr!==null)for(r=fr.return;r!==null;){var n=r;switch(_m(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Mf();break;case 3:Qo(),It(pn),It(Xr),jm();break;case 5:Am(n);break;case 4:Qo();break;case 13:It(zt);break;case 19:It(zt);break;case 10:Em(n.type._context);break;case 22:case 23:$m()}r=r.return}if(Cr=e,fr=e=Oa(e.current,null),Rr=yn=t,yr=0,Fc=null,Mm=Dd=Ci=0,fn=rc=null,hi!==null){for(t=0;t<hi.length;t++)if(r=hi[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}hi=null}return e}function $2(e,t){do{var r=fr;try{if(bm(),vf.current=Xf,Gf){for(var n=Vt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Gf=!1}if(Ti=0,kr=gr=Vt=null,ec=!1,Ac=0,Lm.current=null,r===null||r.return===null){yr=1,Fc=t,fr=null;break}e:{var a=e,i=r.return,o=r,c=t;if(t=Rr,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=uv(i);if(p!==null){p.flags&=-257,fv(p,i,o,a,t),p.mode&1&&cv(a,u,t),t=p,c=u;var x=t.updateQueue;if(x===null){var m=new Set;m.add(c),t.updateQueue=m}else x.add(c);break e}else{if(!(t&1)){cv(a,u,t),zm();break e}c=Error(ve(426))}}else if(Bt&&o.mode&1){var v=uv(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),fv(v,i,o,a,t),Sm(Zo(c,o));break e}}a=c=Zo(c,o),yr!==4&&(yr=2),rc===null?rc=[a]:rc.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var g=b2(a,c,t);nv(a,g);break e;case 1:o=c;var w=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Pa===null||!Pa.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t;var k=E2(a,o,t);nv(a,k);break e}}a=a.return}while(a!==null)}V2(r)}catch(E){t=E,fr===r&&r!==null&&(fr=r=r.return);continue}break}while(!0)}function z2(){var e=Kf.current;return Kf.current=Xf,e===null?Xf:e}function zm(){(yr===0||yr===3||yr===2)&&(yr=4),Cr===null||!(Ci&268435455)&&!(Dd&268435455)||_a(Cr,Rr)}function Jf(e,t){var r=mt;mt|=2;var n=z2();(Cr!==e||Rr!==t)&&(Ws=null,gi(e,t));do try{FC();break}catch(s){$2(e,s)}while(!0);if(bm(),mt=r,Kf.current=n,fr!==null)throw Error(ve(261));return Cr=null,Rr=0,yr}function FC(){for(;fr!==null;)W2(fr)}function RC(){for(;fr!==null&&!s4();)W2(fr)}function W2(e){var t=G2(e.alternate,e,yn);e.memoizedProps=e.pendingProps,t===null?V2(e):fr=t,Lm.current=null}function V2(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=TC(r,t),r!==null){r.flags&=32767,fr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{yr=6,fr=null;return}}else if(r=EC(r,t,yn),r!==null){fr=r;return}if(t=t.sibling,t!==null){fr=t;return}fr=t=e}while(t!==null);yr===0&&(yr=5)}function li(e,t,r){var n=_t,s=Wn.transition;try{Wn.transition=null,_t=1,PC(e,t,r,n)}finally{Wn.transition=s,_t=n}return null}function PC(e,t,r,n){do Uo();while(ba!==null);if(mt&6)throw Error(ve(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ve(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(p4(e,a),e===Cr&&(fr=Cr=null,Rr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||$u||($u=!0,X2(Ff,function(){return Uo(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Wn.transition,Wn.transition=null;var i=_t;_t=1;var o=mt;mt|=4,Lm.current=null,NC(e,r),M2(r,e),eC(Xh),Pf=!!Gh,Xh=Gh=null,e.current=r,AC(r),a4(),mt=o,_t=i,Wn.transition=a}else e.current=r;if($u&&($u=!1,ba=e,Yf=s),a=e.pendingLanes,a===0&&(Pa=null),l4(r.stateNode),xn(e,sr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(qf)throw qf=!1,e=hp,hp=null,e;return Yf&1&&e.tag!==0&&Uo(),a=e.pendingLanes,a&1?e===pp?nc++:(nc=0,pp=e):nc=0,Ya(),null}function Uo(){if(ba!==null){var e=bw(Yf),t=Wn.transition,r=_t;try{if(Wn.transition=null,_t=16>e?16:e,ba===null)var n=!1;else{if(e=ba,ba=null,Yf=0,mt&6)throw Error(ve(331));var s=mt;for(mt|=4,Ne=e.current;Ne!==null;){var a=Ne,i=a.child;if(Ne.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(Ne=u;Ne!==null;){var f=Ne;switch(f.tag){case 0:case 11:case 15:tc(8,f,a)}var d=f.child;if(d!==null)d.return=f,Ne=d;else for(;Ne!==null;){f=Ne;var h=f.sibling,p=f.return;if(I2(f),f===u){Ne=null;break}if(h!==null){h.return=p,Ne=h;break}Ne=p}}}var x=a.alternate;if(x!==null){var m=x.child;if(m!==null){x.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}Ne=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Ne=i;else e:for(;Ne!==null;){if(a=Ne,a.flags&2048)switch(a.tag){case 0:case 11:case 15:tc(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,Ne=g;break e}Ne=a.return}}var w=e.current;for(Ne=w;Ne!==null;){i=Ne;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Ne=y;else e:for(i=w;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:jd(9,o)}}catch(E){Jt(o,o.return,E)}if(o===i){Ne=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,Ne=k;break e}Ne=o.return}}if(mt=s,Ya(),Ns&&typeof Ns.onPostCommitFiberRoot=="function")try{Ns.onPostCommitFiberRoot(Sd,e)}catch{}n=!0}return n}finally{_t=r,Wn.transition=t}}return!1}function bv(e,t,r){t=Zo(r,t),t=b2(e,t,1),e=Ra(e,t,1),t=rn(),e!==null&&(su(e,1,t),xn(e,t))}function Jt(e,t,r){if(e.tag===3)bv(e,e,r);else for(;t!==null;){if(t.tag===3){bv(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Pa===null||!Pa.has(n))){e=Zo(r,e),e=E2(t,e,1),t=Ra(t,e,1),e=rn(),t!==null&&(su(t,1,e),xn(t,e));break}}t=t.return}}function IC(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=rn(),e.pingedLanes|=e.suspendedLanes&r,Cr===e&&(Rr&r)===r&&(yr===4||yr===3&&(Rr&130023424)===Rr&&500>sr()-Bm?gi(e,0):Mm|=r),xn(e,t)}function H2(e,t){t===0&&(e.mode&1?(t=Du,Du<<=1,!(Du&130023424)&&(Du=4194304)):t=1);var r=rn();e=ta(e,t),e!==null&&(su(e,t,r),xn(e,r))}function OC(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),H2(e,r)}function LC(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ve(314))}n!==null&&n.delete(t),H2(e,r)}var G2;G2=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||pn.current)hn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return hn=!1,bC(e,t,r);hn=!!(e.flags&131072)}else hn=!1,Bt&&t.flags&1048576&&Yw(t,$f,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;wf(e,t),e=t.pendingProps;var s=qo(t,Xr.current);Bo(t,r),s=Fm(null,t,n,e,s,r);var a=Rm();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,mn(n)?(a=!0,Bf(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Cm(t),s.updater=Ad,t.stateNode=s,s._reactInternals=t,rp(t,n,e,r),t=ap(null,t,n,!0,a,r)):(t.tag=0,Bt&&a&&wm(t),Zr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(wf(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=BC(n),e=rs(n,e),s){case 0:t=sp(null,t,n,e,r);break e;case 1:t=pv(null,t,n,e,r);break e;case 11:t=dv(null,t,n,e,r);break e;case 14:t=hv(null,t,n,rs(n.type,e),r);break e}throw Error(ve(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rs(n,s),sp(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rs(n,s),pv(e,t,n,s,r);case 3:e:{if(A2(t),e===null)throw Error(ve(387));n=t.pendingProps,a=t.memoizedState,s=a.element,r2(e,t),Vf(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=Zo(Error(ve(423)),t),t=mv(e,t,n,r,s);break e}else if(n!==s){s=Zo(Error(ve(424)),t),t=mv(e,t,n,r,s);break e}else for(bn=Fa(t.stateNode.containerInfo.firstChild),En=t,Bt=!0,as=null,r=e2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Yo(),n===s){t=ra(e,t,r);break e}Zr(e,t,n,r)}t=t.child}return t;case 5:return n2(t),e===null&&Zh(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,Kh(n,s)?i=null:a!==null&&Kh(n,a)&&(t.flags|=32),N2(e,t),Zr(e,t,i,r),t.child;case 6:return e===null&&Zh(t),null;case 13:return j2(e,t,r);case 4:return Nm(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Jo(t,null,n,r):Zr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rs(n,s),dv(e,t,n,s,r);case 7:return Zr(e,t,t.pendingProps,r),t.child;case 8:return Zr(e,t,t.pendingProps.children,r),t.child;case 12:return Zr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,Dt(zf,n._currentValue),n._currentValue=i,a!==null)if(ds(a.value,i)){if(a.children===s.children&&!pn.current){t=ra(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=qs(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),ep(a.return,r,t),o.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(ve(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),ep(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Zr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Bo(t,r),s=Xn(s),n=n(s),t.flags|=1,Zr(e,t,n,r),t.child;case 14:return n=t.type,s=rs(n,t.pendingProps),s=rs(n.type,s),hv(e,t,n,s,r);case 15:return T2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rs(n,s),wf(e,t),t.tag=1,mn(n)?(e=!0,Bf(t)):e=!1,Bo(t,r),k2(t,n,s),rp(t,n,s,r),ap(null,t,n,!0,e,r);case 19:return D2(e,t,r);case 22:return C2(e,t,r)}throw Error(ve(156,t.tag))};function X2(e,t){return ww(e,t)}function MC(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $n(e,t,r,n){return new MC(e,t,r,n)}function Wm(e){return e=e.prototype,!(!e||!e.isReactComponent)}function BC(e){if(typeof e=="function")return Wm(e)?1:0;if(e!=null){if(e=e.$$typeof,e===lm)return 11;if(e===cm)return 14}return 2}function Oa(e,t){var r=e.alternate;return r===null?(r=$n(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function kf(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")Wm(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case _o:return vi(r.children,s,a,t);case om:i=8,s|=8;break;case Th:return e=$n(12,r,t,s|2),e.elementType=Th,e.lanes=a,e;case Ch:return e=$n(13,r,t,s),e.elementType=Ch,e.lanes=a,e;case Nh:return e=$n(19,r,t,s),e.elementType=Nh,e.lanes=a,e;case nw:return Fd(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case tw:i=10;break e;case rw:i=9;break e;case lm:i=11;break e;case cm:i=14;break e;case va:i=16,n=null;break e}throw Error(ve(130,e==null?e:typeof e,""))}return t=$n(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function vi(e,t,r,n){return e=$n(7,e,n,t),e.lanes=r,e}function Fd(e,t,r,n){return e=$n(22,e,n,t),e.elementType=nw,e.lanes=r,e.stateNode={isHidden:!1},e}function B0(e,t,r){return e=$n(6,e,null,t),e.lanes=r,e}function U0(e,t,r){return t=$n(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function UC(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=w0(0),this.expirationTimes=w0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=w0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Vm(e,t,r,n,s,a,i,o,c){return e=new UC(e,t,r,o,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=$n(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cm(a),e}function $C(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function K2(e){if(!e)return Ua;e=e._reactInternals;e:{if(Wi(e)!==e||e.tag!==1)throw Error(ve(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(mn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ve(171))}if(e.tag===1){var r=e.type;if(mn(r))return Kw(e,r,t)}return t}function q2(e,t,r,n,s,a,i,o,c){return e=Vm(r,n,!0,e,s,a,i,o,c),e.context=K2(null),r=e.current,n=rn(),s=Ia(r),a=qs(n,s),a.callback=t??null,Ra(r,a,s),e.current.lanes=s,su(e,s,n),xn(e,n),e}function Rd(e,t,r,n){var s=t.current,a=rn(),i=Ia(s);return r=K2(r),t.context===null?t.context=r:t.pendingContext=r,t=qs(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ra(s,t,i),e!==null&&(cs(e,s,i,a),gf(e,s,i)),i}function Qf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ev(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Hm(e,t){Ev(e,t),(e=e.alternate)&&Ev(e,t)}function zC(){return null}var Y2=typeof reportError=="function"?reportError:function(e){console.error(e)};function Gm(e){this._internalRoot=e}Pd.prototype.render=Gm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ve(409));Rd(e,t,null,null)};Pd.prototype.unmount=Gm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ni(function(){Rd(null,e,null,null)}),t[ea]=null}};function Pd(e){this._internalRoot=e}Pd.prototype.unstable_scheduleHydration=function(e){if(e){var t=Cw();e={blockedOn:null,target:e,priority:t};for(var r=0;r<wa.length&&t!==0&&t<wa[r].priority;r++);wa.splice(r,0,e),r===0&&Aw(e)}};function Xm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Id(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Tv(){}function WC(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=Qf(i);a.call(u)}}var i=q2(t,n,e,0,null,!1,!1,"",Tv);return e._reactRootContainer=i,e[ea]=i.current,bc(e.nodeType===8?e.parentNode:e),Ni(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=Qf(c);o.call(u)}}var c=Vm(e,0,!1,null,null,!1,!1,"",Tv);return e._reactRootContainer=c,e[ea]=c.current,bc(e.nodeType===8?e.parentNode:e),Ni(function(){Rd(t,c,r,n)}),c}function Od(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var c=Qf(i);o.call(c)}}Rd(t,i,e,s)}else i=WC(r,t,e,s,n);return Qf(i)}Ew=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=zl(t.pendingLanes);r!==0&&(dm(t,r|1),xn(t,sr()),!(mt&6)&&(el=sr()+500,Ya()))}break;case 13:Ni(function(){var n=ta(e,1);if(n!==null){var s=rn();cs(n,e,1,s)}}),Hm(e,1)}};hm=function(e){if(e.tag===13){var t=ta(e,134217728);if(t!==null){var r=rn();cs(t,e,134217728,r)}Hm(e,134217728)}};Tw=function(e){if(e.tag===13){var t=Ia(e),r=ta(e,t);if(r!==null){var n=rn();cs(r,e,t,n)}Hm(e,t)}};Cw=function(){return _t};Nw=function(e,t){var r=_t;try{return _t=e,t()}finally{_t=r}};Mh=function(e,t,r){switch(t){case"input":if(Dh(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Td(n);if(!s)throw Error(ve(90));aw(n),Dh(n,s)}}}break;case"textarea":ow(e,r);break;case"select":t=r.value,t!=null&&Io(e,!!r.multiple,t,!1)}};pw=Um;mw=Ni;var VC={usingClientEntryPoint:!1,Events:[iu,Eo,Td,dw,hw,Um]},Il={findFiberByHostInstance:di,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HC={bundleType:Il.bundleType,version:Il.version,rendererPackageName:Il.rendererPackageName,rendererConfig:Il.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ia.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=vw(e),e===null?null:e.stateNode},findFiberByHostInstance:Il.findFiberByHostInstance||zC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zu.isDisabled&&zu.supportsFiber)try{Sd=zu.inject(HC),Ns=zu}catch{}}Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VC;Dn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xm(t))throw Error(ve(200));return $C(e,t,null,r)};Dn.createRoot=function(e,t){if(!Xm(e))throw Error(ve(299));var r=!1,n="",s=Y2;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Vm(e,1,!1,null,null,r,!1,n,s),e[ea]=t.current,bc(e.nodeType===8?e.parentNode:e),new Gm(t)};Dn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ve(188)):(e=Object.keys(e).join(","),Error(ve(268,e)));return e=vw(t),e=e===null?null:e.stateNode,e};Dn.flushSync=function(e){return Ni(e)};Dn.hydrate=function(e,t,r){if(!Id(t))throw Error(ve(200));return Od(null,e,t,!0,r)};Dn.hydrateRoot=function(e,t,r){if(!Xm(e))throw Error(ve(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=Y2;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=q2(t,null,e,1,r??null,s,!1,a,i),e[ea]=t.current,bc(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Pd(t)};Dn.render=function(e,t,r){if(!Id(t))throw Error(ve(200));return Od(null,e,t,!1,r)};Dn.unmountComponentAtNode=function(e){if(!Id(e))throw Error(ve(40));return e._reactRootContainer?(Ni(function(){Od(null,null,e,!1,function(){e._reactRootContainer=null,e[ea]=null})}),!0):!1};Dn.unstable_batchedUpdates=Um;Dn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Id(r))throw Error(ve(200));if(e==null||e._reactInternals===void 0)throw Error(ve(38));return Od(e,t,r,!1,n)};Dn.version="18.3.1-next-f1338f8080-20240426";function J2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(J2)}catch(e){console.error(e)}}J2(),Jy.exports=Dn;var dl=Jy.exports;const Q2=My(dl);var Cv=dl;bh.createRoot=Cv.createRoot,bh.hydrateRoot=Cv.hydrateRoot;function Z2(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=Z2(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function e_(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=Z2(e))&&(n&&(n+=" "),n+=t);return n}function GC(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=t_(t))&&(n&&(n+=" "),n+=r);return n}function t_(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=t_(e[n]))&&(r&&(r+=" "),r+=t);return r}var Km="-";function XC(e){var t=qC(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,s=n===void 0?{}:n;function a(o){var c=o.split(Km);return c[0]===""&&c.length!==1&&c.shift(),r_(c,t)||KC(o)}function i(o,c){var u=r[o]||[];return c&&s[o]?[].concat(u,s[o]):u}return{getClassGroupId:a,getConflictingClassGroupIds:i}}function r_(e,t){if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),s=n?r_(e.slice(1),n):void 0;if(s)return s;if(t.validators.length!==0){var a=e.join(Km);return t.validators.find(function(i){var o=i.validator;return o(a)})?.classGroupId}}var Nv=/^\[(.+)\]$/;function KC(e){if(Nv.test(e)){var t=Nv.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function qC(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},s=JC(Object.entries(e.classGroups),r);return s.forEach(function(a){var i=a[0],o=a[1];gp(o,n,i,t)}),n}function gp(e,t,r,n){e.forEach(function(s){if(typeof s=="string"){var a=s===""?t:Av(t,s);a.classGroupId=r;return}if(typeof s=="function"){if(YC(s)){gp(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(function(i){var o=i[0],c=i[1];gp(c,Av(t,o),r,n)})})}function Av(e,t){var r=e;return t.split(Km).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function YC(e){return e.isThemeGetter}function JC(e,t){return t?e.map(function(r){var n=r[0],s=r[1],a=s.map(function(i){return typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(function(o){var c=o[0],u=o[1];return[t+c,u]})):i});return[n,a]}):e}function QC(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function s(a,i){r.set(a,i),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(i){var o=r.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return s(i,o),o},set:function(i,o){r.has(i)?r.set(i,o):s(i,o)}}}var n_="!";function ZC(e){var t=e.separator||":",r=t.length===1,n=t[0],s=t.length;return function(i){for(var o=[],c=0,u=0,f,d=0;d<i.length;d++){var h=i[d];if(c===0){if(h===n&&(r||i.slice(d,d+s)===t)){o.push(i.slice(u,d)),u=d+s;continue}if(h==="/"){f=d;continue}}h==="["?c++:h==="]"&&c--}var p=o.length===0?i:i.substring(u),x=p.startsWith(n_),m=x?p.substring(1):p,v=f&&f>u?f-u:void 0;return{modifiers:o,hasImportantModifier:x,baseClassName:m,maybePostfixModifierPosition:v}}}function eN(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var s=n[0]==="[";s?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function tN(e){return{cache:QC(e.cacheSize),splitModifiers:ZC(e),...XC(e)}}var rN=/\s+/;function nN(e,t){var r=t.splitModifiers,n=t.getClassGroupId,s=t.getConflictingClassGroupIds,a=new Set;return e.trim().split(rN).map(function(i){var o=r(i),c=o.modifiers,u=o.hasImportantModifier,f=o.baseClassName,d=o.maybePostfixModifierPosition,h=n(d?f.substring(0,d):f),p=!!d;if(!h){if(!d)return{isTailwindClass:!1,originalClassName:i};if(h=n(f),!h)return{isTailwindClass:!1,originalClassName:i};p=!1}var x=eN(c).join(":"),m=u?x+n_:x;return{isTailwindClass:!0,modifierId:m,classGroupId:h,originalClassName:i,hasPostfixModifier:p}}).reverse().filter(function(i){if(!i.isTailwindClass)return!0;var o=i.modifierId,c=i.classGroupId,u=i.hasPostfixModifier,f=o+c;return a.has(f)?!1:(a.add(f),s(c,u).forEach(function(d){return a.add(o+d)}),!0)}).reverse().map(function(i){return i.originalClassName}).join(" ")}function sN(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,s,a,i=o;function o(u){var f=t[0],d=t.slice(1),h=d.reduce(function(p,x){return x(p)},f());return n=tN(h),s=n.cache.get,a=n.cache.set,i=c,c(u)}function c(u){var f=s(u);if(f)return f;var d=nN(u,n);return a(u,d),d}return function(){return i(GC.apply(null,arguments))}}function Ft(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var s_=/^\[(?:([a-z-]+):)?(.+)\]$/i,aN=/^\d+\/\d+$/,iN=new Set(["px","full","screen"]),oN=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lN=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,cN=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Qn(e){return mi(e)||iN.has(e)||aN.test(e)||vp(e)}function vp(e){return Vi(e,"length",mN)}function uN(e){return Vi(e,"size",a_)}function fN(e){return Vi(e,"position",a_)}function dN(e){return Vi(e,"url",xN)}function Wu(e){return Vi(e,"number",mi)}function mi(e){return!Number.isNaN(Number(e))}function hN(e){return e.endsWith("%")&&mi(e.slice(0,-1))}function Ol(e){return jv(e)||Vi(e,"number",jv)}function ot(e){return s_.test(e)}function Ll(){return!0}function ha(e){return oN.test(e)}function pN(e){return Vi(e,"",gN)}function Vi(e,t,r){var n=s_.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function mN(e){return lN.test(e)}function a_(){return!1}function xN(e){return e.startsWith("url(")}function jv(e){return Number.isInteger(Number(e))}function gN(e){return cN.test(e)}function vN(){var e=Ft("colors"),t=Ft("spacing"),r=Ft("blur"),n=Ft("brightness"),s=Ft("borderColor"),a=Ft("borderRadius"),i=Ft("borderSpacing"),o=Ft("borderWidth"),c=Ft("contrast"),u=Ft("grayscale"),f=Ft("hueRotate"),d=Ft("invert"),h=Ft("gap"),p=Ft("gradientColorStops"),x=Ft("gradientColorStopPositions"),m=Ft("inset"),v=Ft("margin"),g=Ft("opacity"),w=Ft("padding"),y=Ft("saturate"),k=Ft("scale"),E=Ft("sepia"),S=Ft("skew"),_=Ft("space"),A=Ft("translate"),F=function(){return["auto","contain","none"]},U=function(){return["auto","hidden","clip","visible","scroll"]},V=function(){return["auto",ot,t]},N=function(){return[ot,t]},X=function(){return["",Qn]},le=function(){return["auto",mi,ot]},J=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},Z=function(){return["solid","dashed","dotted","double","none"]},re=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},te=function(){return["start","end","center","between","around","evenly","stretch"]},z=function(){return["","0",ot]},K=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},se=function(){return[mi,Wu]},P=function(){return[mi,ot]};return{cacheSize:500,theme:{colors:[Ll],spacing:[Qn],blur:["none","",ha,ot],brightness:se(),borderColor:[e],borderRadius:["none","","full",ha,ot],borderSpacing:N(),borderWidth:X(),contrast:se(),grayscale:z(),hueRotate:P(),invert:z(),gap:N(),gradientColorStops:[e],gradientColorStopPositions:[hN,vp],inset:V(),margin:V(),opacity:se(),padding:N(),saturate:se(),scale:se(),sepia:z(),skew:P(),space:N(),translate:N()},classGroups:{aspect:[{aspect:["auto","square","video",ot]}],container:["container"],columns:[{columns:[ha]}],"break-after":[{"break-after":K()}],"break-before":[{"break-before":K()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(J(),[ot])}],overflow:[{overflow:U()}],"overflow-x":[{"overflow-x":U()}],"overflow-y":[{"overflow-y":U()}],overscroll:[{overscroll:F()}],"overscroll-x":[{"overscroll-x":F()}],"overscroll-y":[{"overscroll-y":F()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ol]}],basis:[{basis:V()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ot]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",Ol]}],"grid-cols":[{"grid-cols":[Ll]}],"col-start-end":[{col:["auto",{span:["full",Ol]},ot]}],"col-start":[{"col-start":le()}],"col-end":[{"col-end":le()}],"grid-rows":[{"grid-rows":[Ll]}],"row-start-end":[{row:["auto",{span:[Ol]},ot]}],"row-start":[{"row-start":le()}],"row-end":[{"row-end":le()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ot]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ot]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal"].concat(te())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(te(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(te(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[_]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[_]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",ot,t]}],"min-w":[{"min-w":["min","max","fit",ot,Qn]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[ha]},ha,ot]}],h:[{h:[ot,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",ot,Qn]}],"max-h":[{"max-h":[ot,t,"min","max","fit"]}],"font-size":[{text:["base",ha,vp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Wu]}],"font-family":[{font:[Ll]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ot]}],"line-clamp":[{"line-clamp":["none",mi,Wu]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ot,Qn]}],"list-image":[{"list-image":["none",ot]}],"list-style-type":[{list:["none","disc","decimal",ot]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(Z(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Qn]}],"underline-offset":[{"underline-offset":["auto",ot,Qn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ot]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ot]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(J(),[fN])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",uN]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},dN]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[].concat(Z(),["hidden"])}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:Z()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(Z())}],"outline-offset":[{"outline-offset":[ot,Qn]}],"outline-w":[{outline:[Qn]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:X()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[Qn]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",ha,pN]}],"shadow-color":[{shadow:[Ll]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":re()}],"bg-blend":[{"bg-blend":re()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",ha,ot]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[d]}],saturate:[{saturate:[y]}],sepia:[{sepia:[E]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ot]}],duration:[{duration:P()}],ease:[{ease:["linear","in","out","in-out",ot]}],delay:[{delay:P()}],animate:[{animate:["none","spin","ping","pulse","bounce",ot]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[Ol,ot]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ot]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ot]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ot]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Qn,Wu]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var yN=sN(vN);function tt(...e){return yN(e_(e))}function Ae({className:e,...t}){return l.jsx("div",{"data-slot":"card",className:tt("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",e),...t})}function st({className:e,...t}){return l.jsx("div",{"data-slot":"card-header",className:tt("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function lt({className:e,...t}){return l.jsx("h4",{"data-slot":"card-title",className:tt("leading-none",e),...t})}function je({className:e,...t}){return l.jsx("div",{"data-slot":"card-content",className:tt("px-6 [&:last-child]:pb-6",e),...t})}function Dv(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function i_(...e){return t=>{let r=!1;const n=e.map(s=>{const a=Dv(s,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let s=0;s<n.length;s++){const a=n[s];typeof a=="function"?a():Dv(e[s],null)}}}}function Ct(...e){return T.useCallback(i_(...e),e)}function tl(e){const t=wN(e),r=T.forwardRef((n,s)=>{const{children:a,...i}=n,o=T.Children.toArray(a),c=o.find(SN);if(c){const u=c.props.children,f=o.map(d=>d===c?T.Children.count(u)>1?T.Children.only(null):T.isValidElement(u)?u.props.children:null:d);return l.jsx(t,{...i,ref:s,children:T.isValidElement(u)?T.cloneElement(u,void 0,f):null})}return l.jsx(t,{...i,ref:s,children:a})});return r.displayName=`${e}.Slot`,r}var o_=tl("Slot");function wN(e){const t=T.forwardRef((r,n)=>{const{children:s,...a}=r;if(T.isValidElement(s)){const i=bN(s),o=kN(a,s.props);return s.type!==T.Fragment&&(o.ref=n?i_(n,i):i),T.cloneElement(s,o)}return T.Children.count(s)>1?T.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var l_=Symbol("radix.slottable");function _N(e){const t=({children:r})=>l.jsx(l.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=l_,t}function SN(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===l_}function kN(e,t){const r={...t};for(const n in t){const s=e[n],a=t[n];/^on[A-Z]/.test(n)?s&&a?r[n]=(...o)=>{const c=a(...o);return s(...o),c}:s&&(r[n]=s):n==="style"?r[n]={...s,...a}:n==="className"&&(r[n]=[s,a].filter(Boolean).join(" "))}return{...e,...r}}function bN(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const Fv=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Rv=e_,qm=(e,t)=>r=>{var n;if(t?.variants==null)return Rv(e,r?.class,r?.className);const{variants:s,defaultVariants:a}=t,i=Object.keys(s).map(u=>{const f=r?.[u],d=a?.[u];if(f===null)return null;const h=Fv(f)||Fv(d);return s[u][h]}),o=r&&Object.entries(r).reduce((u,f)=>{let[d,h]=f;return h===void 0||(u[d]=h),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,f)=>{let{class:d,className:h,...p}=f;return Object.entries(p).every(x=>{let[m,v]=x;return Array.isArray(v)?v.includes({...a,...o}[m]):{...a,...o}[m]===v})?[...u,d,h]:u},[]);return Rv(e,i,c,r?.class,r?.className)},Ym=qm("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),be=T.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},a)=>{const i=n?o_:"button";return l.jsx(i,{"data-slot":"button",className:tt(Ym({variant:t,size:r,className:e})),ref:a,...s})});be.displayName="Button";function nt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),r===!1||!s.defaultPrevented)return t?.(s)}}function EN(e,t){const r=T.createContext(t),n=a=>{const{children:i,...o}=a,c=T.useMemo(()=>o,Object.values(o));return l.jsx(r.Provider,{value:c,children:i})};n.displayName=e+"Provider";function s(a){const i=T.useContext(r);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${a}\` must be used within \`${e}\``)}return[n,s]}function oa(e,t=[]){let r=[];function n(a,i){const o=T.createContext(i),c=r.length;r=[...r,i];const u=d=>{const{scope:h,children:p,...x}=d,m=h?.[e]?.[c]||o,v=T.useMemo(()=>x,Object.values(x));return l.jsx(m.Provider,{value:v,children:p})};u.displayName=a+"Provider";function f(d,h){const p=h?.[e]?.[c]||o,x=T.useContext(p);if(x)return x;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${a}\``)}return[u,f]}const s=()=>{const a=r.map(i=>T.createContext(i));return function(o){const c=o?.[e]||a;return T.useMemo(()=>({[`__scope${e}`]:{...o,[e]:c}}),[o,c])}};return s.scopeName=e,[n,TN(s,...t)]}function TN(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const i=n.reduce((o,{useScope:c,scopeName:u})=>{const d=c(a)[`__scope${u}`];return{...o,...d}},{});return T.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}function c_(e){const t=e+"CollectionProvider",[r,n]=oa(t),[s,a]=r(t,{collectionRef:{current:null},itemMap:new Map}),i=m=>{const{scope:v,children:g}=m,w=ye.useRef(null),y=ye.useRef(new Map).current;return l.jsx(s,{scope:v,itemMap:y,collectionRef:w,children:g})};i.displayName=t;const o=e+"CollectionSlot",c=tl(o),u=ye.forwardRef((m,v)=>{const{scope:g,children:w}=m,y=a(o,g),k=Ct(v,y.collectionRef);return l.jsx(c,{ref:k,children:w})});u.displayName=o;const f=e+"CollectionItemSlot",d="data-radix-collection-item",h=tl(f),p=ye.forwardRef((m,v)=>{const{scope:g,children:w,...y}=m,k=ye.useRef(null),E=Ct(v,k),S=a(f,g);return ye.useEffect(()=>(S.itemMap.set(k,{ref:k,...y}),()=>void S.itemMap.delete(k))),l.jsx(h,{[d]:"",ref:E,children:w})});p.displayName=f;function x(m){const v=a(e+"CollectionConsumer",m);return ye.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const y=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((S,_)=>y.indexOf(S.ref.current)-y.indexOf(_.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:i,Slot:u,ItemSlot:p},x,n]}var Ir=globalThis?.document?T.useLayoutEffect:()=>{},CN=qy[" useId ".trim().toString()]||(()=>{}),NN=0;function Ys(e){const[t,r]=T.useState(CN());return Ir(()=>{r(n=>n??String(NN++))},[e]),e||(t?`radix-${t}`:"")}var AN=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ze=AN.reduce((e,t)=>{const r=tl(`Primitive.${t}`),n=T.forwardRef((s,a)=>{const{asChild:i,...o}=s,c=i?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),l.jsx(c,{...o,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function jN(e,t){e&&dl.flushSync(()=>e.dispatchEvent(t))}function $a(e){const t=T.useRef(e);return T.useEffect(()=>{t.current=e}),T.useMemo(()=>(...r)=>t.current?.(...r),[])}var DN=qy[" useInsertionEffect ".trim().toString()]||Ir;function Ai({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[s,a,i]=FN({defaultProp:t,onChange:r}),o=e!==void 0,c=o?e:s;{const f=T.useRef(e!==void 0);T.useEffect(()=>{const d=f.current;d!==o&&console.warn(`${n} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=o},[o,n])}const u=T.useCallback(f=>{if(o){const d=RN(f)?f(e):f;d!==e&&i.current?.(d)}else a(f)},[o,e,a,i]);return[c,u]}function FN({defaultProp:e,onChange:t}){const[r,n]=T.useState(e),s=T.useRef(r),a=T.useRef(t);return DN(()=>{a.current=t},[t]),T.useEffect(()=>{s.current!==r&&(a.current?.(r),s.current=r)},[r,s]),[r,n,a]}function RN(e){return typeof e=="function"}var PN=T.createContext(void 0);function Jm(e){const t=T.useContext(PN);return e||t||"ltr"}var $0="rovingFocusGroup.onEntryFocus",IN={bubbles:!1,cancelable:!0},lu="RovingFocusGroup",[yp,u_,ON]=c_(lu),[LN,f_]=oa(lu,[ON]),[MN,BN]=LN(lu),d_=T.forwardRef((e,t)=>l.jsx(yp.Provider,{scope:e.__scopeRovingFocusGroup,children:l.jsx(yp.Slot,{scope:e.__scopeRovingFocusGroup,children:l.jsx(UN,{...e,ref:t})})}));d_.displayName=lu;var UN=T.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:a,currentTabStopId:i,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:f=!1,...d}=e,h=T.useRef(null),p=Ct(t,h),x=Jm(a),[m,v]=Ai({prop:i,defaultProp:o??null,onChange:c,caller:lu}),[g,w]=T.useState(!1),y=$a(u),k=u_(r),E=T.useRef(!1),[S,_]=T.useState(0);return T.useEffect(()=>{const A=h.current;if(A)return A.addEventListener($0,y),()=>A.removeEventListener($0,y)},[y]),l.jsx(MN,{scope:r,orientation:n,dir:x,loop:s,currentTabStopId:m,onItemFocus:T.useCallback(A=>v(A),[v]),onItemShiftTab:T.useCallback(()=>w(!0),[]),onFocusableItemAdd:T.useCallback(()=>_(A=>A+1),[]),onFocusableItemRemove:T.useCallback(()=>_(A=>A-1),[]),children:l.jsx(Ze.div,{tabIndex:g||S===0?-1:0,"data-orientation":n,...d,ref:p,style:{outline:"none",...e.style},onMouseDown:nt(e.onMouseDown,()=>{E.current=!0}),onFocus:nt(e.onFocus,A=>{const F=!E.current;if(A.target===A.currentTarget&&F&&!g){const U=new CustomEvent($0,IN);if(A.currentTarget.dispatchEvent(U),!U.defaultPrevented){const V=k().filter(Z=>Z.focusable),N=V.find(Z=>Z.active),X=V.find(Z=>Z.id===m),J=[N,X,...V].filter(Boolean).map(Z=>Z.ref.current);m_(J,f)}}E.current=!1}),onBlur:nt(e.onBlur,()=>w(!1))})})}),h_="RovingFocusGroupItem",p_=T.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:a,children:i,...o}=e,c=Ys(),u=a||c,f=BN(h_,r),d=f.currentTabStopId===u,h=u_(r),{onFocusableItemAdd:p,onFocusableItemRemove:x,currentTabStopId:m}=f;return T.useEffect(()=>{if(n)return p(),()=>x()},[n,p,x]),l.jsx(yp.ItemSlot,{scope:r,id:u,focusable:n,active:s,children:l.jsx(Ze.span,{tabIndex:d?0:-1,"data-orientation":f.orientation,...o,ref:t,onMouseDown:nt(e.onMouseDown,v=>{n?f.onItemFocus(u):v.preventDefault()}),onFocus:nt(e.onFocus,()=>f.onItemFocus(u)),onKeyDown:nt(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){f.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const g=WN(v,f.orientation,f.dir);if(g!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let y=h().filter(k=>k.focusable).map(k=>k.ref.current);if(g==="last")y.reverse();else if(g==="prev"||g==="next"){g==="prev"&&y.reverse();const k=y.indexOf(v.currentTarget);y=f.loop?VN(y,k+1):y.slice(k+1)}setTimeout(()=>m_(y))}}),children:typeof i=="function"?i({isCurrentTabStop:d,hasTabStop:m!=null}):i})})});p_.displayName=h_;var $N={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function zN(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function WN(e,t,r){const n=zN(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return $N[n]}function m_(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function VN(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var HN=d_,GN=p_;function XN(e,t){return T.useReducer((r,n)=>t[r][n]??r,e)}var hl=e=>{const{present:t,children:r}=e,n=KN(t),s=typeof r=="function"?r({present:n.isPresent}):T.Children.only(r),a=Ct(n.ref,qN(s));return typeof r=="function"||n.isPresent?T.cloneElement(s,{ref:a}):null};hl.displayName="Presence";function KN(e){const[t,r]=T.useState(),n=T.useRef(null),s=T.useRef(e),a=T.useRef("none"),i=e?"mounted":"unmounted",[o,c]=XN(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return T.useEffect(()=>{const u=Vu(n.current);a.current=o==="mounted"?u:"none"},[o]),Ir(()=>{const u=n.current,f=s.current;if(f!==e){const h=a.current,p=Vu(u);e?c("MOUNT"):p==="none"||u?.display==="none"?c("UNMOUNT"):c(f&&h!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),Ir(()=>{if(t){let u;const f=t.ownerDocument.defaultView??window,d=p=>{const m=Vu(n.current).includes(CSS.escape(p.animationName));if(p.target===t&&m&&(c("ANIMATION_END"),!s.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",u=f.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},h=p=>{p.target===t&&(a.current=Vu(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{f.clearTimeout(u),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:T.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function Vu(e){return e?.animationName||"none"}function qN(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Ld="Tabs",[YN,kV]=oa(Ld,[f_]),x_=f_(),[JN,Qm]=YN(Ld),g_=T.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:a,orientation:i="horizontal",dir:o,activationMode:c="automatic",...u}=e,f=Jm(o),[d,h]=Ai({prop:n,onChange:s,defaultProp:a??"",caller:Ld});return l.jsx(JN,{scope:r,baseId:Ys(),value:d,onValueChange:h,orientation:i,dir:f,activationMode:c,children:l.jsx(Ze.div,{dir:f,"data-orientation":i,...u,ref:t})})});g_.displayName=Ld;var v_="TabsList",y_=T.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...s}=e,a=Qm(v_,r),i=x_(r);return l.jsx(HN,{asChild:!0,...i,orientation:a.orientation,dir:a.dir,loop:n,children:l.jsx(Ze.div,{role:"tablist","aria-orientation":a.orientation,...s,ref:t})})});y_.displayName=v_;var w_="TabsTrigger",__=T.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...a}=e,i=Qm(w_,r),o=x_(r),c=b_(i.baseId,n),u=E_(i.baseId,n),f=n===i.value;return l.jsx(GN,{asChild:!0,...o,focusable:!s,active:f,children:l.jsx(Ze.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":u,"data-state":f?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...a,ref:t,onMouseDown:nt(e.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?i.onValueChange(n):d.preventDefault()}),onKeyDown:nt(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(n)}),onFocus:nt(e.onFocus,()=>{const d=i.activationMode!=="manual";!f&&!s&&d&&i.onValueChange(n)})})})});__.displayName=w_;var S_="TabsContent",k_=T.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:s,children:a,...i}=e,o=Qm(S_,r),c=b_(o.baseId,n),u=E_(o.baseId,n),f=n===o.value,d=T.useRef(f);return T.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),l.jsx(hl,{present:s||f,children:({present:h})=>l.jsx(Ze.div,{"data-state":f?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":c,hidden:!h,id:u,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&a})})});k_.displayName=S_;function b_(e,t){return`${e}-trigger-${t}`}function E_(e,t){return`${e}-content-${t}`}var QN=g_,ZN=y_,eA=__,tA=k_;function Hi({className:e,...t}){return l.jsx(QN,{"data-slot":"tabs",className:tt("flex flex-col gap-2",e),...t})}function Gi({className:e,...t}){return l.jsx(ZN,{"data-slot":"tabs-list",className:tt("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",e),...t})}function kt({className:e,...t}){return l.jsx(eA,{"data-slot":"tabs-trigger",className:tt("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function bt({className:e,...t}){return l.jsx(tA,{"data-slot":"tabs-content",className:tt("flex-1 outline-none",e),...t})}const rA=qm("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function At({className:e,variant:t,...r}){return l.jsx("div",{"data-slot":"alert",role:"alert",className:tt(rA({variant:t}),e),...r})}function jt({className:e,...t}){return l.jsx("div",{"data-slot":"alert-description",className:tt("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}var nA=(e,t,r,n,s,a,i,o)=>{let c=document.documentElement,u=["light","dark"];function f(p){(Array.isArray(e)?e:[e]).forEach(x=>{let m=x==="class",v=m&&a?s.map(g=>a[g]||g):s;m?(c.classList.remove(...v),c.classList.add(a&&a[p]?a[p]:p)):c.setAttribute(x,p)}),d(p)}function d(p){o&&u.includes(p)&&(c.style.colorScheme=p)}function h(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(n)f(n);else try{let p=localStorage.getItem(t)||r,x=i&&p==="system"?h():p;f(x)}catch{}},sA=T.createContext(void 0),aA={setTheme:e=>{},themes:[]},iA=()=>{var e;return(e=T.useContext(sA))!=null?e:aA};T.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:s,defaultTheme:a,value:i,themes:o,nonce:c,scriptProps:u})=>{let f=JSON.stringify([r,t,a,e,o,i,n,s]).slice(1,-1);return T.createElement("script",{...u,suppressHydrationWarning:!0,nonce:typeof window>"u"?c:"",dangerouslySetInnerHTML:{__html:`(${nA.toString()})(${f})`}})});function oA(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const lA=e=>{switch(e){case"success":return fA;case"info":return hA;case"warning":return dA;case"error":return pA;default:return null}},cA=Array(12).fill(0),uA=({visible:e,className:t})=>ye.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},ye.createElement("div",{className:"sonner-spinner"},cA.map((r,n)=>ye.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),fA=ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ye.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),dA=ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ye.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),hA=ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ye.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),pA=ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ye.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),mA=ye.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ye.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ye.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),xA=()=>{const[e,t]=ye.useState(document.hidden);return ye.useEffect(()=>{const r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e};let wp=1;class gA{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;const{message:n,...s}=t,a=typeof t?.id=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:wp++,i=this.toasts.find(c=>c.id===a),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),i?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...t,id:a,title:n}),{...c,...t,id:a,dismissible:o,title:n}):c):this.addToast({title:n,...s,dismissible:o,id:a}),a},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:t,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let a=n!==void 0,i;const o=s.then(async u=>{if(i=["resolve",u],ye.isValidElement(u))a=!1,this.create({id:n,type:"default",message:u});else if(yA(u)&&!u.ok){a=!1;const d=typeof r.error=="function"?await r.error(`HTTP error! status: ${u.status}`):r.error,h=typeof r.description=="function"?await r.description(`HTTP error! status: ${u.status}`):r.description,x=typeof d=="object"&&!ye.isValidElement(d)?d:{message:d};this.create({id:n,type:"error",description:h,...x})}else if(u instanceof Error){a=!1;const d=typeof r.error=="function"?await r.error(u):r.error,h=typeof r.description=="function"?await r.description(u):r.description,x=typeof d=="object"&&!ye.isValidElement(d)?d:{message:d};this.create({id:n,type:"error",description:h,...x})}else if(r.success!==void 0){a=!1;const d=typeof r.success=="function"?await r.success(u):r.success,h=typeof r.description=="function"?await r.description(u):r.description,x=typeof d=="object"&&!ye.isValidElement(d)?d:{message:d};this.create({id:n,type:"success",description:h,...x})}}).catch(async u=>{if(i=["reject",u],r.error!==void 0){a=!1;const f=typeof r.error=="function"?await r.error(u):r.error,d=typeof r.description=="function"?await r.description(u):r.description,p=typeof f=="object"&&!ye.isValidElement(f)?f:{message:f};this.create({id:n,type:"error",description:d,...p})}}).finally(()=>{a&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),c=()=>new Promise((u,f)=>o.then(()=>i[0]==="reject"?f(i[1]):u(i[1])).catch(f));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(t,r)=>{const n=r?.id||wp++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const cn=new gA,vA=(e,t)=>{const r=t?.id||wp++;return cn.addToast({title:e,...t,id:r}),r},yA=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",wA=vA,_A=()=>cn.toasts,SA=()=>cn.getActiveToasts(),fe=Object.assign(wA,{success:cn.success,info:cn.info,warning:cn.warning,error:cn.error,custom:cn.custom,message:cn.message,promise:cn.promise,dismiss:cn.dismiss,loading:cn.loading},{getHistory:_A,getToasts:SA});oA("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Hu(e){return e.label!==void 0}const kA=3,bA="24px",EA="16px",Pv=4e3,TA=356,CA=14,NA=45,AA=200;function gs(...e){return e.filter(Boolean).join(" ")}function jA(e){const[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}const DA=e=>{var t,r,n,s,a,i,o,c,u;const{invert:f,toast:d,unstyled:h,interacting:p,setHeights:x,visibleToasts:m,heights:v,index:g,toasts:w,expanded:y,removeToast:k,defaultRichColors:E,closeButton:S,style:_,cancelButtonStyle:A,actionButtonStyle:F,className:U="",descriptionClassName:V="",duration:N,position:X,gap:le,expandByDefault:J,classNames:Z,icons:re,closeButtonAriaLabel:te="Close toast"}=e,[z,K]=ye.useState(null),[se,P]=ye.useState(null),[b,D]=ye.useState(!1),[R,W]=ye.useState(!1),[q,H]=ye.useState(!1),[Q,ee]=ye.useState(!1),[G,C]=ye.useState(!1),[pe,_e]=ye.useState(0),[Y,ae]=ye.useState(0),ce=ye.useRef(d.duration||N||Pv),xe=ye.useRef(null),De=ye.useRef(null),Ve=g===0,qe=g+1<=m,Oe=d.type,Ie=d.dismissible!==!1,ze=d.className||"",Fe=d.descriptionClassName||"",ft=ye.useMemo(()=>v.findIndex(He=>He.toastId===d.id)||0,[v,d.id]),ir=ye.useMemo(()=>{var He;return(He=d.closeButton)!=null?He:S},[d.closeButton,S]),Gt=ye.useMemo(()=>d.duration||N||Pv,[d.duration,N]),on=ye.useRef(0),We=ye.useRef(0),Mt=ye.useRef(0),hr=ye.useRef(null),[rr,Bs]=X.split("-"),bl=ye.useMemo(()=>v.reduce((He,or,_r)=>_r>=ft?He:He+or.height,0),[v,ft]),Su=xA(),d0=d.invert||f,to=Oe==="loading";We.current=ye.useMemo(()=>ft*le+bl,[ft,bl]),ye.useEffect(()=>{ce.current=Gt},[Gt]),ye.useEffect(()=>{D(!0)},[]),ye.useEffect(()=>{const He=De.current;if(He){const or=He.getBoundingClientRect().height;return ae(or),x(_r=>[{toastId:d.id,height:or,position:d.position},..._r]),()=>x(_r=>_r.filter(Yr=>Yr.toastId!==d.id))}},[x,d.id]),ye.useLayoutEffect(()=>{if(!b)return;const He=De.current,or=He.style.height;He.style.height="auto";const _r=He.getBoundingClientRect().height;He.style.height=or,ae(_r),x(Yr=>Yr.find(pr=>pr.toastId===d.id)?Yr.map(pr=>pr.toastId===d.id?{...pr,height:_r}:pr):[{toastId:d.id,height:_r,position:d.position},...Yr])},[b,d.title,d.description,x,d.id,d.jsx,d.action,d.cancel]);const Yn=ye.useCallback(()=>{W(!0),_e(We.current),x(He=>He.filter(or=>or.toastId!==d.id)),setTimeout(()=>{k(d)},AA)},[d,k,x,We]);ye.useEffect(()=>{if(d.promise&&Oe==="loading"||d.duration===1/0||d.type==="loading")return;let He;return y||p||Su?(()=>{if(Mt.current<on.current){const Yr=new Date().getTime()-on.current;ce.current=ce.current-Yr}Mt.current=new Date().getTime()})():(()=>{ce.current!==1/0&&(on.current=new Date().getTime(),He=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),Yn()},ce.current))})(),()=>clearTimeout(He)},[y,p,d,Oe,Su,Yn]),ye.useEffect(()=>{d.delete&&(Yn(),d.onDismiss==null||d.onDismiss.call(d,d))},[Yn,d.delete]);function ku(){var He;if(re?.loading){var or;return ye.createElement("div",{className:gs(Z?.loader,d==null||(or=d.classNames)==null?void 0:or.loader,"sonner-loader"),"data-visible":Oe==="loading"},re.loading)}return ye.createElement(uA,{className:gs(Z?.loader,d==null||(He=d.classNames)==null?void 0:He.loader),visible:Oe==="loading"})}const h0=d.icon||re?.[Oe]||lA(Oe);var bu,ni;return ye.createElement("li",{tabIndex:0,ref:De,className:gs(U,ze,Z?.toast,d==null||(t=d.classNames)==null?void 0:t.toast,Z?.default,Z?.[Oe],d==null||(r=d.classNames)==null?void 0:r[Oe]),"data-sonner-toast":"","data-rich-colors":(bu=d.richColors)!=null?bu:E,"data-styled":!(d.jsx||d.unstyled||h),"data-mounted":b,"data-promise":!!d.promise,"data-swiped":G,"data-removed":R,"data-visible":qe,"data-y-position":rr,"data-x-position":Bs,"data-index":g,"data-front":Ve,"data-swiping":q,"data-dismissible":Ie,"data-type":Oe,"data-invert":d0,"data-swipe-out":Q,"data-swipe-direction":se,"data-expanded":!!(y||J&&b),"data-testid":d.testId,style:{"--index":g,"--toasts-before":g,"--z-index":w.length-g,"--offset":`${R?pe:We.current}px`,"--initial-height":J?"auto":`${Y}px`,..._,...d.style},onDragEnd:()=>{H(!1),K(null),hr.current=null},onPointerDown:He=>{He.button!==2&&(to||!Ie||(xe.current=new Date,_e(We.current),He.target.setPointerCapture(He.pointerId),He.target.tagName!=="BUTTON"&&(H(!0),hr.current={x:He.clientX,y:He.clientY})))},onPointerUp:()=>{var He,or,_r;if(Q||!Ie)return;hr.current=null;const Yr=Number(((He=De.current)==null?void 0:He.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),ro=Number(((or=De.current)==null?void 0:or.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),pr=new Date().getTime()-((_r=xe.current)==null?void 0:_r.getTime()),ln=z==="x"?Yr:ro,no=Math.abs(ln)/pr;if(Math.abs(ln)>=NA||no>.11){_e(We.current),d.onDismiss==null||d.onDismiss.call(d,d),P(z==="x"?Yr>0?"right":"left":ro>0?"down":"up"),Yn(),ee(!0);return}else{var Jr,vn;(Jr=De.current)==null||Jr.style.setProperty("--swipe-amount-x","0px"),(vn=De.current)==null||vn.style.setProperty("--swipe-amount-y","0px")}C(!1),H(!1),K(null)},onPointerMove:He=>{var or,_r,Yr;if(!hr.current||!Ie||((or=window.getSelection())==null?void 0:or.toString().length)>0)return;const pr=He.clientY-hr.current.y,ln=He.clientX-hr.current.x;var no;const Jr=(no=e.swipeDirections)!=null?no:jA(X);!z&&(Math.abs(ln)>1||Math.abs(pr)>1)&&K(Math.abs(ln)>Math.abs(pr)?"x":"y");let vn={x:0,y:0};const Eu=Us=>1/(1.5+Math.abs(Us)/20);if(z==="y"){if(Jr.includes("top")||Jr.includes("bottom"))if(Jr.includes("top")&&pr<0||Jr.includes("bottom")&&pr>0)vn.y=pr;else{const Us=pr*Eu(pr);vn.y=Math.abs(Us)<Math.abs(pr)?Us:pr}}else if(z==="x"&&(Jr.includes("left")||Jr.includes("right")))if(Jr.includes("left")&&ln<0||Jr.includes("right")&&ln>0)vn.x=ln;else{const Us=ln*Eu(ln);vn.x=Math.abs(Us)<Math.abs(ln)?Us:ln}(Math.abs(vn.x)>0||Math.abs(vn.y)>0)&&C(!0),(_r=De.current)==null||_r.style.setProperty("--swipe-amount-x",`${vn.x}px`),(Yr=De.current)==null||Yr.style.setProperty("--swipe-amount-y",`${vn.y}px`)}},ir&&!d.jsx&&Oe!=="loading"?ye.createElement("button",{"aria-label":te,"data-disabled":to,"data-close-button":!0,onClick:to||!Ie?()=>{}:()=>{Yn(),d.onDismiss==null||d.onDismiss.call(d,d)},className:gs(Z?.closeButton,d==null||(n=d.classNames)==null?void 0:n.closeButton)},(ni=re?.close)!=null?ni:mA):null,(Oe||d.icon||d.promise)&&d.icon!==null&&(re?.[Oe]!==null||d.icon)?ye.createElement("div",{"data-icon":"",className:gs(Z?.icon,d==null||(s=d.classNames)==null?void 0:s.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||ku():null,d.type!=="loading"?h0:null):null,ye.createElement("div",{"data-content":"",className:gs(Z?.content,d==null||(a=d.classNames)==null?void 0:a.content)},ye.createElement("div",{"data-title":"",className:gs(Z?.title,d==null||(i=d.classNames)==null?void 0:i.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?ye.createElement("div",{"data-description":"",className:gs(V,Fe,Z?.description,d==null||(o=d.classNames)==null?void 0:o.description)},typeof d.description=="function"?d.description():d.description):null),ye.isValidElement(d.cancel)?d.cancel:d.cancel&&Hu(d.cancel)?ye.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||A,onClick:He=>{Hu(d.cancel)&&Ie&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,He),Yn())},className:gs(Z?.cancelButton,d==null||(c=d.classNames)==null?void 0:c.cancelButton)},d.cancel.label):null,ye.isValidElement(d.action)?d.action:d.action&&Hu(d.action)?ye.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||F,onClick:He=>{Hu(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,He),!He.defaultPrevented&&Yn())},className:gs(Z?.actionButton,d==null||(u=d.classNames)==null?void 0:u.actionButton)},d.action.label):null)};function Iv(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function FA(e,t){const r={};return[e,t].forEach((n,s)=>{const a=s===1,i=a?"--mobile-offset":"--offset",o=a?EA:bA;function c(u){["top","right","bottom","left"].forEach(f=>{r[`${i}-${f}`]=typeof u=="number"?`${u}px`:u})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(u=>{n[u]===void 0?r[`${i}-${u}`]=o:r[`${i}-${u}`]=typeof n[u]=="number"?`${n[u]}px`:n[u]}):c(o)}),r}const RA=ye.forwardRef(function(t,r){const{id:n,invert:s,position:a="bottom-right",hotkey:i=["altKey","KeyT"],expand:o,closeButton:c,className:u,offset:f,mobileOffset:d,theme:h="light",richColors:p,duration:x,style:m,visibleToasts:v=kA,toastOptions:g,dir:w=Iv(),gap:y=CA,icons:k,containerAriaLabel:E="Notifications"}=t,[S,_]=ye.useState([]),A=ye.useMemo(()=>n?S.filter(b=>b.toasterId===n):S.filter(b=>!b.toasterId),[S,n]),F=ye.useMemo(()=>Array.from(new Set([a].concat(A.filter(b=>b.position).map(b=>b.position)))),[A,a]),[U,V]=ye.useState([]),[N,X]=ye.useState(!1),[le,J]=ye.useState(!1),[Z,re]=ye.useState(h!=="system"?h:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),te=ye.useRef(null),z=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),K=ye.useRef(null),se=ye.useRef(!1),P=ye.useCallback(b=>{_(D=>{var R;return(R=D.find(W=>W.id===b.id))!=null&&R.delete||cn.dismiss(b.id),D.filter(({id:W})=>W!==b.id)})},[]);return ye.useEffect(()=>cn.subscribe(b=>{if(b.dismiss){requestAnimationFrame(()=>{_(D=>D.map(R=>R.id===b.id?{...R,delete:!0}:R))});return}setTimeout(()=>{Q2.flushSync(()=>{_(D=>{const R=D.findIndex(W=>W.id===b.id);return R!==-1?[...D.slice(0,R),{...D[R],...b},...D.slice(R+1)]:[b,...D]})})})}),[S]),ye.useEffect(()=>{if(h!=="system"){re(h);return}if(h==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?re("dark"):re("light")),typeof window>"u")return;const b=window.matchMedia("(prefers-color-scheme: dark)");try{b.addEventListener("change",({matches:D})=>{re(D?"dark":"light")})}catch{b.addListener(({matches:R})=>{try{re(R?"dark":"light")}catch(W){console.error(W)}})}},[h]),ye.useEffect(()=>{S.length<=1&&X(!1)},[S]),ye.useEffect(()=>{const b=D=>{var R;if(i.every(H=>D[H]||D.code===H)){var q;X(!0),(q=te.current)==null||q.focus()}D.code==="Escape"&&(document.activeElement===te.current||(R=te.current)!=null&&R.contains(document.activeElement))&&X(!1)};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[i]),ye.useEffect(()=>{if(te.current)return()=>{K.current&&(K.current.focus({preventScroll:!0}),K.current=null,se.current=!1)}},[te.current]),ye.createElement("section",{ref:r,"aria-label":`${E} ${z}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},F.map((b,D)=>{var R;const[W,q]=b.split("-");return A.length?ye.createElement("ol",{key:b,dir:w==="auto"?Iv():w,tabIndex:-1,ref:te,className:u,"data-sonner-toaster":!0,"data-sonner-theme":Z,"data-y-position":W,"data-x-position":q,style:{"--front-toast-height":`${((R=U[0])==null?void 0:R.height)||0}px`,"--width":`${TA}px`,"--gap":`${y}px`,...m,...FA(f,d)},onBlur:H=>{se.current&&!H.currentTarget.contains(H.relatedTarget)&&(se.current=!1,K.current&&(K.current.focus({preventScroll:!0}),K.current=null))},onFocus:H=>{H.target instanceof HTMLElement&&H.target.dataset.dismissible==="false"||se.current||(se.current=!0,K.current=H.relatedTarget)},onMouseEnter:()=>X(!0),onMouseMove:()=>X(!0),onMouseLeave:()=>{le||X(!1)},onDragEnd:()=>X(!1),onPointerDown:H=>{H.target instanceof HTMLElement&&H.target.dataset.dismissible==="false"||J(!0)},onPointerUp:()=>J(!1)},A.filter(H=>!H.position&&D===0||H.position===b).map((H,Q)=>{var ee,G;return ye.createElement(DA,{key:H.id,icons:k,index:Q,toast:H,defaultRichColors:p,duration:(ee=g?.duration)!=null?ee:x,className:g?.className,descriptionClassName:g?.descriptionClassName,invert:s,visibleToasts:v,closeButton:(G=g?.closeButton)!=null?G:c,interacting:le,position:b,style:g?.style,unstyled:g?.unstyled,classNames:g?.classNames,cancelButtonStyle:g?.cancelButtonStyle,actionButtonStyle:g?.actionButtonStyle,closeButtonAriaLabel:g?.closeButtonAriaLabel,removeToast:P,toasts:A.filter(C=>C.position==H.position),heights:U.filter(C=>C.position==H.position),setHeights:V,expandByDefault:o,gap:y,expanded:N,swipeDirections:t.swipeDirections})})):null}))}),PA=({...e})=>{const{theme:t="system"}=iA();return l.jsx(RA,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})},Et=T.forwardRef(({className:e,type:t,...r},n)=>l.jsx("input",{type:t,"data-slot":"input",className:tt("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),ref:n,...r}));Et.displayName="Input";var IA="Label",T_=T.forwardRef((e,t)=>l.jsx(Ze.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));T_.displayName=IA;var OA=T_;function Me({className:e,...t}){return l.jsx(OA,{"data-slot":"label",className:tt("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}function Ov(e,[t,r]){return Math.min(r,Math.max(t,e))}function LA(e,t=globalThis?.document){const r=$a(e);T.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var MA="DismissableLayer",_p="dismissableLayer.update",BA="dismissableLayer.pointerDownOutside",UA="dismissableLayer.focusOutside",Lv,C_=T.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Zm=T.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:i,onDismiss:o,...c}=e,u=T.useContext(C_),[f,d]=T.useState(null),h=f?.ownerDocument??globalThis?.document,[,p]=T.useState({}),x=Ct(t,_=>d(_)),m=Array.from(u.layers),[v]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),g=m.indexOf(v),w=f?m.indexOf(f):-1,y=u.layersWithOutsidePointerEventsDisabled.size>0,k=w>=g,E=WA(_=>{const A=_.target,F=[...u.branches].some(U=>U.contains(A));!k||F||(s?.(_),i?.(_),_.defaultPrevented||o?.())},h),S=VA(_=>{const A=_.target;[...u.branches].some(U=>U.contains(A))||(a?.(_),i?.(_),_.defaultPrevented||o?.())},h);return LA(_=>{w===u.layers.size-1&&(n?.(_),!_.defaultPrevented&&o&&(_.preventDefault(),o()))},h),T.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Lv=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),Mv(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=Lv)}},[f,h,r,u]),T.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),Mv())},[f,u]),T.useEffect(()=>{const _=()=>p({});return document.addEventListener(_p,_),()=>document.removeEventListener(_p,_)},[]),l.jsx(Ze.div,{...c,ref:x,style:{pointerEvents:y?k?"auto":"none":void 0,...e.style},onFocusCapture:nt(e.onFocusCapture,S.onFocusCapture),onBlurCapture:nt(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:nt(e.onPointerDownCapture,E.onPointerDownCapture)})});Zm.displayName=MA;var $A="DismissableLayerBranch",zA=T.forwardRef((e,t)=>{const r=T.useContext(C_),n=T.useRef(null),s=Ct(t,n);return T.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),l.jsx(Ze.div,{...e,ref:s})});zA.displayName=$A;function WA(e,t=globalThis?.document){const r=$a(e),n=T.useRef(!1),s=T.useRef(()=>{});return T.useEffect(()=>{const a=o=>{if(o.target&&!n.current){let c=function(){N_(BA,r,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function VA(e,t=globalThis?.document){const r=$a(e),n=T.useRef(!1);return T.useEffect(()=>{const s=a=>{a.target&&!n.current&&N_(UA,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Mv(){const e=new CustomEvent(_p);document.dispatchEvent(e)}function N_(e,t,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?jN(s,a):s.dispatchEvent(a)}var z0=0;function A_(){T.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Bv()),document.body.insertAdjacentElement("beforeend",e[1]??Bv()),z0++,()=>{z0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),z0--}},[])}function Bv(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var W0="focusScope.autoFocusOnMount",V0="focusScope.autoFocusOnUnmount",Uv={bubbles:!1,cancelable:!0},HA="FocusScope",ex=T.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:a,...i}=e,[o,c]=T.useState(null),u=$a(s),f=$a(a),d=T.useRef(null),h=Ct(t,m=>c(m)),p=T.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;T.useEffect(()=>{if(n){let m=function(y){if(p.paused||!o)return;const k=y.target;o.contains(k)?d.current=k:xa(d.current,{select:!0})},v=function(y){if(p.paused||!o)return;const k=y.relatedTarget;k!==null&&(o.contains(k)||xa(d.current,{select:!0}))},g=function(y){if(document.activeElement===document.body)for(const E of y)E.removedNodes.length>0&&xa(o)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const w=new MutationObserver(g);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),w.disconnect()}}},[n,o,p.paused]),T.useEffect(()=>{if(o){zv.add(p);const m=document.activeElement;if(!o.contains(m)){const g=new CustomEvent(W0,Uv);o.addEventListener(W0,u),o.dispatchEvent(g),g.defaultPrevented||(GA(JA(j_(o)),{select:!0}),document.activeElement===m&&xa(o))}return()=>{o.removeEventListener(W0,u),setTimeout(()=>{const g=new CustomEvent(V0,Uv);o.addEventListener(V0,f),o.dispatchEvent(g),g.defaultPrevented||xa(m??document.body,{select:!0}),o.removeEventListener(V0,f),zv.remove(p)},0)}}},[o,u,f,p]);const x=T.useCallback(m=>{if(!r&&!n||p.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,g=document.activeElement;if(v&&g){const w=m.currentTarget,[y,k]=XA(w);y&&k?!m.shiftKey&&g===k?(m.preventDefault(),r&&xa(y,{select:!0})):m.shiftKey&&g===y&&(m.preventDefault(),r&&xa(k,{select:!0})):g===w&&m.preventDefault()}},[r,n,p.paused]);return l.jsx(Ze.div,{tabIndex:-1,...i,ref:h,onKeyDown:x})});ex.displayName=HA;function GA(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(xa(n,{select:t}),document.activeElement!==r)return}function XA(e){const t=j_(e),r=$v(t,e),n=$v(t.reverse(),e);return[r,n]}function j_(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function $v(e,t){for(const r of e)if(!KA(r,{upTo:t}))return r}function KA(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function qA(e){return e instanceof HTMLInputElement&&"select"in e}function xa(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&qA(e)&&t&&e.select()}}var zv=YA();function YA(){let e=[];return{add(t){const r=e[0];t!==r&&r?.pause(),e=Wv(e,t),e.unshift(t)},remove(t){e=Wv(e,t),e[0]?.resume()}}}function Wv(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function JA(e){return e.filter(t=>t.tagName!=="A")}const QA=["top","right","bottom","left"],za=Math.min,wn=Math.max,Zf=Math.round,Gu=Math.floor,js=e=>({x:e,y:e}),ZA={left:"right",right:"left",bottom:"top",top:"bottom"},ej={start:"end",end:"start"};function Sp(e,t,r){return wn(e,za(t,r))}function na(e,t){return typeof e=="function"?e(t):e}function sa(e){return e.split("-")[0]}function pl(e){return e.split("-")[1]}function tx(e){return e==="x"?"y":"x"}function rx(e){return e==="y"?"height":"width"}const tj=new Set(["top","bottom"]);function Es(e){return tj.has(sa(e))?"y":"x"}function nx(e){return tx(Es(e))}function rj(e,t,r){r===void 0&&(r=!1);const n=pl(e),s=nx(e),a=rx(s);let i=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(i=ed(i)),[i,ed(i)]}function nj(e){const t=ed(e);return[kp(e),t,kp(t)]}function kp(e){return e.replace(/start|end/g,t=>ej[t])}const Vv=["left","right"],Hv=["right","left"],sj=["top","bottom"],aj=["bottom","top"];function ij(e,t,r){switch(e){case"top":case"bottom":return r?t?Hv:Vv:t?Vv:Hv;case"left":case"right":return t?sj:aj;default:return[]}}function oj(e,t,r,n){const s=pl(e);let a=ij(sa(e),r==="start",n);return s&&(a=a.map(i=>i+"-"+s),t&&(a=a.concat(a.map(kp)))),a}function ed(e){return e.replace(/left|right|bottom|top/g,t=>ZA[t])}function lj(e){return{top:0,right:0,bottom:0,left:0,...e}}function D_(e){return typeof e!="number"?lj(e):{top:e,right:e,bottom:e,left:e}}function td(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function Gv(e,t,r){let{reference:n,floating:s}=e;const a=Es(t),i=nx(t),o=rx(i),c=sa(t),u=a==="y",f=n.x+n.width/2-s.width/2,d=n.y+n.height/2-s.height/2,h=n[o]/2-s[o]/2;let p;switch(c){case"top":p={x:f,y:n.y-s.height};break;case"bottom":p={x:f,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:d};break;case"left":p={x:n.x-s.width,y:d};break;default:p={x:n.x,y:n.y}}switch(pl(t)){case"start":p[i]-=h*(r&&u?-1:1);break;case"end":p[i]+=h*(r&&u?-1:1);break}return p}const cj=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:a=[],platform:i}=r,o=a.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let u=await i.getElementRects({reference:e,floating:t,strategy:s}),{x:f,y:d}=Gv(u,n,c),h=n,p={},x=0;for(let m=0;m<o.length;m++){const{name:v,fn:g}=o[m],{x:w,y,data:k,reset:E}=await g({x:f,y:d,initialPlacement:n,placement:h,strategy:s,middlewareData:p,rects:u,platform:i,elements:{reference:e,floating:t}});f=w??f,d=y??d,p={...p,[v]:{...p[v],...k}},E&&x<=50&&(x++,typeof E=="object"&&(E.placement&&(h=E.placement),E.rects&&(u=E.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:s}):E.rects),{x:f,y:d}=Gv(u,h,c)),m=-1)}return{x:f,y:d,placement:h,strategy:s,middlewareData:p}};async function Rc(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:a,rects:i,elements:o,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=na(t,e),x=D_(p),v=o[h?d==="floating"?"reference":"floating":d],g=td(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(v)))==null||r?v:v.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(o.floating)),boundary:u,rootBoundary:f,strategy:c})),w=d==="floating"?{x:n,y:s,width:i.floating.width,height:i.floating.height}:i.reference,y=await(a.getOffsetParent==null?void 0:a.getOffsetParent(o.floating)),k=await(a.isElement==null?void 0:a.isElement(y))?await(a.getScale==null?void 0:a.getScale(y))||{x:1,y:1}:{x:1,y:1},E=td(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:y,strategy:c}):w);return{top:(g.top-E.top+x.top)/k.y,bottom:(E.bottom-g.bottom+x.bottom)/k.y,left:(g.left-E.left+x.left)/k.x,right:(E.right-g.right+x.right)/k.x}}const uj=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:a,platform:i,elements:o,middlewareData:c}=t,{element:u,padding:f=0}=na(e,t)||{};if(u==null)return{};const d=D_(f),h={x:r,y:n},p=nx(s),x=rx(p),m=await i.getDimensions(u),v=p==="y",g=v?"top":"left",w=v?"bottom":"right",y=v?"clientHeight":"clientWidth",k=a.reference[x]+a.reference[p]-h[p]-a.floating[x],E=h[p]-a.reference[p],S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(u));let _=S?S[y]:0;(!_||!await(i.isElement==null?void 0:i.isElement(S)))&&(_=o.floating[y]||a.floating[x]);const A=k/2-E/2,F=_/2-m[x]/2-1,U=za(d[g],F),V=za(d[w],F),N=U,X=_-m[x]-V,le=_/2-m[x]/2+A,J=Sp(N,le,X),Z=!c.arrow&&pl(s)!=null&&le!==J&&a.reference[x]/2-(le<N?U:V)-m[x]/2<0,re=Z?le<N?le-N:le-X:0;return{[p]:h[p]+re,data:{[p]:J,centerOffset:le-J-re,...Z&&{alignmentOffset:re}},reset:Z}}}),fj=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:a,rects:i,initialPlacement:o,platform:c,elements:u}=t,{mainAxis:f=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:m=!0,...v}=na(e,t);if((r=a.arrow)!=null&&r.alignmentOffset)return{};const g=sa(s),w=Es(o),y=sa(o)===o,k=await(c.isRTL==null?void 0:c.isRTL(u.floating)),E=h||(y||!m?[ed(o)]:nj(o)),S=x!=="none";!h&&S&&E.push(...oj(o,m,x,k));const _=[o,...E],A=await Rc(t,v),F=[];let U=((n=a.flip)==null?void 0:n.overflows)||[];if(f&&F.push(A[g]),d){const le=rj(s,i,k);F.push(A[le[0]],A[le[1]])}if(U=[...U,{placement:s,overflows:F}],!F.every(le=>le<=0)){var V,N;const le=(((V=a.flip)==null?void 0:V.index)||0)+1,J=_[le];if(J&&(!(d==="alignment"?w!==Es(J):!1)||U.every(te=>Es(te.placement)===w?te.overflows[0]>0:!0)))return{data:{index:le,overflows:U},reset:{placement:J}};let Z=(N=U.filter(re=>re.overflows[0]<=0).sort((re,te)=>re.overflows[1]-te.overflows[1])[0])==null?void 0:N.placement;if(!Z)switch(p){case"bestFit":{var X;const re=(X=U.filter(te=>{if(S){const z=Es(te.placement);return z===w||z==="y"}return!0}).map(te=>[te.placement,te.overflows.filter(z=>z>0).reduce((z,K)=>z+K,0)]).sort((te,z)=>te[1]-z[1])[0])==null?void 0:X[0];re&&(Z=re);break}case"initialPlacement":Z=o;break}if(s!==Z)return{reset:{placement:Z}}}return{}}}};function Xv(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Kv(e){return QA.some(t=>e[t]>=0)}const dj=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...s}=na(e,t);switch(n){case"referenceHidden":{const a=await Rc(t,{...s,elementContext:"reference"}),i=Xv(a,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:Kv(i)}}}case"escaped":{const a=await Rc(t,{...s,altBoundary:!0}),i=Xv(a,r.floating);return{data:{escapedOffsets:i,escaped:Kv(i)}}}default:return{}}}}},F_=new Set(["left","top"]);async function hj(e,t){const{placement:r,platform:n,elements:s}=e,a=await(n.isRTL==null?void 0:n.isRTL(s.floating)),i=sa(r),o=pl(r),c=Es(r)==="y",u=F_.has(i)?-1:1,f=a&&c?-1:1,d=na(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:x}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof x=="number"&&(p=o==="end"?x*-1:x),c?{x:p*f,y:h*u}:{x:h*u,y:p*f}}const pj=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:a,placement:i,middlewareData:o}=t,c=await hj(t,e);return i===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:a+c.y,data:{...c,placement:i}}}}},mj=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:s}=t,{mainAxis:a=!0,crossAxis:i=!1,limiter:o={fn:v=>{let{x:g,y:w}=v;return{x:g,y:w}}},...c}=na(e,t),u={x:r,y:n},f=await Rc(t,c),d=Es(sa(s)),h=tx(d);let p=u[h],x=u[d];if(a){const v=h==="y"?"top":"left",g=h==="y"?"bottom":"right",w=p+f[v],y=p-f[g];p=Sp(w,p,y)}if(i){const v=d==="y"?"top":"left",g=d==="y"?"bottom":"right",w=x+f[v],y=x-f[g];x=Sp(w,x,y)}const m=o.fn({...t,[h]:p,[d]:x});return{...m,data:{x:m.x-r,y:m.y-n,enabled:{[h]:a,[d]:i}}}}}},xj=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:s,rects:a,middlewareData:i}=t,{offset:o=0,mainAxis:c=!0,crossAxis:u=!0}=na(e,t),f={x:r,y:n},d=Es(s),h=tx(d);let p=f[h],x=f[d];const m=na(o,t),v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(c){const y=h==="y"?"height":"width",k=a.reference[h]-a.floating[y]+v.mainAxis,E=a.reference[h]+a.reference[y]-v.mainAxis;p<k?p=k:p>E&&(p=E)}if(u){var g,w;const y=h==="y"?"width":"height",k=F_.has(sa(s)),E=a.reference[d]-a.floating[y]+(k&&((g=i.offset)==null?void 0:g[d])||0)+(k?0:v.crossAxis),S=a.reference[d]+a.reference[y]+(k?0:((w=i.offset)==null?void 0:w[d])||0)-(k?v.crossAxis:0);x<E?x=E:x>S&&(x=S)}return{[h]:p,[d]:x}}}},gj=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:s,rects:a,platform:i,elements:o}=t,{apply:c=()=>{},...u}=na(e,t),f=await Rc(t,u),d=sa(s),h=pl(s),p=Es(s)==="y",{width:x,height:m}=a.floating;let v,g;d==="top"||d==="bottom"?(v=d,g=h===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(g=d,v=h==="end"?"top":"bottom");const w=m-f.top-f.bottom,y=x-f.left-f.right,k=za(m-f[v],w),E=za(x-f[g],y),S=!t.middlewareData.shift;let _=k,A=E;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(A=y),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(_=w),S&&!h){const U=wn(f.left,0),V=wn(f.right,0),N=wn(f.top,0),X=wn(f.bottom,0);p?A=x-2*(U!==0||V!==0?U+V:wn(f.left,f.right)):_=m-2*(N!==0||X!==0?N+X:wn(f.top,f.bottom))}await c({...t,availableWidth:A,availableHeight:_});const F=await i.getDimensions(o.floating);return x!==F.width||m!==F.height?{reset:{rects:!0}}:{}}}};function Md(){return typeof window<"u"}function ml(e){return R_(e)?(e.nodeName||"").toLowerCase():"#document"}function Tn(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Os(e){var t;return(t=(R_(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function R_(e){return Md()?e instanceof Node||e instanceof Tn(e).Node:!1}function hs(e){return Md()?e instanceof Element||e instanceof Tn(e).Element:!1}function Ps(e){return Md()?e instanceof HTMLElement||e instanceof Tn(e).HTMLElement:!1}function qv(e){return!Md()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Tn(e).ShadowRoot}const vj=new Set(["inline","contents"]);function cu(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=ps(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!vj.has(s)}const yj=new Set(["table","td","th"]);function wj(e){return yj.has(ml(e))}const _j=[":popover-open",":modal"];function Bd(e){return _j.some(t=>{try{return e.matches(t)}catch{return!1}})}const Sj=["transform","translate","scale","rotate","perspective"],kj=["transform","translate","scale","rotate","perspective","filter"],bj=["paint","layout","strict","content"];function sx(e){const t=ax(),r=hs(e)?ps(e):e;return Sj.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||kj.some(n=>(r.willChange||"").includes(n))||bj.some(n=>(r.contain||"").includes(n))}function Ej(e){let t=Wa(e);for(;Ps(t)&&!rl(t);){if(sx(t))return t;if(Bd(t))return null;t=Wa(t)}return null}function ax(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Tj=new Set(["html","body","#document"]);function rl(e){return Tj.has(ml(e))}function ps(e){return Tn(e).getComputedStyle(e)}function Ud(e){return hs(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Wa(e){if(ml(e)==="html")return e;const t=e.assignedSlot||e.parentNode||qv(e)&&e.host||Os(e);return qv(t)?t.host:t}function P_(e){const t=Wa(e);return rl(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ps(t)&&cu(t)?t:P_(t)}function Pc(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=P_(e),a=s===((n=e.ownerDocument)==null?void 0:n.body),i=Tn(s);if(a){const o=bp(i);return t.concat(i,i.visualViewport||[],cu(s)?s:[],o&&r?Pc(o):[])}return t.concat(s,Pc(s,[],r))}function bp(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function I_(e){const t=ps(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=Ps(e),a=s?e.offsetWidth:r,i=s?e.offsetHeight:n,o=Zf(r)!==a||Zf(n)!==i;return o&&(r=a,n=i),{width:r,height:n,$:o}}function ix(e){return hs(e)?e:e.contextElement}function $o(e){const t=ix(e);if(!Ps(t))return js(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:a}=I_(t);let i=(a?Zf(r.width):r.width)/n,o=(a?Zf(r.height):r.height)/s;return(!i||!Number.isFinite(i))&&(i=1),(!o||!Number.isFinite(o))&&(o=1),{x:i,y:o}}const Cj=js(0);function O_(e){const t=Tn(e);return!ax()||!t.visualViewport?Cj:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Nj(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Tn(e)?!1:t}function ji(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),a=ix(e);let i=js(1);t&&(n?hs(n)&&(i=$o(n)):i=$o(e));const o=Nj(a,r,n)?O_(a):js(0);let c=(s.left+o.x)/i.x,u=(s.top+o.y)/i.y,f=s.width/i.x,d=s.height/i.y;if(a){const h=Tn(a),p=n&&hs(n)?Tn(n):n;let x=h,m=bp(x);for(;m&&n&&p!==x;){const v=$o(m),g=m.getBoundingClientRect(),w=ps(m),y=g.left+(m.clientLeft+parseFloat(w.paddingLeft))*v.x,k=g.top+(m.clientTop+parseFloat(w.paddingTop))*v.y;c*=v.x,u*=v.y,f*=v.x,d*=v.y,c+=y,u+=k,x=Tn(m),m=bp(x)}}return td({width:f,height:d,x:c,y:u})}function $d(e,t){const r=Ud(e).scrollLeft;return t?t.left+r:ji(Os(e)).left+r}function L_(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-$d(e,r),s=r.top+t.scrollTop;return{x:n,y:s}}function Aj(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const a=s==="fixed",i=Os(n),o=t?Bd(t.floating):!1;if(n===i||o&&a)return r;let c={scrollLeft:0,scrollTop:0},u=js(1);const f=js(0),d=Ps(n);if((d||!d&&!a)&&((ml(n)!=="body"||cu(i))&&(c=Ud(n)),Ps(n))){const p=ji(n);u=$o(n),f.x=p.x+n.clientLeft,f.y=p.y+n.clientTop}const h=i&&!d&&!a?L_(i,c):js(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+f.x+h.x,y:r.y*u.y-c.scrollTop*u.y+f.y+h.y}}function jj(e){return Array.from(e.getClientRects())}function Dj(e){const t=Os(e),r=Ud(e),n=e.ownerDocument.body,s=wn(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=wn(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+$d(e);const o=-r.scrollTop;return ps(n).direction==="rtl"&&(i+=wn(t.clientWidth,n.clientWidth)-s),{width:s,height:a,x:i,y:o}}const Yv=25;function Fj(e,t){const r=Tn(e),n=Os(e),s=r.visualViewport;let a=n.clientWidth,i=n.clientHeight,o=0,c=0;if(s){a=s.width,i=s.height;const f=ax();(!f||f&&t==="fixed")&&(o=s.offsetLeft,c=s.offsetTop)}const u=$d(n);if(u<=0){const f=n.ownerDocument,d=f.body,h=getComputedStyle(d),p=f.compatMode==="CSS1Compat"&&parseFloat(h.marginLeft)+parseFloat(h.marginRight)||0,x=Math.abs(n.clientWidth-d.clientWidth-p);x<=Yv&&(a-=x)}else u<=Yv&&(a+=u);return{width:a,height:i,x:o,y:c}}const Rj=new Set(["absolute","fixed"]);function Pj(e,t){const r=ji(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,a=Ps(e)?$o(e):js(1),i=e.clientWidth*a.x,o=e.clientHeight*a.y,c=s*a.x,u=n*a.y;return{width:i,height:o,x:c,y:u}}function Jv(e,t,r){let n;if(t==="viewport")n=Fj(e,r);else if(t==="document")n=Dj(Os(e));else if(hs(t))n=Pj(t,r);else{const s=O_(e);n={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return td(n)}function M_(e,t){const r=Wa(e);return r===t||!hs(r)||rl(r)?!1:ps(r).position==="fixed"||M_(r,t)}function Ij(e,t){const r=t.get(e);if(r)return r;let n=Pc(e,[],!1).filter(o=>hs(o)&&ml(o)!=="body"),s=null;const a=ps(e).position==="fixed";let i=a?Wa(e):e;for(;hs(i)&&!rl(i);){const o=ps(i),c=sx(i);!c&&o.position==="fixed"&&(s=null),(a?!c&&!s:!c&&o.position==="static"&&!!s&&Rj.has(s.position)||cu(i)&&!c&&M_(e,i))?n=n.filter(f=>f!==i):s=o,i=Wa(i)}return t.set(e,n),n}function Oj(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const i=[...r==="clippingAncestors"?Bd(t)?[]:Ij(t,this._c):[].concat(r),n],o=i[0],c=i.reduce((u,f)=>{const d=Jv(t,f,s);return u.top=wn(d.top,u.top),u.right=za(d.right,u.right),u.bottom=za(d.bottom,u.bottom),u.left=wn(d.left,u.left),u},Jv(t,o,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function Lj(e){const{width:t,height:r}=I_(e);return{width:t,height:r}}function Mj(e,t,r){const n=Ps(t),s=Os(t),a=r==="fixed",i=ji(e,!0,a,t);let o={scrollLeft:0,scrollTop:0};const c=js(0);function u(){c.x=$d(s)}if(n||!n&&!a)if((ml(t)!=="body"||cu(s))&&(o=Ud(t)),n){const p=ji(t,!0,a,t);c.x=p.x+t.clientLeft,c.y=p.y+t.clientTop}else s&&u();a&&!n&&s&&u();const f=s&&!n&&!a?L_(s,o):js(0),d=i.left+o.scrollLeft-c.x-f.x,h=i.top+o.scrollTop-c.y-f.y;return{x:d,y:h,width:i.width,height:i.height}}function H0(e){return ps(e).position==="static"}function Qv(e,t){if(!Ps(e)||ps(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Os(e)===r&&(r=r.ownerDocument.body),r}function B_(e,t){const r=Tn(e);if(Bd(e))return r;if(!Ps(e)){let s=Wa(e);for(;s&&!rl(s);){if(hs(s)&&!H0(s))return s;s=Wa(s)}return r}let n=Qv(e,t);for(;n&&wj(n)&&H0(n);)n=Qv(n,t);return n&&rl(n)&&H0(n)&&!sx(n)?r:n||Ej(e)||r}const Bj=async function(e){const t=this.getOffsetParent||B_,r=this.getDimensions,n=await r(e.floating);return{reference:Mj(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Uj(e){return ps(e).direction==="rtl"}const $j={convertOffsetParentRelativeRectToViewportRelativeRect:Aj,getDocumentElement:Os,getClippingRect:Oj,getOffsetParent:B_,getElementRects:Bj,getClientRects:jj,getDimensions:Lj,getScale:$o,isElement:hs,isRTL:Uj};function U_(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function zj(e,t){let r=null,n;const s=Os(e);function a(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function i(o,c){o===void 0&&(o=!1),c===void 0&&(c=1),a();const u=e.getBoundingClientRect(),{left:f,top:d,width:h,height:p}=u;if(o||t(),!h||!p)return;const x=Gu(d),m=Gu(s.clientWidth-(f+h)),v=Gu(s.clientHeight-(d+p)),g=Gu(f),y={rootMargin:-x+"px "+-m+"px "+-v+"px "+-g+"px",threshold:wn(0,za(1,c))||1};let k=!0;function E(S){const _=S[0].intersectionRatio;if(_!==c){if(!k)return i();_?i(!1,_):n=setTimeout(()=>{i(!1,1e-7)},1e3)}_===1&&!U_(u,e.getBoundingClientRect())&&i(),k=!1}try{r=new IntersectionObserver(E,{...y,root:s.ownerDocument})}catch{r=new IntersectionObserver(E,y)}r.observe(e)}return i(!0),a}function Wj(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,u=ix(e),f=s||a?[...u?Pc(u):[],...Pc(t)]:[];f.forEach(g=>{s&&g.addEventListener("scroll",r,{passive:!0}),a&&g.addEventListener("resize",r)});const d=u&&o?zj(u,r):null;let h=-1,p=null;i&&(p=new ResizeObserver(g=>{let[w]=g;w&&w.target===u&&p&&(p.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var y;(y=p)==null||y.observe(t)})),r()}),u&&!c&&p.observe(u),p.observe(t));let x,m=c?ji(e):null;c&&v();function v(){const g=ji(e);m&&!U_(m,g)&&r(),m=g,x=requestAnimationFrame(v)}return r(),()=>{var g;f.forEach(w=>{s&&w.removeEventListener("scroll",r),a&&w.removeEventListener("resize",r)}),d?.(),(g=p)==null||g.disconnect(),p=null,c&&cancelAnimationFrame(x)}}const Vj=pj,Hj=mj,Gj=fj,Xj=gj,Kj=dj,Zv=uj,qj=xj,Yj=(e,t,r)=>{const n=new Map,s={platform:$j,...r},a={...s.platform,_c:n};return cj(e,t,{...s,platform:a})};var Jj=typeof document<"u",Qj=function(){},bf=Jj?T.useLayoutEffect:Qj;function rd(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!rd(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const a=s[n];if(!(a==="_owner"&&e.$$typeof)&&!rd(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function $_(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function e1(e,t){const r=$_(e);return Math.round(t*r)/r}function G0(e){const t=T.useRef(e);return bf(()=>{t.current=e}),t}function Zj(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:a,floating:i}={},transform:o=!0,whileElementsMounted:c,open:u}=e,[f,d]=T.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,p]=T.useState(n);rd(h,n)||p(n);const[x,m]=T.useState(null),[v,g]=T.useState(null),w=T.useCallback(te=>{te!==S.current&&(S.current=te,m(te))},[]),y=T.useCallback(te=>{te!==_.current&&(_.current=te,g(te))},[]),k=a||x,E=i||v,S=T.useRef(null),_=T.useRef(null),A=T.useRef(f),F=c!=null,U=G0(c),V=G0(s),N=G0(u),X=T.useCallback(()=>{if(!S.current||!_.current)return;const te={placement:t,strategy:r,middleware:h};V.current&&(te.platform=V.current),Yj(S.current,_.current,te).then(z=>{const K={...z,isPositioned:N.current!==!1};le.current&&!rd(A.current,K)&&(A.current=K,dl.flushSync(()=>{d(K)}))})},[h,t,r,V,N]);bf(()=>{u===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,d(te=>({...te,isPositioned:!1})))},[u]);const le=T.useRef(!1);bf(()=>(le.current=!0,()=>{le.current=!1}),[]),bf(()=>{if(k&&(S.current=k),E&&(_.current=E),k&&E){if(U.current)return U.current(k,E,X);X()}},[k,E,X,U,F]);const J=T.useMemo(()=>({reference:S,floating:_,setReference:w,setFloating:y}),[w,y]),Z=T.useMemo(()=>({reference:k,floating:E}),[k,E]),re=T.useMemo(()=>{const te={position:r,left:0,top:0};if(!Z.floating)return te;const z=e1(Z.floating,f.x),K=e1(Z.floating,f.y);return o?{...te,transform:"translate("+z+"px, "+K+"px)",...$_(Z.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:z,top:K}},[r,o,Z.floating,f.x,f.y]);return T.useMemo(()=>({...f,update:X,refs:J,elements:Z,floatingStyles:re}),[f,X,J,Z,re])}const e3=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?Zv({element:n.current,padding:s}).fn(r):{}:n?Zv({element:n,padding:s}).fn(r):{}}}},t3=(e,t)=>({...Vj(e),options:[e,t]}),r3=(e,t)=>({...Hj(e),options:[e,t]}),n3=(e,t)=>({...qj(e),options:[e,t]}),s3=(e,t)=>({...Gj(e),options:[e,t]}),a3=(e,t)=>({...Xj(e),options:[e,t]}),i3=(e,t)=>({...Kj(e),options:[e,t]}),o3=(e,t)=>({...e3(e),options:[e,t]});var l3="Arrow",z_=T.forwardRef((e,t)=>{const{children:r,width:n=10,height:s=5,...a}=e;return l.jsx(Ze.svg,{...a,ref:t,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:l.jsx("polygon",{points:"0,0 30,0 15,10"})})});z_.displayName=l3;var c3=z_;function W_(e){const[t,r]=T.useState(void 0);return Ir(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const a=s[0];let i,o;if("borderBoxSize"in a){const c=a.borderBoxSize,u=Array.isArray(c)?c[0]:c;i=u.inlineSize,o=u.blockSize}else i=e.offsetWidth,o=e.offsetHeight;r({width:i,height:o})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var ox="Popper",[V_,H_]=oa(ox),[u3,G_]=V_(ox),X_=e=>{const{__scopePopper:t,children:r}=e,[n,s]=T.useState(null);return l.jsx(u3,{scope:t,anchor:n,onAnchorChange:s,children:r})};X_.displayName=ox;var K_="PopperAnchor",q_=T.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...s}=e,a=G_(K_,r),i=T.useRef(null),o=Ct(t,i),c=T.useRef(null);return T.useEffect(()=>{const u=c.current;c.current=n?.current||i.current,u!==c.current&&a.onAnchorChange(c.current)}),n?null:l.jsx(Ze.div,{...s,ref:o})});q_.displayName=K_;var lx="PopperContent",[f3,d3]=V_(lx),Y_=T.forwardRef((e,t)=>{const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:a="center",alignOffset:i=0,arrowPadding:o=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:f=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:x,...m}=e,v=G_(lx,r),[g,w]=T.useState(null),y=Ct(t,q=>w(q)),[k,E]=T.useState(null),S=W_(k),_=S?.width??0,A=S?.height??0,F=n+(a!=="center"?"-"+a:""),U=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},V=Array.isArray(u)?u:[u],N=V.length>0,X={padding:U,boundary:V.filter(p3),altBoundary:N},{refs:le,floatingStyles:J,placement:Z,isPositioned:re,middlewareData:te}=Zj({strategy:"fixed",placement:F,whileElementsMounted:(...q)=>Wj(...q,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[t3({mainAxis:s+A,alignmentAxis:i}),c&&r3({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?n3():void 0,...X}),c&&s3({...X}),a3({...X,apply:({elements:q,rects:H,availableWidth:Q,availableHeight:ee})=>{const{width:G,height:C}=H.reference,pe=q.floating.style;pe.setProperty("--radix-popper-available-width",`${Q}px`),pe.setProperty("--radix-popper-available-height",`${ee}px`),pe.setProperty("--radix-popper-anchor-width",`${G}px`),pe.setProperty("--radix-popper-anchor-height",`${C}px`)}}),k&&o3({element:k,padding:o}),m3({arrowWidth:_,arrowHeight:A}),h&&i3({strategy:"referenceHidden",...X})]}),[z,K]=Z_(Z),se=$a(x);Ir(()=>{re&&se?.()},[re,se]);const P=te.arrow?.x,b=te.arrow?.y,D=te.arrow?.centerOffset!==0,[R,W]=T.useState();return Ir(()=>{g&&W(window.getComputedStyle(g).zIndex)},[g]),l.jsx("div",{ref:le.setFloating,"data-radix-popper-content-wrapper":"",style:{...J,transform:re?J.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:R,"--radix-popper-transform-origin":[te.transformOrigin?.x,te.transformOrigin?.y].join(" "),...te.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:l.jsx(f3,{scope:r,placedSide:z,onArrowChange:E,arrowX:P,arrowY:b,shouldHideArrow:D,children:l.jsx(Ze.div,{"data-side":z,"data-align":K,...m,ref:y,style:{...m.style,animation:re?void 0:"none"}})})})});Y_.displayName=lx;var J_="PopperArrow",h3={top:"bottom",right:"left",bottom:"top",left:"right"},Q_=T.forwardRef(function(t,r){const{__scopePopper:n,...s}=t,a=d3(J_,n),i=h3[a.placedSide];return l.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:l.jsx(c3,{...s,ref:r,style:{...s.style,display:"block"}})})});Q_.displayName=J_;function p3(e){return e!==null}var m3=e=>({name:"transformOrigin",options:e,fn(t){const{placement:r,rects:n,middlewareData:s}=t,i=s.arrow?.centerOffset!==0,o=i?0:e.arrowWidth,c=i?0:e.arrowHeight,[u,f]=Z_(r),d={start:"0%",center:"50%",end:"100%"}[f],h=(s.arrow?.x??0)+o/2,p=(s.arrow?.y??0)+c/2;let x="",m="";return u==="bottom"?(x=i?d:`${h}px`,m=`${-c}px`):u==="top"?(x=i?d:`${h}px`,m=`${n.floating.height+c}px`):u==="right"?(x=`${-c}px`,m=i?d:`${p}px`):u==="left"&&(x=`${n.floating.width+c}px`,m=i?d:`${p}px`),{data:{x,y:m}}}});function Z_(e){const[t,r="center"]=e.split("-");return[t,r]}var x3=X_,g3=q_,v3=Y_,y3=Q_,w3="Portal",cx=T.forwardRef((e,t)=>{const{container:r,...n}=e,[s,a]=T.useState(!1);Ir(()=>a(!0),[]);const i=r||s&&globalThis?.document?.body;return i?Q2.createPortal(l.jsx(Ze.div,{...n,ref:t}),i):null});cx.displayName=w3;function eS(e){const t=T.useRef({value:e,previous:e});return T.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var tS=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),_3="VisuallyHidden",S3=T.forwardRef((e,t)=>l.jsx(Ze.span,{...e,ref:t,style:{...tS,...e.style}}));S3.displayName=_3;var k3=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ao=new WeakMap,Xu=new WeakMap,Ku={},X0=0,rS=function(e){return e&&(e.host||rS(e.parentNode))},b3=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=rS(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},E3=function(e,t,r,n){var s=b3(t,Array.isArray(e)?e:[e]);Ku[r]||(Ku[r]=new WeakMap);var a=Ku[r],i=[],o=new Set,c=new Set(s),u=function(d){!d||o.has(d)||(o.add(d),u(d.parentNode))};s.forEach(u);var f=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))f(h);else try{var p=h.getAttribute(n),x=p!==null&&p!=="false",m=(ao.get(h)||0)+1,v=(a.get(h)||0)+1;ao.set(h,m),a.set(h,v),i.push(h),m===1&&x&&Xu.set(h,!0),v===1&&h.setAttribute(r,"true"),x||h.setAttribute(n,"true")}catch(g){console.error("aria-hidden: cannot operate on ",h,g)}})};return f(t),o.clear(),X0++,function(){i.forEach(function(d){var h=ao.get(d)-1,p=a.get(d)-1;ao.set(d,h),a.set(d,p),h||(Xu.has(d)||d.removeAttribute(n),Xu.delete(d)),p||d.removeAttribute(r)}),X0--,X0||(ao=new WeakMap,ao=new WeakMap,Xu=new WeakMap,Ku={})}},nS=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),s=k3(e);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),E3(n,s,r,"aria-hidden")):function(){return null}},bs=function(){return bs=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},bs.apply(this,arguments)};function sS(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function T3(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var Ef="right-scroll-bar-position",Tf="width-before-scroll-bar",C3="with-scroll-bars-hidden",N3="--removed-body-scroll-bar-size";function K0(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function A3(e,t){var r=T.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=t,r.facade}var j3=typeof window<"u"?T.useLayoutEffect:T.useEffect,t1=new WeakMap;function D3(e,t){var r=A3(null,function(n){return e.forEach(function(s){return K0(s,n)})});return j3(function(){var n=t1.get(r);if(n){var s=new Set(n),a=new Set(e),i=r.current;s.forEach(function(o){a.has(o)||K0(o,null)}),a.forEach(function(o){s.has(o)||K0(o,i)})}t1.set(r,e)},[e]),r}function F3(e){return e}function R3(e,t){t===void 0&&(t=F3);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(a){var i=t(a,n);return r.push(i),function(){r=r.filter(function(o){return o!==i})}},assignSyncMedium:function(a){for(n=!0;r.length;){var i=r;r=[],i.forEach(a)}r={push:function(o){return a(o)},filter:function(){return r}}},assignMedium:function(a){n=!0;var i=[];if(r.length){var o=r;r=[],o.forEach(a),i=r}var c=function(){var f=i;i=[],f.forEach(a)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(f){i.push(f),u()},filter:function(f){return i=i.filter(f),r}}}};return s}function P3(e){e===void 0&&(e={});var t=R3(null);return t.options=bs({async:!0,ssr:!1},e),t}var aS=function(e){var t=e.sideCar,r=sS(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return T.createElement(n,bs({},r))};aS.isSideCarExport=!0;function I3(e,t){return e.useMedium(t),aS}var iS=P3(),q0=function(){},zd=T.forwardRef(function(e,t){var r=T.useRef(null),n=T.useState({onScrollCapture:q0,onWheelCapture:q0,onTouchMoveCapture:q0}),s=n[0],a=n[1],i=e.forwardProps,o=e.children,c=e.className,u=e.removeScrollBar,f=e.enabled,d=e.shards,h=e.sideCar,p=e.noRelative,x=e.noIsolation,m=e.inert,v=e.allowPinchZoom,g=e.as,w=g===void 0?"div":g,y=e.gapMode,k=sS(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),E=h,S=D3([r,t]),_=bs(bs({},k),s);return T.createElement(T.Fragment,null,f&&T.createElement(E,{sideCar:iS,removeScrollBar:u,shards:d,noRelative:p,noIsolation:x,inert:m,setCallbacks:a,allowPinchZoom:!!v,lockRef:r,gapMode:y}),i?T.cloneElement(T.Children.only(o),bs(bs({},_),{ref:S})):T.createElement(w,bs({},_,{className:c,ref:S}),o))});zd.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};zd.classNames={fullWidth:Tf,zeroRight:Ef};var O3=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function L3(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=O3();return t&&e.setAttribute("nonce",t),e}function M3(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function B3(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var U3=function(){var e=0,t=null;return{add:function(r){e==0&&(t=L3())&&(M3(t,r),B3(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},$3=function(){var e=U3();return function(t,r){T.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},oS=function(){var e=$3(),t=function(r){var n=r.styles,s=r.dynamic;return e(n,s),null};return t},z3={left:0,top:0,right:0,gap:0},Y0=function(e){return parseInt(e||"",10)||0},W3=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[Y0(r),Y0(n),Y0(s)]},V3=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return z3;var t=W3(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},H3=oS(),zo="data-scroll-locked",G3=function(e,t,r,n){var s=e.left,a=e.top,i=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(C3,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(zo,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ef,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(Tf,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(Ef," .").concat(Ef,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Tf," .").concat(Tf,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(zo,`] {
    `).concat(N3,": ").concat(o,`px;
  }
`)},r1=function(){var e=parseInt(document.body.getAttribute(zo)||"0",10);return isFinite(e)?e:0},X3=function(){T.useEffect(function(){return document.body.setAttribute(zo,(r1()+1).toString()),function(){var e=r1()-1;e<=0?document.body.removeAttribute(zo):document.body.setAttribute(zo,e.toString())}},[])},K3=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,s=n===void 0?"margin":n;X3();var a=T.useMemo(function(){return V3(s)},[s]);return T.createElement(H3,{styles:G3(a,!t,s,r?"":"!important")})},Ep=!1;if(typeof window<"u")try{var qu=Object.defineProperty({},"passive",{get:function(){return Ep=!0,!0}});window.addEventListener("test",qu,qu),window.removeEventListener("test",qu,qu)}catch{Ep=!1}var io=Ep?{passive:!1}:!1,q3=function(e){return e.tagName==="TEXTAREA"},lS=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!q3(e)&&r[t]==="visible")},Y3=function(e){return lS(e,"overflowY")},J3=function(e){return lS(e,"overflowX")},n1=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=cS(e,n);if(s){var a=uS(e,n),i=a[1],o=a[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Q3=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Z3=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},cS=function(e,t){return e==="v"?Y3(t):J3(t)},uS=function(e,t){return e==="v"?Q3(t):Z3(t)},eD=function(e,t){return e==="h"&&t==="rtl"?-1:1},tD=function(e,t,r,n,s){var a=eD(e,window.getComputedStyle(t).direction),i=a*n,o=r.target,c=t.contains(o),u=!1,f=i>0,d=0,h=0;do{if(!o)break;var p=uS(e,o),x=p[0],m=p[1],v=p[2],g=m-v-a*x;(x||g)&&cS(e,o)&&(d+=g,h+=x);var w=o.parentNode;o=w&&w.nodeType===Node.DOCUMENT_FRAGMENT_NODE?w.host:w}while(!c&&o!==document.body||c&&(t.contains(o)||t===o));return(f&&Math.abs(d)<1||!f&&Math.abs(h)<1)&&(u=!0),u},Yu=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},s1=function(e){return[e.deltaX,e.deltaY]},a1=function(e){return e&&"current"in e?e.current:e},rD=function(e,t){return e[0]===t[0]&&e[1]===t[1]},nD=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},sD=0,oo=[];function aD(e){var t=T.useRef([]),r=T.useRef([0,0]),n=T.useRef(),s=T.useState(sD++)[0],a=T.useState(oS)[0],i=T.useRef(e);T.useEffect(function(){i.current=e},[e]),T.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var m=T3([e.lockRef.current],(e.shards||[]).map(a1),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=T.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var g=Yu(m),w=r.current,y="deltaX"in m?m.deltaX:w[0]-g[0],k="deltaY"in m?m.deltaY:w[1]-g[1],E,S=m.target,_=Math.abs(y)>Math.abs(k)?"h":"v";if("touches"in m&&_==="h"&&S.type==="range")return!1;var A=n1(_,S);if(!A)return!0;if(A?E=_:(E=_==="v"?"h":"v",A=n1(_,S)),!A)return!1;if(!n.current&&"changedTouches"in m&&(y||k)&&(n.current=E),!E)return!0;var F=n.current||E;return tD(F,v,m,F==="h"?y:k)},[]),c=T.useCallback(function(m){var v=m;if(!(!oo.length||oo[oo.length-1]!==a)){var g="deltaY"in v?s1(v):Yu(v),w=t.current.filter(function(E){return E.name===v.type&&(E.target===v.target||v.target===E.shadowParent)&&rD(E.delta,g)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var y=(i.current.shards||[]).map(a1).filter(Boolean).filter(function(E){return E.contains(v.target)}),k=y.length>0?o(v,y[0]):!i.current.noIsolation;k&&v.cancelable&&v.preventDefault()}}},[]),u=T.useCallback(function(m,v,g,w){var y={name:m,delta:v,target:g,should:w,shadowParent:iD(g)};t.current.push(y),setTimeout(function(){t.current=t.current.filter(function(k){return k!==y})},1)},[]),f=T.useCallback(function(m){r.current=Yu(m),n.current=void 0},[]),d=T.useCallback(function(m){u(m.type,s1(m),m.target,o(m,e.lockRef.current))},[]),h=T.useCallback(function(m){u(m.type,Yu(m),m.target,o(m,e.lockRef.current))},[]);T.useEffect(function(){return oo.push(a),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",c,io),document.addEventListener("touchmove",c,io),document.addEventListener("touchstart",f,io),function(){oo=oo.filter(function(m){return m!==a}),document.removeEventListener("wheel",c,io),document.removeEventListener("touchmove",c,io),document.removeEventListener("touchstart",f,io)}},[]);var p=e.removeScrollBar,x=e.inert;return T.createElement(T.Fragment,null,x?T.createElement(a,{styles:nD(s)}):null,p?T.createElement(K3,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function iD(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const oD=I3(iS,aD);var ux=T.forwardRef(function(e,t){return T.createElement(zd,bs({},e,{ref:t,sideCar:oD}))});ux.classNames=zd.classNames;var lD=[" ","Enter","ArrowUp","ArrowDown"],cD=[" ","Enter"],Di="Select",[Wd,Vd,uD]=c_(Di),[xl,bV]=oa(Di,[uD,H_]),Hd=H_(),[fD,Ja]=xl(Di),[dD,hD]=xl(Di),fS=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:s,onOpenChange:a,value:i,defaultValue:o,onValueChange:c,dir:u,name:f,autoComplete:d,disabled:h,required:p,form:x}=e,m=Hd(t),[v,g]=T.useState(null),[w,y]=T.useState(null),[k,E]=T.useState(!1),S=Jm(u),[_,A]=Ai({prop:n,defaultProp:s??!1,onChange:a,caller:Di}),[F,U]=Ai({prop:i,defaultProp:o,onChange:c,caller:Di}),V=T.useRef(null),N=v?x||!!v.closest("form"):!0,[X,le]=T.useState(new Set),J=Array.from(X).map(Z=>Z.props.value).join(";");return l.jsx(x3,{...m,children:l.jsxs(fD,{required:p,scope:t,trigger:v,onTriggerChange:g,valueNode:w,onValueNodeChange:y,valueNodeHasChildren:k,onValueNodeHasChildrenChange:E,contentId:Ys(),value:F,onValueChange:U,open:_,onOpenChange:A,dir:S,triggerPointerDownPosRef:V,disabled:h,children:[l.jsx(Wd.Provider,{scope:t,children:l.jsx(dD,{scope:e.__scopeSelect,onNativeOptionAdd:T.useCallback(Z=>{le(re=>new Set(re).add(Z))},[]),onNativeOptionRemove:T.useCallback(Z=>{le(re=>{const te=new Set(re);return te.delete(Z),te})},[]),children:r})}),N?l.jsxs(RS,{"aria-hidden":!0,required:p,tabIndex:-1,name:f,autoComplete:d,value:F,onChange:Z=>U(Z.target.value),disabled:h,form:x,children:[F===void 0?l.jsx("option",{value:""}):null,Array.from(X)]},J):null]})})};fS.displayName=Di;var dS="SelectTrigger",hS=T.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...s}=e,a=Hd(r),i=Ja(dS,r),o=i.disabled||n,c=Ct(t,i.onTriggerChange),u=Vd(r),f=T.useRef("touch"),[d,h,p]=IS(m=>{const v=u().filter(y=>!y.disabled),g=v.find(y=>y.value===i.value),w=OS(v,m,g);w!==void 0&&i.onValueChange(w.value)}),x=m=>{o||(i.onOpenChange(!0),p()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return l.jsx(g3,{asChild:!0,...a,children:l.jsx(Ze.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":PS(i.value)?"":void 0,...s,ref:c,onClick:nt(s.onClick,m=>{m.currentTarget.focus(),f.current!=="mouse"&&x(m)}),onPointerDown:nt(s.onPointerDown,m=>{f.current=m.pointerType;const v=m.target;v.hasPointerCapture(m.pointerId)&&v.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(x(m),m.preventDefault())}),onKeyDown:nt(s.onKeyDown,m=>{const v=d.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&h(m.key),!(v&&m.key===" ")&&lD.includes(m.key)&&(x(),m.preventDefault())})})})});hS.displayName=dS;var pS="SelectValue",mS=T.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,children:a,placeholder:i="",...o}=e,c=Ja(pS,r),{onValueNodeHasChildrenChange:u}=c,f=a!==void 0,d=Ct(t,c.onValueNodeChange);return Ir(()=>{u(f)},[u,f]),l.jsx(Ze.span,{...o,ref:d,style:{pointerEvents:"none"},children:PS(c.value)?l.jsx(l.Fragment,{children:i}):a})});mS.displayName=pS;var pD="SelectIcon",xS=T.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...s}=e;return l.jsx(Ze.span,{"aria-hidden":!0,...s,ref:t,children:n||""})});xS.displayName=pD;var mD="SelectPortal",gS=e=>l.jsx(cx,{asChild:!0,...e});gS.displayName=mD;var Fi="SelectContent",vS=T.forwardRef((e,t)=>{const r=Ja(Fi,e.__scopeSelect),[n,s]=T.useState();if(Ir(()=>{s(new DocumentFragment)},[]),!r.open){const a=n;return a?dl.createPortal(l.jsx(yS,{scope:e.__scopeSelect,children:l.jsx(Wd.Slot,{scope:e.__scopeSelect,children:l.jsx("div",{children:e.children})})}),a):null}return l.jsx(wS,{...e,ref:t})});vS.displayName=Fi;var ts=10,[yS,Qa]=xl(Fi),xD="SelectContentImpl",gD=tl("SelectContent.RemoveScroll"),wS=T.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:a,onPointerDownOutside:i,side:o,sideOffset:c,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:x,hideWhenDetached:m,avoidCollisions:v,...g}=e,w=Ja(Fi,r),[y,k]=T.useState(null),[E,S]=T.useState(null),_=Ct(t,q=>k(q)),[A,F]=T.useState(null),[U,V]=T.useState(null),N=Vd(r),[X,le]=T.useState(!1),J=T.useRef(!1);T.useEffect(()=>{if(y)return nS(y)},[y]),A_();const Z=T.useCallback(q=>{const[H,...Q]=N().map(C=>C.ref.current),[ee]=Q.slice(-1),G=document.activeElement;for(const C of q)if(C===G||(C?.scrollIntoView({block:"nearest"}),C===H&&E&&(E.scrollTop=0),C===ee&&E&&(E.scrollTop=E.scrollHeight),C?.focus(),document.activeElement!==G))return},[N,E]),re=T.useCallback(()=>Z([A,y]),[Z,A,y]);T.useEffect(()=>{X&&re()},[X,re]);const{onOpenChange:te,triggerPointerDownPosRef:z}=w;T.useEffect(()=>{if(y){let q={x:0,y:0};const H=ee=>{q={x:Math.abs(Math.round(ee.pageX)-(z.current?.x??0)),y:Math.abs(Math.round(ee.pageY)-(z.current?.y??0))}},Q=ee=>{q.x<=10&&q.y<=10?ee.preventDefault():y.contains(ee.target)||te(!1),document.removeEventListener("pointermove",H),z.current=null};return z.current!==null&&(document.addEventListener("pointermove",H),document.addEventListener("pointerup",Q,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",H),document.removeEventListener("pointerup",Q,{capture:!0})}}},[y,te,z]),T.useEffect(()=>{const q=()=>te(!1);return window.addEventListener("blur",q),window.addEventListener("resize",q),()=>{window.removeEventListener("blur",q),window.removeEventListener("resize",q)}},[te]);const[K,se]=IS(q=>{const H=N().filter(G=>!G.disabled),Q=H.find(G=>G.ref.current===document.activeElement),ee=OS(H,q,Q);ee&&setTimeout(()=>ee.ref.current.focus())}),P=T.useCallback((q,H,Q)=>{const ee=!J.current&&!Q;(w.value!==void 0&&w.value===H||ee)&&(F(q),ee&&(J.current=!0))},[w.value]),b=T.useCallback(()=>y?.focus(),[y]),D=T.useCallback((q,H,Q)=>{const ee=!J.current&&!Q;(w.value!==void 0&&w.value===H||ee)&&V(q)},[w.value]),R=n==="popper"?Tp:_S,W=R===Tp?{side:o,sideOffset:c,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:x,hideWhenDetached:m,avoidCollisions:v}:{};return l.jsx(yS,{scope:r,content:y,viewport:E,onViewportChange:S,itemRefCallback:P,selectedItem:A,onItemLeave:b,itemTextRefCallback:D,focusSelectedItem:re,selectedItemText:U,position:n,isPositioned:X,searchRef:K,children:l.jsx(ux,{as:gD,allowPinchZoom:!0,children:l.jsx(ex,{asChild:!0,trapped:w.open,onMountAutoFocus:q=>{q.preventDefault()},onUnmountAutoFocus:nt(s,q=>{w.trigger?.focus({preventScroll:!0}),q.preventDefault()}),children:l.jsx(Zm,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:q=>q.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:l.jsx(R,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:q=>q.preventDefault(),...g,...W,onPlaced:()=>le(!0),ref:_,style:{display:"flex",flexDirection:"column",outline:"none",...g.style},onKeyDown:nt(g.onKeyDown,q=>{const H=q.ctrlKey||q.altKey||q.metaKey;if(q.key==="Tab"&&q.preventDefault(),!H&&q.key.length===1&&se(q.key),["ArrowUp","ArrowDown","Home","End"].includes(q.key)){let ee=N().filter(G=>!G.disabled).map(G=>G.ref.current);if(["ArrowUp","End"].includes(q.key)&&(ee=ee.slice().reverse()),["ArrowUp","ArrowDown"].includes(q.key)){const G=q.target,C=ee.indexOf(G);ee=ee.slice(C+1)}setTimeout(()=>Z(ee)),q.preventDefault()}})})})})})})});wS.displayName=xD;var vD="SelectItemAlignedPosition",_S=T.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...s}=e,a=Ja(Fi,r),i=Qa(Fi,r),[o,c]=T.useState(null),[u,f]=T.useState(null),d=Ct(t,_=>f(_)),h=Vd(r),p=T.useRef(!1),x=T.useRef(!0),{viewport:m,selectedItem:v,selectedItemText:g,focusSelectedItem:w}=i,y=T.useCallback(()=>{if(a.trigger&&a.valueNode&&o&&u&&m&&v&&g){const _=a.trigger.getBoundingClientRect(),A=u.getBoundingClientRect(),F=a.valueNode.getBoundingClientRect(),U=g.getBoundingClientRect();if(a.dir!=="rtl"){const G=U.left-A.left,C=F.left-G,pe=_.left-C,_e=_.width+pe,Y=Math.max(_e,A.width),ae=window.innerWidth-ts,ce=Ov(C,[ts,Math.max(ts,ae-Y)]);o.style.minWidth=_e+"px",o.style.left=ce+"px"}else{const G=A.right-U.right,C=window.innerWidth-F.right-G,pe=window.innerWidth-_.right-C,_e=_.width+pe,Y=Math.max(_e,A.width),ae=window.innerWidth-ts,ce=Ov(C,[ts,Math.max(ts,ae-Y)]);o.style.minWidth=_e+"px",o.style.right=ce+"px"}const V=h(),N=window.innerHeight-ts*2,X=m.scrollHeight,le=window.getComputedStyle(u),J=parseInt(le.borderTopWidth,10),Z=parseInt(le.paddingTop,10),re=parseInt(le.borderBottomWidth,10),te=parseInt(le.paddingBottom,10),z=J+Z+X+te+re,K=Math.min(v.offsetHeight*5,z),se=window.getComputedStyle(m),P=parseInt(se.paddingTop,10),b=parseInt(se.paddingBottom,10),D=_.top+_.height/2-ts,R=N-D,W=v.offsetHeight/2,q=v.offsetTop+W,H=J+Z+q,Q=z-H;if(H<=D){const G=V.length>0&&v===V[V.length-1].ref.current;o.style.bottom="0px";const C=u.clientHeight-m.offsetTop-m.offsetHeight,pe=Math.max(R,W+(G?b:0)+C+re),_e=H+pe;o.style.height=_e+"px"}else{const G=V.length>0&&v===V[0].ref.current;o.style.top="0px";const pe=Math.max(D,J+m.offsetTop+(G?P:0)+W)+Q;o.style.height=pe+"px",m.scrollTop=H-D+m.offsetTop}o.style.margin=`${ts}px 0`,o.style.minHeight=K+"px",o.style.maxHeight=N+"px",n?.(),requestAnimationFrame(()=>p.current=!0)}},[h,a.trigger,a.valueNode,o,u,m,v,g,a.dir,n]);Ir(()=>y(),[y]);const[k,E]=T.useState();Ir(()=>{u&&E(window.getComputedStyle(u).zIndex)},[u]);const S=T.useCallback(_=>{_&&x.current===!0&&(y(),w?.(),x.current=!1)},[y,w]);return l.jsx(wD,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:p,onScrollButtonChange:S,children:l.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:k},children:l.jsx(Ze.div,{...s,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});_S.displayName=vD;var yD="SelectPopperPosition",Tp=T.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=ts,...a}=e,i=Hd(r);return l.jsx(v3,{...i,...a,ref:t,align:n,collisionPadding:s,style:{boxSizing:"border-box",...a.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Tp.displayName=yD;var[wD,fx]=xl(Fi,{}),Cp="SelectViewport",SS=T.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...s}=e,a=Qa(Cp,r),i=fx(Cp,r),o=Ct(t,a.onViewportChange),c=T.useRef(0);return l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),l.jsx(Wd.Slot,{scope:r,children:l.jsx(Ze.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:nt(s.onScroll,u=>{const f=u.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=i;if(h?.current&&d){const p=Math.abs(c.current-f.scrollTop);if(p>0){const x=window.innerHeight-ts*2,m=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),g=Math.max(m,v);if(g<x){const w=g+p,y=Math.min(x,w),k=w-y;d.style.height=y+"px",d.style.bottom==="0px"&&(f.scrollTop=k>0?k:0,d.style.justifyContent="flex-end")}}}c.current=f.scrollTop})})})]})});SS.displayName=Cp;var kS="SelectGroup",[_D,SD]=xl(kS),kD=T.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=Ys();return l.jsx(_D,{scope:r,id:s,children:l.jsx(Ze.div,{role:"group","aria-labelledby":s,...n,ref:t})})});kD.displayName=kS;var bS="SelectLabel",bD=T.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=SD(bS,r);return l.jsx(Ze.div,{id:s.id,...n,ref:t})});bD.displayName=bS;var nd="SelectItem",[ED,ES]=xl(nd),TS=T.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:a,...i}=e,o=Ja(nd,r),c=Qa(nd,r),u=o.value===n,[f,d]=T.useState(a??""),[h,p]=T.useState(!1),x=Ct(t,w=>c.itemRefCallback?.(w,n,s)),m=Ys(),v=T.useRef("touch"),g=()=>{s||(o.onValueChange(n),o.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return l.jsx(ED,{scope:r,value:n,disabled:s,textId:m,isSelected:u,onItemTextChange:T.useCallback(w=>{d(y=>y||(w?.textContent??"").trim())},[]),children:l.jsx(Wd.ItemSlot,{scope:r,value:n,disabled:s,textValue:f,children:l.jsx(Ze.div,{role:"option","aria-labelledby":m,"data-highlighted":h?"":void 0,"aria-selected":u&&h,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...i,ref:x,onFocus:nt(i.onFocus,()=>p(!0)),onBlur:nt(i.onBlur,()=>p(!1)),onClick:nt(i.onClick,()=>{v.current!=="mouse"&&g()}),onPointerUp:nt(i.onPointerUp,()=>{v.current==="mouse"&&g()}),onPointerDown:nt(i.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:nt(i.onPointerMove,w=>{v.current=w.pointerType,s?c.onItemLeave?.():v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:nt(i.onPointerLeave,w=>{w.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:nt(i.onKeyDown,w=>{c.searchRef?.current!==""&&w.key===" "||(cD.includes(w.key)&&g(),w.key===" "&&w.preventDefault())})})})})});TS.displayName=nd;var Vl="SelectItemText",CS=T.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,...a}=e,i=Ja(Vl,r),o=Qa(Vl,r),c=ES(Vl,r),u=hD(Vl,r),[f,d]=T.useState(null),h=Ct(t,g=>d(g),c.onItemTextChange,g=>o.itemTextRefCallback?.(g,c.value,c.disabled)),p=f?.textContent,x=T.useMemo(()=>l.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:m,onNativeOptionRemove:v}=u;return Ir(()=>(m(x),()=>v(x)),[m,v,x]),l.jsxs(l.Fragment,{children:[l.jsx(Ze.span,{id:c.textId,...a,ref:h}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?dl.createPortal(a.children,i.valueNode):null]})});CS.displayName=Vl;var NS="SelectItemIndicator",AS=T.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return ES(NS,r).isSelected?l.jsx(Ze.span,{"aria-hidden":!0,...n,ref:t}):null});AS.displayName=NS;var Np="SelectScrollUpButton",jS=T.forwardRef((e,t)=>{const r=Qa(Np,e.__scopeSelect),n=fx(Np,e.__scopeSelect),[s,a]=T.useState(!1),i=Ct(t,n.onScrollButtonChange);return Ir(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=c.scrollTop>0;a(u)};const c=r.viewport;return o(),c.addEventListener("scroll",o),()=>c.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),s?l.jsx(FS,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:c}=r;o&&c&&(o.scrollTop=o.scrollTop-c.offsetHeight)}}):null});jS.displayName=Np;var Ap="SelectScrollDownButton",DS=T.forwardRef((e,t)=>{const r=Qa(Ap,e.__scopeSelect),n=fx(Ap,e.__scopeSelect),[s,a]=T.useState(!1),i=Ct(t,n.onScrollButtonChange);return Ir(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=c.scrollHeight-c.clientHeight,f=Math.ceil(c.scrollTop)<u;a(f)};const c=r.viewport;return o(),c.addEventListener("scroll",o),()=>c.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),s?l.jsx(FS,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:c}=r;o&&c&&(o.scrollTop=o.scrollTop+c.offsetHeight)}}):null});DS.displayName=Ap;var FS=T.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=e,a=Qa("SelectScrollButton",r),i=T.useRef(null),o=Vd(r),c=T.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return T.useEffect(()=>()=>c(),[c]),Ir(()=>{o().find(f=>f.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[o]),l.jsx(Ze.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:nt(s.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(n,50))}),onPointerMove:nt(s.onPointerMove,()=>{a.onItemLeave?.(),i.current===null&&(i.current=window.setInterval(n,50))}),onPointerLeave:nt(s.onPointerLeave,()=>{c()})})}),TD="SelectSeparator",CD=T.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return l.jsx(Ze.div,{"aria-hidden":!0,...n,ref:t})});CD.displayName=TD;var jp="SelectArrow",ND=T.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=Hd(r),a=Ja(jp,r),i=Qa(jp,r);return a.open&&i.position==="popper"?l.jsx(y3,{...s,...n,ref:t}):null});ND.displayName=jp;var AD="SelectBubbleInput",RS=T.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const s=T.useRef(null),a=Ct(n,s),i=eS(t);return T.useEffect(()=>{const o=s.current;if(!o)return;const c=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==t&&f){const d=new Event("change",{bubbles:!0});f.call(o,t),o.dispatchEvent(d)}},[i,t]),l.jsx(Ze.select,{...r,style:{...tS,...r.style},ref:a,defaultValue:t})});RS.displayName=AD;function PS(e){return e===""||e===void 0}function IS(e){const t=$a(e),r=T.useRef(""),n=T.useRef(0),s=T.useCallback(i=>{const o=r.current+i;t(o),function c(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(o)},[t]),a=T.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return T.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,a]}function OS(e,t,r){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,a=r?e.indexOf(r):-1;let i=jD(e,Math.max(a,0));s.length===1&&(i=i.filter(u=>u!==r));const c=i.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function jD(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var DD=fS,FD=hS,RD=mS,PD=xS,ID=gS,OD=vS,LD=SS,MD=TS,BD=CS,UD=AS,$D=jS,zD=DS;/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WD=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),VD=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),i1=e=>{const t=VD(e);return t.charAt(0).toUpperCase()+t.slice(1)},LS=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var HD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=T.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},c)=>T.createElement("svg",{ref:c,...HD,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:LS("lucide",s),...o},[...i.map(([u,f])=>T.createElement(u,f)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=(e,t)=>{const r=T.forwardRef(({className:n,...s},a)=>T.createElement(GD,{ref:a,iconNode:t,className:LS(`lucide-${WD(i1(e))}`,`lucide-${e}`,n),...s}));return r.displayName=i1(e),r};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XD=[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]],dx=Le("bug",XD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KD=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],qD=Le("building-2",KD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YD=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],Ts=Le("calculator",YD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JD=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Fo=Le("chart-column",JD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QD=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],hx=Le("check",QD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZD=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],px=Le("chevron-down",ZD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],MS=Le("chevron-up",eF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],aa=Le("circle-alert",tF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Vn=Le("circle-check-big",rF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],sc=Le("circle-check",nF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],aF=Le("circle-user",sF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],oF=Le("clock",iF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Cf=Le("copy",lF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Ri=Le("database",cF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],La=Le("download",uF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],J0=Le("external-link",fF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dF=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],hF=Le("eye-off",dF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],mF=Le("eye",pF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],gF=Le("file-spreadsheet",xF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],nl=Le("file-text",vF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 13v-1h6v1",key:"1bb014"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M11 18h2",key:"12mj7e"}]],wF=Le("file-type",yF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],sl=Le("file",_F);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],BS=Le("folder-open",SF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],bF=Le("globe",kF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ic=Le("info",EF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Q0=Le("loader-circle",TF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]],o1=Le("log-in",CF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],AF=Le("log-out",NF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],l1=Le("mail",jF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],FF=Le("package",DF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],PF=Le("pen-line",RF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],c1=Le("phone",IF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],US=Le("play",OF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Oc=Le("plus",LF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],dr=Le("refresh-cw",MF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Z0=Le("rocket",BF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],$S=Le("save",UF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],zF=Le("search",$F);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],VF=Le("server",WF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HF=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],GF=Le("settings-2",HF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],KF=Le("settings",XF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qF=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],zS=Le("shield",qF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],JF=Le("square-pen",YF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ZF=Le("target",QF);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],uu=Le("trash-2",eR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],WS=Le("trending-up",tR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ds=Le("triangle-alert",rR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Fs=Le("upload",nR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Ma=Le("users",sR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],sd=Le("x",aR);function Xt({...e}){return l.jsx(DD,{"data-slot":"select",...e})}function Kt({...e}){return l.jsx(RD,{"data-slot":"select-value",...e})}function qt({className:e,size:t="default",children:r,...n}){return l.jsxs(FD,{"data-slot":"select-trigger","data-size":t,className:tt("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...n,children:[r,l.jsx(PD,{asChild:!0,children:l.jsx(px,{className:"size-4 opacity-50"})})]})}function Yt({className:e,children:t,position:r="popper",...n}){return l.jsx(ID,{children:l.jsxs(OD,{"data-slot":"select-content",className:tt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[l.jsx(iR,{}),l.jsx(LD,{className:tt("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),l.jsx(oR,{})]})})}function Je({className:e,children:t,...r}){return l.jsxs(MD,{"data-slot":"select-item",className:tt("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...r,children:[l.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:l.jsx(UD,{children:l.jsx(hx,{className:"size-4"})})}),l.jsx(BD,{children:t})]})}function iR({className:e,...t}){return l.jsx($D,{"data-slot":"select-scroll-up-button",className:tt("flex cursor-default items-center justify-center py-1",e),...t,children:l.jsx(MS,{className:"size-4"})})}function oR({className:e,...t}){return l.jsx(zD,{"data-slot":"select-scroll-down-button",className:tt("flex cursor-default items-center justify-center py-1",e),...t,children:l.jsx(px,{className:"size-4"})})}const lR=qm("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function pt({className:e,variant:t,asChild:r=!1,...n}){const s=r?o_:"span";return l.jsx(s,{"data-slot":"badge",className:tt(lR({variant:t}),e),...n})}function Lc({className:e,...t}){return l.jsx("textarea",{"data-slot":"textarea",className:tt("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const $e="baabzbunxucblvtojbfj",Fr="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJhYWJ6YnVueHVjYmx2dG9qYmZqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU5NjkyNDAsImV4cCI6MjA3MTU0NTI0MH0.4Cr44RQtGzBfs4QlyqXHd3ogvrsN2YULMQdAdygnfx4",cR=()=>(console.log(" Using Supabase Edge Functions URL"),`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43`),xi=cR(),uR="modulepreload",fR=function(e){return"/"+e},u1={},gl=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=i?.nonce||i?.getAttribute("nonce");s=Promise.allSettled(r.map(c=>{if(c=fR(c),c in u1)return;u1[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":uR,u||(d.as="script"),d.crossOrigin="",d.href=c,o&&d.setAttribute("nonce",o),document.head.appendChild(d),u)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})},dR=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>gl(async()=>{const{default:n}=await Promise.resolve().then(()=>vl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class mx extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class hR extends mx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class f1 extends mx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class d1 extends mx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Dp;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Dp||(Dp={}));var pR=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class mR{constructor(t,{headers:r={},customFetch:n,region:s=Dp.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=dR(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return pR(this,void 0,void 0,function*(){try{const{headers:s,method:a,body:i}=r;let o={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(o["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let f;i&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",f=i):typeof i=="string"?(o["Content-Type"]="text/plain",f=i):typeof FormData<"u"&&i instanceof FormData?f=i:(o["Content-Type"]="application/json",f=JSON.stringify(i)));const d=yield this.fetch(u.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:f}).catch(m=>{throw new hR(m)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new f1(d);if(!d.ok)throw new d1(d);let p=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return p==="application/json"?x=yield d.json():p==="application/octet-stream"?x=yield d.blob():p==="text/event-stream"?x=d:p==="multipart/form-data"?x=yield d.formData():x=yield d.text(),{data:x,error:null,response:d}}catch(s){return{data:null,error:s,response:s instanceof d1||s instanceof f1?s.context:void 0}}})}}var dn={},xx={},Gd={},fu={},Xd={},Kd={},xR=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},al=xR();const gR=al.fetch,VS=al.fetch.bind(al),HS=al.Headers,vR=al.Request,yR=al.Response,vl=Object.freeze(Object.defineProperty({__proto__:null,Headers:HS,Request:vR,Response:yR,default:VS,fetch:gR},Symbol.toStringTag,{value:"Module"})),wR=wT(vl);var qd={};Object.defineProperty(qd,"__esModule",{value:!0});let _R=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};qd.default=_R;var GS=Gn&&Gn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Kd,"__esModule",{value:!0});const SR=GS(wR),kR=GS(qd);let bR=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=SR.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var i,o,c,u;let f=null,d=null,h=null,p=a.status,x=a.statusText;if(a.ok){if(this.method!=="HEAD"){const w=await a.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?d=w:d=JSON.parse(w))}const v=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),g=(c=a.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");v&&g&&g.length>1&&(h=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(f={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,p=406,x="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const v=await a.text();try{f=JSON.parse(v),Array.isArray(f)&&a.status===404&&(d=[],f=null,p=200,x="OK")}catch{a.status===404&&v===""?(p=204,x="No Content"):f={message:v}}if(f&&this.isMaybeSingle&&(!((u=f?.details)===null||u===void 0)&&u.includes("0 rows"))&&(f=null,p=200,x="OK"),f&&this.shouldThrowOnError)throw new kR.default(f)}return{error:f,data:d,count:h,status:p,statusText:x}});return this.shouldThrowOnError||(s=s.catch(a=>{var i,o,c;return{error:{message:`${(i=a?.name)!==null&&i!==void 0?i:"FetchError"}: ${a?.message}`,details:`${(o=a?.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=a?.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};Kd.default=bR;var ER=Gn&&Gn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xd,"__esModule",{value:!0});const TR=ER(Kd);let CR=class extends TR.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:a=s}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const a=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:a=!1,format:i="text"}={}){var o;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${u}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Xd.default=CR;var NR=Gn&&Gn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fu,"__esModule",{value:!0});const AR=NR(Xd);let jR=class extends AR.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${a}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};fu.default=jR;var DR=Gn&&Gn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gd,"__esModule",{value:!0});const Ml=DR(fu);let FR=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let a=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),n&&this.headers.append("Prefer",`count=${n}`),new Ml.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var s;const a="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(i.length>0){const o=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new Ml.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:a=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(c.length>0){const u=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new Ml.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Ml.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Ml.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Gd.default=FR;var XS=Gn&&Gn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xx,"__esModule",{value:!0});const RR=XS(Gd),PR=XS(fu);let IR=class KS{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new RR.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new KS(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:a}={}){var i;let o;const c=new URL(`${this.url}/rpc/${t}`);let u;n||s?(o=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{c.searchParams.append(d,h)})):(o="POST",u=r);const f=new Headers(this.headers);return a&&f.set("Prefer",`count=${a}`),new PR.default({method:o,url:c,headers:f,schema:this.schemaName,body:u,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};xx.default=IR;var yl=Gn&&Gn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dn,"__esModule",{value:!0});dn.PostgrestError=dn.PostgrestBuilder=dn.PostgrestTransformBuilder=dn.PostgrestFilterBuilder=dn.PostgrestQueryBuilder=dn.PostgrestClient=void 0;const qS=yl(xx);dn.PostgrestClient=qS.default;const YS=yl(Gd);dn.PostgrestQueryBuilder=YS.default;const JS=yl(fu);dn.PostgrestFilterBuilder=JS.default;const QS=yl(Xd);dn.PostgrestTransformBuilder=QS.default;const ZS=yl(Kd);dn.PostgrestBuilder=ZS.default;const ek=yl(qd);dn.PostgrestError=ek.default;var OR=dn.default={PostgrestClient:qS.default,PostgrestQueryBuilder:YS.default,PostgrestFilterBuilder:JS.default,PostgrestTransformBuilder:QS.default,PostgrestBuilder:ZS.default,PostgrestError:ek.default};const{PostgrestClient:LR,PostgrestQueryBuilder:jV,PostgrestFilterBuilder:DV,PostgrestTransformBuilder:FV,PostgrestBuilder:RV,PostgrestError:PV}=OR;class MR{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const BR="2.15.4",UR=`realtime-js/${BR}`,$R="1.0.0",Fp=1e4,zR=1e3,WR=100;var ac;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ac||(ac={}));var mr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(mr||(mr={}));var ss;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(ss||(ss={}));var Rp;(function(e){e.websocket="websocket"})(Rp||(Rp={}));var ui;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ui||(ui={}));class VR{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),a=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+s));i=i+s;const c=n.decode(t.slice(i,i+a));i=i+a;const u=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:c,payload:u}}}class tk{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Nt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Nt||(Nt={}));const h1=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((a,i)=>(a[i]=HR(i,e,t,s),a),{})},HR=(e,t,r,n)=>{const s=t.find(o=>o.name===e),a=s?.type,i=r[e];return a&&!n.includes(a)?rk(a,i):Pp(i)},rk=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return qR(t,r)}switch(e){case Nt.bool:return GR(t);case Nt.float4:case Nt.float8:case Nt.int2:case Nt.int4:case Nt.int8:case Nt.numeric:case Nt.oid:return XR(t);case Nt.json:case Nt.jsonb:return KR(t);case Nt.timestamp:return YR(t);case Nt.abstime:case Nt.date:case Nt.daterange:case Nt.int4range:case Nt.int8range:case Nt.money:case Nt.reltime:case Nt.text:case Nt.time:case Nt.timestamptz:case Nt.timetz:case Nt.tsrange:case Nt.tstzrange:return Pp(t);default:return Pp(t)}},Pp=e=>e,GR=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},XR=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},KR=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},qR=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const i=e.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>rk(t,o))}return e},YR=e=>typeof e=="string"?e.replace(" ","T"):e,nk=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class eh{constructor(t,r,n={},s=Fp){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var p1;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(p1||(p1={}));class ic{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ic.syncState(this.state,s,a,i),this.pendingDiffs.forEach(c=>{this.state=ic.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ic.syncDiff(this.state,s,a,i),o())}),this.onJoin((s,a,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:i})}),this.onLeave((s,a,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const a=this.cloneDeep(t),i=this.transformState(r),o={},c={};return this.map(a,(u,f)=>{i[u]||(c[u]=f)}),this.map(i,(u,f)=>{const d=a[u];if(d){const h=f.map(v=>v.presence_ref),p=d.map(v=>v.presence_ref),x=f.filter(v=>p.indexOf(v.presence_ref)<0),m=d.filter(v=>h.indexOf(v.presence_ref)<0);x.length>0&&(o[u]=x),m.length>0&&(c[u]=m)}else o[u]=f}),this.syncDiff(a,{joins:o,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(o,c)=>{var u;const f=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(c),f.length>0){const d=t[o].map(p=>p.presence_ref),h=f.filter(p=>d.indexOf(p.presence_ref)<0);t[o].unshift(...h)}n(o,f,c)}),this.map(i,(o,c)=>{let u=t[o];if(!u)return;const f=c.map(d=>d.presence_ref);u=u.filter(d=>f.indexOf(d.presence_ref)<0),t[o]=u,s(o,u,c),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var m1;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(m1||(m1={}));var oc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(oc||(oc={}));var Vs;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Vs||(Vs={}));class gx{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=mr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new eh(this,ss.join,this.params,this.timeout),this.rejoinTimer=new tk(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=mr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=mr.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=mr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=mr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=mr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ss.reply,{},(s,a)=>{this._trigger(this._replyEventName(a),s)}),this.presence=new ic(this),this.broadcastEndpointURL=nk(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==mr.closed){const{config:{broadcast:i,presence:o,private:c}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&s!==void 0?s:[],f=!!this.bindings[oc.PRESENCE]&&this.bindings[oc.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,d={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:f}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(p=>t?.(Vs.CHANNEL_ERROR,p)),this._onClose(()=>t?.(Vs.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var x;if(this.socket.setAuth(),p===void 0){t?.(Vs.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,v=(x=m?.length)!==null&&x!==void 0?x:0,g=[];for(let w=0;w<v;w++){const y=m[w],{filter:{event:k,schema:E,table:S,filter:_}}=y,A=p&&p[w];if(A&&A.event===k&&A.schema===E&&A.table===S&&A.filter===_)g.push(Object.assign(Object.assign({},y),{id:A.id}));else{this.unsubscribe(),this.state=mr.errored,t?.(Vs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Vs.SUBSCRIBED);return}}).receive("error",p=>{this.state=mr.errored,t?.(Vs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t?.(Vs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===mr.joined&&t===oc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=mr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ss.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new eh(this,ss.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=mr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new eh(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>WR){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,a;const i=t.toLocaleLowerCase(),{close:o,error:c,leave:u,join:f}=ss;if(n&&[o,c,u,f].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var x,m,v;return((x=p.filter)===null||x===void 0?void 0:x.event)==="*"||((v=(m=p.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===i}).map(p=>p.callback(h,n)):(a=this.bindings[i])===null||a===void 0||a.filter(p=>{var x,m,v,g,w,y;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const k=p.id,E=(x=p.filter)===null||x===void 0?void 0:x.event;return k&&((m=r.ids)===null||m===void 0?void 0:m.includes(k))&&(E==="*"||E?.toLocaleLowerCase()===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const k=(w=(g=p?.filter)===null||g===void 0?void 0:g.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return k==="*"||k===((y=r?.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:m,table:v,commit_timestamp:g,type:w,errors:y}=x;h=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:g,eventType:w,new:{},old:{},errors:y}),this._getPayloadRecords(x))}p.callback(h,n)})}_isClosed(){return this.state===mr.closed}_isJoined(){return this.state===mr.joined}_isJoining(){return this.state===mr.joining}_isLeaving(){return this.state===mr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&gx.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ss.close,{},t)}_onError(t){this._on(ss.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=mr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=h1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=h1(t.columns,t.old_record)),r}}const th=()=>{},Ju={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},JR=[1e3,2e3,5e3,1e4],QR=1e4,ZR=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class eP{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Fp,this.transport=null,this.heartbeatIntervalMs=Ju.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=th,this.ref=0,this.reconnectTimer=null,this.logger=th,this.conn=null,this.sendBuffer=[],this.serializer=new VR,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...i)=>gl(async()=>{const{default:o}=await Promise.resolve().then(()=>vl);return{default:o}},void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...i)=>a(...i)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Rp.websocket}`,this.httpEndpoint=nk(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=MR.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:$R}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ac.connecting:return ui.Connecting;case ac.open:return ui.Open;case ac.closing:return ui.Closing;default:return ui.Closed}}isConnected(){return this.connectionState()===ui.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new gx(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:s,ref:a}=t,i=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(zR,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Ju.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:i}=r,o=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${n} ${s} ${o}`.trim(),a),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ss.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([ZR],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:UR};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(ss.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new tk(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ju.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,a,i,o,c,u,f;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Fp,this.heartbeatIntervalMs=(s=t?.heartbeatIntervalMs)!==null&&s!==void 0?s:Ju.HEARTBEAT_INTERVAL,this.worker=(a=t?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=t?.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t?.heartbeatCallback)!==null&&o!==void 0?o:th,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:d=>JR[d-1]||QR,this.encode=(u=t?.encode)!==null&&u!==void 0?u:(d,h)=>h(JSON.stringify(d)),this.decode=(f=t?.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class vx extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function xr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class tP extends vx{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ip extends vx{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var rP=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const sk=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>gl(async()=>{const{default:n}=await Promise.resolve().then(()=>vl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},nP=()=>rP(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield gl(()=>Promise.resolve().then(()=>vl),void 0)).Response:Response}),Op=e=>{if(Array.isArray(e))return e.map(r=>Op(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=Op(n)}),t},sP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Xi=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const rh=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),aP=(e,t,r)=>Xi(void 0,void 0,void 0,function*(){const n=yield nP();e instanceof n&&!r?.noResolveJson?e.json().then(s=>{const a=e.status||500,i=s?.statusCode||a+"";t(new tP(rh(s),a,i))}).catch(s=>{t(new Ip(rh(s),s))}):t(new Ip(rh(e),e))}),iP=(e,t,r,n)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"||!n?s:(sP(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(n)):s.body=n,t?.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function du(e,t,r,n,s,a){return Xi(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,iP(t,n,s,a)).then(c=>{if(!c.ok)throw c;return n?.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>aP(c,o,n))})})}function ad(e,t,r,n){return Xi(this,void 0,void 0,function*(){return du(e,"GET",t,r,n)})}function Ss(e,t,r,n,s){return Xi(this,void 0,void 0,function*(){return du(e,"POST",t,n,s,r)})}function Lp(e,t,r,n,s){return Xi(this,void 0,void 0,function*(){return du(e,"PUT",t,n,s,r)})}function oP(e,t,r,n){return Xi(this,void 0,void 0,function*(){return du(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function ak(e,t,r,n,s){return Xi(this,void 0,void 0,function*(){return du(e,"DELETE",t,n,s,r)})}var Qr=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const lP={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},x1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class cP{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=sk(s)}uploadOrUpdate(t,r,n,s){return Qr(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},x1),s);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s?.headers&&(o=Object.assign(Object.assign({},o),s.headers));const u=this._removeEmptyFolders(r),f=this._getFinalPath(u),d=yield(t=="PUT"?Lp:Ss)(this.fetch,`${this.url}/object/${f}`,a,Object.assign({headers:o},i?.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(a){if(xr(a))return{data:null,error:a};throw a}})}upload(t,r,n){return Qr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Qr(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:x1.upsert},s),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType);const d=yield Lp(this.fetch,o.toString(),c,{headers:f});return{data:{path:a,fullPath:d.Key},error:null}}catch(c){if(xr(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Qr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r?.upsert&&(s["x-upsert"]="true");const a=yield Ss(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new vx("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(xr(n))return{data:null,error:n};throw n}})}update(t,r,n){return Qr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Qr(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(xr(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Qr(this,void 0,void 0,function*(){try{return{data:{path:(yield Ss(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(xr(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Qr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),a=yield Ss(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(s){if(xr(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Qr(this,void 0,void 0,function*(){try{const s=yield Ss(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(s){if(xr(s))return{data:null,error:s};throw s}})}download(t,r){return Qr(this,void 0,void 0,function*(){const s=typeof r?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(r?.transform||{}),i=a?`?${a}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield ad(this.fetch,`${this.url}/${s}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(xr(o))return{data:null,error:o};throw o}})}info(t){return Qr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield ad(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Op(n),error:null}}catch(n){if(xr(n))return{data:null,error:n};throw n}})}exists(t){return Qr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield oP(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(xr(n)&&n instanceof Ip){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],a=r?.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&s.push(a);const o=typeof r?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(r?.transform||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${u}`)}}}remove(t){return Qr(this,void 0,void 0,function*(){try{return{data:yield ak(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(xr(r))return{data:null,error:r};throw r}})}list(t,r,n){return Qr(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},lP),r),{prefix:t||""});return{data:yield Ss(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(xr(s))return{data:null,error:s};throw s}})}listV2(t,r){return Qr(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Ss(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(xr(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const uP="2.11.0",fP={"X-Client-Info":`storage-js/${uP}`};var lo=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class dP{constructor(t,r={},n,s){const a=new URL(t);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},fP),r),this.fetch=sk(n)}listBuckets(){return lo(this,void 0,void 0,function*(){try{return{data:yield ad(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(xr(t))return{data:null,error:t};throw t}})}getBucket(t){return lo(this,void 0,void 0,function*(){try{return{data:yield ad(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(xr(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return lo(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(xr(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return lo(this,void 0,void 0,function*(){try{return{data:yield Lp(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(xr(n))return{data:null,error:n};throw n}})}emptyBucket(t){return lo(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(xr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return lo(this,void 0,void 0,function*(){try{return{data:yield ak(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(xr(r))return{data:null,error:r};throw r}})}}class hP extends dP{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new cP(this.url,this.headers,t,this.fetch)}}const pP="2.56.1";let Hl="";typeof Deno<"u"?Hl="deno":typeof document<"u"?Hl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Hl="react-native":Hl="node";const mP={"X-Client-Info":`supabase-js-${Hl}/${pP}`},xP={headers:mP},gP={schema:"public"},vP={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},yP={};var wP=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const _P=e=>{let t;return e?t=e:typeof fetch>"u"?t=VS:t=fetch,(...r)=>t(...r)},SP=()=>typeof Headers>"u"?HS:Headers,kP=(e,t,r)=>{const n=_P(r),s=SP();return(a,i)=>wP(void 0,void 0,void 0,function*(){var o;const c=(o=yield t())!==null&&o!==void 0?o:e;let u=new s(i?.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(a,Object.assign(Object.assign({},i),{headers:u}))})};var bP=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};function EP(e){return e.endsWith("/")?e:e+"/"}function TP(e,t){var r,n;const{db:s,auth:a,realtime:i,global:o}=e,{db:c,auth:u,realtime:f,global:d}=t,h={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},f),i),storage:{},global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},(r=d?.headers)!==null&&r!==void 0?r:{}),(n=o?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>bP(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const ik="2.71.1",go=30*1e3,Mp=3,nh=Mp*go,CP="http://localhost:9999",NP="supabase.auth.token",AP={"X-Client-Info":`gotrue-js/${ik}`},Bp="X-Supabase-Api-Version",ok={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},jP=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,DP=10*60*1e3;class yx extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Xe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class FP extends yx{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function RP(e){return Xe(e)&&e.name==="AuthApiError"}class lk extends yx{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Za extends yx{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class ga extends Za{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function PP(e){return Xe(e)&&e.name==="AuthSessionMissingError"}class Qu extends Za{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Zu extends Za{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ef extends Za{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function IP(e){return Xe(e)&&e.name==="AuthImplicitGrantRedirectError"}class g1 extends Za{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Up extends Za{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function sh(e){return Xe(e)&&e.name==="AuthRetryableFetchError"}class v1 extends Za{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class $p extends Za{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const id="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),y1=` 	
\r=`.split(""),OP=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<y1.length;t+=1)e[y1[t].charCodeAt(0)]=-2;for(let t=0;t<id.length;t+=1)e[id[t].charCodeAt(0)]=t;return e})();function w1(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(id[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(id[n]),t.queuedBits-=6}}function ck(e,t,r){const n=OP[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function _1(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=i=>{BP(i,n,r)};for(let i=0;i<e.length;i+=1)ck(e.charCodeAt(i),s,a);return t.join("")}function LP(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function MP(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}LP(n,t)}}function BP(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function UP(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)ck(e.charCodeAt(s),r,n);return new Uint8Array(t)}function $P(e){const t=[];return MP(e,r=>t.push(r)),new Uint8Array(t)}function zP(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>w1(s,r,n)),w1(null,r,n),t.join("")}function WP(e){return Math.round(Date.now()/1e3)+e}function VP(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const es=()=>typeof window<"u"&&typeof document<"u",ai={tested:!1,writable:!1},uk=()=>{if(!es())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ai.tested)return ai.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ai.tested=!0,ai.writable=!0}catch{ai.tested=!0,ai.writable=!1}return ai.writable};function HP(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const fk=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>gl(async()=>{const{default:n}=await Promise.resolve().then(()=>vl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},GP=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",vo=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ii=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},pa=async(e,t)=>{await e.removeItem(t)};class Yd{constructor(){this.promise=new Yd.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Yd.promiseConstructor=Promise;function ah(e){const t=e.split(".");if(t.length!==3)throw new $p("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!jP.test(t[n]))throw new $p("JWT not in base64url format");return{header:JSON.parse(_1(t[0])),payload:JSON.parse(_1(t[1])),signature:UP(t[2]),raw:{header:t[0],payload:t[1]}}}async function XP(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function KP(e,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await e(a);if(!t(a,null,i)){n(i);return}}catch(i){if(!t(a,i)){s(i);return}}})()})}function qP(e){return("0"+e.toString(16)).substr(-2)}function YP(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,qP).join("")}async function JP(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function QP(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await JP(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function co(e,t,r=!1){const n=YP();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await vo(e,`${t}-code-verifier`,s);const a=await QP(n);return[a,n===a?"plain":"s256"]}const ZP=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function eI(e){const t=e.headers.get(Bp);if(!t||!t.match(ZP))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function tI(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function rI(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const nI=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function uo(e){if(!nI.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ih(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function S1(e){return JSON.parse(JSON.stringify(e))}var sI=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const ci=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),aI=[502,503,504];async function k1(e){var t;if(!GP(e))throw new Up(ci(e),0);if(aI.includes(e.status))throw new Up(ci(e),e.status);let r;try{r=await e.json()}catch(a){throw new lk(ci(a),a)}let n;const s=eI(e);if(s&&s.getTime()>=ok["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new v1(ci(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ga}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new v1(ci(r),e.status,r.weak_password.reasons);throw new FP(ci(r),e.status||500,n)}const iI=(e,t,r,n)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function rt(e,t,r,n){var s;const a=Object.assign({},n?.headers);a[Bp]||(a[Bp]=ok["2024-01-01"].name),n?.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const i=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await oI(e,t,r+o,{headers:a,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(c):{data:Object.assign({},c),error:null}}async function oI(e,t,r,n,s,a){const i=iI(t,n,s,a);let o;try{o=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new Up(ci(c),0)}if(o.ok||await k1(o),n?.noResolveJson)return o;try{return await o.json()}catch(c){await k1(c)}}function zs(e){var t;let r=null;fI(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=WP(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function b1(e){const t=zs(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Sa(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function lI(e){return{data:e,error:null}}function cI(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e,i=sI(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function uI(e){return e}function fI(e){return e.access_token&&e.refresh_token&&e.expires_in}const oh=["global","local","others"];var dI=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class hI{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=fk(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=oh[0]){if(oh.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${oh.join(", ")}`);try{return await rt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Xe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await rt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Sa})}catch(n){if(Xe(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=dI(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await rt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:cI,redirectTo:r?.redirectTo})}catch(r){if(Xe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await rt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Sa})}catch(r){if(Xe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,a,i,o,c;try{const u={nextPage:null,lastPage:0,total:0},f=await rt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:uI});if(f.error)throw f.error;const d=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(x=>{const m=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(x.split(";")[1].split("=")[1]);u[`${v}Page`]=m}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(Xe(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){uo(t);try{return await rt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Sa})}catch(r){if(Xe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){uo(t);try{return await rt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Sa})}catch(n){if(Xe(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){uo(t);try{return await rt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Sa})}catch(n){if(Xe(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){uo(t.userId);try{const{data:r,error:n}=await rt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Xe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){uo(t.userId),uo(t.id);try{return{data:await rt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Xe(r))return{data:null,error:r};throw r}}}function E1(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function pI(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const fo={debug:!!(globalThis&&uk()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class dk extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class mI extends dk{}async function xI(e,t,r){fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),fo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw fo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new mI(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(fo.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}pI();const gI={url:CP,storageKey:NP,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:AP,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function T1(e,t,r){return await r()}const ho={};class Mc{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Mc.nextInstanceID,Mc.nextInstanceID+=1,this.instanceID>0&&es()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},gI),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new hI({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=fk(s.fetch),this.lock=s.lock||T1,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:es()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=xI:this.lock=T1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:uk()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=E1(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=E1(this.memoryStorage)),es()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=ho[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){ho[this.storageKey]=Object.assign(Object.assign({},ho[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=ho[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ho[this.storageKey]=Object.assign(Object.assign({},ho[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ik}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=HP(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),es()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),IP(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Xe(r)?{error:r}:{error:new lk("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const a=await rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t?.options)===null||s===void 0?void 0:s.captchaToken}},xform:zs}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(Xe(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var r,n,s;try{let a;if("email"in t){const{email:f,password:d,options:h}=t;let p=null,x=null;this.flowType==="pkce"&&([p,x]=await co(this.storage,this.storageKey)),a=await rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h?.emailRedirectTo,body:{email:f,password:d,data:(r=h?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:p,code_challenge_method:x},xform:zs})}else if("phone"in t){const{phone:f,password:d,options:h}=t;a=await rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=h?.data)!==null&&n!==void 0?n:{},channel:(s=h?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:zs})}else throw new Zu("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(Xe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:i,options:o}=t;r=await rt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:b1})}else if("phone"in t){const{phone:a,password:i,options:o}=t;r=await rt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:b1})}else throw new Zu("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Qu}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Xe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,s,a,i,o,c,u,f,d,h,p;let x,m;if("message"in t)x=t.message,m=t.signature;else{const{chain:v,wallet:g,statement:w,options:y}=t;let k;if(es())if(typeof g=="object")k=g;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))k=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!y?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=g}const E=new URL((r=y?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in k&&k.signIn){const S=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y?.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),w?{statement:w}:null));let _;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")_=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)_=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)x=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),m=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${E.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(s=(n=y?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=y?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((i=y?.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y?.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((u=y?.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((d=(f=y?.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||d===void 0)&&d.length?["Resources",...y.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const S=await k.signMessage(new TextEncoder().encode(x),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=S}}try{const{data:v,error:g}=await rt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:zP(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:zs});if(g)throw g;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new Qu}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:g})}catch(v){if(Xe(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(t){const r=await ii(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:a,error:i}=await rt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:zs});if(await pa(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Qu}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:i})}catch(a){if(Xe(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:a,nonce:i}=t,o=await rt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:zs}),{data:c,error:u}=o;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Qu}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(Xe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,a,i;try{if("email"in t){const{email:o,options:c}=t;let u=null,f=null;this.flowType==="pkce"&&([u,f]=await co(this.storage,this.storageKey));const{error:d}=await rt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(n=c?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:u,code_challenge_method:f},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:o,options:c}=t,{data:u,error:f}=await rt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(a=c?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(i=c?.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u?.message_id},error:f}}throw new Zu("You must provide either an email or phone number.")}catch(o){if(Xe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let s,a;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await rt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:zs});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(Xe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await co(this.storage,this.storageKey)),await rt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:lI})}catch(a){if(Xe(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new ga;const{error:s}=await rt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Xe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:i}=await rt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:i,error:o}=await rt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return{data:{user:null,session:null,messageId:i?.message_id},error:o}}throw new Zu("You must provide either an email or phone number and a type")}catch(r){if(Xe(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ii(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<nh:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await ii(this.userStorage,this.storageKey+"-user");i?.user?t.user=i.user:t.user=ih()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,f)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,f))})}return{data:{session:t},error:null}}const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await rt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Sa}):await this._useSession(async r=>{var n,s,a;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ga}:await rt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Sa})})}catch(r){if(Xe(r))return PP(r)&&(await this._removeSession(),await pa(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new ga;const i=s.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await co(this.storage,this.storageKey));const{data:u,error:f}=await rt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:Sa});if(f)throw f;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Xe(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ga;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:i}=ah(t.access_token);if(i.exp&&(n=i.exp,s=n<=r),s){const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(Xe(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new ga;const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Xe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!es())throw new ef("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ef(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new g1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ef("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new g1("No code detected.");const{data:w,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:i,expires_in:o,expires_at:c,token_type:u}=t;if(!a||!o||!i||!u)throw new ef("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(o);let h=f+d;c&&(h=parseInt(c));const p=h-f;p*1e3<=go&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const x=h-d;f-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,f):f-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,f);const{data:m,error:v}=await this._getUser(a);if(v)throw v;const g={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:d,expires_at:h,refresh_token:i,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(n){if(Xe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ii(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{error:a};const i=(n=s.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(RP(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await pa(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=VP(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await co(this.storage,this.storageKey,!0));try{return await rt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(Xe(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Xe(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var i,o,c,u,f;const{data:d,error:h}=a;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await rt(this.fetch,"GET",p,{headers:this.headers,jwt:(f=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:void 0})});if(s)throw s;return es()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(Xe(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:i}=r;if(i)throw i;return await rt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Xe(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await KP(async s=>(s>0&&await XP(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await rt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:zs})),(s,a)=>{const i=200*Math.pow(2,s);return a&&sh(a)&&Date.now()+i-n<go})}catch(n){if(this._debug(r,"error",n),Xe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),es()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await ii(this.storage,this.storageKey);if(s&&this.userStorage){let i=await ii(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await vo(this.userStorage,this.storageKey+"-user",i)),s.user=(t=i?.user)!==null&&t!==void 0?t:ih()}else if(s&&!s.user&&!s.user){const i=await ii(this.storage,this.storageKey+"-user");i&&i?.user?(s.user=i.user,await pa(this.storage,this.storageKey+"-user"),await vo(this.storage,this.storageKey,s)):s.user=ih()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<nh;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${nh}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),sh(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(s.access_token);!o&&i?.user?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new ga;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Yd;const{data:a,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!a.session)throw new ga;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(s,"error",a),Xe(a)){const i={session:null,error:a};return sh(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await vo(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=S1(s);await vo(this.storage,this.storageKey,a)}else{const s=S1(r);await vo(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await pa(this.storage,this.storageKey),await pa(this.storage,this.storageKey+"-code-verifier"),await pa(this.storage,this.storageKey+"-user"),this.userStorage&&await pa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&es()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),go);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/go);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${go}ms, refresh threshold is ${Mp} ticks`),s<=Mp&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof dk)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!es()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,i]=await co(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(o.toString())}if(n?.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await rt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Xe(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await rt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Xe(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{data:null,error:a};const{data:i,error:o}=await rt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(Xe(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await rt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Xe(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=t?.factors||[],s=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),a=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:s,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:a}=t;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=ah(s.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const f=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+DP>s)return n;const{data:a,error:i}=await rt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:x}=await this.getSession();if(x||!p.session)return{data:null,error:x};n=p.session.access_token}const{header:s,payload:a,signature:i,raw:{header:o,payload:c}}=ah(n);r?.allowExpired||tI(a.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!u){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:a,header:s,signature:i},error:null}}const f=rI(s.alg),d=await crypto.subtle.importKey("jwk",u,f,!0,["verify"]);if(!await crypto.subtle.verify(f,d,i,$P(`${o}.${c}`)))throw new $p("Invalid JWT signature");return{data:{claims:a,header:s,signature:i},error:null}}catch(n){if(Xe(n))return{data:null,error:n};throw n}}}Mc.nextInstanceID=0;const vI=Mc;class yI extends vI{constructor(t){super(t)}}var wI=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class _I{constructor(t,r,n){var s,a,i;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=EP(t),c=new URL(o);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:gP,realtime:yP,auth:Object.assign(Object.assign({},vP),{storageKey:u}),global:xP},d=TP(n??{},f);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=kP(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new LR(new URL("rest/v1",c).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new hP(this.storageUrl.href,this.headers,this.fetch,n?.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new mR(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return wI(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:a,flowType:i,lock:o,debug:c},u,f){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new yI({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:a,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:i,lock:o,debug:c,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new eP(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const SI=(e,t,r)=>new _I(e,t,r);function kI(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}kI()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");class bI{supabase=SI(`https://${$e}.supabase.co`,Fr);async signUpWithEmail(t,r,n){try{const{data:s,error:a}=await this.supabase.auth.signUp({email:t,password:r,options:{data:{name:n||""}}});if(a)throw new Error(a.message);return{data:s,error:null}}catch(s){return console.error("Sign up error:",s),{data:null,error:s instanceof Error?s.message:"Sign up failed"}}}async signUpWithServerAutoConfirm(t,r,n){const s={email:t,password:r,name:n||""},a=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/auth/signup`;console.log("Making server signup request:",{url:a,method:"POST",body:{email:t,hasPassword:!!r,name:n}});try{const i=await this.makePublicRequest(a,{method:"POST",body:JSON.stringify(s)});console.log("Server signup response received:",{status:i.status,statusText:i.statusText,ok:i.ok,url:i.url,headers:Object.fromEntries(i.headers.entries())});const o=i.headers.get("content-type");if(!o||!o.includes("application/json")){const d=await i.text();throw console.error("Server returned non-JSON response:",{status:i.status,contentType:o,responseText:d.substring(0,500)}),i.status===404?new Error("Signup endpoint not found. The authentication service may not be deployed properly."):new Error(`Server returned ${o||"unknown"} instead of JSON. This usually means the Supabase Edge Function is not deployed or has an error.`)}let c;try{c=await i.json()}catch(d){throw console.error("Failed to parse server JSON response:",d),new Error("Server returned invalid JSON response.")}if(!i.ok)throw new Error(c.error||`Server error: HTTP ${i.status}`);if(!c.success)throw new Error(c.error||"Signup failed");const{data:u,error:f}=await this.signInWithEmail(t,r);if(f)throw new Error(`Account created but sign in failed: ${f}`);return{data:u,error:null,message:"Account created and signed in successfully"}}catch(i){return console.error("Server signup error:",i),{data:null,error:i instanceof Error?i.message:"Server signup failed"}}}async signInWithEmail(t,r){try{const{data:n,error:s}=await this.supabase.auth.signInWithPassword({email:t,password:r});if(s)throw new Error(s.message);return{data:n,error:null}}catch(n){return console.error("Sign in error:",n),{data:null,error:n instanceof Error?n.message:"Sign in failed"}}}async sendPhoneOTP(t){try{const{data:r,error:n}=await this.supabase.auth.signInWithOtp({phone:t,options:{channel:"sms"}});if(n){let s=n.message;throw n.message.toLowerCase().includes("unsupported phone provider")||n.message.toLowerCase().includes("phone provider not configured")||n.message.toLowerCase().includes("sms provider")?s="SMS authentication is not set up for this application. Please use email authentication instead or contact your administrator to configure an SMS provider (Twilio, MessageBird, etc.) in the Supabase Dashboard.":n.message.toLowerCase().includes("invalid phone number")||n.message.toLowerCase().includes("phone number")?s="Please enter a valid phone number with country code (e.g., +1234567890, +91987654321)":n.message.toLowerCase().includes("rate limit")||n.message.toLowerCase().includes("too many requests")?s="Too many OTP requests. Please wait a few minutes before trying again.":n.message.toLowerCase().includes("timeout")&&(s="SMS delivery timeout. Please try again or use email authentication."),new Error(s)}return{data:r,error:null}}catch(r){console.error("Phone OTP error:",r);const n=r instanceof Error?r.message:"Failed to send OTP";return n.toLowerCase().includes("network")||n.toLowerCase().includes("fetch")?{data:null,error:"Network error occurred while sending SMS. Please check your connection and try again."}:{data:null,error:n}}}async verifyPhoneOTP(t,r){try{const{data:n,error:s}=await this.supabase.auth.verifyOtp({phone:t,token:r,type:"sms"});if(s)throw new Error(s.message);return{data:n,error:null}}catch(n){return console.error("OTP verification error:",n),{data:null,error:n instanceof Error?n.message:"OTP verification failed"}}}async signOut(){try{const{error:t}=await this.supabase.auth.signOut();if(t)throw new Error(t.message);return{error:null}}catch(t){return console.error("Sign out error:",t),{error:t instanceof Error?t.message:"Sign out failed"}}}async getSession(){try{const{data:{session:t},error:r}=await this.supabase.auth.getSession();if(r)throw new Error(r.message);return{session:t,error:null}}catch(t){return console.error("Get session error:",t),{session:null,error:t instanceof Error?t.message:"Failed to get session"}}}async getCurrentUser(){try{const{data:{user:t},error:r}=await this.supabase.auth.getUser();if(r)throw new Error(r.message);return{user:t,error:null}}catch(t){return console.error("Get user error:",t),{user:null,error:t instanceof Error?t.message:"Failed to get user"}}}onAuthStateChange(t){return this.supabase.auth.onAuthStateChange(t)}async getAccessToken(){try{const{data:{session:t},error:r}=await this.supabase.auth.getSession();return r?(console.error("Error getting session for access token:",r),null):t?t.access_token?t.access_token===Fr?(console.error("Session access_token is the anon key - this should not happen"),null):(console.log("Access token retrieved successfully, length:",t.access_token.length),t.access_token):(console.warn("Session found but no access token available"),null):(console.warn("No active session found when getting access token"),null)}catch(t){return console.error("Get access token error:",t),null}}async refreshSession(){try{const{data:t,error:r}=await this.supabase.auth.refreshSession();return r?(console.error("Session refresh error:",r),{session:null,error:r.message}):(console.log("Session refreshed successfully"),{session:t.session,error:null})}catch(t){return console.error("Session refresh error:",t),{session:null,error:t instanceof Error?t.message:"Session refresh failed"}}}async resendConfirmationEmail(t){try{const{error:r}=await this.supabase.auth.resend({type:"signup",email:t});if(r)throw new Error(r.message);return{error:null}}catch(r){return console.error("Resend confirmation error:",r),{error:r instanceof Error?r.message:"Failed to resend confirmation email"}}}async makeAuthenticatedRequest(t,r={},n=0){try{let s=await this.getAccessToken();if(!s)throw console.error("No access token available - user not authenticated"),new Error("No access token available - user not authenticated");if(s===Fr)throw console.error("Access token is the anon key instead of user token"),new Error("Invalid token - received anon key instead of user access token");const a={Authorization:`Bearer ${s}`,"Content-Type":"application/json",...r.headers};console.log("Making authenticated request to:",t),console.log("Using access token (first 20 chars):",s.substring(0,20)+"..."),console.log("Token length:",s.length);const i=await fetch(t,{...r,headers:a});if(console.log("Response status:",i.status,i.statusText),i.status===401&&n===0){console.log("Got 401, attempting to refresh session...");const{session:o,error:c}=await this.refreshSession();if(!c&&o)return console.log("Session refreshed, retrying request..."),this.makeAuthenticatedRequest(t,r,n+1)}if(!i.ok){let o="";try{const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const u=await i.json();o=JSON.stringify(u)}else o=await i.text()}catch(c){o=`Failed to read error response: ${c}`}throw console.error("Request failed with error:",o),new Error(`HTTP ${i.status}: ${o}`)}return i}catch(s){throw console.error("Authenticated request failed:",s),s}}async makePublicRequest(t,r={}){try{const n={Authorization:`Bearer ${Fr}`,"Content-Type":"application/json",...r.headers};return console.log("Making public request to:",t),await fetch(t,{...r,headers:n})}catch(n){throw console.error("Public request failed:",n),n}}}const at=new bI,hk=T.forwardRef(({onSchemeCreated:e},t)=>{const[r,n]=T.useState({name:"",type:"",distributorData:{zone:"",state:"",distributorType:"",allDistributors:!0,specificDistributors:[]},catalogType:{family:"",class:"",brand:"",article:"",specificArticleIds:""},distIds:{type:"all",specificIds:[]},articles:{type:"all",specificIds:[]},slabType:"",commissionType:"",startDate:"",endDate:""}),[s,a]=T.useState([{min:0,max:null,rate:0}]),[i,o]=T.useState(!1),[c,u]=T.useState(!1),[f,d]=T.useState({}),[h,p]=T.useState(null),[x,m]=T.useState(0),[v,g]=T.useState(""),[w,y]=T.useState(""),[k,E]=T.useState({}),[S,_]=T.useState(""),A=["East","West","North1","North2","South"],F=[{code:"P1",name:"National Distributor"},{code:"P2",name:"Regional Distributor"},{code:"P3",name:"Large Format Retailer"},{code:"P4",name:"Regional Retailer"},{code:"P5",name:"Direct Dealer"},{code:"P6",name:"PBG_Liquidation"},{code:"P7",name:"Advance Dealer-PBG"},{code:"P8",name:"Advance Dist-PBG"},{code:"P9",name:"Advance FOMT-PBG"},{code:"PD",name:"PBG DD Prime Partner"},{code:"PC",name:"PBG CDG Group"}],U=async()=>{try{console.log("CreateScheme: Fetching zone-state mapping...");const G=Date.now(),C=Math.random().toString(36).substr(2,9),_e=await(await at.makePublicRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/zone-state-mapping?t=${G}&r=${C}`,{method:"GET"})).json();_e.success&&_e.mapping?(console.log("CreateScheme: Zone-state mapping loaded successfully"),d(_e.mapping||{})):(console.warn("CreateScheme: Zone-state mapping not available:",_e),d({}))}catch(G){console.error("CreateScheme: Error fetching zone-state mapping:",G),d({})}},V=async(G=!1)=>{try{const C=Date.now();if(!G&&C-x<1e3){console.log("CreateScheme: Skipping category data fetch - too recent");return}console.log("CreateScheme: Fetching category data...",{force:G,timeSinceLastFetch:C-x,currentTime:new Date(C).toISOString()});const pe=Date.now(),_e=Math.random().toString(36).substr(2,9),Y=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/category-data?t=${pe}&r=${_e}`;G&&(console.log("CreateScheme: Force refresh - clearing existing category data"),p(null));const ae=await at.makeAuthenticatedRequest(Y,{method:"GET"});let ce;if(ae.status===404)ce={success:!1,message:"No category data found"},console.log("CreateScheme: No category data found (404) - user needs to upload category data first");else if(ae.ok)ce=await ae.json(),console.log("CreateScheme: Category data API response:",{success:ce.success,families:ce.categoryData?.families?.length||0,uploadId:ce.categoryData?.uploadId,uploadedAt:ce.categoryData?.uploadedAt,responseTimestamp:new Date().toISOString()});else{const xe=await ae.text();throw new Error(`HTTP ${ae.status}: ${xe}`)}if(m(C),ce.success&&ce.categoryData&&ce.categoryData.families&&ce.categoryData.families.length>0){const xe=ce.categoryData;console.log("CreateScheme: Category data loaded successfully:",{families:xe.families?.length||0,familiesList:xe.families,classes:xe.classes?.length||0,brands:xe.brands?.length||0,articles:Object.keys(xe.articleMappings||{}).length,uploadId:xe.uploadId,uploadedAt:xe.uploadedAt}),!h||JSON.stringify(h.families)!==JSON.stringify(xe.families)||h.uploadId!==xe.uploadId?(console.log("CreateScheme: New category data detected, updating state"),r.type==="per_unit"&&h&&(console.log("CreateScheme: Category data changed for Booster scheme, clearing form selections"),n(Ve=>({...Ve,catalogType:{family:"",class:"",brand:"",article:"",specificArticleIds:""}})))):console.log("CreateScheme: Category data unchanged"),p(xe),G&&fe.success(`Category data refreshed - ${xe.families?.length||0} families available (Upload ID: ${xe.uploadId?.slice(-8)||"Unknown"})`,{duration:3e3})}else console.warn("CreateScheme: No category data available or empty data:",ce),p(null),G&&fe.info("No category data found. Please upload category data first to enable family, class, and brand selections for Booster schemes.")}catch(C){if(console.error("CreateScheme: Error fetching category data:",C),p(null),G){const pe=C instanceof Error?C.message:"Unknown error";pe.includes("No access token")||pe.includes("user not authenticated")?fe.error("Authentication failed. Please logout and login again."):pe.includes("Invalid token")||pe.includes("anon key")?fe.error("Authentication token is invalid. Please logout and login again."):pe.includes("404")?fe.info("No category data found. Please upload category data first in the Category Data tab."):pe.includes("Network")||pe.includes("Failed to fetch")?fe.error("Network error. Please check your connection and try again."):fe.error(`Failed to load category data: ${pe}`)}}},N=async(G=!1)=>{console.log("CreateScheme: Refreshing data...",G?"(forced)":"","at",new Date().toISOString()),u(!0);try{await Promise.all([U(),V(G)]),console.log("CreateScheme: Data refresh completed at",new Date().toISOString())}finally{u(!1)}},X=()=>{console.log("CreateScheme: Clearing category data state"),p(null),m(0),r.type==="per_unit"&&n(G=>({...G,catalogType:{family:"",class:"",brand:"",article:"",specificArticleIds:""}}))};T.useImperativeHandle(t,()=>({refresh:()=>{console.log("CreateScheme: External refresh called at",new Date().toISOString()),N(!0)},clearCategoryData:()=>{console.log("CreateScheme: External clearCategoryData called at",new Date().toISOString()),X()}})),T.useEffect(()=>{console.log("CreateScheme: Initial data load"),N(!0)},[]);const le=()=>!f||typeof f!="object"?[]:!r.distributorData.zone||r.distributorData.zone==="all-zones"?Object.values(f).flat():f[r.distributorData.zone]||[],J=()=>!h||!h.classes?[]:!r.catalogType.family||r.catalogType.family==="all-families"?h.classes||[]:h.familyClassMapping?h.familyClassMapping[r.catalogType.family]||[]:[],Z=()=>!h||!h.brands?[]:r.catalogType.class&&r.catalogType.class!=="all-classes"?h.classBrandMapping?h.classBrandMapping[r.catalogType.class]||[]:[]:r.catalogType.family&&r.catalogType.family!=="all-families"?h.familyBrandMapping?h.familyBrandMapping[r.catalogType.family]||[]:[]:h.brands||[],re=(G,C)=>{if(G.includes(".")){const[pe,_e]=G.split(".");n(Y=>{const ae={...Y,[pe]:{...Y[pe],[_e]:C}};return G==="distributorData.zone"&&(ae.distributorData.state=""),G==="catalogType.family"&&(ae.catalogType.class="",ae.catalogType.brand="",ae.catalogType.article=""),G==="catalogType.class"&&(ae.catalogType.brand="",ae.catalogType.article=""),G==="catalogType.brand"&&(ae.catalogType.article="",ae.catalogType.specificArticleIds=""),G==="catalogType.article"&&(ae.catalogType.specificArticleIds="",C==="others-articles"&&(ae.catalogType.family="",ae.catalogType.class="",ae.catalogType.brand="")),(G==="catalogType.family"||G==="catalogType.class"||G==="catalogType.brand")&&ae.catalogType.article==="others-articles"&&(ae.catalogType.article=""),ae})}else n(pe=>({...pe,[G]:C}))},te=G=>{n(C=>({...C,distIds:{type:G,specificIds:[]}})),g(""),G==="other"&&n(C=>({...C,distributorData:{zone:"",state:"",distributorType:"",allDistributors:!0,specificDistributors:[]}}))},z=G=>{g(G);const C=G.split(",").map(pe=>pe.trim()).filter(pe=>pe);n(pe=>({...pe,distIds:{...pe.distIds,specificIds:C}}))},K=G=>{y(G);const C=G.split(",").map(pe=>pe.trim()).filter(pe=>pe);n(pe=>({...pe,articles:{...pe.articles,specificIds:C}}))},se=()=>{const G=`Article ID,Commission
ART001,10.5
ART002,25
ART003,15.75
ART004,50
ART005,8.25`,C=new Blob([G],{type:"text/csv"}),pe=window.URL.createObjectURL(C),_e=document.createElement("a");_e.href=pe,_e.download="article-scheme-template.csv",document.body.appendChild(_e),_e.click(),document.body.removeChild(_e),window.URL.revokeObjectURL(pe),fe.success("Article scheme template downloaded! Use this to define your articles and commissions.")},P=async G=>{const C=G.target.files?.[0];if(C){if(!C.name.toLowerCase().endsWith(".csv")&&!C.name.toLowerCase().endsWith(".xlsx")&&!C.name.toLowerCase().endsWith(".xls")){fe.error("Please upload a CSV or Excel file");return}try{const _e=(await C.text()).split(`
`).filter(Oe=>Oe.trim());if(_e.length<2){fe.error("File must contain header and at least one data row");return}const Y=_e[0].split(",").map(Oe=>Oe.trim().toLowerCase()),ae=Y.findIndex(Oe=>Oe.includes("article")&&(Oe.includes("id")||Oe.includes("code"))),ce=Y.findIndex(Oe=>Oe.includes("commission"));if(ae===-1){fe.error('Could not find Article ID column. Please ensure your file has an "Article ID" column.');return}if(ce===-1){fe.error('Could not find Commission column. Please ensure your file has a "Commission" column.');return}const xe={},De=[];let Ve=0;const qe=[];for(let Oe=1;Oe<_e.length;Oe++){const Ie=_e[Oe].split(",").map(ir=>ir.trim());if(Ie.length<=Math.max(ae,ce)){qe.push(`Row ${Oe+1}: Insufficient columns`);continue}const ze=Ie[ae],Fe=Ie[ce];if(!ze){qe.push(`Row ${Oe+1}: Missing Article ID`);continue}const ft=parseFloat(Fe);if(isNaN(ft)){qe.push(`Row ${Oe+1}: Invalid commission value "${Fe}"`);continue}xe[ze]=ft,De.push(ze),Ve++}if(qe.length>0&&Ve===0){fe.error(l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Upload failed"}),l.jsx("p",{className:"text-sm",children:qe.slice(0,3).join(", ")}),qe.length>3&&l.jsxs("p",{className:"text-sm",children:["...and ",qe.length-3," more errors"]})]}));return}E(xe),_(C.name),n(Oe=>({...Oe,articles:{type:"other",specificIds:De}})),y(De.join(", ")),fe.success(l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Excel Upload Successful!"}),l.jsxs("p",{className:"text-sm",children:[Ve," articles loaded with commission data"]}),qe.length>0&&l.jsxs("p",{className:"text-sm text-orange-600",children:[qe.length," rows had errors"]})]}))}catch(pe){console.error("Error processing Excel file:",pe),fe.error("Failed to process Excel file. Please check the format.")}G.target.value=""}},b=()=>{E({}),_(""),n(G=>({...G,articles:{type:"all",specificIds:[]}})),y(""),fe.success("Article scheme data cleared successfully.")},D=()=>{a(G=>[...G,{min:0,max:null,rate:0}])},R=G=>{a(C=>C.filter((pe,_e)=>_e!==G))},W=G=>{const C=parseFloat(G);return isNaN(C)?0:C},q=(G,C,pe)=>{a(_e=>_e.map((Y,ae)=>{if(ae!==G)return Y;if(C==="max"&&pe===null)return{...Y,max:null};if(C==="max"&&pe==="")return{...Y,max:null};if(typeof pe=="string"){const ce=W(pe);return{...Y,[C]:ce}}return{...Y,[C]:pe}}))},H=G=>{const C={...G};return C.distributorData.zone==="all-zones"&&(C.distributorData.zone=""),C.distributorData.state==="all-states"&&(C.distributorData.state=""),C.distributorData.distributorType==="all-types"&&(C.distributorData.distributorType=""),C.catalogType.family==="all-families"&&(C.catalogType.family=""),C.catalogType.brand==="all-brands"&&(C.catalogType.brand=""),C.catalogType.class==="all-classes"&&(C.catalogType.class=""),C.catalogType.article==="all-articles"&&(C.catalogType.article=""),C.catalogType.article==="others-articles"&&(C.catalogType.article="others"),C},Q=async G=>{if(G.preventDefault(),r.type==="article"&&Object.keys(k).length===0){fe.error("Please upload an Excel file with Article ID and Commission data for Article schemes.");return}o(!0);try{const C=H(r);let pe=C.type;C.type==="per_unit"?pe="booster-scheme":C.type==="article"&&(pe="article-scheme");const _e={...C,schemeType:pe,basicInfo:{schemeName:C.name,schemeType:pe,type:C.type,slabType:C.slabType||"quantity",commissionType:C.commissionType||"percentage",slabs:r.type==="article"?[]:s,startDate:C.startDate,endDate:C.endDate},slabs:r.type==="article"?[]:s,articleCommissions:Object.keys(k).length>0?k:void 0};console.log("Creating scheme with data:",{name:_e.basicInfo?.schemeName,type:_e.type,schemeType:_e.schemeType,slabType:_e.basicInfo?.slabType,commissionType:_e.basicInfo?.commissionType,slabCount:_e.slabs?.length||0,hasArticleCommissions:!!_e.articleCommissions});const ae=await(await at.makeAuthenticatedRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/schemes`,{method:"POST",body:JSON.stringify(_e)})).json();ae.success?(fe.success(l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Vn,{className:"h-5 w-5 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Scheme Created Successfully!"}),l.jsxs("p",{className:"text-sm text-gray-600",children:['"',r.name,'" is now ready for calculations']})]})]}),{duration:4e3}),n({name:"",type:"",distributorData:{zone:"",state:"",distributorType:"",allDistributors:!0,specificDistributors:[]},catalogType:{family:"",class:"",brand:"",article:"",specificArticleIds:""},distIds:{type:"all",specificIds:[]},articles:{type:"all",specificIds:[]},slabType:"",commissionType:"",startDate:"",endDate:""}),a([{min:0,max:null,rate:0}]),g(""),y(""),E({}),_(""),e&&e()):fe.error(`Failed to create scheme: ${ae.error}`)}catch(C){console.error("Error creating scheme:",C),fe.error("Failed to create scheme. Please try again.")}finally{o(!1)}},ee=r.distIds.type==="other";return l.jsxs("form",{onSubmit:Q,className:"space-y-6",children:[h?l.jsxs(Ae,{className:"bg-blue-50 border-blue-200",children:[l.jsx(st,{className:"pb-3",children:l.jsxs(lt,{className:"text-sm flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(aa,{className:"h-4 w-4"}),l.jsx("span",{children:"Category Data Status"})]}),l.jsxs(be,{type:"button",variant:"outline",size:"sm",onClick:()=>N(!0),disabled:c,className:"h-8",children:[l.jsx(dr,{className:`h-3 w-3 mr-1 ${c?"animate-spin":""}`}),"Refresh"]})]})}),l.jsx(je,{className:"pt-0",children:l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Families:"}),l.jsx("div",{className:"text-blue-700",children:h.families?.length||0})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Classes:"}),l.jsx("div",{className:"text-blue-700",children:h.classes?.length||0})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Brands:"}),l.jsx("div",{className:"text-blue-700",children:h.brands?.length||0})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Upload ID:"}),l.jsx("div",{className:"text-blue-700 font-mono text-xs",children:h.uploadId?.slice(-12)||"None"})]})]})})]}):l.jsxs(Ae,{className:"bg-yellow-50 border-yellow-200",children:[l.jsx(st,{className:"pb-3",children:l.jsxs(lt,{className:"text-sm flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(aa,{className:"h-4 w-4 text-yellow-600"}),l.jsx("span",{children:"Category Data Required"})]}),l.jsxs(be,{type:"button",variant:"outline",size:"sm",onClick:()=>N(!0),disabled:c,className:"h-8",children:[l.jsx(dr,{className:`h-3 w-3 mr-1 ${c?"animate-spin":""}`}),"Load Data"]})]})}),l.jsx(je,{className:"pt-0",children:l.jsx("p",{className:"text-sm text-yellow-700",children:"No category data loaded. Please load category data to enable family, class, and brand selections for Booster schemes."})})]}),l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsx(lt,{children:"Basic Information"})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"name",children:"Scheme Name"}),l.jsx(Et,{id:"name",value:r.name,onChange:G=>re("name",G.target.value),placeholder:"Enter scheme name",required:!0})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"type",children:"Scheme Type"}),l.jsxs(Xt,{value:r.type,onValueChange:G=>re("type",G),children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select scheme type"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"article",children:"Article Scheme"}),l.jsx(Je,{value:"per_unit",children:"Booster"})]})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"startDate",children:"Start Date"}),l.jsx(Et,{id:"startDate",type:"date",value:r.startDate,onChange:G=>re("startDate",G.target.value),required:!0})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"endDate",children:"End Date"}),l.jsx(Et,{id:"endDate",type:"date",value:r.endDate,onChange:G=>re("endDate",G.target.value),required:!0})]})]})]})]}),l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsx(lt,{children:"Distributor Criteria"})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"distIds",children:"DIST ID's"}),l.jsxs(Xt,{value:r.distIds.type,onValueChange:te,children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select distributor ID option"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"all",children:"All"}),l.jsx(Je,{value:"other",children:"Other"})]})]})]}),r.distIds.type==="other"&&l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"specificDistIds",children:"Specific Distributor IDs"}),l.jsx(Lc,{id:"specificDistIds",value:v,onChange:G=>z(G.target.value),placeholder:"Enter distributor IDs separated by commas (e.g., DIST001, DIST002, DIST003)",rows:3}),r.distIds.specificIds.length>0&&l.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:r.distIds.specificIds.map(G=>l.jsx(pt,{variant:"outline",children:G},G))})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"zone",children:"Zone"}),l.jsxs(Xt,{value:r.distributorData.zone,onValueChange:G=>re("distributorData.zone",G),disabled:ee,children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select zone"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"all-zones",children:"ALL Zones"}),A.map(G=>l.jsx(Je,{value:G,children:G},G))]})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"state",children:"State"}),l.jsxs(Xt,{value:r.distributorData.state,onValueChange:G=>re("distributorData.state",G),disabled:ee,children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select state"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"all-states",children:"ALL States"}),le().map(G=>l.jsx(Je,{value:G,children:G},G))]})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"distributorType",children:"Distributor Type"}),l.jsxs(Xt,{value:r.distributorData.distributorType,onValueChange:G=>re("distributorData.distributorType",G),disabled:ee,children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select type"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"all-types",children:"ALL Types"}),F.map(G=>l.jsxs(Je,{value:G.code,children:[G.code," - ",G.name]},G.code))]})]})]})]})]})]}),r.type==="per_unit"&&l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsx(lt,{children:"Catalog Criteria"})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"family",children:"Family"}),l.jsxs(Xt,{value:r.catalogType.family,onValueChange:G=>re("catalogType.family",G),children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select family"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"all-families",children:"ALL Families"}),h?.families?.map(G=>l.jsx(Je,{value:G,children:G},G))]})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"class",children:"Class"}),l.jsxs(Xt,{value:r.catalogType.class,onValueChange:G=>re("catalogType.class",G),disabled:r.catalogType.article==="others-articles",children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select class"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"all-classes",children:"ALL Classes"}),J().map(G=>l.jsx(Je,{value:G,children:G},G))]})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"brand",children:"Brand"}),l.jsxs(Xt,{value:r.catalogType.brand,onValueChange:G=>re("catalogType.brand",G),disabled:r.catalogType.article==="others-articles",children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select brand"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"all-brands",children:"ALL Brands"}),Z().map(G=>l.jsx(Je,{value:G,children:G},G))]})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"article",children:"Articles"}),l.jsxs(Xt,{value:r.catalogType.article,onValueChange:G=>re("catalogType.article",G),children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select articles"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"all-articles",children:"ALL Articles"}),l.jsx(Je,{value:"others-articles",children:"Others"})]})]})]})]}),r.catalogType.article==="others-articles"&&l.jsxs("div",{className:"mt-4",children:[l.jsx(Me,{htmlFor:"specificArticleIds",children:"Specific Article IDs"}),l.jsx(Lc,{id:"specificArticleIds",value:w,onChange:G=>K(G.target.value),placeholder:"Enter article IDs separated by commas (e.g., ART001, ART002, ART003)",rows:3}),r.articles.specificIds.length>0&&l.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:r.articles.specificIds.map(G=>l.jsx(pt,{variant:"outline",children:G},G))})]})]})]}),r.type==="article"&&l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsx(lt,{children:"Article Scheme Definition"})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"commissionType",children:"Commission Type"}),l.jsxs(Xt,{value:r.commissionType,onValueChange:G=>re("commissionType",G),children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select commission type"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"fixed",children:"Fixed"}),l.jsx(Je,{value:"absolute",children:"Absolute (per unit)"}),l.jsx(Je,{value:"percentage",children:"Percentage"})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx(Me,{children:"Upload Article Commissions"}),l.jsxs(be,{type:"button",variant:"outline",size:"sm",onClick:se,children:[l.jsx(La,{className:"h-4 w-4 mr-2"}),"Download Template"]})]}),l.jsxs("div",{children:[l.jsx(Et,{type:"file",accept:".csv,.xlsx,.xls",onChange:P,className:"cursor-pointer"}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload a CSV or Excel file with Article ID and Commission columns"})]}),S&&l.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-md",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(gF,{className:"h-4 w-4 text-green-600"}),l.jsx("span",{className:"text-sm text-green-800",children:S}),l.jsxs(pt,{variant:"outline",className:"text-green-700",children:[Object.keys(k).length," articles"]})]}),l.jsx(be,{type:"button",variant:"outline",size:"sm",onClick:b,children:"Clear"})]})]})]})]}),r.type==="per_unit"&&l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsx(lt,{children:"Slab Configuration"})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"slabType",children:"Slab Type"}),l.jsxs(Xt,{value:r.slabType,onValueChange:G=>re("slabType",G),children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select slab type"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"quantity",children:"Quantity"}),l.jsx(Je,{value:"value",children:"Value"})]})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"commissionType",children:"Commission Type"}),l.jsxs(Xt,{value:r.commissionType,onValueChange:G=>re("commissionType",G),children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select commission type"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"fixed",children:"Fixed"}),l.jsx(Je,{value:"percentage",children:"Percentage"}),l.jsx(Je,{value:"absolute_per_unit",children:"Absolute Per Unit"})]})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx(Me,{children:"Slabs"}),l.jsxs(be,{type:"button",variant:"outline",size:"sm",onClick:D,children:[l.jsx(Oc,{className:"h-4 w-4 mr-2"}),"Add Slab"]})]}),s.map((G,C)=>l.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-md",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx(Me,{className:"text-sm",children:"Min"}),l.jsx(Et,{type:"number",value:G.min,onChange:pe=>q(C,"min",pe.target.value),min:"0",step:"0.01"})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx(Me,{className:"text-sm",children:"Max (Optional)"}),l.jsx(Et,{type:"number",value:G.max===null?"":G.max,onChange:pe=>q(C,"max",pe.target.value||null),min:"0",step:"0.01",placeholder:"No limit"})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx(Me,{className:"text-sm",children:"Rate"}),l.jsx(Et,{type:"number",value:G.rate,onChange:pe=>q(C,"rate",pe.target.value),min:"0",step:"0.01"})]}),s.length>1&&l.jsx(be,{type:"button",variant:"outline",size:"sm",onClick:()=>R(C),children:l.jsx(uu,{className:"h-4 w-4"})})]},C))]})]})]}),l.jsxs("div",{className:"flex justify-end space-x-4",children:[l.jsxs(be,{type:"button",variant:"outline",onClick:()=>N(!0),disabled:c,children:[l.jsx(dr,{className:`h-4 w-4 mr-2 ${c?"animate-spin":""}`}),"Refresh Data"]}),l.jsx(be,{type:"submit",disabled:i,children:i?l.jsxs(l.Fragment,{children:[l.jsx(dr,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating Scheme..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Vn,{className:"h-4 w-4 mr-2"}),"Create Scheme"]})})]})]})});hk.displayName="CreateScheme";function EI({onDataUploaded:e}){const[t,r]=T.useState(null),[n,s]=T.useState(""),[a,i]=T.useState(""),[o,c]=T.useState(!1),[u,f]=T.useState("idle"),[d,h]=T.useState([]),p=T.useRef(null),x=["January","February","March","April","May","June","July","August","September","October","November","December"],m=new Date().getFullYear(),v=Array.from({length:5},(E,S)=>m-2+S),g=E=>{const S=E.target.files?.[0];S&&(r(S),f("idle"),S.type==="text/csv"||S.name.endsWith(".csv")?w(S):fe.error("Please upload a CSV file"))},w=E=>{const S=new FileReader;S.onload=_=>{const F=(_.target?.result).split(`
`);F[0].split(",").map(V=>V.trim());const U=[];for(let V=1;V<F.length;V++){if(F[V].trim()==="")continue;const N=F[V].split(",").map(le=>le.trim()),X={monthOfBillingDate:N[0]||"",dayOfBillingDate:N[1]||"",distributorId:N[2]||"",articleId:N[3]||"",billingQuantity:parseFloat(N[4])||0,netSales:parseFloat(N[5])||0,billingDocument:N[6]||""};U.push(X)}if(U.length>1e5){fe.error(`File contains ${U.length} records. Maximum 100,000 records allowed for optimal performance. Please split your data into smaller files.`),h([]);return}h(U),fe.success(`Parsed ${U.length} records from CSV`)},S.onerror=()=>{fe.error("Error reading file")},S.readAsText(E)},y=async()=>{if(!t||!n||!a||d.length===0){fe.error("Please select a file, month, year and ensure data is parsed");return}c(!0);try{const E={fileName:t.name,data:d,month:n,year:parseInt(a)};console.log("Uploading to:",`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/upload-sales-data`),console.log("Upload data summary:",{fileName:E.fileName,recordCount:E.data.length,month:E.month,year:E.year});const S=await at.makeAuthenticatedRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/upload-sales-data`,{method:"POST",body:JSON.stringify(E)});console.log("Response status:",S.status,S.statusText),console.log("Response headers:",Object.fromEntries(S.headers.entries()));let _;const A=await S.text();console.log("Raw response:",A);try{_=JSON.parse(A)}catch(F){console.error("JSON parse error:",F),console.error("Response text that failed to parse:",A),fe.error(l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ds,{className:"h-4 w-4 text-red-500"}),l.jsx("span",{className:"font-medium",children:"Server Response Error"})]}),l.jsxs("div",{className:"text-sm",children:[l.jsx("p",{children:"The server returned an invalid response:"}),l.jsxs("code",{className:"bg-red-100 px-2 py-1 rounded text-xs block mt-1 max-w-md overflow-hidden",children:[A.substring(0,200),A.length>200?"...":""]}),l.jsxs("p",{className:"mt-2",children:["Status: ",S.status," ",S.statusText]}),l.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Check the Debug tab for more information about the backend connection."})]})]}),{duration:1e4}),f("error");return}if(S.ok&&_.success)f("success"),fe.success(l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Vn,{className:"h-5 w-5 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Sales Data Uploaded Successfully!"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[d.length," records uploaded for ",n," ",a]})]})]}),{duration:5e3}),setTimeout(()=>{fe.info(l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(BS,{className:"h-5 w-5 text-blue-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Ready for Calculations!"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Go to 'Manage Schemes' or 'View Calculations' tab to run calculations with this data"})]})]}),{duration:6e3})},1e3),r(null),s(""),i(""),h([]),p.current&&(p.current.value=""),e&&e();else{f("error");const F=_?.error||`HTTP ${S.status}: ${S.statusText}`;fe.error(l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ds,{className:"h-4 w-4 text-red-500"}),l.jsx("span",{className:"font-medium",children:"Upload Failed"})]}),l.jsxs("div",{className:"text-sm",children:[l.jsx("p",{children:F}),S.status===404&&l.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"The upload endpoint may not be deployed. Check the Debug tab for backend status."})]})]}),{duration:8e3})}}catch(E){console.error("Upload error:",E),f("error");let S="Failed to upload sales data";E instanceof Error&&(E.message.includes("Failed to fetch")?S="Unable to connect to the backend server. Please check if the Supabase Edge Function is deployed.":E.message.includes("NetworkError")?S="Network error occurred. Please check your internet connection.":S=`Upload error: ${E.message}`),fe.error(l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ds,{className:"h-4 w-4 text-red-500"}),l.jsx("span",{className:"font-medium",children:"Upload Error"})]}),l.jsxs("div",{className:"text-sm",children:[l.jsx("p",{children:S}),l.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Check the Debug tab for more information about the backend connection."})]})]}),{duration:8e3})}finally{c(!1)}},k=()=>{const E=["Month of Billing Date,Day of Billing Date,Distributor ID,Article ID,Billing Quantity,Net Sales,Billing Document","01,15,DIST001,ART123456,10,500000,INV001234","01,20,DIST002,ART123457,15,450000,INV001235","01,25,DIST003,ART123458,5,150000,INV001236","02,05,DIST004,ART123459,8,240000,INV001237","02,12,DIST005,ART123460,12,120000,INV001238","02,18,DIST006,ART123461,6,180000,INV001239","03,08,DIST007,ART123462,4,80000,INV001240","03,14,DIST008,ART123459,5,150000,INV001241","03,22,DIST009,ART123456,7,350000,INV001242"].join(`
`),S=new Blob([E],{type:"text/csv"}),_=window.URL.createObjectURL(S),A=document.createElement("a");A.href=_,A.download="sample_sales_data.csv",A.click(),window.URL.revokeObjectURL(_)};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs(At,{children:[l.jsx(Ic,{className:"h-4 w-4"}),l.jsxs(jt,{children:[l.jsx("strong",{children:"Updated Format & Performance Limits:"})," Sales data follows the new billing format with Month, Day, Distributor ID, Article ID, Billing Quantity, Net Sales, and Billing Document.",l.jsx("strong",{children:"Maximum 100,000 records per upload"})," for optimal performance. Make sure your Article IDs match those from your category upload for proper calculations."]})]}),l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsx(lt,{children:"Upload Configuration"})}),l.jsx(je,{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"month",children:"Month"}),l.jsxs(Xt,{value:n,onValueChange:s,children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select month"})}),l.jsx(Yt,{children:x.map((E,S)=>l.jsx(Je,{value:E,children:E},E))})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"year",children:"Year"}),l.jsxs(Xt,{value:a,onValueChange:i,children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select year"})}),l.jsx(Yt,{children:v.map(E=>l.jsx(Je,{value:E.toString(),children:E},E))})]})]})]})})]}),l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Upload Sales Data"}),l.jsxs(be,{onClick:k,variant:"outline",size:"sm",children:[l.jsx(sl,{className:"h-4 w-4 mr-2"}),"Download Sample CSV"]})]})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[l.jsx(Fs,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-lg",children:"Drop your CSV file here or click to browse"}),l.jsx("p",{className:"text-sm text-gray-500",children:"CSV format: Month of Billing Date, Day of Billing Date, Distributor ID, Article ID, Billing Quantity, Net Sales, Billing Document"})]}),l.jsx("input",{ref:p,type:"file",accept:".csv",onChange:g,className:"hidden",id:"file-upload"}),l.jsx(be,{onClick:()=>p.current?.click(),variant:"outline",className:"mt-4",children:"Select File"})]}),t&&l.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(sl,{className:"h-5 w-5 text-blue-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:t.name}),l.jsxs("p",{className:"text-sm text-gray-500",children:[(t.size/1024).toFixed(1)," KB"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[u==="success"&&l.jsxs(pt,{variant:"secondary",className:"bg-green-100 text-green-800",children:[l.jsx(hx,{className:"h-3 w-3 mr-1"}),"Uploaded"]}),u==="error"&&l.jsxs(pt,{variant:"secondary",className:"bg-red-100 text-red-800",children:[l.jsx(sd,{className:"h-3 w-3 mr-1"}),"Error"]}),l.jsx(be,{onClick:()=>{r(null),h([]),f("idle"),p.current&&(p.current.value="")},variant:"ghost",size:"sm",children:l.jsx(sd,{className:"h-4 w-4"})})]})]}),d.length>0&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h4",{className:"font-medium",children:"Data Preview"}),l.jsxs(pt,{variant:"outline",children:[d.length," records"]})]}),l.jsxs("div",{className:"max-h-64 overflow-auto border rounded-lg",children:[l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2 text-left",children:"Month"}),l.jsx("th",{className:"p-2 text-left",children:"Day"}),l.jsx("th",{className:"p-2 text-left",children:"Distributor ID"}),l.jsx("th",{className:"p-2 text-left",children:"Article ID"}),l.jsx("th",{className:"p-2 text-right",children:"Quantity"}),l.jsx("th",{className:"p-2 text-right",children:"Net Sales"}),l.jsx("th",{className:"p-2 text-left",children:"Document"})]})}),l.jsx("tbody",{children:d.slice(0,10).map((E,S)=>l.jsxs("tr",{className:"border-t",children:[l.jsx("td",{className:"p-2",children:E.monthOfBillingDate}),l.jsx("td",{className:"p-2",children:E.dayOfBillingDate}),l.jsx("td",{className:"p-2",children:E.distributorId}),l.jsx("td",{className:"p-2 font-mono text-xs",children:E.articleId}),l.jsx("td",{className:"p-2 text-right",children:E.billingQuantity}),l.jsxs("td",{className:"p-2 text-right",children:["",E.netSales.toLocaleString()]}),l.jsx("td",{className:"p-2 text-xs",children:E.billingDocument})]},S))})]}),d.length>10&&l.jsxs("div",{className:"p-2 text-center text-sm text-gray-500 bg-gray-50",children:["... and ",d.length-10," more records"]})]})]}),l.jsx("div",{className:"flex justify-end",children:l.jsx(be,{onClick:y,disabled:!t||!n||!a||o||d.length===0,size:"lg",children:o?"Uploading...":"Upload Sales Data"})})]})]}),u==="success"&&l.jsx(Ae,{className:"border-green-200 bg-green-50",children:l.jsx(je,{className:"p-6",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Vn,{className:"h-6 w-6 text-green-600"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-green-900",children:"Sales Data Uploaded Successfully!"}),l.jsx("p",{className:"text-sm text-green-700",children:"Your billing data is now ready for scheme calculations. The system will use the Article IDs to map to the corresponding family, class, and brand information from your category data, along with distributor information for comprehensive scheme calculations. Head to 'Manage Schemes' or 'View Calculations' to run calculations with this uploaded data."})]})]})})})]})}const wx=()=>{const e=Date.now(),t=Math.random().toString(36).substr(2,9);return`v=${e}&r=${t}`},TI=async()=>{try{const e=wx(),t=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/schemes?${e}`;console.log("=== FETCHING SCHEMES ==="),console.log("URL:",t);const r=await at.makeAuthenticatedRequest(t,{method:"GET"});if(console.log("Schemes response:",{status:r.status,statusText:r.statusText,ok:r.ok}),!r.ok){const s=await r.text();if(console.error("Schemes fetch failed:",r.status,s),r.status===404||r.status===500)return console.warn(`Schemes endpoint returned ${r.status} - returning empty array`),[];throw new Error(`HTTP ${r.status}: ${s}`)}const n=await r.json();if(console.log("Schemes result:",{success:n.success,schemesLength:n.schemes?.length||0}),n.success&&Array.isArray(n.schemes)){const s=n.schemes.map(a=>{const i=a.value||a;return{id:i.id,name:i.name,type:i.type,startDate:i.startDate,endDate:i.endDate,status:i.status||"active",slabType:i.slabType,commissionType:i.commissionType,distributorData:i.distributorData,catalogType:i.catalogType}}).filter(a=>a&&a.id&&a.name);return console.log("Successfully processed schemes:",s.length),s}return console.log("No schemes found or invalid response structure"),[]}catch(e){console.error("Error fetching schemes:",e);const t=e instanceof Error?e.message:"Unknown error";return e instanceof Error&&(e.message.includes("404")||e.message.includes("500"))?(console.log("Backend error when fetching schemes - may be expected if backend is not deployed"),[]):(fe.error(`Failed to fetch schemes: ${t}`),[])}},CI=async()=>{try{const e=wx(),t=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/sales-data?${e}`;console.log("=== FETCHING SALES DATA (UPLOADS) ==="),console.log("URL:",t);const r=await at.makeAuthenticatedRequest(t,{method:"GET"});if(console.log("Sales data response:",{status:r.status,statusText:r.statusText,ok:r.ok}),!r.ok){const s=await r.text();if(console.error("Sales data fetch failed:",r.status,s),r.status===404)return console.log("Sales data endpoint returned 404 - this is expected when no sales data has been uploaded"),[];if(r.status===500)return console.warn("Server error when fetching sales data - backend may be experiencing issues"),[];throw new Error(`HTTP ${r.status}: ${s}`)}const n=await r.json();if(console.log("Sales data result:",{success:n.success,salesDataExists:!!n.salesData,salesDataLength:n.salesData?.length||0}),n.success){if(!n.salesData||!Array.isArray(n.salesData)||n.salesData.length===0)return console.log("No sales data found - returning empty uploads array"),[];const s=[],a=new Map;n.salesData.forEach(o=>{const c=o.uploadMonth||"Unknown",u=o.uploadYear||new Date().getFullYear(),f=o.fileName||"sales_data.csv",d=o.uploadedAt?o.uploadedAt.split("T")[0]:new Date().toISOString().split("T")[0],h=`${c}_${u}_${f}_${d}`;a.has(h)||a.set(h,[]),a.get(h).push(o)});let i=0;return a.forEach((o,c)=>{const u=o[0],f={id:`upload_${i}_${u.uploadMonth||"unknown"}_${u.uploadYear||"unknown"}`,fileName:u.fileName||"sales_data.csv",month:u.uploadMonth||"Unknown",year:Number(u.uploadYear)||new Date().getFullYear(),uploadedAt:u.uploadedAt||new Date().toISOString(),data:o};s.push(f),i++}),console.log("Successfully transformed sales data to uploads:",{uploadsCount:s.length,totalSalesRecords:n.salesData.length,uploadDetails:s.map(o=>`${o.month} ${o.year} (${o.data?.length||0} records)`)}),s}return console.log("Sales data response did not contain expected structure or was not successful"),[]}catch(e){console.error("Error fetching sales data for uploads:",e);const t=e instanceof Error?e.message:"Unknown error";if(e instanceof Error){if(e.message.includes("404"))return console.log("No sales data available - this is expected when no data has been uploaded"),[];if(e.message.includes("500"))return console.warn("Server error when fetching sales data"),[];if(e.message.includes("Failed to fetch")||e.message.includes("NetworkError"))return console.error("Network error - backend may not be accessible"),[]}return console.warn("Showing error toast for unexpected error:",t),fe.error(`Failed to fetch sales data: ${t}`),[]}},NI=async(e=50,t=0)=>{try{const r=wx(),n=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/calculations/latest?${r}`;console.log("=== FETCHING LATEST CALCULATION ==="),console.log("URL:",n);const s=await at.makeAuthenticatedRequest(n,{method:"GET"});if(console.log("Calculations response:",{status:s.status,statusText:s.statusText,ok:s.ok}),!s.ok){const i=await s.text();if(console.error("Calculations fetch failed:",s.status,i),s.status===408)throw new Error("Server timeout - too much calculation data. Please try again or contact support.");if(s.status===404)return console.log("No calculations found - this is expected when no calculations have been run"),[];throw new Error(`HTTP ${s.status}: ${i}`)}const a=await s.json();if(console.log("Calculations result:",{success:a.success,calculationsLength:a.calculations?.length||0,calculationId:a.calculationId,totalRecords:a.totalRecords}),a.success&&Array.isArray(a.calculations)){const i={id:a.calculationId||`calc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,schemeId:"",uploadId:"all-sales-data",calculations:a.calculations,distributorArticleSummary:[],totalCommission:a.calculations.reduce((o,c)=>o+(c.commission||0),0),totalDistributorArticleCombinations:new Set(a.calculations.map(o=>`${o.distributorId}:${o.articleId}`)).size,calculatedAt:a.createdAt||new Date().toISOString(),calculationType:"optimized-chunked"};return console.log("Successfully processed latest calculation:",{id:i.id,totalCommission:i.totalCommission,totalRecords:i.calculations.length}),[i]}return console.log("Calculations response did not contain expected structure"),[]}catch(r){console.error("Error fetching calculations:",r);const n=r instanceof Error?r.message:"Unknown error";if(n.includes("timeout"))throw r;if(r instanceof Error&&(r.message.includes("404")||r.message.includes("500")))return console.log("Backend error when fetching calculations - may be expected"),[];throw fe.error(`Failed to fetch calculations: ${n}`),r}},AI=async(e,t)=>{try{console.log("=== CALCULATING SCHEME ==="),console.log("Scheme ID:",e);const r=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/calculate`;console.log("Calculate URL:",r);const n=await at.makeAuthenticatedRequest(r,{method:"POST",body:JSON.stringify({schemeId:e})});if(console.log("Calculate response:",{status:n.status,statusText:n.statusText,ok:n.ok}),!n.ok){const a=await n.text();throw console.error("Calculate request failed:",n.status,a),n.status===408?new Error("Calculation timeout - Dataset too large. Please reduce your data size or contact support."):new Error(`HTTP ${n.status}: ${a}`)}const s=await n.json();return console.log("Calculate result:",{success:s.success,calculationId:s.calculationId,totalCommission:s.summary?.totalCommission,recordsProcessed:s.calculations?.length}),s}catch(r){throw console.error("Error in calculateScheme:",r),r}},pk=(e,t,r)=>{const n=t.find(u=>u.id===e.schemeId),s=r.find(u=>u.id===e.uploadId),a=["Scheme Name,Calculation Date,Sales Period,Month,Day,Distributor ID,Distributor Name,Article ID,Billing Quantity,Net Sales,Billing Document,Commission,Scheme Type,Total Group Quantity,Total Group Value,Slab Rate,Total Group Commission",...e.calculations.map(u=>`${n?.name||"Unknown"},${new Date(e.calculatedAt).toLocaleDateString()},${s?`${s.month} ${s.year}`:"Unknown"},${u.monthOfBillingDate},${u.dayOfBillingDate},${u.distributorId},${u.distributorName||""},${u.articleId||""},${u.billingQuantity},${u.netSales},${u.billingDocument||""},${u.commission},${u.schemeType},${u.totalGroupQuantity||""},${u.totalGroupValue||""},${u.slabRate||""},${u.totalGroupCommission||""}`)].join(`
`),i=new Blob([a],{type:"text/csv"}),o=window.URL.createObjectURL(i),c=document.createElement("a");c.href=o,c.download=`scheme_calculation_detailed_${n?.name?.replace(/\s+/g,"_")||e.id}_${new Date(e.calculatedAt).toISOString().split("T")[0]}.csv`,c.click(),window.URL.revokeObjectURL(o),fe.success("Detailed calculation exported successfully!")},mk=(e,t,r)=>{if(!e.distributorArticleSummary||e.distributorArticleSummary.length===0){fe.error("No distributor-article summary data available for this calculation");return}const n=t.find(u=>u.id===e.schemeId),s=r.find(u=>u.id===e.uploadId),a=["Scheme Name,Calculation Date,Sales Period,Distributor ID,Distributor Name,Article ID,Total Quantity,Total Value,Slab Rate,Commission,Sales Count,Comparison Value,Slab Type,Commission Type",...e.distributorArticleSummary.map(u=>`${n?.name||"Unknown"},${new Date(e.calculatedAt).toLocaleDateString()},${s?`${s.month} ${s.year}`:"Unknown"},${u.distributorId},${u.distributorName},${u.articleId},${u.totalQuantity},${u.totalValue},${u.slabRate},${u.commission},${u.salesCount},${u.comparisonValue},${u.slabType},${u.commissionType}`)].join(`
`),i=new Blob([a],{type:"text/csv"}),o=window.URL.createObjectURL(i),c=document.createElement("a");c.href=o,c.download=`scheme_distributor_article_summary_${n?.name?.replace(/\s+/g,"_")||e.id}_${new Date(e.calculatedAt).toISOString().split("T")[0]}.csv`,c.click(),window.URL.revokeObjectURL(o),fe.success("Distributor-Article summary exported successfully!")},xk=(e,t,r)=>{const n=e.flatMap(c=>{const u=t.find(h=>h.id===c.schemeId),f=r.find(h=>h.id===c.uploadId),d=new Map;return c.calculations.forEach(h=>{const p=`${h.distributorId}_${h.articleId}`,x=d.get(p);x?(x.totalQuantity+=h.billingQuantity,x.totalValue+=h.netSales,x.totalCommission+=h.commission,x.recordCount+=1):d.set(p,{schemeName:u?.name||"Unknown",calculationDate:new Date(c.calculatedAt).toLocaleDateString(),salesPeriod:f?`${f.month} ${f.year}`:"Unknown",distributorId:h.distributorId,distributorName:h.distributorName||"",articleId:h.articleId||"",totalQuantity:h.billingQuantity,totalValue:h.netSales,totalCommission:h.commission,recordCount:1})}),Array.from(d.values())});if(n.length===0){fe.error("No distributor-article level data available");return}const s=["Scheme Name,Calculation Date,Sales Period,Distributor ID,Distributor Name,Article ID,Total Quantity,Total Value,Total Commission,Record Count",...n.map(c=>`${c.schemeName},${c.calculationDate},${c.salesPeriod},${c.distributorId},${c.distributorName},${c.articleId},${c.totalQuantity},${c.totalValue},${c.totalCommission},${c.recordCount}`)].join(`
`),a=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=`distributor_article_level_export_${new Date().toISOString().split("T")[0]}.csv`,o.click(),window.URL.revokeObjectURL(i),fe.success("Distributor + Article level export completed successfully!")},gk=(e,t,r)=>{const n=e.flatMap(c=>{const u=t.find(h=>h.id===c.schemeId),f=r.find(h=>h.id===c.uploadId),d=new Map;return c.calculations.forEach(h=>{const p=`${c.schemeId}_${h.distributorId}`,x=d.get(p);x?(x.uniqueArticles.add(h.articleId||""),x.totalQuantity+=h.billingQuantity,x.totalValue+=h.netSales,x.totalCommission+=h.commission,x.recordCount+=1):d.set(p,{schemeName:u?.name||"Unknown",schemeType:u?.type||"Unknown",calculationDate:new Date(c.calculatedAt).toLocaleDateString(),salesPeriod:f?`${f.month} ${f.year}`:"Unknown",distributorId:h.distributorId,distributorName:h.distributorName||"",uniqueArticles:new Set([h.articleId||""]),totalQuantity:h.billingQuantity,totalValue:h.netSales,totalCommission:h.commission,recordCount:1})}),Array.from(d.values()).map(h=>({...h,articleCount:h.uniqueArticles.size,articleList:Array.from(h.uniqueArticles).join(", ")}))});if(n.length===0){fe.error("No scheme-distributor level data available");return}const s=["Scheme Name,Scheme Type,Calculation Date,Sales Period,Distributor ID,Distributor Name,Article Count,Articles,Total Quantity,Total Value,Total Commission,Record Count",...n.map(c=>`${c.schemeName},${c.schemeType},${c.calculationDate},${c.salesPeriod},${c.distributorId},${c.distributorName},${c.articleCount},"${c.articleList}",${c.totalQuantity},${c.totalValue},${c.totalCommission},${c.recordCount}`)].join(`
`),a=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=`scheme_distributor_level_export_${new Date().toISOString().split("T")[0]}.csv`,o.click(),window.URL.revokeObjectURL(i),fe.success("Scheme + Distributor level export completed successfully!")};function Bc({className:e,...t}){return l.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:l.jsx("table",{"data-slot":"table",className:tt("w-full caption-bottom text-sm",e),...t})})}function Uc({className:e,...t}){return l.jsx("thead",{"data-slot":"table-header",className:tt("[&_tr]:border-b",e),...t})}function $c({className:e,...t}){return l.jsx("tbody",{"data-slot":"table-body",className:tt("[&_tr:last-child]:border-0",e),...t})}function is({className:e,...t}){return l.jsx("tr",{"data-slot":"table-row",className:tt("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function dt({className:e,...t}){return l.jsx("th",{"data-slot":"table-head",className:tt("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function ut({className:e,...t}){return l.jsx("td",{"data-slot":"table-cell",className:tt("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function jI({currentCalculation:e,schemes:t,uploads:r}){return e?l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Latest Calculation Details"}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs(be,{onClick:()=>pk(e,t,r),variant:"outline",size:"sm",children:[l.jsx(La,{className:"h-4 w-4 mr-2"}),"Export Detailed"]}),e.distributorArticleSummary&&e.distributorArticleSummary.length>0&&l.jsxs(be,{onClick:()=>mk(e,t,r),variant:"outline",size:"sm",children:[l.jsx(Fo,{className:"h-4 w-4 mr-2"}),"Export Summary"]}),l.jsxs(be,{onClick:()=>xk([e],t,r),variant:"outline",size:"sm",children:[l.jsx(La,{className:"h-4 w-4 mr-2"}),"Export Distributor+Article"]}),l.jsxs(be,{onClick:()=>gk([e],t,r),variant:"outline",size:"sm",children:[l.jsx(La,{className:"h-4 w-4 mr-2"}),"Export Scheme+Distributor"]})]})]})}),l.jsxs(je,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["",e.totalCommission.toLocaleString()]}),l.jsx("div",{className:"text-sm text-gray-500",children:"Total Commission"})]})})}),l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.calculations.length}),l.jsx("div",{className:"text-sm text-gray-500",children:"Detailed Records"})]})})}),l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e.totalDistributorArticleCombinations||0}),l.jsx("div",{className:"text-sm text-gray-500",children:"Distributor-Article Combinations"})]})})})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(Bc,{children:[l.jsx(Uc,{children:l.jsxs(is,{children:[l.jsx(dt,{children:"Distributor ID"}),l.jsx(dt,{children:"Article ID"}),l.jsx(dt,{children:"Quantity"}),l.jsx(dt,{children:"Net Sales"}),l.jsx(dt,{children:"Commission"}),l.jsx(dt,{children:"Slab Rate"}),l.jsx(dt,{children:"Group Total Qty"}),l.jsx(dt,{children:"Group Commission"})]})}),l.jsx($c,{children:e.calculations.slice(0,50).map((n,s)=>l.jsxs(is,{children:[l.jsx(ut,{className:"font-mono text-sm",children:n.distributorId}),l.jsx(ut,{className:"font-mono text-sm",children:n.articleId}),l.jsx(ut,{className:"text-right",children:n.billingQuantity}),l.jsxs(ut,{className:"text-right",children:["",n.netSales.toLocaleString()]}),l.jsxs(ut,{className:"text-right font-medium",children:["",n.commission.toFixed(2)]}),l.jsx(ut,{className:"text-right",children:n.slabRate||"-"}),l.jsx(ut,{className:"text-right",children:n.totalGroupQuantity||"-"}),l.jsx(ut,{className:"text-right font-medium",children:n.totalGroupCommission?`${n.totalGroupCommission.toFixed(2)}`:"-"})]},s))})]})}),e.calculations.length>50&&l.jsxs("div",{className:"text-center text-gray-500 text-sm mt-4",children:["Showing first 50 records of ",e.calculations.length,". Export to see all data."]})]})]}):l.jsx(Ae,{children:l.jsxs(je,{className:"p-8 text-center",children:[l.jsx(Ts,{className:"h-16 w-16 mx-auto text-gray-400 mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Current Calculation"}),l.jsx("p",{className:"text-gray-500",children:"Run a calculation above to see detailed results here."})]})})}function DI(){const[e,t]=T.useState([]),[r,n]=T.useState([]),[s,a]=T.useState([]),[i,o]=T.useState(""),[c,u]=T.useState("all-sales-data"),[f,d]=T.useState(null),[h,p]=T.useState(!1),[x,m]=T.useState(""),[v,g]=T.useState("all"),[w,y]=T.useState(null);T.useEffect(()=>{k()},[]),T.useEffect(()=>{r.length>0&&!c&&u("all-sales-data")},[r]);const k=async()=>{p(!0),y(null);try{const[N,X]=await Promise.all([TI(),CI()]);t(N),n(X);try{const le=await NI(50,0);a(le)}catch(le){console.error("Error fetching calculations:",le);const J=le instanceof Error?le.message:"Unknown error";J.includes("timeout")?(y("Calculations data is taking too long to load. The system may have too much historical data. Recent calculations functionality is temporarily unavailable."),a([])):(y(`Failed to load calculations: ${J}`),a([]))}}catch(N){console.error("Error fetching main data:",N),fe.error("Failed to fetch schemes and uploads data")}finally{p(!1)}},E=async()=>{if(!i){fe.error("Please select a scheme to calculate");return}if(r.length===0){fe.error("No sales data available. Please upload sales data first.");return}p(!0);const N=Date.now();try{const X=await AI(i,c==="all-sales-data"?"":c);if(X.success){const le=Date.now()-N;fe.success(l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Vn,{className:"h-5 w-5 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Calculation Completed Successfully!"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[X.totalRecords?.toLocaleString()||0," detailed records generated  Stored in ",X.totalChunks||1," chunks ",(le/1e3).toFixed(1),"s"]})]})]}),{duration:6e3}),await k(),o(""),u("all-sales-data")}else fe.error(`Calculation failed: ${X.error}`)}catch(X){console.error("Error calculating scheme:",X);let le="Failed to calculate scheme";X instanceof Error?(le=X.message,le.includes("timeout")?le="Calculation timed out. This may be due to a large dataset. Please try with smaller data sets or contact support.":le.includes("statement timeout")&&(le="Database operation timed out. The system may be processing too much data. Please try again or contact support.")):typeof X=="string"&&(le=X),fe.error(l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Calculation Error"}),l.jsx("p",{className:"text-sm text-gray-600",children:le})]}),{duration:8e3})}finally{p(!1)}},S=s.filter(N=>v==="all"||N.schemeId===v),_=s.reduce((N,X)=>N+X.totalCommission,0);s.reduce((N,X)=>N+X.calculations.length,0);const A=s.reduce((N,X)=>N+(X.totalDistributorArticleCombinations||0),0),F=new Set(s.flatMap(N=>N.calculations.map(X=>X.distributorId))).size,U=e.find(N=>N&&N.id===i)||null,V=c&&c!=="all-sales-data"&&r.find(N=>N&&N.id===c)||null;return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ts,{className:"h-5 w-5 text-blue-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Total Calculations"}),l.jsx("p",{className:"text-2xl font-bold",children:s.length})]})]})})}),l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(WS,{className:"h-5 w-5 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Total Commission"}),l.jsxs("p",{className:"text-2xl font-bold",children:["",_.toLocaleString()]})]})]})})}),l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Fo,{className:"h-5 w-5 text-purple-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Distributor-Article Combinations"}),l.jsx("p",{className:"text-2xl font-bold",children:A})]})]})})}),l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ma,{className:"h-5 w-5 text-orange-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Unique Distributors"}),l.jsx("p",{className:"text-2xl font-bold",children:F})]})]})})})]}),w&&l.jsxs(At,{className:"border-orange-200 bg-orange-50",children:[l.jsx(Fo,{className:"h-4 w-4 text-orange-600"}),l.jsxs(jt,{className:"text-orange-800",children:[l.jsx("strong",{children:"Calculations Loading Issue:"})," ",w,l.jsx("div",{className:"mt-2",children:l.jsxs(be,{onClick:k,variant:"outline",size:"sm",disabled:h,className:"ml-0",children:[l.jsx(dr,{className:`h-4 w-4 mr-2 ${h?"animate-spin":""}`}),"Try Again"]})})]})]}),r.length===0&&l.jsxs(At,{className:"border-blue-200 bg-blue-50",children:[l.jsx(Fs,{className:"h-4 w-4 text-blue-600"}),l.jsxs(jt,{className:"text-blue-800",children:[l.jsx("strong",{children:"No Sales Data Available:"}),' You need to upload sales data before you can run calculations. Please go to the "Upload Data" tab to upload your sales data first.']})]}),r.length>0&&l.jsxs(At,{className:"border-green-200 bg-green-50",children:[l.jsx(Ri,{className:"h-4 w-4 text-green-600"}),l.jsxs(jt,{className:"text-green-800",children:[l.jsx("strong",{children:"Sales Data Available:"})," ",r.length," sales data upload(s) ready for calculation.",l.jsxs("div",{className:"mt-2 text-sm",children:["Available periods: ",r.map(N=>`${N.month} ${N.year}`).join(", ")]})]})]}),l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(Ts,{className:"h-5 w-5"}),l.jsx("span",{children:"Calculate New Commission"})]})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs(At,{children:[l.jsx(Fo,{className:"h-4 w-4"}),l.jsxs(jt,{children:[l.jsx("strong",{children:"Booster Schemes (per_unit):"})," Use cumulative quantity-based calculation where commission is recalculated as sales accumulate chronologically. Each sale contributes to the cumulative total, and commission = slab_rate  cumulative_total_quantity.",l.jsx("br",{}),l.jsx("strong",{children:"Article Schemes:"})," Use multi-slab logic where sales are grouped by distributor-article combination, and commission = slab_rate  total_quantity.",l.jsx("br",{}),l.jsx("strong",{children:"Negative Quantity Rule:"})," If the total/cumulative quantity is negative, commission is automatically set to zero."]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Scheme"}),l.jsxs(Xt,{value:i,onValueChange:o,children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Choose a scheme"})}),l.jsx(Yt,{children:e.filter(N=>N&&N.id).map(N=>l.jsxs(Je,{value:N.id,children:[N.name," (",N.type==="per_unit"?"Booster":N.type==="article"?"Article Scheme":N.type,")"]},N.id))})]}),U&&l.jsx("div",{className:"mt-2 p-3 bg-gray-50 rounded-md",children:l.jsxs("div",{className:"text-sm space-y-1",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Type:"})," ",U.type==="per_unit"?"Booster":U.type==="article"?"Article Scheme":U.type]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Period:"})," ",U.startDate," to ",U.endDate]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Slab Type:"})," ",U.slabType]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Commission Type:"})," ",U.commissionType==="fixed"?"Fixed":U.commissionType==="absolute_per_unit"?"Absolute(per unit)":U.commissionType==="percentage"?"Percentage":U.commissionType]})]})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Sales Data"}),r.length>0?l.jsxs(Xt,{value:c||"all-sales-data",onValueChange:u,children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Choose sales data"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"all-sales-data",children:"All Sales Data (Recommended)"}),r.map(N=>l.jsxs(Je,{value:N.id,children:[N.month," ",N.year," (",N.data?.length||0," records)"]},N.id))]})]}):l.jsx("div",{className:"p-3 border border-gray-200 rounded-md bg-gray-50 text-gray-500 text-sm",children:"No sales data available. Please upload sales data first."}),V&&l.jsx("div",{className:"mt-2 p-3 bg-blue-50 rounded-md",children:l.jsxs("div",{className:"text-sm space-y-1 text-blue-700",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"File:"})," ",V.fileName]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Period:"})," ",V.month," ",V.year]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Records:"})," ",V.data?.length||0]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Uploaded:"})," ",new Date(V.uploadedAt).toLocaleDateString()]})]})}),(!c||c==="all-sales-data")&&r.length>0&&l.jsx("div",{className:"mt-2 p-3 bg-green-50 rounded-md border border-green-200",children:l.jsxs("div",{className:"text-sm space-y-1 text-green-700",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:" All Sales Data Selected:"})," The system will use all available sales data"]}),l.jsxs("p",{className:"text-xs",children:["Available periods: ",r.map(N=>`${N.month} ${N.year}`).join(", ")," (",r.reduce((N,X)=>N+(X.data?.length||0),0)," total records)"]})]})}),c&&c!=="all-sales-data"&&V&&l.jsx("div",{className:"mt-2 p-3 bg-blue-50 rounded-md border border-blue-200",children:l.jsxs("div",{className:"text-sm space-y-1 text-blue-700",children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:" Specific Period Selected:"})," ",V.month," ",V.year]}),l.jsxs("p",{className:"text-xs",children:["Records: ",V.data?.length||0,"  Uploaded: ",new Date(V.uploadedAt).toLocaleDateString()]})]})})]})]}),e.length===0&&l.jsxs(At,{children:[l.jsx(nl,{className:"h-4 w-4"}),l.jsx(jt,{children:"No schemes found. Please create a scheme first before calculating commissions."})]}),r.length===0&&l.jsxs(At,{children:[l.jsx(Ts,{className:"h-4 w-4"}),l.jsx(jt,{children:"No sales data found. Please upload sales data first before calculating commissions."})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs(be,{onClick:k,variant:"outline",size:"sm",disabled:h,children:[l.jsx(dr,{className:`h-4 w-4 mr-2 ${h?"animate-spin":""}`}),"Refresh Data"]}),l.jsx(be,{onClick:async()=>{try{console.log("Testing debug endpoint...");const N=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/debug/route-test`,X=await fetch(N,{headers:{Authorization:`Bearer ${Fr}`}});console.log("Debug test result:",{status:X.status,ok:X.ok,result:X.ok?await X.json():await X.text()}),fe.success("Debug endpoint test completed - check console")}catch(N){console.error("Debug test failed:",N),fe.error("Debug endpoint test failed")}},variant:"outline",size:"sm",children:"Test Debug"})]}),l.jsxs(be,{onClick:E,disabled:!i||r.length===0||h,size:"lg",className:"bg-blue-600 hover:bg-blue-700 text-white",children:[l.jsx(US,{className:"h-4 w-4 mr-2"}),h?"Calculating...":"Calculate Commission"]})]})]})]}),l.jsxs(Hi,{defaultValue:"results",className:"w-full",children:[l.jsxs(Gi,{className:"grid w-full grid-cols-2",children:[l.jsx(kt,{value:"results",children:"All Calculation Results"}),l.jsx(kt,{value:"current",children:"Latest Calculation"})]}),l.jsxs(bt,{value:"results",className:"space-y-4",children:[l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:l.jsx("div",{className:"w-full md:w-64",children:l.jsxs(Xt,{value:v,onValueChange:g,children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Filter by scheme"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"all",children:"All Schemes"}),e.map(N=>l.jsx(Je,{value:N.id,children:N.name},N.id))]})]})})})})}),l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center justify-between",children:[l.jsxs("span",{children:["Calculation History (",S.length,")"]}),l.jsxs(be,{onClick:k,variant:"outline",size:"sm",disabled:h,children:[l.jsx(dr,{className:`h-4 w-4 mr-2 ${h?"animate-spin":""}`}),"Refresh"]})]})}),l.jsx(je,{children:S.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Ts,{className:"h-16 w-16 mx-auto text-gray-400 mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s.length===0?"No Calculations Yet":"No Results Found"}),l.jsx("p",{className:"text-gray-500 mb-6",children:s.length===0?"Create schemes and upload sales data to start calculating commissions.":"Try adjusting your filter criteria."})]}):l.jsx("div",{className:"space-y-4",children:S.sort((N,X)=>new Date(X.calculatedAt).getTime()-new Date(N.calculatedAt).getTime()).map(N=>{const X=e.find(J=>J.id===N.schemeId),le=r.find(J=>J.id===N.uploadId);return l.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-lg",children:X?.name||"Unknown Scheme"}),l.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mt-1",children:[l.jsxs("span",{children:["Calculated: ",new Date(N.calculatedAt).toLocaleDateString()]}),le&&l.jsxs("span",{children:["Sales Period: ",le.month," ",le.year]}),!le&&l.jsx("span",{children:"Used: All Sales Data"}),l.jsxs("span",{children:["Detailed Records: ",N.calculations.length]}),N.totalDistributorArticleCombinations&&l.jsxs("span",{children:["Distributor-Article Combinations: ",N.totalDistributorArticleCombinations]}),N.calculationType&&l.jsx(pt,{variant:"outline",children:N.calculationType})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["",N.totalCommission.toLocaleString()]}),l.jsx("div",{className:"text-sm text-gray-500",children:"Total Commission"})]}),l.jsxs("div",{className:"flex flex-col space-y-2",children:[l.jsx(be,{onClick:()=>d(N),variant:"outline",size:"sm",children:"View Detail"}),l.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.jsx(be,{onClick:()=>pk(N,e,r),variant:"outline",size:"sm",title:"Export Detailed Records",children:l.jsx(La,{className:"h-4 w-4"})}),N.distributorArticleSummary&&N.distributorArticleSummary.length>0&&l.jsx(be,{onClick:()=>mk(N,e,r),variant:"outline",size:"sm",title:"Export Distributor-Article Summary",children:l.jsx(Fo,{className:"h-4 w-4"})}),l.jsx(be,{onClick:()=>xk([N],e,r),variant:"outline",size:"sm",title:"Export Distributor+Article Level",children:l.jsx(Ma,{className:"h-4 w-4"})}),l.jsx(be,{onClick:()=>gk([N],e,r),variant:"outline",size:"sm",title:"Export Scheme+Distributor Level",children:l.jsx(nl,{className:"h-4 w-4"})})]})]})]})]})},N.id)})})})]})]}),l.jsx(bt,{value:"current",className:"space-y-4",children:l.jsx(jI,{currentCalculation:f,schemes:e,uploads:r})})]})]})}var Jd="Dialog",[vk,yk]=oa(Jd),[FI,ms]=vk(Jd),wk=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:a,modal:i=!0}=e,o=T.useRef(null),c=T.useRef(null),[u,f]=Ai({prop:n,defaultProp:s??!1,onChange:a,caller:Jd});return l.jsx(FI,{scope:t,triggerRef:o,contentRef:c,contentId:Ys(),titleId:Ys(),descriptionId:Ys(),open:u,onOpenChange:f,onOpenToggle:T.useCallback(()=>f(d=>!d),[f]),modal:i,children:r})};wk.displayName=Jd;var _k="DialogTrigger",Sk=T.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ms(_k,r),a=Ct(t,s.triggerRef);return l.jsx(Ze.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":kx(s.open),...n,ref:a,onClick:nt(e.onClick,s.onOpenToggle)})});Sk.displayName=_k;var _x="DialogPortal",[RI,kk]=vk(_x,{forceMount:void 0}),bk=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,a=ms(_x,t);return l.jsx(RI,{scope:t,forceMount:r,children:T.Children.map(n,i=>l.jsx(hl,{present:r||a.open,children:l.jsx(cx,{asChild:!0,container:s,children:i})}))})};bk.displayName=_x;var od="DialogOverlay",Ek=T.forwardRef((e,t)=>{const r=kk(od,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=ms(od,e.__scopeDialog);return a.modal?l.jsx(hl,{present:n||a.open,children:l.jsx(II,{...s,ref:t})}):null});Ek.displayName=od;var PI=tl("DialogOverlay.RemoveScroll"),II=T.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ms(od,r);return l.jsx(ux,{as:PI,allowPinchZoom:!0,shards:[s.contentRef],children:l.jsx(Ze.div,{"data-state":kx(s.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Pi="DialogContent",Tk=T.forwardRef((e,t)=>{const r=kk(Pi,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=ms(Pi,e.__scopeDialog);return l.jsx(hl,{present:n||a.open,children:a.modal?l.jsx(OI,{...s,ref:t}):l.jsx(LI,{...s,ref:t})})});Tk.displayName=Pi;var OI=T.forwardRef((e,t)=>{const r=ms(Pi,e.__scopeDialog),n=T.useRef(null),s=Ct(t,r.contentRef,n);return T.useEffect(()=>{const a=n.current;if(a)return nS(a)},[]),l.jsx(Ck,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:nt(e.onCloseAutoFocus,a=>{a.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:nt(e.onPointerDownOutside,a=>{const i=a.detail.originalEvent,o=i.button===0&&i.ctrlKey===!0;(i.button===2||o)&&a.preventDefault()}),onFocusOutside:nt(e.onFocusOutside,a=>a.preventDefault())})}),LI=T.forwardRef((e,t)=>{const r=ms(Pi,e.__scopeDialog),n=T.useRef(!1),s=T.useRef(!1);return l.jsx(Ck,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{e.onCloseAutoFocus?.(a),a.defaultPrevented||(n.current||r.triggerRef.current?.focus(),a.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:a=>{e.onInteractOutside?.(a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const i=a.target;r.triggerRef.current?.contains(i)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}})}),Ck=T.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:a,...i}=e,o=ms(Pi,r),c=T.useRef(null),u=Ct(t,c);return A_(),l.jsxs(l.Fragment,{children:[l.jsx(ex,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:a,children:l.jsx(Zm,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":kx(o.open),...i,ref:u,onDismiss:()=>o.onOpenChange(!1)})}),l.jsxs(l.Fragment,{children:[l.jsx(BI,{titleId:o.titleId}),l.jsx($I,{contentRef:c,descriptionId:o.descriptionId})]})]})}),Sx="DialogTitle",Nk=T.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ms(Sx,r);return l.jsx(Ze.h2,{id:s.titleId,...n,ref:t})});Nk.displayName=Sx;var Ak="DialogDescription",jk=T.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ms(Ak,r);return l.jsx(Ze.p,{id:s.descriptionId,...n,ref:t})});jk.displayName=Ak;var Dk="DialogClose",Fk=T.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ms(Dk,r);return l.jsx(Ze.button,{type:"button",...n,ref:t,onClick:nt(e.onClick,()=>s.onOpenChange(!1))})});Fk.displayName=Dk;function kx(e){return e?"open":"closed"}var Rk="DialogTitleWarning",[MI,Pk]=EN(Rk,{contentName:Pi,titleName:Sx,docsSlug:"dialog"}),BI=({titleId:e})=>{const t=Pk(Rk),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return T.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},UI="DialogDescriptionWarning",$I=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Pk(UI).contentName}}.`;return T.useEffect(()=>{const s=e.current?.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},zI=wk,WI=Sk,VI=bk,HI=Ek,GI=Tk,XI=Nk,KI=jk,Ik=Fk,Ok="AlertDialog",[qI,IV]=oa(Ok,[yk]),la=yk(),Lk=e=>{const{__scopeAlertDialog:t,...r}=e,n=la(t);return l.jsx(zI,{...n,...r,modal:!0})};Lk.displayName=Ok;var YI="AlertDialogTrigger",Mk=T.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=la(r);return l.jsx(WI,{...s,...n,ref:t})});Mk.displayName=YI;var JI="AlertDialogPortal",Bk=e=>{const{__scopeAlertDialog:t,...r}=e,n=la(t);return l.jsx(VI,{...n,...r})};Bk.displayName=JI;var QI="AlertDialogOverlay",Uk=T.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=la(r);return l.jsx(HI,{...s,...n,ref:t})});Uk.displayName=QI;var Wo="AlertDialogContent",[ZI,e8]=qI(Wo),t8=_N("AlertDialogContent"),$k=T.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...s}=e,a=la(r),i=T.useRef(null),o=Ct(t,i),c=T.useRef(null);return l.jsx(MI,{contentName:Wo,titleName:zk,docsSlug:"alert-dialog",children:l.jsx(ZI,{scope:r,cancelRef:c,children:l.jsxs(GI,{role:"alertdialog",...a,...s,ref:o,onOpenAutoFocus:nt(s.onOpenAutoFocus,u=>{u.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[l.jsx(t8,{children:n}),l.jsx(n8,{contentRef:i})]})})})});$k.displayName=Wo;var zk="AlertDialogTitle",Wk=T.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=la(r);return l.jsx(XI,{...s,...n,ref:t})});Wk.displayName=zk;var Vk="AlertDialogDescription",Hk=T.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=la(r);return l.jsx(KI,{...s,...n,ref:t})});Hk.displayName=Vk;var r8="AlertDialogAction",Gk=T.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=la(r);return l.jsx(Ik,{...s,...n,ref:t})});Gk.displayName=r8;var Xk="AlertDialogCancel",Kk=T.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:s}=e8(Xk,r),a=la(r),i=Ct(t,s);return l.jsx(Ik,{...a,...n,ref:i})});Kk.displayName=Xk;var n8=({contentRef:e})=>{const t=`\`${Wo}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Wo}\` by passing a \`${Vk}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Wo}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return T.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},s8=Lk,a8=Mk,i8=Bk,o8=Uk,l8=$k,c8=Gk,u8=Kk,f8=Wk,d8=Hk;function h8({...e}){return l.jsx(s8,{"data-slot":"alert-dialog",...e})}function p8({...e}){return l.jsx(a8,{"data-slot":"alert-dialog-trigger",...e})}function m8({...e}){return l.jsx(i8,{"data-slot":"alert-dialog-portal",...e})}function x8({className:e,...t}){return l.jsx(o8,{"data-slot":"alert-dialog-overlay",className:tt("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function g8({className:e,...t}){return l.jsxs(m8,{children:[l.jsx(x8,{}),l.jsx(l8,{"data-slot":"alert-dialog-content",className:tt("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...t})]})}function v8({className:e,...t}){return l.jsx("div",{"data-slot":"alert-dialog-header",className:tt("flex flex-col gap-2 text-center sm:text-left",e),...t})}function y8({className:e,...t}){return l.jsx("div",{"data-slot":"alert-dialog-footer",className:tt("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function w8({className:e,...t}){return l.jsx(f8,{"data-slot":"alert-dialog-title",className:tt("text-lg font-semibold",e),...t})}function _8({className:e,...t}){return l.jsx(d8,{"data-slot":"alert-dialog-description",className:tt("text-muted-foreground text-sm",e),...t})}function S8({className:e,...t}){return l.jsx(c8,{className:tt(Ym(),e),...t})}function k8({className:e,...t}){return l.jsx(u8,{className:tt(Ym({variant:"outline"}),e),...t})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var zc={};zc.version="0.18.5";var Cn=1200,Ii=1252,b8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],bx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Qd=function(e){b8.indexOf(e)!=-1&&(Ii=bx[0]=e)};function E8(){Qd(1252)}var zn=function(e){Cn=e,Qd(e)};function Zd(){zn(1200),E8()}function ld(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function T8(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function qk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ro=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?T8(e.slice(2)):t==254&&r==255?qk(e.slice(2)):t==65279?e.slice(1):e},Gl=function(t){return String.fromCharCode(t)},zp=function(t){return String.fromCharCode(t)},ht;function C8(e){ht=e,zn=function(t){Cn=t,Qd(t)},Ro=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?ht.utils.decode(1200,ld(t.slice(2))):t},Gl=function(r){return Cn===1200?String.fromCharCode(r):ht.utils.decode(Cn,[r&255,r>>8])[0]},zp=function(r){return ht.utils.decode(Ii,[r])[0]},bb()}var Ea="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Wc(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=Ea.charAt(a)+Ea.charAt(i)+Ea.charAt(o)+Ea.charAt(c);return t}function An(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=Ea.indexOf(e.charAt(u++)),i=Ea.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=Ea.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Ea.indexOf(e.charAt(u++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ca=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Va(e){return Qe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function C1(e){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Sn=function(t){return Qe?ca(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function hu(e){if(typeof ArrayBuffer>"u")return Sn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function ei(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function N8(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Ex(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ex(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Er=Qe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ca(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function A8(e){for(var t=[],r=0,n=e.length+250,s=Va(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Va(65535),n=65530)}return t.push(s.slice(0,r)),Er(t)}var Hr=/\u0000/g,Xl=/[\u0001-\u0006]/g;function Vo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function os(e,t){var r=""+e;return r.length>=t?r:Qt("0",t-r.length)+r}function Tx(e,t){var r=""+e;return r.length>=t?r:Qt(" ",t-r.length)+r}function cd(e,t){var r=""+e;return r.length>=t?r:r+Qt(" ",t-r.length)}function j8(e,t){var r=""+Math.round(e);return r.length>=t?r:Qt("0",t-r.length)+r}function D8(e,t){var r=""+e;return r.length>=t?r:Qt("0",t-r.length)+r}var N1=Math.pow(2,32);function po(e,t){if(e>N1||e<-N1)return j8(e,t);var r=Math.round(e);return D8(r,t)}function ud(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var A1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],lh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function F8(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Pe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},j1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},R8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function fd(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,u=0,f=0,d=Math.floor(s);u<t&&(d=Math.floor(s),o=d*i+a,f=d*u+c,!(s-d<5e-8));)s=1/(s-d),a=i,i=o,c=u,u=f;if(f>t&&(u>t?(f=c,o=a):(f=u,o=i)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function Ta(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=B8(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var Yk=new Date(1899,11,31,0,0,0),P8=Yk.getTime(),I8=new Date(1900,2,1,0,0,0);function Jk(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=I8&&(r+=24*60*60*1e3),(r-(P8+(e.getTimezoneOffset()-Yk.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Cx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function O8(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function L8(e){var t=e<0?12:11,r=Cx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function M8(e){var t=Cx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Vc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=L8(e):t===10?r=e.toFixed(10).substr(0,12):r=M8(e),Cx(O8(r.toUpperCase()))}function Oi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Vc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return jn(14,Jk(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function B8(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function U8(e,t,r,n){var s="",a=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return lh[r.m-1][1];case 5:return lh[r.m-1][0];default:return lh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return A1[r.q][0];default:return A1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?os(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=os(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var f=u>0?os(c,u):"";return f}function Ca(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Qk=/%/g;function $8(e,t,r){var n=t.replace(Qk,""),s=t.length-n.length;return Js(e,n,r*Math.pow(10,2*s))+Qt("%",s)}function z8(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Js(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Zk(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Zk(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var eb=/# (\?+)( ?)\/( ?)(\d+)/;function W8(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Qt(" ",e[1].length+1+e[4].length):Tx(i,e[1].length)+e[2]+"/"+e[3]+os(o,e[4].length))}function V8(e,t,r){return r+(t===0?"":""+t)+Qt(" ",e[1].length+2+e[4].length)}var tb=/^#*0*\.([0#]+)/,rb=/\).*[0#]/,nb=/\(###\) ###\\?-####/;function en(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function D1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function F1(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function H8(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function G8(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Pn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(rb)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Pn("n",n,r):"("+Pn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return z8(e,t,r);if(t.indexOf("%")!==-1)return $8(e,t,r);if(t.indexOf("E")!==-1)return Zk(t,r);if(t.charCodeAt(0)===36)return"$"+Pn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+po(c,t.length);if(t.match(/^[#?]+$/))return s=po(r,0),s==="0"&&(s=""),s.length>t.length?s:en(t.substr(0,t.length-s.length))+s;if(a=t.match(eb))return W8(a,c,u);if(t.match(/^#+0+$/))return u+po(c,t.length-t.indexOf("0"));if(a=t.match(tb))return s=D1(r,a[1].length).replace(/^([^\.]+)$/,"$1."+en(a[1])).replace(/\.$/,"."+en(a[1])).replace(/\.(\d*)$/,function(x,m){return"."+m+Qt("0",en(a[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+D1(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Ca(po(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Pn(e,t,-r):Ca(""+(Math.floor(r)+H8(r,a[1].length)))+"."+os(F1(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Pn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Vo(Pn(e,t.replace(/[\\-]/g,""),r)),i=0,Vo(Vo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(nb))return s=Pn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=fd(c,Math.pow(10,i)-1,!1),s=""+u,f=Js("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=cd(o[2],i),f.length<a[4].length&&(f=en(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=fd(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Tx(o[1],i)+a[2]+"/"+a[3]+cd(o[2],i):Qt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=po(r,0),t.length<=s.length?s:en(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,h=t.length-s.length-d;return en(t.substr(0,d)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=F1(r,a[1].length),r<0?"-"+Pn(e,t,-r):Ca(G8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?os(0,3-x.length):"")+x})+"."+os(i,a[1].length);switch(t){case"###,##0.00":return Pn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Ca(po(c,0));return p!=="0"?u+p:"";case"###,###.00":return Pn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Pn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function X8(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Js(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function K8(e,t,r){var n=t.replace(Qk,""),s=t.length-n.length;return Js(e,n,r*Math.pow(10,2*s))+Qt("%",s)}function sb(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+sb(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ys(e,t,r){if(e.charCodeAt(0)===40&&!t.match(rb)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ys("n",n,r):"("+ys("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return X8(e,t,r);if(t.indexOf("%")!==-1)return K8(e,t,r);if(t.indexOf("E")!==-1)return sb(t,r);if(t.charCodeAt(0)===36)return"$"+ys(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+os(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:en(t.substr(0,t.length-s.length))+s;if(a=t.match(eb))return V8(a,c,u);if(t.match(/^#+0+$/))return u+os(c,t.length-t.indexOf("0"));if(a=t.match(tb))return s=(""+r).replace(/^([^\.]+)$/,"$1."+en(a[1])).replace(/\.$/,"."+en(a[1])),s=s.replace(/\.(\d*)$/,function(x,m){return"."+m+Qt("0",en(a[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Ca(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ys(e,t,-r):Ca(""+r)+"."+Qt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return ys(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Vo(ys(e,t.replace(/[\\-]/g,""),r)),i=0,Vo(Vo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(nb))return s=ys(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=fd(c,Math.pow(10,i)-1,!1),s=""+u,f=Js("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=cd(o[2],i),f.length<a[4].length&&(f=en(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=fd(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Tx(o[1],i)+a[2]+"/"+a[3]+cd(o[2],i):Qt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:en(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,h=t.length-s.length-d;return en(t.substr(0,d)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ys(e,t,-r):Ca(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?os(0,3-x.length):"")+x})+"."+os(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Ca(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return ys(e,t.slice(0,t.lastIndexOf(".")),r)+en(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Js(e,t,r){return(r|0)===r?ys(e,t,r):Pn(e,t,r)}function q8(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ab=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ki(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ud(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(ab))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Y8(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",u,f,d,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!ud(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(d=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(d);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Ta(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ta(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var m={t:o,v:o};if(u==null&&(u=Ta(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",i+=5,h="h"):(m.t="t",++i),u==null&&m.t==="T")return"";s[s.length]=m,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(ab)){if(u==null&&(u=Ta(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ki(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var v=0,g=0,w;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=h,c="h",v<1&&(v=1);break;case"s":(w=s[i].v.match(/\.0+$/))&&(g=Math.max(g,w[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[i].v.match(/[Hh]/)&&(v=1),v<2&&s[i].v.match(/[Mm]/)&&(v=2),v<3&&s[i].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",k;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=U8(s[i].t.charCodeAt(0),s[i].v,u,g),s[i].t="t";break;case"n":case"?":for(k=i+1;s[k]!=null&&((o=s[k].t)==="?"||o==="D"||(o===" "||o==="t")&&s[k+1]!=null&&(s[k+1].t==="?"||s[k+1].t==="t"&&s[k+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[k].v==="/"||s[k].v===" "&&s[k+1]!=null&&s[k+1].t=="?"));)s[i].v+=s[k].v,s[k]={v:"",t:";"},++k;y+=s[i].v,i=k-1;break;case"G":s[i].t="t",s[i].v=Oi(t,r);break}var E="",S,_;if(y.length>0){y.charCodeAt(0)==40?(S=t<0&&y.charCodeAt(0)===45?-t:t,_=Js("n",y,S)):(S=t<0&&n>1?-t:t,_=Js("n",y,S),S<0&&s[0]&&s[0].t=="t"&&(_=_.substr(1),s[0].v="-"+s[0].v)),k=_.length-1;var A=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){A=i;break}var F=s.length;if(A===s.length&&_.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(k>=s[i].v.length-1?(k-=s[i].v.length,s[i].v=_.substr(k+1,s[i].v.length)):k<0?s[i].v="":(s[i].v=_.substr(0,k+1),k=-1),s[i].t="t",F=i);k>=0&&F<s.length&&(s[F].v=_.substr(0,k+1)+s[F].v)}else if(A!==s.length&&_.indexOf("E")===-1){for(k=_.indexOf(".")-1,i=A;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===A?s[i].v.indexOf(".")-1:s[i].v.length-1,E=s[i].v.substr(f+1);f>=0;--f)k>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(E=_.charAt(k--)+E);s[i].v=E,s[i].t="t",F=i}for(k>=0&&F<s.length&&(s[F].v=_.substr(0,k+1)+s[F].v),k=_.indexOf(".")+1,i=A;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==A)){for(f=s[i].v.indexOf(".")>-1&&i===A?s[i].v.indexOf(".")+1:0,E=s[i].v.substr(0,f);f<s[i].v.length;++f)k<_.length&&(E+=_.charAt(k++));s[i].v=E,s[i].t="t",F=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(S=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Js(s[i].t,s[i].v,S),s[i].t="t");var U="";for(i=0;i!==s.length;++i)s[i]!=null&&(U+=s[i].v);return U}var R1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function P1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function J8(e,t){var r=q8(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(R1),o=r[1].match(R1);return P1(t,i)?[n,r[0]]:P1(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function jn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Pe)[e],n==null&&(n=r.table&&r.table[j1[e]]||Pe[j1[e]]),n==null&&(n=R8[e]||"General");break}if(ud(n,0))return Oi(t,r);t instanceof Date&&(t=Jk(t,r.date1904));var s=J8(n,t);if(ud(s[1]))return Oi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Y8(s[1],t,r,s[0])}function Rs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Pe[r]==null){t<0&&(t=r);continue}if(Pe[r]==e){t=r;break}}t<0&&(t=391)}return Pe[t]=e,t}function pu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Rs(e[t],t)}function wl(){Pe=F8()}var ib={format:jn,load:Rs,_table:Pe,load_table:pu,parse_date_code:Ta,is_date:Ki,get_table:function(){return ib._table=Pe}},Q8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ob=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Z8(e){var t=typeof e=="number"?Pe[e]:e;return t=t.replace(ob,"(\\d+)"),new RegExp("^"+t+"$")}function e6(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(ob)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":c=p;break;case"m":i>=0?o=p:s=p;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&s==-1&&a==-1?f:u+"T"+f}var t6=function(){var e={};e.version="1.2.0";function t(){for(var _=0,A=new Array(256),F=0;F!=256;++F)_=F,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,A[F]=_;return typeof Int32Array<"u"?new Int32Array(A):A}var r=t();function n(_){var A=0,F=0,U=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)V[U]=_[U];for(U=0;U!=256;++U)for(F=_[U],A=256+U;A<4096;A+=256)F=V[A]=F>>>8^_[F&255];var N=[];for(U=1;U!=16;++U)N[U-1]=typeof Int32Array<"u"?V.subarray(U*256,U*256+256):V.slice(U*256,U*256+256);return N}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],u=s[4],f=s[5],d=s[6],h=s[7],p=s[8],x=s[9],m=s[10],v=s[11],g=s[12],w=s[13],y=s[14];function k(_,A){for(var F=A^-1,U=0,V=_.length;U<V;)F=F>>>8^r[(F^_.charCodeAt(U++))&255];return~F}function E(_,A){for(var F=A^-1,U=_.length-15,V=0;V<U;)F=y[_[V++]^F&255]^w[_[V++]^F>>8&255]^g[_[V++]^F>>16&255]^v[_[V++]^F>>>24]^m[_[V++]]^x[_[V++]]^p[_[V++]]^h[_[V++]]^d[_[V++]]^f[_[V++]]^u[_[V++]]^c[_[V++]]^o[_[V++]]^i[_[V++]]^a[_[V++]]^r[_[V++]];for(U+=15;V<U;)F=F>>>8^r[(F^_[V++])&255];return~F}function S(_,A){for(var F=A^-1,U=0,V=_.length,N=0,X=0;U<V;)N=_.charCodeAt(U++),N<128?F=F>>>8^r[(F^N)&255]:N<2048?(F=F>>>8^r[(F^(192|N>>6&31))&255],F=F>>>8^r[(F^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,X=_.charCodeAt(U++)&1023,F=F>>>8^r[(F^(240|N>>8&7))&255],F=F>>>8^r[(F^(128|N>>2&63))&255],F=F>>>8^r[(F^(128|X>>6&15|(N&3)<<4))&255],F=F>>>8^r[(F^(128|X&63))&255]):(F=F>>>8^r[(F^(224|N>>12&15))&255],F=F>>>8^r[(F^(128|N>>6&63))&255],F=F>>>8^r[(F^(128|N&63))&255]);return~F}return e.table=r,e.bstr=k,e.buf=E,e.str=S,e}(),Re=function(){var t={};t.version="1.2.1";function r(j,L){for(var I=j.split("/"),O=L.split("/"),M=0,B=0,ie=Math.min(I.length,O.length);M<ie;++M){if(B=I[M].length-O[M].length)return B;if(I[M]!=O[M])return I[M]<O[M]?-1:1}return I.length-O.length}function n(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:n(j.slice(0,-1));var L=j.lastIndexOf("/");return L===-1?j:j.slice(0,L+1)}function s(j){if(j.charAt(j.length-1)=="/")return s(j.slice(0,-1));var L=j.lastIndexOf("/");return L===-1?j:j.slice(L+1)}function a(j,L){typeof L=="string"&&(L=new Date(L));var I=L.getHours();I=I<<6|L.getMinutes(),I=I<<5|L.getSeconds()>>>1,j.write_shift(2,I);var O=L.getFullYear()-1980;O=O<<4|L.getMonth()+1,O=O<<5|L.getDate(),j.write_shift(2,O)}function i(j){var L=j.read_shift(2)&65535,I=j.read_shift(2)&65535,O=new Date,M=I&31;I>>>=5;var B=I&15;I>>>=4,O.setMilliseconds(0),O.setFullYear(I+1980),O.setMonth(B-1),O.setDate(M);var ie=L&31;L>>>=5;var he=L&63;return L>>>=6,O.setHours(L),O.setMinutes(he),O.setSeconds(ie<<1),O}function o(j){jr(j,0);for(var L={},I=0;j.l<=j.length-4;){var O=j.read_shift(2),M=j.read_shift(2),B=j.l+M,ie={};switch(O){case 21589:I=j.read_shift(1),I&1&&(ie.mtime=j.read_shift(4)),M>5&&(I&2&&(ie.atime=j.read_shift(4)),I&4&&(ie.ctime=j.read_shift(4))),ie.mtime&&(ie.mt=new Date(ie.mtime*1e3));break}j.l=B,L[O]=ie}return L}var c;function u(){return c||(c={})}function f(j,L){if(j[0]==80&&j[1]==75)return ku(j,L);if((j[0]|32)==109&&(j[1]|32)==105)return pr(j,L);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var I=3,O=512,M=0,B=0,ie=0,he=0,ne=0,oe=[],ue=j.slice(0,512);jr(ue,0);var ge=d(ue);switch(I=ge[0],I){case 3:O=512;break;case 4:O=4096;break;case 0:if(ge[1]==0)return ku(j,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}O!==512&&(ue=j.slice(0,O),jr(ue,28));var Ee=j.slice(0,O);h(ue,I);var Ce=ue.read_shift(4,"i");if(I===3&&Ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ce);ue.l+=4,ie=ue.read_shift(4,"i"),ue.l+=4,ue.chk("00100000","Mini Stream Cutoff Size: "),he=ue.read_shift(4,"i"),M=ue.read_shift(4,"i"),ne=ue.read_shift(4,"i"),B=ue.read_shift(4,"i");for(var we=-1,Te=0;Te<109&&(we=ue.read_shift(4,"i"),!(we<0));++Te)oe[Te]=we;var Ge=p(j,O);v(ne,B,Ge,O,oe);var Ut=w(Ge,ie,oe,O);Ut[ie].name="!Directory",M>0&&he!==X&&(Ut[he].name="!MiniFAT"),Ut[oe[0]].name="!FAT",Ut.fat_addrs=oe,Ut.ssz=O;var $t={},Or=[],El=[],Tl=[];y(ie,Ut,Ge,Or,M,$t,El,he),x(El,Tl,Or),Or.shift();var Cl={FileIndex:El,FullPaths:Tl};return L&&L.raw&&(Cl.raw={header:Ee,sectors:Ge}),Cl}function d(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(le,"Header Signature: "),j.l+=16;var L=j.read_shift(2,"u");return[j.read_shift(2,"u"),L]}function h(j,L){var I=9;switch(j.l+=2,I=j.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function p(j,L){for(var I=Math.ceil(j.length/L)-1,O=[],M=1;M<I;++M)O[M-1]=j.slice(M*L,(M+1)*L);return O[I-1]=j.slice(I*L),O}function x(j,L,I){for(var O=0,M=0,B=0,ie=0,he=0,ne=I.length,oe=[],ue=[];O<ne;++O)oe[O]=ue[O]=O,L[O]=I[O];for(;he<ue.length;++he)O=ue[he],M=j[O].L,B=j[O].R,ie=j[O].C,oe[O]===O&&(M!==-1&&oe[M]!==M&&(oe[O]=oe[M]),B!==-1&&oe[B]!==B&&(oe[O]=oe[B])),ie!==-1&&(oe[ie]=O),M!==-1&&O!=oe[O]&&(oe[M]=oe[O],ue.lastIndexOf(M)<he&&ue.push(M)),B!==-1&&O!=oe[O]&&(oe[B]=oe[O],ue.lastIndexOf(B)<he&&ue.push(B));for(O=1;O<ne;++O)oe[O]===O&&(B!==-1&&oe[B]!==B?oe[O]=oe[B]:M!==-1&&oe[M]!==M&&(oe[O]=oe[M]));for(O=1;O<ne;++O)if(j[O].type!==0){if(he=O,he!=oe[he])do he=oe[he],L[O]=L[he]+"/"+L[O];while(he!==0&&oe[he]!==-1&&he!=oe[he]);oe[O]=-1}for(L[0]+="/",O=1;O<ne;++O)j[O].type!==2&&(L[O]+="/")}function m(j,L,I){for(var O=j.start,M=j.size,B=[],ie=O;I&&M>0&&ie>=0;)B.push(L.slice(ie*N,ie*N+N)),M-=N,ie=fi(I,ie*4);return B.length===0?de(0):Er(B).slice(0,j.size)}function v(j,L,I,O,M){var B=X;if(j===X){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var ie=I[j],he=(O>>>2)-1;if(!ie)return;for(var ne=0;ne<he&&(B=fi(ie,ne*4))!==X;++ne)M.push(B);v(fi(ie,O-4),L-1,I,O,M)}}function g(j,L,I,O,M){var B=[],ie=[];M||(M=[]);var he=O-1,ne=0,oe=0;for(ne=L;ne>=0;){M[ne]=!0,B[B.length]=ne,ie.push(j[ne]);var ue=I[Math.floor(ne*4/O)];if(oe=ne*4&he,O<4+oe)throw new Error("FAT boundary crossed: "+ne+" 4 "+O);if(!j[ue])break;ne=fi(j[ue],oe)}return{nodes:B,data:G1([ie])}}function w(j,L,I,O){var M=j.length,B=[],ie=[],he=[],ne=[],oe=O-1,ue=0,ge=0,Ee=0,Ce=0;for(ue=0;ue<M;++ue)if(he=[],Ee=ue+L,Ee>=M&&(Ee-=M),!ie[Ee]){ne=[];var we=[];for(ge=Ee;ge>=0;){we[ge]=!0,ie[ge]=!0,he[he.length]=ge,ne.push(j[ge]);var Te=I[Math.floor(ge*4/O)];if(Ce=ge*4&oe,O<4+Ce)throw new Error("FAT boundary crossed: "+ge+" 4 "+O);if(!j[Te]||(ge=fi(j[Te],Ce),we[ge]))break}B[Ee]={nodes:he,data:G1([ne])}}return B}function y(j,L,I,O,M,B,ie,he){for(var ne=0,oe=O.length?2:0,ue=L[j].data,ge=0,Ee=0,Ce;ge<ue.length;ge+=128){var we=ue.slice(ge,ge+128);jr(we,64),Ee=we.read_shift(2),Ce=n0(we,0,Ee-oe),O.push(Ce);var Te={name:Ce,type:we.read_shift(1),color:we.read_shift(1),L:we.read_shift(4,"i"),R:we.read_shift(4,"i"),C:we.read_shift(4,"i"),clsid:we.read_shift(16),state:we.read_shift(4,"i"),start:0,size:0},Ge=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);Ge!==0&&(Te.ct=k(we,we.l-8));var Ut=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);Ut!==0&&(Te.mt=k(we,we.l-8)),Te.start=we.read_shift(4,"i"),Te.size=we.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=X,Te.name=""),Te.type===5?(ne=Te.start,M>0&&ne!==X&&(L[ne].name="!StreamData")):Te.size>=4096?(Te.storage="fat",L[Te.start]===void 0&&(L[Te.start]=g(I,Te.start,L.fat_addrs,L.ssz)),L[Te.start].name=Te.name,Te.content=L[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:ne!==X&&Te.start!==X&&L[ne]&&(Te.content=m(Te,L[ne].data,(L[he]||{}).data))),Te.content&&jr(Te.content,0),B[Ce]=Te,ie.push(Te)}}function k(j,L){return new Date((br(j,L+4)/1e7*Math.pow(2,32)+br(j,L)/1e7-11644473600)*1e3)}function E(j,L){return u(),f(c.readFileSync(j),L)}function S(j,L){var I=L&&L.type;switch(I||Qe&&Buffer.isBuffer(j)&&(I="buffer"),I||"base64"){case"file":return E(j,L);case"base64":return f(Sn(An(j)),L);case"binary":return f(Sn(j),L)}return f(j,L)}function _(j,L){var I=L||{},O=I.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=O+"/",j.FileIndex[0]={name:O,type:5}),I.CLSID&&(j.FileIndex[0].clsid=I.CLSID),A(j)}function A(j){var L="Sh33tJ5";if(!Re.find(j,"/"+L)){var I=de(4);I[0]=55,I[1]=I[3]=50,I[2]=54,j.FileIndex.push({name:L,type:2,content:I,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+L),F(j)}}function F(j,L){_(j);for(var I=!1,O=!1,M=j.FullPaths.length-1;M>=0;--M){var B=j.FileIndex[M];switch(B.type){case 0:O?I=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(B.R*B.L*B.C)&&(I=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!L)){var ie=new Date(1987,1,19),he=0,ne=Object.create?Object.create(null):{},oe=[];for(M=0;M<j.FullPaths.length;++M)ne[j.FullPaths[M]]=!0,j.FileIndex[M].type!==0&&oe.push([j.FullPaths[M],j.FileIndex[M]]);for(M=0;M<oe.length;++M){var ue=n(oe[M][0]);O=ne[ue],O||(oe.push([ue,{name:s(ue).replace("/",""),type:1,clsid:Z,ct:ie,mt:ie,content:null}]),ne[ue]=!0)}for(oe.sort(function(Ce,we){return r(Ce[0],we[0])}),j.FullPaths=[],j.FileIndex=[],M=0;M<oe.length;++M)j.FullPaths[M]=oe[M][0],j.FileIndex[M]=oe[M][1];for(M=0;M<oe.length;++M){var ge=j.FileIndex[M],Ee=j.FullPaths[M];if(ge.name=s(Ee).replace("/",""),ge.L=ge.R=ge.C=-(ge.color=1),ge.size=ge.content?ge.content.length:0,ge.start=0,ge.clsid=ge.clsid||Z,M===0)ge.C=oe.length>1?1:-1,ge.size=0,ge.type=5;else if(Ee.slice(-1)=="/"){for(he=M+1;he<oe.length&&n(j.FullPaths[he])!=Ee;++he);for(ge.C=he>=oe.length?-1:he,he=M+1;he<oe.length&&n(j.FullPaths[he])!=n(Ee);++he);ge.R=he>=oe.length?-1:he,ge.type=1}else n(j.FullPaths[M+1]||"")==n(Ee)&&(ge.R=M+1),ge.type=2}}}function U(j,L){var I=L||{};if(I.fileType=="mad")return ln(j,I);switch(F(j),I.fileType){case"zip":return bu(j,I)}var O=function(Ce){for(var we=0,Te=0,Ge=0;Ge<Ce.FileIndex.length;++Ge){var Ut=Ce.FileIndex[Ge];if(Ut.content){var $t=Ut.content.length;$t>0&&($t<4096?we+=$t+63>>6:Te+=$t+511>>9)}}for(var Or=Ce.FullPaths.length+3>>2,El=we+7>>3,Tl=we+127>>7,Cl=El+Te+Or+Tl,si=Cl+127>>7,p0=si<=109?0:Math.ceil((si-109)/127);Cl+si+p0+127>>7>si;)p0=++si<=109?0:Math.ceil((si-109)/127);var $s=[1,p0,si,Tl,Or,Te,we,0];return Ce.FileIndex[0].size=we<<6,$s[7]=(Ce.FileIndex[0].start=$s[0]+$s[1]+$s[2]+$s[3]+$s[4]+$s[5])+($s[6]+7>>3),$s}(j),M=de(O[7]<<9),B=0,ie=0;{for(B=0;B<8;++B)M.write_shift(1,J[B]);for(B=0;B<8;++B)M.write_shift(2,0);for(M.write_shift(2,62),M.write_shift(2,3),M.write_shift(2,65534),M.write_shift(2,9),M.write_shift(2,6),B=0;B<3;++B)M.write_shift(2,0);for(M.write_shift(4,0),M.write_shift(4,O[2]),M.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),M.write_shift(4,0),M.write_shift(4,4096),M.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:X),M.write_shift(4,O[3]),M.write_shift(-4,O[1]?O[0]-1:X),M.write_shift(4,O[1]),B=0;B<109;++B)M.write_shift(-4,B<O[2]?O[1]+B:-1)}if(O[1])for(ie=0;ie<O[1];++ie){for(;B<236+ie*127;++B)M.write_shift(-4,B<O[2]?O[1]+B:-1);M.write_shift(-4,ie===O[1]-1?X:ie+1)}var he=function(Ce){for(ie+=Ce;B<ie-1;++B)M.write_shift(-4,B+1);Ce&&(++B,M.write_shift(-4,X))};for(ie=B=0,ie+=O[1];B<ie;++B)M.write_shift(-4,re.DIFSECT);for(ie+=O[2];B<ie;++B)M.write_shift(-4,re.FATSECT);he(O[3]),he(O[4]);for(var ne=0,oe=0,ue=j.FileIndex[0];ne<j.FileIndex.length;++ne)ue=j.FileIndex[ne],ue.content&&(oe=ue.content.length,!(oe<4096)&&(ue.start=ie,he(oe+511>>9)));for(he(O[6]+7>>3);M.l&511;)M.write_shift(-4,re.ENDOFCHAIN);for(ie=B=0,ne=0;ne<j.FileIndex.length;++ne)ue=j.FileIndex[ne],ue.content&&(oe=ue.content.length,!(!oe||oe>=4096)&&(ue.start=ie,he(oe+63>>6)));for(;M.l&511;)M.write_shift(-4,re.ENDOFCHAIN);for(B=0;B<O[4]<<2;++B){var ge=j.FullPaths[B];if(!ge||ge.length===0){for(ne=0;ne<17;++ne)M.write_shift(4,0);for(ne=0;ne<3;++ne)M.write_shift(4,-1);for(ne=0;ne<12;++ne)M.write_shift(4,0);continue}ue=j.FileIndex[B],B===0&&(ue.start=ue.size?ue.start-1:X);var Ee=B===0&&I.root||ue.name;if(oe=2*(Ee.length+1),M.write_shift(64,Ee,"utf16le"),M.write_shift(2,oe),M.write_shift(1,ue.type),M.write_shift(1,ue.color),M.write_shift(-4,ue.L),M.write_shift(-4,ue.R),M.write_shift(-4,ue.C),ue.clsid)M.write_shift(16,ue.clsid,"hex");else for(ne=0;ne<4;++ne)M.write_shift(4,0);M.write_shift(4,ue.state||0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,ue.start),M.write_shift(4,ue.size),M.write_shift(4,0)}for(B=1;B<j.FileIndex.length;++B)if(ue=j.FileIndex[B],ue.size>=4096)if(M.l=ue.start+1<<9,Qe&&Buffer.isBuffer(ue.content))ue.content.copy(M,M.l,0,ue.size),M.l+=ue.size+511&-512;else{for(ne=0;ne<ue.size;++ne)M.write_shift(1,ue.content[ne]);for(;ne&511;++ne)M.write_shift(1,0)}for(B=1;B<j.FileIndex.length;++B)if(ue=j.FileIndex[B],ue.size>0&&ue.size<4096)if(Qe&&Buffer.isBuffer(ue.content))ue.content.copy(M,M.l,0,ue.size),M.l+=ue.size+63&-64;else{for(ne=0;ne<ue.size;++ne)M.write_shift(1,ue.content[ne]);for(;ne&63;++ne)M.write_shift(1,0)}if(Qe)M.l=M.length;else for(;M.l<M.length;)M.write_shift(1,0);return M}function V(j,L){var I=j.FullPaths.map(function(ne){return ne.toUpperCase()}),O=I.map(function(ne){var oe=ne.split("/");return oe[oe.length-(ne.slice(-1)=="/"?2:1)]}),M=!1;L.charCodeAt(0)===47?(M=!0,L=I[0].slice(0,-1)+L):M=L.indexOf("/")!==-1;var B=L.toUpperCase(),ie=M===!0?I.indexOf(B):O.indexOf(B);if(ie!==-1)return j.FileIndex[ie];var he=!B.match(Xl);for(B=B.replace(Hr,""),he&&(B=B.replace(Xl,"!")),ie=0;ie<I.length;++ie)if((he?I[ie].replace(Xl,"!"):I[ie]).replace(Hr,"")==B||(he?O[ie].replace(Xl,"!"):O[ie]).replace(Hr,"")==B)return j.FileIndex[ie];return null}var N=64,X=-2,le="d0cf11e0a1b11ae1",J=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:X,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function te(j,L,I){u();var O=U(j,I);c.writeFileSync(L,O)}function z(j){for(var L=new Array(j.length),I=0;I<j.length;++I)L[I]=String.fromCharCode(j[I]);return L.join("")}function K(j,L){var I=U(j,L);switch(L&&L.type||"buffer"){case"file":return u(),c.writeFileSync(L.filename,I),I;case"binary":return typeof I=="string"?I:z(I);case"base64":return Wc(typeof I=="string"?I:z(I));case"buffer":if(Qe)return Buffer.isBuffer(I)?I:ca(I);case"array":return typeof I=="string"?Sn(I):I}return I}var se;function P(j){try{var L=j.InflateRaw,I=new L;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)se=j;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function b(j,L){if(!se)return to(j,L);var I=se.InflateRaw,O=new I,M=O._processChunk(j.slice(j.l),O._finishFlushFlag);return j.l+=O.bytesRead,M}function D(j){return se?se.deflateRawSync(j):We(j)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function H(j){var L=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(L>>16|L>>8|L)&255}for(var Q=typeof Uint8Array<"u",ee=Q?new Uint8Array(256):[],G=0;G<256;++G)ee[G]=H(G);function C(j,L){var I=ee[j&255];return L<=8?I>>>8-L:(I=I<<8|ee[j>>8&255],L<=16?I>>>16-L:(I=I<<8|ee[j>>16&255],I>>>24-L))}function pe(j,L){var I=L&7,O=L>>>3;return(j[O]|(I<=6?0:j[O+1]<<8))>>>I&3}function _e(j,L){var I=L&7,O=L>>>3;return(j[O]|(I<=5?0:j[O+1]<<8))>>>I&7}function Y(j,L){var I=L&7,O=L>>>3;return(j[O]|(I<=4?0:j[O+1]<<8))>>>I&15}function ae(j,L){var I=L&7,O=L>>>3;return(j[O]|(I<=3?0:j[O+1]<<8))>>>I&31}function ce(j,L){var I=L&7,O=L>>>3;return(j[O]|(I<=1?0:j[O+1]<<8))>>>I&127}function xe(j,L,I){var O=L&7,M=L>>>3,B=(1<<I)-1,ie=j[M]>>>O;return I<8-O||(ie|=j[M+1]<<8-O,I<16-O)||(ie|=j[M+2]<<16-O,I<24-O)||(ie|=j[M+3]<<24-O),ie&B}function De(j,L,I){var O=L&7,M=L>>>3;return O<=5?j[M]|=(I&7)<<O:(j[M]|=I<<O&255,j[M+1]=(I&7)>>8-O),L+3}function Ve(j,L,I){var O=L&7,M=L>>>3;return I=(I&1)<<O,j[M]|=I,L+1}function qe(j,L,I){var O=L&7,M=L>>>3;return I<<=O,j[M]|=I&255,I>>>=8,j[M+1]=I,L+8}function Oe(j,L,I){var O=L&7,M=L>>>3;return I<<=O,j[M]|=I&255,I>>>=8,j[M+1]=I&255,j[M+2]=I>>>8,L+16}function Ie(j,L){var I=j.length,O=2*I>L?2*I:L+5,M=0;if(I>=L)return j;if(Qe){var B=C1(O);if(j.copy)j.copy(B);else for(;M<j.length;++M)B[M]=j[M];return B}else if(Q){var ie=new Uint8Array(O);if(ie.set)ie.set(j);else for(;M<I;++M)ie[M]=j[M];return ie}return j.length=O,j}function ze(j){for(var L=new Array(j),I=0;I<j;++I)L[I]=0;return L}function Fe(j,L,I){var O=1,M=0,B=0,ie=0,he=0,ne=j.length,oe=Q?new Uint16Array(32):ze(32);for(B=0;B<32;++B)oe[B]=0;for(B=ne;B<I;++B)j[B]=0;ne=j.length;var ue=Q?new Uint16Array(ne):ze(ne);for(B=0;B<ne;++B)oe[M=j[B]]++,O<M&&(O=M),ue[B]=0;for(oe[0]=0,B=1;B<=O;++B)oe[B+16]=he=he+oe[B-1]<<1;for(B=0;B<ne;++B)he=j[B],he!=0&&(ue[B]=oe[he+16]++);var ge=0;for(B=0;B<ne;++B)if(ge=j[B],ge!=0)for(he=C(ue[B],O)>>O-ge,ie=(1<<O+4-ge)-1;ie>=0;--ie)L[he|ie<<ge]=ge&15|B<<4;return O}var ft=Q?new Uint16Array(512):ze(512),ir=Q?new Uint16Array(32):ze(32);if(!Q){for(var Gt=0;Gt<512;++Gt)ft[Gt]=0;for(Gt=0;Gt<32;++Gt)ir[Gt]=0}(function(){for(var j=[],L=0;L<32;L++)j.push(5);Fe(j,ir,32);var I=[];for(L=0;L<=143;L++)I.push(8);for(;L<=255;L++)I.push(9);for(;L<=279;L++)I.push(7);for(;L<=287;L++)I.push(8);Fe(I,ft,288)})();var on=function(){for(var L=Q?new Uint8Array(32768):[],I=0,O=0;I<q.length-1;++I)for(;O<q[I+1];++O)L[O]=I;for(;O<32768;++O)L[O]=29;var M=Q?new Uint8Array(259):[];for(I=0,O=0;I<W.length-1;++I)for(;O<W[I+1];++O)M[O]=I;function B(he,ne){for(var oe=0;oe<he.length;){var ue=Math.min(65535,he.length-oe),ge=oe+ue==he.length;for(ne.write_shift(1,+ge),ne.write_shift(2,ue),ne.write_shift(2,~ue&65535);ue-- >0;)ne[ne.l++]=he[oe++]}return ne.l}function ie(he,ne){for(var oe=0,ue=0,ge=Q?new Uint16Array(32768):[];ue<he.length;){var Ee=Math.min(65535,he.length-ue);if(Ee<10){for(oe=De(ne,oe,+(ue+Ee==he.length)),oe&7&&(oe+=8-(oe&7)),ne.l=oe/8|0,ne.write_shift(2,Ee),ne.write_shift(2,~Ee&65535);Ee-- >0;)ne[ne.l++]=he[ue++];oe=ne.l*8;continue}oe=De(ne,oe,+(ue+Ee==he.length)+2);for(var Ce=0;Ee-- >0;){var we=he[ue];Ce=(Ce<<5^we)&32767;var Te=-1,Ge=0;if((Te=ge[Ce])&&(Te|=ue&-32768,Te>ue&&(Te-=32768),Te<ue))for(;he[Te+Ge]==he[ue+Ge]&&Ge<250;)++Ge;if(Ge>2){we=M[Ge],we<=22?oe=qe(ne,oe,ee[we+1]>>1)-1:(qe(ne,oe,3),oe+=5,qe(ne,oe,ee[we-23]>>5),oe+=3);var Ut=we<8?0:we-4>>2;Ut>0&&(Oe(ne,oe,Ge-W[we]),oe+=Ut),we=L[ue-Te],oe=qe(ne,oe,ee[we]>>3),oe-=3;var $t=we<4?0:we-2>>1;$t>0&&(Oe(ne,oe,ue-Te-q[we]),oe+=$t);for(var Or=0;Or<Ge;++Or)ge[Ce]=ue&32767,Ce=(Ce<<5^he[ue])&32767,++ue;Ee-=Ge-1}else we<=143?we=we+48:oe=Ve(ne,oe,1),oe=qe(ne,oe,ee[we]),ge[Ce]=ue&32767,++ue}oe=qe(ne,oe,0)-1}return ne.l=(oe+7)/8|0,ne.l}return function(ne,oe){return ne.length<8?B(ne,oe):ie(ne,oe)}}();function We(j){var L=de(50+Math.floor(j.length*1.1)),I=on(j,L);return L.slice(0,I)}var Mt=Q?new Uint16Array(32768):ze(32768),hr=Q?new Uint16Array(32768):ze(32768),rr=Q?new Uint16Array(128):ze(128),Bs=1,bl=1;function Su(j,L){var I=ae(j,L)+257;L+=5;var O=ae(j,L)+1;L+=5;var M=Y(j,L)+4;L+=4;for(var B=0,ie=Q?new Uint8Array(19):ze(19),he=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ne=1,oe=Q?new Uint8Array(8):ze(8),ue=Q?new Uint8Array(8):ze(8),ge=ie.length,Ee=0;Ee<M;++Ee)ie[R[Ee]]=B=_e(j,L),ne<B&&(ne=B),oe[B]++,L+=3;var Ce=0;for(oe[0]=0,Ee=1;Ee<=ne;++Ee)ue[Ee]=Ce=Ce+oe[Ee-1]<<1;for(Ee=0;Ee<ge;++Ee)(Ce=ie[Ee])!=0&&(he[Ee]=ue[Ce]++);var we=0;for(Ee=0;Ee<ge;++Ee)if(we=ie[Ee],we!=0){Ce=ee[he[Ee]]>>8-we;for(var Te=(1<<7-we)-1;Te>=0;--Te)rr[Ce|Te<<we]=we&7|Ee<<3}var Ge=[];for(ne=1;Ge.length<I+O;)switch(Ce=rr[ce(j,L)],L+=Ce&7,Ce>>>=3){case 16:for(B=3+pe(j,L),L+=2,Ce=Ge[Ge.length-1];B-- >0;)Ge.push(Ce);break;case 17:for(B=3+_e(j,L),L+=3;B-- >0;)Ge.push(0);break;case 18:for(B=11+ce(j,L),L+=7;B-- >0;)Ge.push(0);break;default:Ge.push(Ce),ne<Ce&&(ne=Ce);break}var Ut=Ge.slice(0,I),$t=Ge.slice(I);for(Ee=I;Ee<286;++Ee)Ut[Ee]=0;for(Ee=O;Ee<30;++Ee)$t[Ee]=0;return Bs=Fe(Ut,Mt,286),bl=Fe($t,hr,30),L}function d0(j,L){if(j[0]==3&&!(j[1]&3))return[Va(L),2];for(var I=0,O=0,M=C1(L||1<<18),B=0,ie=M.length>>>0,he=0,ne=0;!(O&1);){if(O=_e(j,I),I+=3,O>>>1)O>>1==1?(he=9,ne=5):(I=Su(j,I),he=Bs,ne=bl);else{I&7&&(I+=8-(I&7));var oe=j[I>>>3]|j[(I>>>3)+1]<<8;if(I+=32,oe>0)for(!L&&ie<B+oe&&(M=Ie(M,B+oe),ie=M.length);oe-- >0;)M[B++]=j[I>>>3],I+=8;continue}for(;;){!L&&ie<B+32767&&(M=Ie(M,B+32767),ie=M.length);var ue=xe(j,I,he),ge=O>>>1==1?ft[ue]:Mt[ue];if(I+=ge&15,ge>>>=4,!(ge>>>8&255))M[B++]=ge;else{if(ge==256)break;ge-=257;var Ee=ge<8?0:ge-4>>2;Ee>5&&(Ee=0);var Ce=B+W[ge];Ee>0&&(Ce+=xe(j,I,Ee),I+=Ee),ue=xe(j,I,ne),ge=O>>>1==1?ir[ue]:hr[ue],I+=ge&15,ge>>>=4;var we=ge<4?0:ge-2>>1,Te=q[ge];for(we>0&&(Te+=xe(j,I,we),I+=we),!L&&ie<Ce&&(M=Ie(M,Ce+100),ie=M.length);B<Ce;)M[B]=M[B-Te],++B}}}return L?[M,I+7>>>3]:[M.slice(0,B),I+7>>>3]}function to(j,L){var I=j.slice(j.l||0),O=d0(I,L);return j.l+=O[1],O[0]}function Yn(j,L){if(j)typeof console<"u"&&console.error(L);else throw new Error(L)}function ku(j,L){var I=j;jr(I,0);var O=[],M=[],B={FileIndex:O,FullPaths:M};_(B,{root:L.root});for(var ie=I.length-4;(I[ie]!=80||I[ie+1]!=75||I[ie+2]!=5||I[ie+3]!=6)&&ie>=0;)--ie;I.l=ie+4,I.l+=4;var he=I.read_shift(2);I.l+=6;var ne=I.read_shift(4);for(I.l=ne,ie=0;ie<he;++ie){I.l+=20;var oe=I.read_shift(4),ue=I.read_shift(4),ge=I.read_shift(2),Ee=I.read_shift(2),Ce=I.read_shift(2);I.l+=8;var we=I.read_shift(4),Te=o(I.slice(I.l+ge,I.l+ge+Ee));I.l+=ge+Ee+Ce;var Ge=I.l;I.l=we+4,h0(I,oe,ue,B,Te),I.l=Ge}return B}function h0(j,L,I,O,M){j.l+=2;var B=j.read_shift(2),ie=j.read_shift(2),he=i(j);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var ne=j.read_shift(4),oe=j.read_shift(4),ue=j.read_shift(4),ge=j.read_shift(2),Ee=j.read_shift(2),Ce="",we=0;we<ge;++we)Ce+=String.fromCharCode(j[j.l++]);if(Ee){var Te=o(j.slice(j.l,j.l+Ee));(Te[21589]||{}).mt&&(he=Te[21589].mt),((M||{})[21589]||{}).mt&&(he=M[21589].mt)}j.l+=Ee;var Ge=j.slice(j.l,j.l+oe);switch(ie){case 8:Ge=b(j,ue);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ie)}var Ut=!1;B&8&&(ne=j.read_shift(4),ne==134695760&&(ne=j.read_shift(4),Ut=!0),oe=j.read_shift(4),ue=j.read_shift(4)),oe!=L&&Yn(Ut,"Bad compressed size: "+L+" != "+oe),ue!=I&&Yn(Ut,"Bad uncompressed size: "+I+" != "+ue),Jr(O,Ce,Ge,{unsafe:!0,mt:he})}function bu(j,L){var I=L||{},O=[],M=[],B=de(1),ie=I.compression?8:0,he=0,ne=0,oe=0,ue=0,ge=0,Ee=j.FullPaths[0],Ce=Ee,we=j.FileIndex[0],Te=[],Ge=0;for(ne=1;ne<j.FullPaths.length;++ne)if(Ce=j.FullPaths[ne].slice(Ee.length),we=j.FileIndex[ne],!(!we.size||!we.content||Ce=="Sh33tJ5")){var Ut=ue,$t=de(Ce.length);for(oe=0;oe<Ce.length;++oe)$t.write_shift(1,Ce.charCodeAt(oe)&127);$t=$t.slice(0,$t.l),Te[ge]=t6.buf(we.content,0);var Or=we.content;ie==8&&(Or=D(Or)),B=de(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,he),B.write_shift(2,ie),we.mt?a(B,we.mt):B.write_shift(4,0),B.write_shift(-4,Te[ge]),B.write_shift(4,Or.length),B.write_shift(4,we.content.length),B.write_shift(2,$t.length),B.write_shift(2,0),ue+=B.length,O.push(B),ue+=$t.length,O.push($t),ue+=Or.length,O.push(Or),B=de(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,he),B.write_shift(2,ie),B.write_shift(4,0),B.write_shift(-4,Te[ge]),B.write_shift(4,Or.length),B.write_shift(4,we.content.length),B.write_shift(2,$t.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,Ut),Ge+=B.l,M.push(B),Ge+=$t.length,M.push($t),++ge}return B=de(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,ge),B.write_shift(2,ge),B.write_shift(4,Ge),B.write_shift(4,ue),B.write_shift(2,0),Er([Er(O),Er(M),B])}var ni={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function He(j,L){if(j.ctype)return j.ctype;var I=j.name||"",O=I.match(/\.([^\.]+)$/);return O&&ni[O[1]]||L&&(O=(I=L).match(/[\.\\]([^\.\\])+$/),O&&ni[O[1]])?ni[O[1]]:"application/octet-stream"}function or(j){for(var L=Wc(j),I=[],O=0;O<L.length;O+=76)I.push(L.slice(O,O+76));return I.join(`\r
`)+`\r
`}function _r(j){var L=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var ue=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(ue.length==1?"0"+ue:ue)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],O=L.split(`\r
`),M=0;M<O.length;++M){var B=O[M];if(B.length==0){I.push("");continue}for(var ie=0;ie<B.length;){var he=76,ne=B.slice(ie,ie+he);ne.charAt(he-1)=="="?he--:ne.charAt(he-2)=="="?he-=2:ne.charAt(he-3)=="="&&(he-=3),ne=B.slice(ie,ie+he),ie+=he,ie<B.length&&(ne+="="),I.push(ne)}}return I.join(`\r
`)}function Yr(j){for(var L=[],I=0;I<j.length;++I){for(var O=j[I];I<=j.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+j[++I];L.push(O)}for(var M=0;M<L.length;++M)L[M]=L[M].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return Sn(L.join(`\r
`))}function ro(j,L,I){for(var O="",M="",B="",ie,he=0;he<10;++he){var ne=L[he];if(!ne||ne.match(/^\s*$/))break;var oe=ne.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":O=oe[2].trim();break;case"content-type":B=oe[2].trim();break;case"content-transfer-encoding":M=oe[2].trim();break}}switch(++he,M.toLowerCase()){case"base64":ie=Sn(An(L.slice(he).join("")));break;case"quoted-printable":ie=Yr(L.slice(he));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+M)}var ue=Jr(j,O.slice(I.length),ie,{unsafe:!0});B&&(ue.ctype=B)}function pr(j,L){if(z(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=L&&L.root||"",O=(Qe&&Buffer.isBuffer(j)?j.toString("binary"):z(j)).split(`\r
`),M=0,B="";for(M=0;M<O.length;++M)if(B=O[M],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),I||(I=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),B.slice(0,I.length)!=I););var ie=(O[1]||"").match(/boundary="(.*?)"/);if(!ie)throw new Error("MAD cannot find boundary");var he="--"+(ie[1]||""),ne=[],oe=[],ue={FileIndex:ne,FullPaths:oe};_(ue);var ge,Ee=0;for(M=0;M<O.length;++M){var Ce=O[M];Ce!==he&&Ce!==he+"--"||(Ee++&&ro(ue,O.slice(ge,M),I),ge=M)}return ue}function ln(j,L){var I=L||{},O=I.boundary||"SheetJS";O="------="+O;for(var M=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],B=j.FullPaths[0],ie=B,he=j.FileIndex[0],ne=1;ne<j.FullPaths.length;++ne)if(ie=j.FullPaths[ne].slice(B.length),he=j.FileIndex[ne],!(!he.size||!he.content||ie=="Sh33tJ5")){ie=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ge){return"_x"+Ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ge){return"_u"+Ge.charCodeAt(0).toString(16)+"_"});for(var oe=he.content,ue=Qe&&Buffer.isBuffer(oe)?oe.toString("binary"):z(oe),ge=0,Ee=Math.min(1024,ue.length),Ce=0,we=0;we<=Ee;++we)(Ce=ue.charCodeAt(we))>=32&&Ce<128&&++ge;var Te=ge>=Ee*4/5;M.push(O),M.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+ie),M.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),M.push("Content-Type: "+He(he,ie)),M.push(""),M.push(Te?_r(ue):or(ue))}return M.push(O+`--\r
`),M.join(`\r
`)}function no(j){var L={};return _(L,j),L}function Jr(j,L,I,O){var M=O&&O.unsafe;M||_(j);var B=!M&&Re.find(j,L);if(!B){var ie=j.FullPaths[0];L.slice(0,ie.length)==ie?ie=L:(ie.slice(-1)!="/"&&(ie+="/"),ie=(ie+L).replace("//","/")),B={name:s(L),type:2},j.FileIndex.push(B),j.FullPaths.push(ie),M||Re.utils.cfb_gc(j)}return B.content=I,B.size=I?I.length:0,O&&(O.CLSID&&(B.clsid=O.CLSID),O.mt&&(B.mt=O.mt),O.ct&&(B.ct=O.ct)),B}function vn(j,L){_(j);var I=Re.find(j,L);if(I){for(var O=0;O<j.FileIndex.length;++O)if(j.FileIndex[O]==I)return j.FileIndex.splice(O,1),j.FullPaths.splice(O,1),!0}return!1}function Eu(j,L,I){_(j);var O=Re.find(j,L);if(O){for(var M=0;M<j.FileIndex.length;++M)if(j.FileIndex[M]==O)return j.FileIndex[M].name=s(I),j.FullPaths[M]=I,!0}return!1}function Us(j){F(j,!0)}return t.find=V,t.read=S,t.parse=f,t.write=K,t.writeFile=te,t.utils={cfb_new:no,cfb_add:Jr,cfb_del:vn,cfb_mov:Eu,cfb_gc:Us,ReadShift:lc,CheckField:Eb,prep_blob:jr,bconcat:Er,use_zlib:P,_deflateRaw:We,_inflateRaw:to,consts:re},t}();let Na;function r6(e){Na=e}function n6(e){return typeof e=="string"?hu(e):Array.isArray(e)?N8(e):e}function mu(e,t,r){if(typeof Na<"u"&&Na.writeFileSync)return r?Na.writeFileSync(e,t,r):Na.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=hu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Cs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([n6(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=ei(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function s6(e){if(typeof Na<"u")return Na.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function tr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function I1(e,t){for(var r=[],n=tr(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function e0(e){for(var t=[],r=tr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function t0(e){for(var t=[],r=tr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function a6(e){for(var t=[],r=tr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var dd=new Date(1899,11,30,0,0,0);function wr(e,t){var r=e.getTime(),n=dd.getTime()+(e.getTimezoneOffset()-dd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var lb=new Date,i6=dd.getTime()+(lb.getTimezoneOffset()-dd.getTimezoneOffset())*6e4,O1=lb.getTimezoneOffset();function r0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+i6),t.getTimezoneOffset()!==O1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-O1)*6e4),t}function o6(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var L1=new Date("2017-02-19T19:06:09.000Z"),cb=isNaN(L1.getFullYear())?new Date("2/19/17"):L1,l6=cb.getFullYear()==2017;function Lt(e,t){var r=new Date(e);if(l6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(cb.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Li(e,t){if(Qe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Cs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Cs(qk(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Cs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Cs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Tt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Tt(e[r]));return t}function Qt(e,t){for(var r="";r.length<t;)r+=e;return r}function us(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var c6=["january","february","march","april","may","june","july","august","september","october","november","december"];function il(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&c6.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var u6=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function ub(e){return e?e.content&&e.type?Li(e.content,!0):e.data?Ro(e.data):e.asNodeBuffer&&Qe?Ro(e.asNodeBuffer().toString("binary")):e.asBinary?Ro(e.asBinary()):e._data&&e._data.getContent?Ro(Li(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function fb(e){if(!e)return null;if(e.data)return ld(e.data);if(e.asNodeBuffer&&Qe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?ld(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function f6(e){return e&&e.name.slice(-4)===".bin"?fb(e):ub(e)}function Ln(e,t){for(var r=e.FullPaths||tr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Nx(e,t){var r=Ln(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function cr(e,t,r){if(!r)return f6(Nx(e,t));if(!t)return null;try{return cr(e,t)}catch{return null}}function kn(e,t,r){if(!r)return ub(Nx(e,t));if(!t)return null;try{return kn(e,t)}catch{return null}}function d6(e,t,r){return fb(Nx(e,t))}function M1(e){for(var t=e.FullPaths||tr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ye(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Qe?n=ca(r):n=A8(r),Re.utils.cfb_add(e,t,n)}Re.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ax(){return Re.utils.cfb_new()}function db(e,t){switch(t.type){case"base64":return Re.read(e,{type:"base64"});case"binary":return Re.read(e,{type:"binary"});case"buffer":case"array":return Re.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Kl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var ar=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,h6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,B1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,p6=/<[^>]*>/g,qr=ar.match(B1)?B1:p6,m6=/<\w*:/,x6=/<(\/?)\w+:/;function Ue(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(h6),o=0,c="",u=0,f="",d="",h=1;if(i)for(u=0;u!=i.length;++u){for(d=i[u],a=0;a!=d.length&&d.charCodeAt(a)!==61;++a);for(f=d.slice(0,a).trim();d.charCodeAt(a+1)==32;)++a;for(h=(s=d.charCodeAt(a+1))==34||s==39?1:0,c=d.slice(a+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function Ls(e){return e.replace(x6,"<$1")}var hb={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},jx=e0(hb),xt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return hb[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),Dx=/[&<>'"]/g,g6=/[\u0000-\u0008\u000b-\u001f]/g;function wt(e){var t=e+"";return t.replace(Dx,function(r){return jx[r]}).replace(g6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function U1(e){return wt(e).replace(/ /g,"_x0020_")}var pb=/[\u0000-\u001f]/g;function Fx(e){var t=e+"";return t.replace(Dx,function(r){return jx[r]}).replace(/\n/g,"<br/>").replace(pb,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function v6(e){var t=e+"";return t.replace(Dx,function(r){return jx[r]}).replace(pb,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var $1=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function y6(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Pt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ch(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function z1(e){var t=Va(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function W1(e){return ca(e,"binary").toString("utf8")}var tf="foo bar baz",St=Qe&&(W1(tf)==ch(tf)&&W1||z1(tf)==ch(tf)&&z1)||ch,Cs=Qe?function(e){return ca(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Hc=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),mb=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),w6=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),_6=/<\/?(?:vt:)?variant>/g,S6=/<(?:vt:)([^>]*)>([\s\S]*)</;function V1(e,t){var r=Ue(e),n=e.match(w6(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(_6,"").match(S6);i&&s.push({v:St(i[2]),t:i[1]})}),s}var xb=/(^\s|\s$|\n)/;function Dr(e,t){return"<"+e+(t.match(xb)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Gc(e){return tr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Se(e,t,r){return"<"+e+(r!=null?Gc(r):"")+(t!=null?(t.match(xb)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Wp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function k6(e,t){switch(typeof e){case"string":var r=Se("vt:lpwstr",wt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Se((e|0)==e?"vt:i4":"vt:r8",wt(String(e)));case"boolean":return Se("vt:bool",e?"true":"false")}if(e instanceof Date)return Se("vt:filetime",Wp(e));throw new Error("Unable to serialize "+e)}function Rx(e){if(Qe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return St(ei(Ex(e)));throw new Error("Bad input format: expected Buffer or string")}var Xc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,vr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},qi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_n={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function b6(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function E6(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var H1=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},G1=Qe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ca(t)})):H1(e)}:H1,X1=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Ks(e,s)));return n.join("").replace(Hr,"")},n0=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Hr,""):X1(e,t,r)}:X1,K1=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},gb=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):K1(e,t,r)}:K1,q1=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(yo(e,s)));return n.join("")},_l=Qe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):q1(t,r,n)}:q1,vb=function(e,t){var r=br(e,t);return r>0?_l(e,t+4,t+4+r-1):""},Px=vb,yb=function(e,t){var r=br(e,t);return r>0?_l(e,t+4,t+4+r-1):""},Ix=yb,wb=function(e,t){var r=2*br(e,t);return r>0?_l(e,t+4,t+4+r-1):""},Ox=wb,_b=function(t,r){var n=br(t,r);return n>0?n0(t,r+4,r+4+n):""},Lx=_b,Sb=function(e,t){var r=br(e,t);return r>0?_l(e,t+4,t+4+r):""},Mx=Sb,kb=function(e,t){return b6(e,t)},hd=kb,Bx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Qe&&(Px=function(t,r){if(!Buffer.isBuffer(t))return vb(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Ix=function(t,r){if(!Buffer.isBuffer(t))return yb(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Ox=function(t,r){if(!Buffer.isBuffer(t))return wb(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Lx=function(t,r){if(!Buffer.isBuffer(t))return _b(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Mx=function(t,r){if(!Buffer.isBuffer(t))return Sb(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},hd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):kb(t,r)},Bx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function bb(){n0=function(e,t,r){return ht.utils.decode(1200,e.slice(t,r)).replace(Hr,"")},_l=function(e,t,r){return ht.utils.decode(65001,e.slice(t,r))},Px=function(e,t){var r=br(e,t);return r>0?ht.utils.decode(Ii,e.slice(t+4,t+4+r-1)):""},Ix=function(e,t){var r=br(e,t);return r>0?ht.utils.decode(Cn,e.slice(t+4,t+4+r-1)):""},Ox=function(e,t){var r=2*br(e,t);return r>0?ht.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Lx=function(e,t){var r=br(e,t);return r>0?ht.utils.decode(1200,e.slice(t+4,t+4+r)):""},Mx=function(e,t){var r=br(e,t);return r>0?ht.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof ht<"u"&&bb();var yo=function(e,t){return e[t]},Ks=function(e,t){return e[t+1]*256+e[t]},T6=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},br=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},fi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},C6=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function lc(e,t){var r="",n,s,a=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ks(this,u)),u+=2;e*=2;break;case"utf8":r=_l(this,this.l,this.l+e);break;case"utf16le":e*=2,r=n0(this,this.l,this.l+e);break;case"wstr":if(typeof ht<"u")r=ht.utils.decode(Cn,this.slice(this.l,this.l+2*e));else return lc.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Px(this,this.l),e=4+br(this,this.l);break;case"lpstr-cp":r=Ix(this,this.l),e=4+br(this,this.l);break;case"lpwstr":r=Ox(this,this.l),e=4+2*br(this,this.l);break;case"lpp4":e=4+br(this,this.l),r=Lx(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+br(this,this.l),r=Mx(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=yo(this,this.l+e++))!==0;)a.push(Gl(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Ks(this,this.l+e))!==0;)a.push(Gl(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=yo(this,u),this.l=u+1,o=lc.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Gl(Ks(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":if(typeof ht<"u"){r=ht.utils.decode(Cn,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=yo(this,u),this.l=u+1,o=lc.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Gl(yo(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=yo(this,this.l),this.l++,n;case 2:return n=(t==="i"?T6:Ks)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?fi:C6)(this,this.l),this.l+=4,n):(s=br(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=hd(this,this.l):s=hd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=gb(this,this.l,e);break}}return this.l+=e,r}var N6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},A6=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},j6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function D6(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)j6(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){if(typeof ht<"u"&&Ii==874)for(s=0;s!=t.length;++s){var a=ht.utils.encode(Ii,t.charAt(s));this[this.l+s]=a[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,N6(this,t,this.l);break;case 8:if(n=8,r==="f"){E6(this,t,this.l);break}case 16:break;case-4:n=4,A6(this,t,this.l);break}return this.l+=n,this}function Eb(e,t){var r=gb(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function jr(e,t){e.l=t,e.read_shift=lc,e.chk=Eb,e.write_shift=D6}function Kr(e,t){e.l+=t}function de(e){var t=Va(e);return jr(t,0),t}function ua(e,t,r){if(e){var n,s,a;jr(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Zc[o]||Zc[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var f=u.f&&u.f(e,a,r);if(e.l=c,t(f,u,o))return}}}function gn(){var e=[],t=Qe?256:2048,r=function(u){var f=de(u);return jr(f,0),f},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),Er(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function me(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=Zc[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&Bx(r)&&e.push(r)}}function cc(e,t,r){var n=Tt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Y1(e,t,r){var n=Tt(e);return n.s=cc(n.s,t.s,r),n.e=cc(n.e,t.s,r),n}function uc(e,t){if(e.cRel&&e.c<0)for(e=Tt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Tt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Be(e);return!e.cRel&&e.cRel!=null&&(r=P6(r)),!e.rRel&&e.rRel!=null&&(r=F6(r)),r}function uh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ot(e.s.c)+":"+(e.e.cRel?"":"$")+Ot(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Zt(e.s.r)+":"+(e.e.rRel?"":"$")+Zt(e.e.r):uc(e.s,t.biff)+":"+uc(e.e,t.biff)}function Ux(e){return parseInt(R6(e),10)-1}function Zt(e){return""+(e+1)}function F6(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function R6(e){return e.replace(/\$(\d+)$/,"$1")}function $x(e){for(var t=I6(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ot(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function P6(e){return e.replace(/^([A-Z])/,"$$$1")}function I6(e){return e.replace(/^\$([A-Z])/,"$1")}function O6(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wt(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Be(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function nn(e){var t=e.indexOf(":");return t==-1?{s:Wt(e),e:Wt(e)}:{s:Wt(e.slice(0,t)),e:Wt(e.slice(t+1))}}function Ke(e,t){return typeof t>"u"||typeof t=="number"?Ke(e.s,e.e):(typeof e!="string"&&(e=Be(e)),typeof t!="string"&&(t=Be(t)),e==t?e:e+":"+t)}function ct(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function J1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=jn(e.z,r?wr(t):t)}catch{}try{return e.w=jn((e.XF||{}).numFmtId||(r?14:0),r?wr(t):t)}catch{return""+t}}function Is(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?fa[e.v]||e.v:t==null?J1(e,e.v):J1(e,t))}function ti(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Tb(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Wt(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=ct(a["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(u.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var p={v:t[d][h]},x=i+d,m=o+h;if(u.s.r>x&&(u.s.r=x),u.s.c>m&&(u.s.c=m),u.e.r<x&&(u.e.r=x),u.e.c<m&&(u.e.c=m),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))p=t[d][h];else if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Pe[14],n.cellDates?(p.t="d",p.w=jn(p.z,wr(p.v))):(p.t="n",p.v=wr(p.v),p.w=jn(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][m]&&a[x][m].z&&(p.z=a[x][m].z),a[x][m]=p;else{var v=Be({c:m,r:x});a[v]&&a[v].z&&(p.z=a[v].z),a[v]=p}}}return u.s.c<1e7&&(a["!ref"]=Ke(u)),a}function Sl(e,t){return Tb(null,e,t)}function L6(e){return e.read_shift(4,"i")}function fs(e,t){return t||(t=de(4)),t.write_shift(4,e),t}function Gr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Tr(e,t){var r=!1;return t==null&&(r=!0,t=de(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function M6(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function B6(e,t){return t||(t=de(4)),t.write_shift(2,0),t.write_shift(2,0),t}function zx(e,t){var r=e.l,n=e.read_shift(1),s=Gr(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(M6(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function U6(e,t){var r=!1;return t==null&&(r=!0,t=de(15+4*e.t.length)),t.write_shift(1,0),Tr(e.t,t),r?t.slice(0,t.l):t}var $6=zx;function z6(e,t){var r=!1;return t==null&&(r=!0,t=de(23+4*e.t.length)),t.write_shift(1,1),Tr(e.t,t),t.write_shift(4,1),B6({},t),r?t.slice(0,t.l):t}function qn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Yi(e,t){return t==null&&(t=de(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ji(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Qi(e,t){return t==null&&(t=de(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var W6=Gr,Cb=Tr;function Wx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function pd(e,t){var r=!1;return t==null&&(r=!0,t=de(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var V6=Gr,Vp=Wx,Vx=pd;function Hx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?hd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):fi(t,0)>>2;return r?s/100:s}function Nb(e,t){t==null&&(t=de(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Ab(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function H6(e,t){return t||(t=de(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Zi=Ab,kl=H6;function Vr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Mi(e,t){return(t||de(8)).write_shift(8,e,"f")}function G6(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=yi[s];u&&(t.rgb=qc(u));break;case 2:t.rgb=qc([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function md(e,t){if(t||(t=de(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function X6(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function K6(e,t){t||(t=de(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function jb(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function q6(e){return jb(e,1)}function Y6(e){return jb(e,2)}var Gx=2,un=3,rf=11,Q1=12,xd=19,nf=64,J6=65,Q6=71,Z6=4108,eO=4126,Sr=80,Db=81,tO=[Sr,Db],Hp={1:{n:"CodePage",t:Gx},2:{n:"Category",t:Sr},3:{n:"PresentationFormat",t:Sr},4:{n:"ByteCount",t:un},5:{n:"LineCount",t:un},6:{n:"ParagraphCount",t:un},7:{n:"SlideCount",t:un},8:{n:"NoteCount",t:un},9:{n:"HiddenCount",t:un},10:{n:"MultimediaClipCount",t:un},11:{n:"ScaleCrop",t:rf},12:{n:"HeadingPairs",t:Z6},13:{n:"TitlesOfParts",t:eO},14:{n:"Manager",t:Sr},15:{n:"Company",t:Sr},16:{n:"LinksUpToDate",t:rf},17:{n:"CharacterCount",t:un},19:{n:"SharedDoc",t:rf},22:{n:"HyperlinksChanged",t:rf},23:{n:"AppVersion",t:un,p:"version"},24:{n:"DigSig",t:J6},26:{n:"ContentType",t:Sr},27:{n:"ContentStatus",t:Sr},28:{n:"Language",t:Sr},29:{n:"Version",t:Sr},255:{},2147483648:{n:"Locale",t:xd},2147483651:{n:"Behavior",t:xd},1919054434:{}},Gp={1:{n:"CodePage",t:Gx},2:{n:"Title",t:Sr},3:{n:"Subject",t:Sr},4:{n:"Author",t:Sr},5:{n:"Keywords",t:Sr},6:{n:"Comments",t:Sr},7:{n:"Template",t:Sr},8:{n:"LastAuthor",t:Sr},9:{n:"RevNumber",t:Sr},10:{n:"EditTime",t:nf},11:{n:"LastPrinted",t:nf},12:{n:"CreatedDate",t:nf},13:{n:"ModifiedDate",t:nf},14:{n:"PageCount",t:un},15:{n:"WordCount",t:un},16:{n:"CharCount",t:un},17:{n:"Thumbnail",t:Q6},18:{n:"Application",t:Sr},19:{n:"DocSecurity",t:un},255:{},2147483648:{n:"Locale",t:xd},2147483651:{n:"Behavior",t:xd},1919054434:{}},Z1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},rO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function nO(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var sO=nO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),yi=Tt(sO),fa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Fb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Xp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},sf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Xx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function aO(e){var t=Xx();if(!e||!e.match)return t;var r={};if((e.match(qr)||[]).forEach(function(n){var s=Ue(n);switch(s[0].replace(m6,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Xp[s.ContentType]]!==void 0&&t[Xp[s.ContentType]].push(s.PartName);break}}),t.xmlns!==vr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Rb(e,t){var r=a6(Xp),n=[],s;n[n.length]=ar,n[n.length]=Se("Types",null,{xmlns:vr.CT,"xmlns:xsd":vr.xsd,"xmlns:xsi":vr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Se("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Se("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:sf[c][t.bookType]||sf[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Se("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:sf[c][t.bookType]||sf[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Se("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var et={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Kc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function fc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(qr)||[]).forEach(function(s){var a=Ue(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:Kl(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function Ho(e){var t=[ar,Se("Relationships",null,{xmlns:vr.RELS})];return tr(e["!id"]).forEach(function(r){t[t.length]=Se("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function yt(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[et.HLINK,et.XPATH,et.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var iO="application/vnd.oasis.opendocument.spreadsheet";function oO(e,t){for(var r=Rx(e),n,s;n=Xc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Ue(n[0],!1),s.path=="/"&&s.type!==iO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function lO(e){var t=[ar];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function ey(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function cO(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function uO(e){var t=[ar];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(ey(e[r][0],e[r][1])),t.push(cO("",e[r][0]));return t.push(ey("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Pb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+zc.version+"</meta:generator></office:meta></office:document-meta>"}var Hn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],fO=function(){for(var e=new Array(Hn.length),t=0;t<Hn.length;++t){var r=Hn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Ib(e){var t={};e=St(e);for(var r=0;r<Hn.length;++r){var n=Hn[r],s=e.match(fO[r]);s!=null&&s.length>0&&(t[n[1]]=xt(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Lt(t[n[1]]))}return t}function fh(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=wt(t),n[n.length]=r?Se(e,t,r):Dr(e,t))}function Ob(e,t){var r=t||{},n=[ar,Se("cp:coreProperties",null,{"xmlns:cp":vr.CORE_PROPS,"xmlns:dc":vr.dc,"xmlns:dcterms":vr.dcterms,"xmlns:dcmitype":vr.dcmitype,"xmlns:xsi":vr.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&fh("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Wp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&fh("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Wp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Hn.length;++a){var i=Hn[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&fh(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var wi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Lb=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Mb(e,t,r,n){var s=[];if(typeof e=="string")s=V1(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(f){return{v:f}}));var i=typeof t=="string"?V1(t,n).map(function(f){return f.v}):t,o=0,c=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function dO(e,t,r){var n={};return t||(t={}),e=St(e),wi.forEach(function(s){var a=(e.match(Hc(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=xt(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Mb(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Bb(e){var t=[],r=Se;return e||(e={}),e.Application="SheetJS",t[t.length]=ar,t[t.length]=Se("Properties",null,{xmlns:vr.EXT_PROPS,"xmlns:vt":vr.vt}),wi.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=wt(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+wt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var hO=/<[^>]+>[^<]*/g;function pO(e,t){var r={},n="",s=e.match(hO);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Ue(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=xt(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),f=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=xt(f);break;case"bool":r[n]=Pt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Lt(f);break;case"cy":case"error":r[n]=xt(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function Ub(e){var t=[ar,Se("Properties",null,{xmlns:vr.CUST_PROPS,"xmlns:vt":vr.vt})];if(!e)return t.join("");var r=1;return tr(e).forEach(function(s){++r,t[t.length]=Se("property",k6(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:wt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Kp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dh;function mO(e,t,r){dh||(dh=e0(Kp)),t=dh[t]||t,e[t]=r}function xO(e,t){var r=[];return tr(Kp).map(function(n){for(var s=0;s<Hn.length;++s)if(Hn[s][1]==n)return Hn[s];for(s=0;s<wi.length;++s)if(wi[s][1]==n)return wi[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Dr(Kp[n[1]]||n[1],s))}}),Se("DocumentProperties",r.join(""),{xmlns:_n.o})}function gO(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&tr(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Hn.length;++i)if(a==Hn[i][1])return;for(i=0;i<wi.length;++i)if(a==wi[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(Se(U1(a),o,{"dt:dt":c}))}}),t&&tr(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(Se(U1(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+_n.o+'">'+s.join("")+"</"+n+">"}function Kx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function vO(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=de(8);return i.write_shift(4,n),i.write_shift(4,s),i}function $b(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function zb(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Wb(e,t,r){return t===31?zb(e):$b(e,t,r)}function qp(e,t,r){return Wb(e,t,r===!1?0:4)}function yO(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Wb(e,t,0)}function wO(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Hr,""),e.l-s&2&&(e.l+=2)}return r}function _O(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Hr,"");return r}function SO(e){var t=e.l,r=gd(e,Db);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=gd(e,un);return[r,n]}function kO(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(SO(e));return r}function ty(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Hr,"").replace(Xl,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Vb(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function bO(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function gd(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==Q1&&n!==t&&tO.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Q1?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return $b(e,n,4).replace(Hr,"");case 31:return zb(e);case 64:return Kx(e);case 65:return Vb(e);case 71:return bO(e);case 80:return qp(e,n,!a.raw).replace(Hr,"");case 81:return yO(e,n).replace(Hr,"");case 4108:return kO(e);case 4126:case 4127:return n==4127?wO(e):_O(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function ry(e,t){var r=de(4),n=de(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=de(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=vO(t);break;case 31:case 80:for(n=de(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Er([r,n])}function ny(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,u={};for(i=0;i!=s;++i){var f=e.read_shift(4),d=e.read_shift(4);a[i]=[f,d+r]}a.sort(function(w,y){return w[1]-y[1]});var h={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(h[x.n]=gd(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:zn(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(a[i][0]===1){if(o=h.CodePage=gd(e,Gx),zn(o),c!==-1){var m=e.l;e.l=a[c][1],u=ty(e,o),e.l=m}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}u=ty(e,o)}else{var v=u[a[i][0]],g;switch(e[e.l]){case 65:e.l+=4,g=Vb(e);break;case 30:e.l+=4,g=qp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=qp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=nr(e,4);break;case 64:e.l+=4,g=Lt(Kx(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=g}}return e.l=r+n,h}var Hb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function EO(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function sy(e,t,r){var n=de(8),s=[],a=[],i=8,o=0,c=de(8),u=de(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),i+=8+c.length,!t){u=de(8),u.write_shift(4,0),s.unshift(u);var f=[de(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(c=de(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=Er(f),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Hb.indexOf(e[o][0])>-1||Lb.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(t){p=+t[e[o][0]];var x=r[p];if(x.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}c=ry(x.t,h)}else{var v=EO(h);v==-1&&(v=31,h=String(h)),c=ry(v,h)}a.push(c),u=de(8),u.write_shift(4,t?p:2+o),s.push(u),i+=8+c.length}var g=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,g),g+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),Er([n].concat(s).concat(a))}function ay(e,t,r){var n=e.content;if(!n)return{};jr(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==Re.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var d=ny(n,t),h={SystemIdentifier:u};for(var p in d)h[p]=d[p];if(h.FMTID=a,s===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=ny(n,null)}catch{}for(p in x)h[p]=x[p];return h.FMTID=[a,i],h}function iy(e,t,r,n,s,a){var i=de(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Re.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=sy(e,r,n);if(o.push(c),s){var u=sy(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(u)}return Er(o)}function ma(e,t){return e.read_shift(t),null}function TO(e,t){t||(t=de(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function CO(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function nr(e,t){return e.read_shift(t)===1}function tn(e,t){return t||(t=de(2)),t.write_shift(2,+!!e),t}function ur(e){return e.read_shift(2,"u")}function Mn(e,t){return t||(t=de(2)),t.write_shift(2,e),t}function Gb(e,t){return CO(e,t,ur)}function NO(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Xb(e,t,r){return r||(r=de(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function xu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont",a=Cn;if(r&&r.biff>=8&&(Cn=1200),!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return Cn=a,o}function AO(e){var t=Cn;Cn=1200;var r=e.read_shift(2),n=e.read_shift(1),s=n&4,a=n&8,i=1+(n&1),o=0,c,u={};a&&(o=e.read_shift(2)),s&&(c=e.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",d=r===0?"":e.read_shift(r,f);return a&&(e.l+=4*o),s&&(e.l+=c),u.t=d,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),Cn=t,u}function jO(e){var t=e.t||"",r=de(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=de(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Er(s)}function Bi(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function gu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Bi(e,n,r)}function eo(e,t,r){if(r.biff>5)return gu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Kb(e,t,r){return r||(r=de(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function DO(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function FO(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Hr,"");return n&&(e.l+=24),s}function RO(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Hr,"");return r+i}function PO(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return FO(e);case"0303000000000000c000000000000046":return RO(e);default:throw new Error("Unsupported Moniker "+r)}}function af(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Hr,""):"";return r}function oy(e,t){t||(t=de(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function IO(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,u="",f,d;s&16&&(a=af(e,r-e.l)),s&128&&(i=af(e,r-e.l)),(s&257)===257&&(o=af(e,r-e.l)),(s&257)===1&&(c=PO(e,r-e.l)),s&8&&(u=af(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(d=Kx(e)),e.l=r;var h=i||o||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return f&&(p.guid=f),d&&(p.time=d),a&&(p.Tooltip=a),p}function OO(e){var t=de(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),oy(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&oy(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function qb(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function Yb(e,t){var r=qb(e);return r[3]=0,r}function Ms(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ui(e,t,r,n){return n||(n=de(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function LO(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function MO(e,t,r){return t===0?"":eo(e,t,r)}function BO(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function Jb(e){var t=e.read_shift(2),r=Hx(e);return[t,r]}function UO(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=xu(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function s0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function Qb(e,t){return t||(t=de(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Zb(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var $O=Zb;function eE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function zO(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function WO(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Br(e){e.l+=2,e.l+=e.read_shift(2)}var VO={0:Br,4:Br,5:Br,6:Br,7:WO,8:Br,9:Br,10:Br,11:Br,12:Br,13:zO,14:Br,15:Br,16:Br,17:Br,18:Br,19:Br,20:Br,21:eE};function HO(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(VO[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function of(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function qx(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=de(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function GO(e,t){return t===0||e.read_shift(2),1200}function XO(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=eo(e,0,r);return e.read_shift(t+n-e.l),s}function KO(e,t){var r=!t||t.biff==8,n=de(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function qO(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function YO(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=xu(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function JO(e,t){var r=!t||t.biff>=8?2:1,n=de(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function QO(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(AO(e));return a.Count=n,a.Unique=s,a}function ZO(e,t){var r=de(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=jO(e[s]);var a=Er([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function e5(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function t5(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function r5(e){var t=LO(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function n5(e){return e.read_shift(2),e.read_shift(4)}function ly(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function s5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:u}}function a5(){var e=de(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function i5(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function o5(e){var t=de(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function l5(){}function c5(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=xu(e,0,r),n}function u5(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=de(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function f5(e){var t=Ms(e);return t.isst=e.read_shift(4),t}function d5(e,t,r,n){var s=de(10);return Ui(e,t,n,s),s.write_shift(4,r),s}function h5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Ms(e);r.biff==2&&e.l++;var a=gu(e,n-e.l,r);return s.val=a,s}function p5(e,t,r,n,s){var a=!s||s.biff==8,i=de(8+ +a+(1+a)*r.length);return Ui(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function m5(e,t,r){var n=e.read_shift(2),s=eo(e,0,r);return[n,s]}function x5(e,t,r,n){var s=r&&r.biff==5;n||(n=de(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var g5=eo;function cy(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function v5(e,t){var r=t.biff==8||!t.biff?4:2,n=de(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function y5(e){var t=e.read_shift(2),r=e.read_shift(2),n=Jb(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function w5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(Jb(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function _5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function S5(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=rO[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function k5(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=S5(e,t,n.fStyle,r),n}function uy(e,t,r,n){var s=r&&r.biff==5;n||(n=de(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function b5(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function E5(e){var t=de(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function fy(e,t,r){var n=Ms(e);(r.biff==2||t==9)&&++e.l;var s=NO(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function T5(e,t,r,n,s,a){var i=de(8);return Ui(e,t,n,i),Xb(r,a,i),i}function C5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ms(e),s=Vr(e);return n.val=s,n}function N5(e,t,r,n){var s=de(14);return Ui(e,t,n,s),Mi(r,s),s}var dy=MO;function A5(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Bi(e,a),o=[];n>e.l;)o.push(gu(e));return[a,s,i,o]}function hy(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=UO(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var j5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function py(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Bi(e,i,r);s&32&&(u=j5[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:HB(e,f,r,o);return{chKey:a,Name:u,itab:c,rgce:d}}function tE(e,t,r){if(r.biff<8)return D5(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(BO(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function D5(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=xu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function F5(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=Bi(e,n,r),i=Bi(e,s,r);return[a,i]}function R5(e,t,r){var n=Zb(e);e.l++;var s=e.read_shift(1);return t-=8,[GB(e,t,r),s,n]}function my(e,t,r){var n=$O(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,WB(e,t,r)]}function P5(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function I5(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=eo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function O5(e,t,r){return I5(e,t,r)}function L5(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(s0(e));return r}function M5(e){var t=de(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Qb(e[r],t);return t}function B5(e,t,r){if(r&&r.biff<8)return $5(e,t,r);var n=eE(e),s=HO(e,t-22,n[1]);return{cmo:n,ft:s}}var U5={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function $5(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((U5[n]||Kr)(e,t,r)),{cmo:[s,n,a],ft:i}}function z5(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=DO(e,6,r);var o=e.read_shift(2);e.read_shift(2),ur(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=Bi(e,e.lens[u+1]-e.lens[u]-1);if(s+=d,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function W5(e,t){var r=s0(e);e.l+=16;var n=IO(e,t-24);return[r,n]}function V5(e){var t=de(24),r=Wt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Er([t,OO(e[1])])}function H5(e,t){e.read_shift(2);var r=s0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Hr,""),[r,n]}function G5(e){var t=e[1].Tooltip,r=de(10+2*(t.length+1));r.write_shift(2,2048);var n=Wt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function X5(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Z1[r]||r,r=e.read_shift(2),t[1]=Z1[r]||r,t}function K5(e){return e||(e=de(4)),e.write_shift(2,1),e.write_shift(2,1),e}function q5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Yb(e));return r}function Y5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Yb(e));return r}function J5(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function rE(e,t,r){if(!r.cellStyles)return Kr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function Q5(e,t){var r=de(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Z5(e,t){var r={};return t<32||(e.l+=16,r.header=Vr(e),r.footer=Vr(e),e.l+=2),r}function eL(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function tL(e){for(var t=de(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var rL=Ms,nL=Gb,sL=gu;function aL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function iL(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ms(e);++e.l;var s=eo(e,t-7,r);return n.t="str",n.val=s,n}function oL(e){var t=Ms(e);++e.l;var r=Vr(e);return t.t="n",t.val=r,t}function lL(e,t,r){var n=de(15);return _u(n,e,t),n.write_shift(8,r,"f"),n}function cL(e){var t=Ms(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function uL(e,t,r){var n=de(9);return _u(n,e,t),n.write_shift(2,r),n}function fL(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function dL(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function hL(e,t,r){var n=e.l+t,s=Ms(e),a=e.read_shift(2),i=Bi(e,a,r);return e.l=n,s.t="str",s.val=i,s}var pL=[2,3,48,49,131,139,140,245],Yp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=e0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],f=Va(1);switch(c.type){case"base64":f=Sn(An(o));break;case"binary":f=Sn(o);break;case"buffer":case"array":f=o;break}jr(f,0);var d=f.read_shift(1),h=!!(d&136),p=!1,x=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,v=521;d==2&&(m=f.read_shift(2)),f.l+=3,d!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(v=f.read_shift(2));var g=f.read_shift(2),w=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var y=[],k={},E=Math.min(f.length,d==2?521:v-10-(p?264:0)),S=x?32:11;f.l<E&&f[f.l]!=13;)switch(k={},k.name=ht.utils.decode(w,f.slice(f.l,f.l+S)).replace(/[\u0000\r\n].*$/g,""),f.l+=S,k.type=String.fromCharCode(f.read_shift(1)),d!=2&&!x&&(k.offset=f.read_shift(4)),k.len=f.read_shift(1),d==2&&(k.offset=f.read_shift(2)),k.dec=f.read_shift(1),k.name.length&&y.push(k),d!=2&&(f.l+=x?13:14),k.type){case"B":(!p||k.len!=8)&&c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(f[f.l]!==13&&(f.l=v-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=v;var _=0,A=0;for(u[0]=[],A=0;A!=y.length;++A)u[0][A]=y[A].name;for(;m-- >0;){if(f[f.l]===42){f.l+=g;continue}for(++f.l,u[++_]=[],A=0,A=0;A!=y.length;++A){var F=f.slice(f.l,f.l+y[A].len);f.l+=y[A].len,jr(F,0);var U=ht.utils.decode(w,F);switch(y[A].type){case"C":U.trim().length&&(u[_][A]=U.replace(/\s+$/,""));break;case"D":U.length===8?u[_][A]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):u[_][A]=U;break;case"F":u[_][A]=parseFloat(U.trim());break;case"+":case"I":u[_][A]=x?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":u[_][A]=!0;break;case"N":case"F":u[_][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[_][A]="##MEMO##"+(x?parseInt(U.trim(),10):F.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(u[_][A]=+U||0);break;case"@":u[_][A]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":u[_][A]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":u[_][A]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[_][A]=-F.read_shift(-8,"f");break;case"B":if(p&&y[A].len==8){u[_][A]=F.read_shift(8,"f");break}case"G":case"P":F.l+=y[A].len;break;case"0":if(y[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[A].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Sl(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function s(o,c){try{return ti(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&zn(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=gn(),d=wd(o,{header:1,raw:!0,cellDates:!0}),h=d[0],p=d.slice(1),x=o["!cols"]||[],m=0,v=0,g=0,w=1;for(m=0;m<h.length;++m){if(((x[m]||{}).DBF||{}).name){h[m]=x[m].DBF.name,++g;continue}if(h[m]!=null){if(++g,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(v=0;v<1024;++v)if(h.indexOf(h[m]+"_"+v)==-1){h[m]+="_"+v;break}}}}var y=ct(o["!ref"]),k=[],E=[],S=[];for(m=0;m<=y.e.c-y.s.c;++m){var _="",A="",F=0,U=[];for(v=0;v<p.length;++v)p[v][m]!=null&&U.push(p[v][m]);if(U.length==0||h[m]==null){k[m]="?";continue}for(v=0;v<U.length;++v){switch(typeof U[v]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=U[v]instanceof Date?"D":"C";break;default:A="C"}F=Math.max(F,String(U[v]).length),_=_&&_!=A?"C":A}F>250&&(F=250),A=((x[m]||{}).DBF||{}).type,A=="C"&&x[m].DBF.len>F&&(F=x[m].DBF.len),_=="B"&&A=="N"&&(_="N",S[m]=x[m].DBF.dec,F=x[m].DBF.len),E[m]=_=="C"||A=="N"?F:a[_]||0,w+=E[m],k[m]=_}var V=f.next(32);for(V.write_shift(4,318902576),V.write_shift(4,p.length),V.write_shift(2,296+32*g),V.write_shift(2,w),m=0;m<4;++m)V.write_shift(4,0);for(V.write_shift(4,0|(+t[Ii]||3)<<8),m=0,v=0;m<h.length;++m)if(h[m]!=null){var N=f.next(32),X=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,X,"sbcs"),N.write_shift(1,k[m]=="?"?"C":k[m],"sbcs"),N.write_shift(4,v),N.write_shift(1,E[m]||a[k[m]]||0),N.write_shift(1,S[m]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),v+=E[m]||a[k[m]]||0}var le=f.next(264);for(le.write_shift(4,13),m=0;m<65;++m)le.write_shift(4,0);for(m=0;m<p.length;++m){var J=f.next(w);for(J.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(k[v]){case"L":J.write_shift(1,p[m][v]==null?63:p[m][v]?84:70);break;case"B":J.write_shift(8,p[m][v]||0,"f");break;case"N":var Z="0";for(typeof p[m][v]=="number"&&(Z=p[m][v].toFixed(S[v]||0)),g=0;g<E[v]-Z.length;++g)J.write_shift(1,32);J.write_shift(1,Z,"sbcs");break;case"D":p[m][v]?(J.write_shift(4,("0000"+p[m][v].getFullYear()).slice(-4),"sbcs"),J.write_shift(2,("00"+(p[m][v].getMonth()+1)).slice(-2),"sbcs"),J.write_shift(2,("00"+p[m][v].getDate()).slice(-2),"sbcs")):J.write_shift(8,"00000000","sbcs");break;case"C":var re=String(p[m][v]!=null?p[m][v]:"").slice(0,E[v]);for(J.write_shift(1,re,"sbcs"),g=0;g<E[v]-re.length;++g)J.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),nE=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+tr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var x=e[p];return typeof x=="number"?zp(x):x},n=function(h,p,x){var m=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return m==59?h:zp(m)};e["|"]=254;function s(h,p){switch(p.type){case"base64":return a(An(h),p);case"binary":return a(h,p);case"buffer":return a(Qe&&Buffer.isBuffer(h)?h.toString("binary"):ei(h),p);case"array":return a(Li(h),p)}throw new Error("Unrecognized type "+p.type)}function a(h,p){var x=h.split(/[\n\r]+/),m=-1,v=-1,g=0,w=0,y=[],k=[],E=null,S={},_=[],A=[],F=[],U=0,V;for(+p.codepage>=0&&zn(+p.codepage);g!==x.length;++g){U=0;var N=x[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),X=N.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),le=X[0],J;if(N.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":X[1].charAt(0)=="P"&&k.push(N.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,re=!1,te=!1,z=!1,K=-1,se=-1;for(w=1;w<X.length;++w)switch(X[w].charAt(0)){case"A":break;case"X":v=parseInt(X[w].slice(1))-1,re=!0;break;case"Y":for(m=parseInt(X[w].slice(1))-1,re||(v=0),V=y.length;V<=m;++V)y[V]=[];break;case"K":J=X[w].slice(1),J.charAt(0)==='"'?J=J.slice(1,J.length-1):J==="TRUE"?J=!0:J==="FALSE"?J=!1:isNaN(us(J))?isNaN(il(J).getDate())||(J=Lt(J)):(J=us(J),E!==null&&Ki(E)&&(J=r0(J))),typeof ht<"u"&&typeof J=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(J=ht.utils.decode(p.codepage,J)),Z=!0;break;case"E":z=!0;var P=Go(X[w].slice(1),{r:m,c:v});y[m][v]=[y[m][v],P];break;case"S":te=!0,y[m][v]=[y[m][v],"S5S"];break;case"G":break;case"R":K=parseInt(X[w].slice(1))-1;break;case"C":se=parseInt(X[w].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+N)}if(Z&&(y[m][v]&&y[m][v].length==2?y[m][v][0]=J:y[m][v]=J,E=null),te){if(z)throw new Error("SYLK shared formula cannot have own formula");var b=K>-1&&y[K][se];if(!b||!b[1])throw new Error("SYLK shared formula cannot find base");y[m][v][1]=_E(b[1],{r:m-K,c:v-se})}break;case"F":var D=0;for(w=1;w<X.length;++w)switch(X[w].charAt(0)){case"X":v=parseInt(X[w].slice(1))-1,++D;break;case"Y":for(m=parseInt(X[w].slice(1))-1,V=y.length;V<=m;++V)y[V]=[];break;case"M":U=parseInt(X[w].slice(1))/20;break;case"F":break;case"G":break;case"P":E=k[parseInt(X[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=X[w].slice(1).split(" "),V=parseInt(F[0],10);V<=parseInt(F[1],10);++V)U=parseInt(F[2],10),A[V-1]=U===0?{hidden:!0}:{wch:U},Ha(A[V-1]);break;case"C":v=parseInt(X[w].slice(1))-1,A[v]||(A[v]={});break;case"R":m=parseInt(X[w].slice(1))-1,_[m]||(_[m]={}),U>0?(_[m].hpt=U,_[m].hpx=ll(U)):U===0&&(_[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+N)}D<1&&(E=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+N)}}return _.length>0&&(S["!rows"]=_),A.length>0&&(S["!cols"]=A),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,S]}function i(h,p){var x=s(h,p),m=x[0],v=x[1],g=Sl(m,p);return tr(v).forEach(function(w){g[w]=v[w]}),g}function o(h,p){return ti(i(h,p),p)}function c(h,p,x,m){var v="C;Y"+(x+1)+";X"+(m+1)+";K";switch(h.t){case"n":v+=h.v||0,h.f&&!h.F&&(v+=";E"+tg(h.f,{r:x,c:m}));break;case"b":v+=h.v?"TRUE":"FALSE";break;case"e":v+=h.w||h.v;break;case"d":v+='"'+(h.w||h.v)+'"';break;case"s":v+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function u(h,p){p.forEach(function(x,m){var v="F;W"+(m+1)+" "+(m+1)+" ";x.hidden?v+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Yc(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Jc(x.wpx)),typeof x.wch=="number"&&(v+=Math.round(x.wch))),v.charAt(v.length-1)!=" "&&h.push(v)})}function f(h,p){p.forEach(function(x,m){var v="F;";x.hidden?v+="M0;":x.hpt?v+="M"+20*x.hpt+";":x.hpx&&(v+="M"+20*Qc(x.hpx)+";"),v.length>2&&h.push(v+"R"+(m+1))})}function d(h,p){var x=["ID;PWXL;N;E"],m=[],v=ct(h["!ref"]),g,w=Array.isArray(h),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&f(x,h["!rows"]),x.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var k=v.s.r;k<=v.e.r;++k)for(var E=v.s.c;E<=v.e.c;++E){var S=Be({r:k,c:E});g=w?(h[k]||[])[E]:h[S],!(!g||g.v==null&&(!g.f||g.F))&&m.push(c(g,h,k,E))}return x.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),sE=function(){function e(a,i){switch(i.type){case"base64":return t(An(a),i);case"binary":return t(a,i);case"buffer":return t(Qe&&Buffer.isBuffer(a)?a.toString("binary"):ei(a),i);case"array":return t(Li(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++c]=[],u=0;continue}if(!(c<0)){var h=o[f].trim().split(","),p=h[0],x=h[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+p){case-1:if(m==="BOT"){d[++c]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[c][u]=!0:m==="FALSE"?d[c][u]=!1:isNaN(us(x))?isNaN(il(x).getDate())?d[c][u]=x:d[c][u]=Lt(x):d[c][u]=us(x),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[c][u++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(a,i){return Sl(e(a,i),i)}function n(a,i){return ti(r(a,i),i)}var s=function(){var a=function(c,u,f,d,h){c.push(u),c.push(f+","+d),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,u,f,d){c.push(u+","+f),c.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var u=[],f=ct(c["!ref"]),d,h=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,f.e.r-f.s.r+1,""),a(u,"TUPLES",0,f.e.c-f.s.c+1,""),a(u,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){i(u,-1,0,"BOT");for(var x=f.s.c;x<=f.e.c;++x){var m=Be({r:p,c:x});if(d=h?(c[p]||[])[x]:c[m],!d){i(u,1,0,"");continue}switch(d.t){case"n":var v=d.w;!v&&d.v!=null&&(v=d.v),v==null?d.f&&!d.F?i(u,1,0,"="+d.f):i(u,1,0,""):i(u,0,v,"V");break;case"b":i(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=jn(d.z||Pe[14],wr(Lt(d.v)))),i(u,0,d.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var g=`\r
`,w=u.join(g);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),aE=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),x=-1,m=-1,v=0,g=[];v!==p.length;++v){var w=p[v].trim().split(":");if(w[0]==="cell"){var y=Wt(w[1]);if(g.length<=y.r)for(x=g.length;x<=y.r;++x)g[x]||(g[x]=[]);switch(x=y.r,m=y.c,w[2]){case"t":g[x][m]=e(w[3]);break;case"v":g[x][m]=+w[3];break;case"vtf":var k=w[w.length-1];case"vtc":switch(w[3]){case"nl":g[x][m]=!!+w[4];break;default:g[x][m]=+w[4];break}w[2]=="vtf"&&(g[x][m]=[g[x][m],k])}}}return h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}function n(d,h){return Sl(r(d,h),h)}function s(d,h){return ti(n(d,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],x,m="",v=nn(d["!ref"]),g=Array.isArray(d),w=v.s.r;w<=v.e.r;++w)for(var y=v.s.c;y<=v.e.c;++y)if(m=Be({r:w,c:y}),x=g?(d[w]||[])[y]:d[m],!(!x||x.v==null||x.t==="z")){switch(p=["cell",m,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var k=wr(Lt(x.v));p[2]="vtc",p[3]="nd",p[4]=""+k,p[5]=x.w||jn(x.z||Pe[14],k);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[a,i,o,i,u(d),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),ol=function(){function e(f,d,h,p,x){x.raw?d[h][p]=f:f===""||(f==="TRUE"?d[h][p]=!0:f==="FALSE"?d[h][p]=!1:isNaN(us(f))?isNaN(il(f).getDate())?d[h][p]=f:d[h][p]=Lt(f):d[h][p]=us(f))}function t(f,d){var h=d||{},p=[];if(!f||f.length===0)return p;for(var x=f.split(/[\r\n]/),m=x.length-1;m>=0&&x[m].length===0;)--m;for(var v=10,g=0,w=0;w<=m;++w)g=x[w].indexOf(" "),g==-1?g=x[w].length:g++,v=Math.max(v,g);for(w=0;w<=m;++w){p[w]=[];var y=0;for(e(x[w].slice(0,v).trim(),p,w,y,h),y=1;y<=(x[w].length-v)/10+1;++y)e(x[w].slice(v+(y-1)*10,v+y*10).trim(),p,w,y,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var d={},h=!1,p=0,x=0;p<f.length;++p)(x=f.charCodeAt(p))==34?h=!h:!h&&x in r&&(d[x]=(d[x]||0)+1);x=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p]);if(!x.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p])}return x.sort(function(m,v){return m[0]-v[0]||n[m[1]]-n[v[1]]}),r[x.pop()[1]]||44}function a(f,d){var h=d||{},p="",x=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=s(f.slice(0,1024)):h&&h.FS?p=h.FS:p=s(f.slice(0,1024));var v=0,g=0,w=0,y=0,k=0,E=p.charCodeAt(0),S=!1,_=0,A=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var F=h.dateNF!=null?Z8(h.dateNF):null;function U(){var V=f.slice(y,k),N={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)N.t="z";else if(h.raw)N.t="s",N.v=V;else if(V.trim().length===0)N.t="s",N.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(N.t="s",N.v=V.slice(2,-1).replace(/""/g,'"')):A7(V)?(N.t="n",N.f=V.slice(1)):(N.t="s",N.v=V);else if(V=="TRUE")N.t="b",N.v=!0;else if(V=="FALSE")N.t="b",N.v=!1;else if(!isNaN(w=us(V)))N.t="n",h.cellText!==!1&&(N.w=V),N.v=w;else if(!isNaN(il(V).getDate())||F&&V.match(F)){N.z=h.dateNF||Pe[14];var X=0;F&&V.match(F)&&(V=e6(V,h.dateNF,V.match(F)||[]),X=1),h.cellDates?(N.t="d",N.v=Lt(V,X)):(N.t="n",N.v=wr(Lt(V,X))),h.cellText!==!1&&(N.w=jn(N.z,N.v instanceof Date?wr(N.v):N.v)),h.cellNF||delete N.z}else N.t="s",N.v=V;if(N.t=="z"||(h.dense?(x[v]||(x[v]=[]),x[v][g]=N):x[Be({c:g,r:v})]=N),y=k+1,A=f.charCodeAt(y),m.e.c<g&&(m.e.c=g),m.e.r<v&&(m.e.r=v),_==E)++g;else if(g=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;k<f.length;++k)switch(_=f.charCodeAt(k)){case 34:A===34&&(S=!S);break;case E:case 10:case 13:if(!S&&U())break e;break}return k-y>0&&U(),x["!ref"]=Ke(m),x}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,d):Sl(t(f,d),d)}function o(f,d){var h="",p=d.type=="string"?[0,0,0,0]:ug(f,d);switch(d.type){case"base64":h=An(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof ht<"u"?h=ht.utils.decode(d.codepage,f):h=Qe&&Buffer.isBuffer(f)?f.toString("binary"):ei(f);break;case"array":h=Li(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=St(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=St(h):d.type=="binary"&&typeof ht<"u"&&d.codepage&&(h=ht.utils.decode(d.codepage,ht.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?aE.to_sheet(d.type=="string"?h:St(h),d):i(h,d)}function c(f,d){return ti(o(f,d),d)}function u(f){for(var d=[],h=ct(f["!ref"]),p,x=Array.isArray(f),m=h.s.r;m<=h.e.r;++m){for(var v=[],g=h.s.c;g<=h.e.c;++g){var w=Be({r:m,c:g});if(p=x?(f[m]||[])[g]:f[w],!p||p.v==null){v.push("          ");continue}for(var y=(p.w||(Is(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";v.push(y+(g===0?" ":""))}d.push(v.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function mL(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=nE.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return ol.to_workbook(e,t)}}var _i=function(){function e(P,b,D){if(P){jr(P,P.l||0);for(var R=D.Enum||K;P.l<P.length;){var W=P.read_shift(2),q=R[W]||R[65535],H=P.read_shift(2),Q=P.l+H,ee=q.f&&q.f(P,H,D);if(P.l=Q,b(ee,q,W))return}}}function t(P,b){switch(b.type){case"base64":return r(Sn(An(P)),b);case"binary":return r(Sn(P),b);case"buffer":case"array":return r(P,b)}throw"Unsupported type "+b.type}function r(P,b){if(!P)return P;var D=b||{},R=D.dense?[]:{},W="Sheet1",q="",H=0,Q={},ee=[],G=[],C={s:{r:0,c:0},e:{r:0,c:0}},pe=D.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)D.Enum=K,e(P,function(ce,xe,De){switch(De){case 0:D.vers=ce,ce>=4096&&(D.qpro=!0);break;case 6:C=ce;break;case 204:ce&&(q=ce);break;case 222:q=ce;break;case 15:case 51:D.qpro||(ce[1].v=ce[1].v.slice(1));case 13:case 14:case 16:De==14&&(ce[2]&112)==112&&(ce[2]&15)>1&&(ce[2]&15)<15&&(ce[1].z=D.dateNF||Pe[14],D.cellDates&&(ce[1].t="d",ce[1].v=r0(ce[1].v))),D.qpro&&ce[3]>H&&(R["!ref"]=Ke(C),Q[W]=R,ee.push(W),R=D.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},H=ce[3],W=q||"Sheet"+(H+1),q="");var Ve=D.dense?(R[ce[0].r]||[])[ce[0].c]:R[Be(ce[0])];if(Ve){Ve.t=ce[1].t,Ve.v=ce[1].v,ce[1].z!=null&&(Ve.z=ce[1].z),ce[1].f!=null&&(Ve.f=ce[1].f);break}D.dense?(R[ce[0].r]||(R[ce[0].r]=[]),R[ce[0].r][ce[0].c]=ce[1]):R[Be(ce[0])]=ce[1];break}},D);else if(P[2]==26||P[2]==14)D.Enum=se,P[2]==14&&(D.qpro=!0,P.l=0),e(P,function(ce,xe,De){switch(De){case 204:W=ce;break;case 22:ce[1].v=ce[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ce[3]>H&&(R["!ref"]=Ke(C),Q[W]=R,ee.push(W),R=D.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},H=ce[3],W="Sheet"+(H+1)),pe>0&&ce[0].r>=pe)break;D.dense?(R[ce[0].r]||(R[ce[0].r]=[]),R[ce[0].r][ce[0].c]=ce[1]):R[Be(ce[0])]=ce[1],C.e.c<ce[0].c&&(C.e.c=ce[0].c),C.e.r<ce[0].r&&(C.e.r=ce[0].r);break;case 27:ce[14e3]&&(G[ce[14e3][0]]=ce[14e3][1]);break;case 1537:G[ce[0]]=ce[1],ce[0]==H&&(W=ce[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(R["!ref"]=Ke(C),Q[q||W]=R,ee.push(q||W),!G.length)return{SheetNames:ee,Sheets:Q};for(var _e={},Y=[],ae=0;ae<G.length;++ae)Q[ee[ae]]?(Y.push(G[ae]||ee[ae]),_e[G[ae]]=Q[G[ae]]||Q[ee[ae]]):(Y.push(G[ae]),_e[G[ae]]={"!ref":"A1"});return{SheetNames:Y,Sheets:_e}}function n(P,b){var D=b||{};if(+D.codepage>=0&&zn(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var R=gn(),W=ct(P["!ref"]),q=Array.isArray(P),H=[];ke(R,0,a(1030)),ke(R,6,c(W));for(var Q=Math.min(W.e.r,8191),ee=W.s.r;ee<=Q;++ee)for(var G=Zt(ee),C=W.s.c;C<=W.e.c;++C){ee===W.s.r&&(H[C]=Ot(C));var pe=H[C]+G,_e=q?(P[ee]||[])[C]:P[pe];if(!(!_e||_e.t=="z"))if(_e.t=="n")(_e.v|0)==_e.v&&_e.v>=-32768&&_e.v<=32767?ke(R,13,p(ee,C,_e.v)):ke(R,14,m(ee,C,_e.v));else{var Y=Is(_e);ke(R,15,d(ee,C,Y.slice(0,239)))}}return ke(R,1),R.end()}function s(P,b){var D=b||{};if(+D.codepage>=0&&zn(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var R=gn();ke(R,0,i(P));for(var W=0,q=0;W<P.SheetNames.length;++W)(P.Sheets[P.SheetNames[W]]||{})["!ref"]&&ke(R,27,z(P.SheetNames[W],q++));var H=0;for(W=0;W<P.SheetNames.length;++W){var Q=P.Sheets[P.SheetNames[W]];if(!(!Q||!Q["!ref"])){for(var ee=ct(Q["!ref"]),G=Array.isArray(Q),C=[],pe=Math.min(ee.e.r,8191),_e=ee.s.r;_e<=pe;++_e)for(var Y=Zt(_e),ae=ee.s.c;ae<=ee.e.c;++ae){_e===ee.s.r&&(C[ae]=Ot(ae));var ce=C[ae]+Y,xe=G?(Q[_e]||[])[ae]:Q[ce];if(!(!xe||xe.t=="z"))if(xe.t=="n")ke(R,23,U(_e,ae,H,xe.v));else{var De=Is(xe);ke(R,22,_(_e,ae,H,De.slice(0,239)))}}++H}}return ke(R,1),R.end()}function a(P){var b=de(2);return b.write_shift(2,P),b}function i(P){var b=de(26);b.write_shift(2,4096),b.write_shift(2,4),b.write_shift(4,0);for(var D=0,R=0,W=0,q=0;q<P.SheetNames.length;++q){var H=P.SheetNames[q],Q=P.Sheets[H];if(!(!Q||!Q["!ref"])){++W;var ee=nn(Q["!ref"]);D<ee.e.r&&(D=ee.e.r),R<ee.e.c&&(R=ee.e.c)}}return D>8191&&(D=8191),b.write_shift(2,D),b.write_shift(1,W),b.write_shift(1,R),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(1,1),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(4,0),b}function o(P,b,D){var R={s:{c:0,r:0},e:{c:0,r:0}};return b==8&&D.qpro?(R.s.c=P.read_shift(1),P.l++,R.s.r=P.read_shift(2),R.e.c=P.read_shift(1),P.l++,R.e.r=P.read_shift(2),R):(R.s.c=P.read_shift(2),R.s.r=P.read_shift(2),b==12&&D.qpro&&(P.l+=2),R.e.c=P.read_shift(2),R.e.r=P.read_shift(2),b==12&&D.qpro&&(P.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function c(P){var b=de(8);return b.write_shift(2,P.s.c),b.write_shift(2,P.s.r),b.write_shift(2,P.e.c),b.write_shift(2,P.e.r),b}function u(P,b,D){var R=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(R[0].c=P.read_shift(1),R[3]=P.read_shift(1),R[0].r=P.read_shift(2),P.l+=2):(R[2]=P.read_shift(1),R[0].c=P.read_shift(2),R[0].r=P.read_shift(2)),R}function f(P,b,D){var R=P.l+b,W=u(P,b,D);if(W[1].t="s",D.vers==20768){P.l++;var q=P.read_shift(1);return W[1].v=P.read_shift(q,"utf8"),W}return D.qpro&&P.l++,W[1].v=P.read_shift(R-P.l,"cstr"),W}function d(P,b,D){var R=de(7+D.length);R.write_shift(1,255),R.write_shift(2,b),R.write_shift(2,P),R.write_shift(1,39);for(var W=0;W<R.length;++W){var q=D.charCodeAt(W);R.write_shift(1,q>=128?95:q)}return R.write_shift(1,0),R}function h(P,b,D){var R=u(P,b,D);return R[1].v=P.read_shift(2,"i"),R}function p(P,b,D){var R=de(7);return R.write_shift(1,255),R.write_shift(2,b),R.write_shift(2,P),R.write_shift(2,D,"i"),R}function x(P,b,D){var R=u(P,b,D);return R[1].v=P.read_shift(8,"f"),R}function m(P,b,D){var R=de(13);return R.write_shift(1,255),R.write_shift(2,b),R.write_shift(2,P),R.write_shift(8,D,"f"),R}function v(P,b,D){var R=P.l+b,W=u(P,b,D);if(W[1].v=P.read_shift(8,"f"),D.qpro)P.l=R;else{var q=P.read_shift(2);k(P.slice(P.l,P.l+q),W),P.l+=q}return W}function g(P,b,D){var R=b&32768;return b&=-32769,b=(R?P:0)+(b>=8192?b-16384:b),(R?"":"$")+(D?Ot(b):Zt(b))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(P,b){jr(P,0);for(var D=[],R=0,W="",q="",H="",Q="";P.l<P.length;){var ee=P[P.l++];switch(ee){case 0:D.push(P.read_shift(8,"f"));break;case 1:q=g(b[0].c,P.read_shift(2),!0),W=g(b[0].r,P.read_shift(2),!1),D.push(q+W);break;case 2:{var G=g(b[0].c,P.read_shift(2),!0),C=g(b[0].r,P.read_shift(2),!1);q=g(b[0].c,P.read_shift(2),!0),W=g(b[0].r,P.read_shift(2),!1),D.push(G+C+":"+q+W)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(P.read_shift(2));break;case 6:{for(var pe="";ee=P[P.l++];)pe+=String.fromCharCode(ee);D.push('"'+pe.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:Q=D.pop(),H=D.pop(),D.push(["AND","OR"][ee-20]+"("+H+","+Q+")");break;default:if(ee<32&&y[ee])Q=D.pop(),H=D.pop(),D.push(H+y[ee]+Q);else if(w[ee]){if(R=w[ee][1],R==69&&(R=P[P.l++]),R>D.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+D.join("|")+"|");return}var _e=D.slice(-R);D.length-=R,D.push(w[ee][0]+"("+_e.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}D.length==1?b[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function E(P){var b=[{c:0,r:0},{t:"n",v:0},0];return b[0].r=P.read_shift(2),b[3]=P[P.l++],b[0].c=P[P.l++],b}function S(P,b){var D=E(P);return D[1].t="s",D[1].v=P.read_shift(b-4,"cstr"),D}function _(P,b,D,R){var W=de(6+R.length);W.write_shift(2,P),W.write_shift(1,D),W.write_shift(1,b),W.write_shift(1,39);for(var q=0;q<R.length;++q){var H=R.charCodeAt(q);W.write_shift(1,H>=128?95:H)}return W.write_shift(1,0),W}function A(P,b){var D=E(P);D[1].v=P.read_shift(2);var R=D[1].v>>1;if(D[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return D[1].v=R,D}function F(P,b){var D=E(P),R=P.read_shift(4),W=P.read_shift(4),q=P.read_shift(2);if(q==65535)return R===0&&W===3221225472?(D[1].t="e",D[1].v=15):R===0&&W===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var H=q&32768;return q=(q&32767)-16446,D[1].v=(1-H*2)*(W*Math.pow(2,q+32)+R*Math.pow(2,q)),D}function U(P,b,D,R){var W=de(14);if(W.write_shift(2,P),W.write_shift(1,D),W.write_shift(1,b),R==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var q=0,H=0,Q=0,ee=0;return R<0&&(q=1,R=-R),H=Math.log2(R)|0,R/=Math.pow(2,H-31),ee=R>>>0,ee&2147483648||(R/=2,++H,ee=R>>>0),R-=ee,ee|=2147483648,ee>>>=0,R*=Math.pow(2,32),Q=R>>>0,W.write_shift(4,Q),W.write_shift(4,ee),H+=16383+(q?32768:0),W.write_shift(2,H),W}function V(P,b){var D=F(P);return P.l+=b-14,D}function N(P,b){var D=E(P),R=P.read_shift(4);return D[1].v=R>>6,D}function X(P,b){var D=E(P),R=P.read_shift(8,"f");return D[1].v=R,D}function le(P,b){var D=X(P);return P.l+=b-10,D}function J(P,b){return P[P.l+b-1]==0?P.read_shift(b,"cstr"):""}function Z(P,b){var D=P[P.l++];D>b-1&&(D=b-1);for(var R="";R.length<D;)R+=String.fromCharCode(P[P.l++]);return R}function re(P,b,D){if(!(!D.qpro||b<21)){var R=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var W=P.read_shift(b-21,"cstr");return[R,W]}}function te(P,b){for(var D={},R=P.l+b;P.l<R;){var W=P.read_shift(2);if(W==14e3){for(D[W]=[0,""],D[W][0]=P.read_shift(2);P[P.l];)D[W][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return D}function z(P,b){var D=de(5+P.length);D.write_shift(2,14e3),D.write_shift(2,b);for(var R=0;R<P.length;++R){var W=P.charCodeAt(R);D[D.l++]=W>127?95:W}return D[D.l++]=0,D}var K={0:{n:"BOF",f:ur},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:J},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:J},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:re},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function xL(e){var t={},r=e.match(qr),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Ue(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=bx[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var gL=function(){var e=Hc("t"),t=Hc("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:xt(i[1])},c=a.match(t);return c&&(o.s=xL(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),vL=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),yL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,wL=/<(?:\w+:)?r>/,_L=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Yx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=xt(St(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=St(e),r&&(n.h=Fx(n.t))):e.match(wL)&&(n.r=St(e),n.t=xt(St((e.replace(_L,"").match(yL)||[]).join("").replace(qr,""))),r&&(n.h=vL(gL(n.r)))),n):{t:""}}var SL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kL=/<(?:\w+:)?(?:si|sstItem)>/g,bL=/<\/(?:\w+:)?(?:si|sstItem)>/;function EL(e,t){var r=[],n="";if(!e)return r;var s=e.match(SL);if(s){n=s[2].replace(kL,"").split(bL);for(var a=0;a!=n.length;++a){var i=Yx(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Ue(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var TL=/^\s|\s$|[\t\n\r]/;function iE(e,t){if(!t.bookSST)return"";var r=[ar];r[r.length]=Se("sst",null,{xmlns:qi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(TL)&&(a+=' xml:space="preserve"'),a+=">"+wt(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function CL(e){return[e.read_shift(4),e.read_shift(4)]}function NL(e,t){var r=[],n=!1;return ua(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function AL(e,t){return t||(t=de(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var jL=U6;function DL(e){var t=gn();me(t,159,AL(e));for(var r=0;r<e.length;++r)me(t,19,jL(e[r]));return me(t,160),t.end()}function oE(e){if(typeof ht<"u")return ht.utils.encode(Ii,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Qs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function FL(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Qs(e,4),t.U=Qs(e,4),t.W=Qs(e,4),t}function RL(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function PL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(RL(e));return t}function IL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function OL(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Qs(e,4),t.U=Qs(e,4),t.W=Qs(e,4),t}function LL(e){var t=OL(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function lE(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function cE(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function ML(e){var t=Qs(e);switch(t.Minor){case 2:return[t.Minor,BL(e)];case 3:return[t.Minor,UL()];case 4:return[t.Minor,$L(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function BL(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=lE(e,r),s=cE(e,e.length-e.l);return{t:"Std",h:n,v:s}}function UL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $L(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(qr,function(a){var i=Ue(a);switch(Ls(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function zL(e,t){var r={},n=r.EncryptionVersionInfo=Qs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=lE(e,s),t-=s,r.EncryptionVerifier=cE(e,t),r}function WL(e){var t={},r=t.EncryptionVersionInfo=Qs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Jx(e){var t=0,r,n=oE(e),s=n.length+1,a,i,o,c,u;for(r=Va(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var uE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var f=i[u],d=0;d!=7;++d)f&64&&(o^=r[c]),f*=2,--c;return o};return function(i){for(var o=oE(i),c=a(o),u=o.length,f=Va(16),d=0;d!=16;++d)f[d]=0;var h,p,x;for((u&1)===1&&(h=c>>8,f[u]=s(e[0],h),--u,h=c&255,p=o[o.length-1],f[u]=s(p,h));u>0;)--u,h=c>>8,f[u]=s(o[u],h),--u,h=c&255,f[u]=s(o[u],h);for(u=15,x=15-o.length;x>0;)h=c>>8,f[u]=s(e[x],h),--u,--x,h=c&255,f[u]=s(o[u],h),--u,--x;return f}}(),VL=function(e,t,r,n,s){s||(s=t),n||(n=uE(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},HL=function(e){var t=0,r=uE(e);return function(n){var s=VL("",n,t,r);return t=s[1],s[0]}};function GL(e,t,r,n){var s={key:ur(e),verificationBytes:ur(e)};return r.password&&(s.verifier=Jx(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=HL(r.password)),s}function XL(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=WL(e):n.Data=zL(e,t),n}function KL(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?XL(e,t-2,n):GL(e,r.biff>=8?t:t-2,r,n),n}var fE=function(){function e(s,a){switch(a.type){case"base64":return t(An(s),a);case"binary":return t(s,a);case"buffer":return t(Qe&&Buffer.isBuffer(s)?s.toString("binary"):ei(s),a);case"array":return t(Li(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,p=0,x,m=-1;x=h.exec(f);){switch(x[0]){case"\\cell":var v=f.slice(p,h.lastIndex-x[0].length);if(v[0]==" "&&(v=v.slice(1)),++m,v.length){var g={v,t:"s"};Array.isArray(o)?o[d][m]=g:o[Be({r:d,c:m})]=g}break}p=h.lastIndex}m>u.e.c&&(u.e.c=m)}),o["!ref"]=Ke(u),o}function r(s,a){return ti(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=ct(s["!ref"]),o,c=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=Be({r:u,c:f});o=c?(s[u]||[])[f]:s[d],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Is(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function qL(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function qc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function YL(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,u=s+a;switch(c=i/(u>1?2-u:u),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,u/2]}function JL(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function vd(e,t){if(t===0)return e;var r=YL(qL(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),qc(JL(r))}var dE=6,QL=15,ZL=1,Wr=dE;function Yc(e){return Math.floor((e+Math.round(128/Wr)/256)*Wr)}function Jc(e){return Math.floor((e-5)/Wr*100+.5)/100}function yd(e){return Math.round((e*Wr+5)/Wr*256)/256}function hh(e){return yd(Jc(Yc(e)))}function Qx(e){var t=Math.abs(e-hh(e)),r=Wr;if(t>.005)for(Wr=ZL;Wr<QL;++Wr)Math.abs(e-hh(e))<=t&&(t=Math.abs(e-hh(e)),r=Wr);Wr=r}function Ha(e){e.width?(e.wpx=Yc(e.width),e.wch=Jc(e.wpx),e.MDW=Wr):e.wpx?(e.wch=Jc(e.wpx),e.width=yd(e.wch),e.MDW=Wr):typeof e.wch=="number"&&(e.width=yd(e.wch),e.wpx=Yc(e.width),e.MDW=Wr),e.customWidth&&delete e.customWidth}var eM=96,hE=eM;function Qc(e){return e*96/hE}function ll(e){return e*hE/96}var tM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function rM(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(qr)||[]).forEach(function(i){var o=Ue(i);switch(Ls(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Pt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Pt(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function nM(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(qr)||[]).forEach(function(i){var o=Ue(i);switch(Ls(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function sM(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(qr)||[]).forEach(function(i){var o=Ue(i);switch(Ls(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=St(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Pt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Pt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Pt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Pt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Pt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Pt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Pt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=bx[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Pt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=yi[s.color.index];s.color.index==81&&(c=yi[1]),c||(c=yi[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=vd(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function aM(e,t,r){t.NumberFmt=[];for(var n=tr(Pe),s=0;s<n.length;++s)t.NumberFmt[n[s]]=Pe[n[s]];var a=e[0].match(qr);if(a)for(s=0;s<a.length;++s){var i=Ue(a[s]);switch(Ls(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=xt(St(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}Rs(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function iM(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Se("numFmt",null,{numFmtId:n,formatCode:wt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Se("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var lf=["numFmtId","fillId","fontId","borderId","xfId"],cf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function oM(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(qr)||[]).forEach(function(a){var i=Ue(a),o=0;switch(Ls(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<lf.length;++o)n[lf[o]]&&(n[lf[o]]=parseInt(n[lf[o]],10));for(o=0;o<cf.length;++o)n[cf[o]]&&(n[cf[o]]=Pt(n[cf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=Pt(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function lM(e){var t=[];return t[t.length]=Se("cellXfs",null),e.forEach(function(r){t[t.length]=Se("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Se("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var cM=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&aM(d,f,u),(d=o.match(s))&&sM(d,f,c,u),(d=o.match(n))&&nM(d,f,c,u),(d=o.match(a))&&rM(d,f,c,u),(d=o.match(r))&&oM(d,f,u),f}}();function pE(e,t){var r=[ar,Se("styleSheet",null,{xmlns:qi[0],"xmlns:vt":vr.vt})],n;return e.SSF&&(n=iM(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=lM(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function uM(e,t){var r=e.read_shift(2),n=Gr(e);return[r,n]}function fM(e,t,r){r||(r=de(6+4*t.length)),r.write_shift(2,e),Tr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function dM(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=X6(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=G6(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Gr(e),n}function hM(e,t){t||(t=de(25+4*32)),t.write_shift(2,e.sz*20),K6(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),md(e.color,t);var n=0;return n=2,t.write_shift(1,n),Tr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var pM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ph,mM=Kr;function xy(e,t){t||(t=de(4*3+8*7+16*1)),ph||(ph=e0(pM));var r=ph[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(md({auto:1},t),md({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function xM(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function mE(e,t,r){r||(r=de(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Bl(e,t){return t||(t=de(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var gM=Kr;function vM(e,t){return t||(t=de(51)),t.write_shift(1,0),Bl(null,t),Bl(null,t),Bl(null,t),Bl(null,t),Bl(null,t),t.length>t.l?t.slice(0,t.l):t}function yM(e,t){return t||(t=de(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),pd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function wM(e,t,r){var n=de(2052);return n.write_shift(4,e),pd(t,n),pd(r,n),n.length>n.l?n.slice(0,n.l):n}function _M(e,t,r){var n={};n.NumberFmt=[];for(var s in Pe)n.NumberFmt[s]=Pe[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return ua(e,function(c,u,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],Rs(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=vd(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(f),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(f);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function SM(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(me(e,615,fs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&me(e,44,fM(s,t[s]))}),me(e,616))}}function kM(e){var t=1;me(e,611,fs(t)),me(e,43,hM({sz:12,color:{theme:1},name:"Calibri",family:2})),me(e,612)}function bM(e){var t=2;me(e,603,fs(t)),me(e,45,xy({patternType:"none"})),me(e,45,xy({patternType:"gray125"})),me(e,604)}function EM(e){var t=1;me(e,613,fs(t)),me(e,46,vM()),me(e,614)}function TM(e){var t=1;me(e,626,fs(t)),me(e,47,mE({numFmtId:0},65535)),me(e,627)}function CM(e,t){me(e,617,fs(t.length)),t.forEach(function(r){me(e,47,mE(r,0))}),me(e,618)}function NM(e){var t=1;me(e,619,fs(t)),me(e,48,yM({xfId:0,name:"Normal"})),me(e,620)}function AM(e){var t=0;me(e,505,fs(t)),me(e,506)}function jM(e){var t=0;me(e,508,wM(t,"TableStyleMedium9","PivotStyleMedium4")),me(e,509)}function DM(e,t){var r=gn();return me(r,278),SM(r,e.SSF),kM(r),bM(r),EM(r),TM(r),CM(r,t.cellXfs),NM(r),AM(r),jM(r),me(r,279),r.end()}var FM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function RM(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(qr)||[]).forEach(function(s){var a=Ue(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[FM.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function PM(){}function IM(){}var OM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,LM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,MM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function BM(e,t,r){t.themeElements={};var n;[["clrScheme",OM,RM],["fontScheme",LM,PM],["fmtScheme",MM,IM]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var UM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function xE(e,t){(!e||e.length===0)&&(e=Zx());var r,n={};if(!(r=e.match(UM)))throw new Error("themeElements not found in theme");return BM(r[0],n,t),n.raw=e,n}function Zx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ar];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function $M(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=db(a,{type:"array"})}catch{return}var o=kn(i,"theme/theme/theme1.xml",!0);if(o)return xE(o,r)}}function zM(e){return e.read_shift(4)}function WM(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=VM(e,4);break;case 2:t.xclrValue=qb(e);break;case 3:t.xclrValue=zM(e);break;case 4:e.l+=4;break}return e.l+=8,t}function VM(e,t){return Kr(e,t)}function HM(e,t){return Kr(e,t)}function GM(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=WM(e);break;case 6:n[1]=HM(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function XM(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(GM(e,r-e.l));return{ixfe:n,ext:a}}function KM(e,t){t.forEach(function(r){switch(r[0]){}})}function qM(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Gr(e)}}function YM(e){var t=de(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Tr(e.name,t),t.slice(0,t.l)}function JM(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function QM(e){var t=de(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function ZM(e,t){var r=de(8+2*t.length);return r.write_shift(4,e),Tr(t,r),r.slice(0,r.l)}function e7(e){return e.l+=4,e.read_shift(4)!=0}function t7(e,t){var r=de(8);return r.write_shift(4,e),r.write_shift(4,1),r}function r7(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return ua(e,function(c,u,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(f),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function n7(){var e=gn();return me(e,332),me(e,334,fs(1)),me(e,335,YM({name:"XLDAPR",version:12e4,flags:3496657072})),me(e,336),me(e,339,ZM(1,"XLDAPR")),me(e,52),me(e,35,fs(514)),me(e,4096,fs(0)),me(e,4097,Mn(1)),me(e,36),me(e,53),me(e,340),me(e,337,t7(1)),me(e,51,QM([[1,0]])),me(e,338),me(e,333),e.end()}function s7(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(qr,function(o){var c=Ue(o);switch(Ls(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function gE(){var e=[ar];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function a7(e){var t=[];if(!e)return t;var r=1;return(e.match(qr)||[]).forEach(function(n){var s=Ue(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function i7(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Be(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function o7(e,t,r){var n=[];return ua(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function l7(e,t,r,n){if(!e)return e;var s=n||{},a=!1;ua(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function c7(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Po=1024;function vE(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Se("xml",null,{"xmlns:v":_n.v,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:mv":_n.mv}).replace(/\/>/,">"),Se("o:shapelayout",Se("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Se("v:shapetype",[Se("v:stroke",null,{joinstyle:"miter"}),Se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Po<e*1e3;)Po+=1e3;return t.forEach(function(a){var i=Wt(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Se("v:fill",c,o),f={on:"t",obscured:"t"};++Po,s=s.concat(["<v:shape"+Gc({id:"_x0000_s"+Po,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Se("v:shadow",null,f),Se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Dr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Dr("x:AutoFill","False"),Dr("x:Row",String(i.r)),Dr("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function gy(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=Wt(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=ct(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Ke(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}a.c.push(f)})}function u7(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ue(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=Wt(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&Yx(d[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function yE(e){var t=[ar,Se("comments",null,{xmlns:qi[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=wt(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(wt(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(Dr("t",wt(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(Dr("t",wt(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function f7(e,t){var r=[],n=!1,s={},a=0;return e.replace(qr,function(o,c){var u=Ue(o);switch(Ls(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function d7(e,t,r){var n=[ar,Se("ThreadedComments",null,{xmlns:vr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Se("threadedComment",Dr("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function h7(e,t){var r=[],n=!1;return e.replace(qr,function(a){var i=Ue(a);switch(Ls(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function p7(e){var t=[ar,Se("personList",null,{xmlns:vr.TCMNT,"xmlns:x":qi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Se("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function m7(e){var t={};t.iauthor=e.read_shift(4);var r=Zi(e);return t.rfx=r.s,t.ref=Be(r.s),e.l+=16,t}function x7(e,t){return t==null&&(t=de(36)),t.write_shift(4,e[1].iauthor),kl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var g7=Gr;function v7(e){return Tr(e.slice(0,54))}function y7(e,t){var r=[],n=[],s={},a=!1;return ua(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function w7(e){var t=gn(),r=[];return me(t,628),me(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),me(t,632,v7(s.a)))})}),me(t,631),me(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Wt(n[0]),e:Wt(n[0])};me(t,635,x7([a,s])),s.t&&s.t.length>0&&me(t,637,z6(s)),me(t,636),delete s.iauthor})}),me(t,634),me(t,629),t.end()}var _7="application/vnd.ms-office.vbaProject";function S7(e){var t=Re.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Re.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Re.write(t)}function k7(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Re.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var wE=["xlsb","xlsm","xlam","biff8","xla"];function b7(){return{"!type":"dialog"}}function E7(){return{"!type":"dialog"}}function T7(){return{"!type":"macro"}}function C7(){return{"!type":"macro"}}var Go=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,c?u+=t.r:--u,s+(o?"":"$")+Ot(f)+(c?"":"$")+Zt(u)}return function(s,a){return t=a,s.replace(e,r)}}(),eg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,tg=function(){return function(t,r){return t.replace(eg,function(n,s,a,i,o,c){var u=$x(i)-(a?0:r.c),f=Ux(c)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=u==0?"":a?u+1:"["+u+"]";return s+"R"+d+"C"+h})}}();function _E(e,t){return e.replace(eg,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Ot($x(a)+t.c))+(i=="$"?i+o:Zt(Ux(o)+t.r))})}function N7(e,t,r){var n=nn(t),s=n.s,a=Wt(r),i={r:a.r-s.r,c:a.c-s.c};return _E(e,i)}function A7(e){return e.length!=1}function vy(e){return e.replace(/_xlfn\./g,"")}function lr(e){e.l+=1}function Ga(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function SE(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return kE(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Ga(e),o=Ga(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function kE(e){var t=Ga(e),r=Ga(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function j7(e,t,r){if(r.biff<8)return kE(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Ga(e),i=Ga(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function bE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return D7(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Ga(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function D7(e){var t=Ga(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function F7(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function R7(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return P7(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function P7(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function I7(e,t,r){var n=(e[e.l++]&96)>>5,s=SE(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function O7(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=SE(e,a,r);return[n,s,i]}function L7(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function M7(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function B7(e,t,r){var n=(e[e.l++]&96)>>5,s=j7(e,t-1,r);return[n,s]}function U7(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function yy(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function $7(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function z7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function W7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function V7(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function H7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function EE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function G7(e){return e.read_shift(2),EE(e)}function X7(e){return e.read_shift(2),EE(e)}function K7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=bE(e,0,r);return[n,s]}function q7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=R7(e,0,r);return[n,s]}function Y7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=bE(e,0,r);return[n,s,a]}function J7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[e9[s],NE[s],n]}function Q7(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Z7(e);return[s,(a[0]===0?NE:ZB)[a[1]]]}function Z7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function eB(e,t,r){e.l+=r&&r.biff==2?3:4}function tB(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function rB(e){return e.l++,fa[e.read_shift(1)]}function nB(e){return e.l++,e.read_shift(2)}function sB(e){return e.l++,e.read_shift(1)!==0}function aB(e){return e.l++,Vr(e)}function iB(e,t,r){return e.l++,xu(e,t-1,r)}function oB(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=nr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=fa[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Vr(e);break;case 2:r[1]=eo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function lB(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?Zi:s0)(e));return s}function cB(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=oB(e,r.biff);return i}function uB(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function fB(e,t,r){if(r.biff==5)return dB(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function dB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function hB(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function pB(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function mB(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function xB(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var gB=Kr,vB=Kr,yB=Kr;function vu(e,t,r){return e.l+=2,[F7(e)]}function rg(e){return e.l+=6,[]}var wB=vu,_B=rg,SB=rg,kB=vu;function TE(e){return e.l+=2,[ur(e),e.read_shift(2)&1]}var bB=vu,EB=TE,TB=rg,CB=vu,NB=vu,AB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jB(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=AB[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function DB(e){return e.l+=2,[e.read_shift(4)]}function FB(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function RB(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function PB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function IB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function OB(e){return e.l+=4,[0,0]}var wy={1:{n:"PtgExp",f:tB},2:{n:"PtgTbl",f:yB},3:{n:"PtgAdd",f:lr},4:{n:"PtgSub",f:lr},5:{n:"PtgMul",f:lr},6:{n:"PtgDiv",f:lr},7:{n:"PtgPower",f:lr},8:{n:"PtgConcat",f:lr},9:{n:"PtgLt",f:lr},10:{n:"PtgLe",f:lr},11:{n:"PtgEq",f:lr},12:{n:"PtgGe",f:lr},13:{n:"PtgGt",f:lr},14:{n:"PtgNe",f:lr},15:{n:"PtgIsect",f:lr},16:{n:"PtgUnion",f:lr},17:{n:"PtgRange",f:lr},18:{n:"PtgUplus",f:lr},19:{n:"PtgUminus",f:lr},20:{n:"PtgPercent",f:lr},21:{n:"PtgParen",f:lr},22:{n:"PtgMissArg",f:lr},23:{n:"PtgStr",f:iB},26:{n:"PtgSheet",f:FB},27:{n:"PtgEndSheet",f:RB},28:{n:"PtgErr",f:rB},29:{n:"PtgBool",f:sB},30:{n:"PtgInt",f:nB},31:{n:"PtgNum",f:aB},32:{n:"PtgArray",f:U7},33:{n:"PtgFunc",f:J7},34:{n:"PtgFuncVar",f:Q7},35:{n:"PtgName",f:uB},36:{n:"PtgRef",f:K7},37:{n:"PtgArea",f:I7},38:{n:"PtgMemArea",f:hB},39:{n:"PtgMemErr",f:gB},40:{n:"PtgMemNoMem",f:vB},41:{n:"PtgMemFunc",f:pB},42:{n:"PtgRefErr",f:mB},43:{n:"PtgAreaErr",f:L7},44:{n:"PtgRefN",f:q7},45:{n:"PtgAreaN",f:B7},46:{n:"PtgMemAreaN",f:PB},47:{n:"PtgMemNoMemN",f:IB},57:{n:"PtgNameX",f:fB},58:{n:"PtgRef3d",f:Y7},59:{n:"PtgArea3d",f:O7},60:{n:"PtgRefErr3d",f:xB},61:{n:"PtgAreaErr3d",f:M7},255:{}},LB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},MB={1:{n:"PtgElfLel",f:TE},2:{n:"PtgElfRw",f:CB},3:{n:"PtgElfCol",f:wB},6:{n:"PtgElfRwV",f:NB},7:{n:"PtgElfColV",f:kB},10:{n:"PtgElfRadical",f:bB},11:{n:"PtgElfRadicalS",f:TB},13:{n:"PtgElfColS",f:_B},15:{n:"PtgElfColSV",f:SB},16:{n:"PtgElfRadicalLel",f:EB},25:{n:"PtgList",f:jB},29:{n:"PtgSxName",f:DB},255:{}},BB={0:{n:"PtgAttrNoop",f:OB},1:{n:"PtgAttrSemi",f:H7},2:{n:"PtgAttrIf",f:W7},4:{n:"PtgAttrChoose",f:$7},8:{n:"PtgAttrGoto",f:z7},16:{n:"PtgAttrSum",f:eB},32:{n:"PtgAttrBaxcel",f:yy},33:{n:"PtgAttrBaxcel",f:yy},64:{n:"PtgAttrSpace",f:G7},65:{n:"PtgAttrSpaceSemi",f:X7},128:{n:"PtgAttrIfError",f:V7},255:{}};function yu(e,t,r,n){if(n.biff<8)return Kr(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=cB(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=lB(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Kr(e,t)),a}function wu(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=wy[a]||wy[LB[a]],(a===24||a===25)&&(s=(a===24?MB:BB)[e[e.l+1]]),!s||!s.f?Kr(e,t):i.push([s.n,s.f(e,t,r)]);return i}function UB(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var $B={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zB(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function CE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function _y(e,t,r){var n=CE(e,t,r);return n=="#REF"?n:zB(n,r)}function $r(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,u,f,d=0,h=0,p,x="";if(!e[0]||!e[0][0])return"";for(var m=-1,v="",g=0,w=e[0].length;g<w;++g){var y=e[0][g];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:v=Qt(" ",e[0][m][1][1]);break;case 1:v=Qt("\r",e[0][m][1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+v,m=-1}o.push(u+$B[y[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=cc(y[1][1],i,s),o.push(uc(f,a));break;case"PtgRefN":f=r?cc(y[1][1],r,s):y[1][1],o.push(uc(f,a));break;case"PtgRef3d":d=y[1][1],f=cc(y[1][2],i,s),x=_y(n,d,s),o.push(x+"!"+uc(f,a));break;case"PtgFunc":case"PtgFuncVar":var k=y[1][0],E=y[1][1];k||(k=0),k&=127;var S=k==0?[]:o.slice(-k);o.length-=k,E==="User"&&(E=S.shift()),o.push(E+"("+S.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=Y1(y[1][1],r?{s:r}:i,s),o.push(uh(p,s));break;case"PtgArea":p=Y1(y[1][1],i,s),o.push(uh(p,s));break;case"PtgArea3d":d=y[1][1],p=y[1][2],x=_y(n,d,s),o.push(x+"!"+uh(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var _=(n.names||[])[h-1]||(n[0]||[])[h],A=_?_.Name:"SH33TJSNAME"+String(h);A&&A.slice(0,6)=="_xlfn."&&!s.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var F=y[1][1];h=y[1][2];var U;if(s.biff<=5)F<0&&(F=-F),n[F]&&(U=n[F][h]);else{var V="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][h]&&n[F][h].itab>0&&(V=n.SheetNames[n[F][h].itab-1]+"!"):V=n.SheetNames[h-1]+"!"),n[F]&&n[F][h])V+=n[F][h].Name;else if(n[0]&&n[0][h])V+=n[0][h].Name;else{var N=(CE(n,F,s)||"").split(";;");N[h-1]?V=N[h-1]:V+="SH33TJSERRX"}o.push(V);break}U||(U={Name:"SH33TJSERRY"}),o.push(U.Name);break;case"PtgParen":var X="(",le=")";if(m>=0){switch(v="",e[0][m][1][0]){case 2:X=Qt(" ",e[0][m][1][1])+X;break;case 3:X=Qt("\r",e[0][m][1][1])+X;break;case 4:le=Qt(" ",e[0][m][1][1])+le;break;case 5:le=Qt("\r",e[0][m][1][1])+le;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(X+o.pop()+le);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:y[1][1],r:y[1][0]};var J={c:r.c,r:r.r};if(n.sharedf[Be(f)]){var Z=n.sharedf[Be(f)];o.push($r(Z,i,J,n,s))}else{var re=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push($r(u[1],i,J,n,s)),re=!0;break}re||o.push(y[1])}break;case"PtgArray":o.push("{"+UB(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&te.indexOf(e[0][g][0])==-1){y=e[0][m];var z=!0;switch(y[1][0]){case 4:z=!1;case 0:v=Qt(" ",y[1][1]);break;case 5:z=!1;case 1:v=Qt("\r",y[1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((z?v:"")+o.pop()+(z?"":v)),m=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function WB(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Kr(e,t-2)];var o=wu(e,i,r);return t!==i+s&&(a=yu(e,t-i-s,o,r)),e.l=n,[o,a]}function VB(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Kr(e,t-2)];var o=wu(e,i,r);return t!==i+s&&(a=yu(e,t-i-s,o,r)),e.l=n,[o,a]}function HB(e,t,r,n){var s=e.l+t,a=wu(e,n,r),i;return s!==e.l&&(i=yu(e,s-e.l,a,r)),[a,i]}function GB(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=wu(e,a,r);return a==65535?[[],Kr(e,t-2)]:(t!==a+2&&(s=yu(e,n-a-2,i,r)),[i,s])}function XB(e){var t;if(Ks(e,e.l+6)!==65535)return[Vr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function KB(e){if(e==null){var t=de(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Mi(e);return Mi(0)}function mh(e,t,r){var n=e.l+t,s=Ms(e);r.biff==2&&++e.l;var a=XB(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=VB(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function qB(e,t,r,n,s){var a=Ui(t,r,s),i=KB(e.v),o=de(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=de(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var d=Er([a,i,o,u]);return d}function a0(e,t,r){var n=e.read_shift(4),s=wu(e,n,r),a=e.read_shift(4),i=a>0?yu(e,a,s,r):null;return[s,i]}var YB=a0,i0=a0,JB=a0,QB=a0,ZB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},NE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},e9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Sy(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function t9(e){var t="of:="+e.replace(eg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function xh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function r9(e){return e.replace(/\./,"!")}var dc={},Xo={},hc=typeof Map<"u";function ng(e,t,r){var n=0,s=e.length;if(r){if(hc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=hc?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(hc?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function o0(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Wr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Jc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=yd(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Si(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ri(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Rs(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function AE(e,t,r,n,s,a){try{n.cellNF&&(e.z=Pe[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Lt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Pe[t]==null&&Rs(Q8[t]||"General",t),e.t==="e")e.w=e.w||fa[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vc(e.v);else if(e.t==="d"){var i=wr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Vc(i)}else{if(e.v===void 0)return"";e.w=Oi(e.v,Xo)}else e.t==="d"?e.w=jn(t,wr(e.v),Xo):e.w=jn(t,e.v,Xo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=vd(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=vd(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function n9(e,t,r){if(e&&e["!ref"]){var n=ct(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function s9(e,t){var r=ct(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ke(r))}var a9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,i9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,o9=/<(?:\w:)?hyperlink [^>]*>/mg,l9=/"(\w*:\w*)"/,c9=/<(?:\w:)?col\b[^>]*[\/]?>/g,u9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,f9=/<(?:\w:)?pageMargins[^>]*\/>/g,jE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,d9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,h9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function p9(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(i9);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var h=u.match(jE);h?sg(h[0],o,s,r):(h=u.match(d9))&&x9(h[0],h[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(l9);x&&s9(o,x[1])}var m=u.match(h9);m&&m[1]&&A9(m[1],s);var v=[];if(t.cellStyles){var g=u.match(c9);g&&b9(v,g)}d&&F9(d[1],o,t,c,a,i);var w=f.match(u9);w&&(o["!autofilter"]=T9(w[0]));var y=[],k=f.match(a9);if(k)for(p=0;p!=k.length;++p)y[p]=ct(k[p].slice(k[p].indexOf('"')+1));var E=f.match(o9);E&&_9(o,E,n);var S=f.match(f9);if(S&&(o["!margins"]=S9(Ue(S[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ke(c)),t.sheetRows>0&&o["!ref"]){var _=ct(o["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ke(_))}return v.length>0&&(o["!cols"]=v),y.length>0&&(o["!merges"]=y),o}function m9(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ke(e[r])+'"/>';return t+"</mergeCells>"}function sg(e,t,r,n){var s=Ue(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=xt(St(s.codeName)))}function x9(e,t,r,n,s){sg(e.slice(0,e.indexOf(">")),r,n,s)}function g9(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=Cs(wt(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Se("outlinePr",null,u)}!a&&!o||(s[s.length]=Se("sheetPr",o,i))}var v9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],y9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function w9(e){var t={sheet:1};return v9.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),y9.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Jx(e.password).toString(16).toUpperCase()),Se("sheetProtection",null,t)}function _9(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Ue(St(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+xt(a.location))):(a.Target="#"+xt(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=ct(a.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var f=Be({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function S9(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function k9(e){return Si(e),Se("pageMargins",null,e)}function b9(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Ue(t[n],!0);s.hidden&&(s.hidden=Pt(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Qx(s.width)),Ha(s);a<=i;)e[a++]=Tt(s)}}function E9(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Se("col",null,o0(s,n)));return r[r.length]="</cols>",r.join("")}function T9(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function C9(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Ke(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=nn(s);i.s.r==i.e.r&&(i.e.r=nn(t["!ref"]).e.r,s=Ke(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Se("autoFilter",null,{ref:s})}var N9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function A9(e,t){t.Views||(t.Views=[{}]),(e.match(N9)||[]).forEach(function(r,n){var s=Ue(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Pt(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function j9(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Se("sheetViews",Se("sheetView",null,s),{})}function D9(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=fa[e.v];break;case"d":n&&n.cellDates?s=Lt(e.v,-1).toISOString():(e=Tt(e),e.t="n",s=""+(e.v=wr(Lt(e.v)))),typeof e.z>"u"&&(e.z=Pe[14]);break;default:s=e.v;break}var o=Dr("v",wt(s)),c={r:t},u=ri(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Dr("v",""+ng(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Se("f",wt(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Se("c",o,c)}var F9=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Hc("v"),i=Hc("f");return function(c,u,f,d,h,p){for(var x=0,m="",v=[],g=[],w=0,y=0,k=0,E="",S,_,A=0,F=0,U,V,N=0,X=0,le=Array.isArray(p.CellXf),J,Z=[],re=[],te=Array.isArray(u),z=[],K={},se=!1,P=!!f.sheetStubs,b=c.split(t),D=0,R=b.length;D!=R;++D){m=b[D].trim();var W=m.length;if(W!==0){var q=0;e:for(x=0;x<W;++x)switch(m[x]){case">":if(m[x-1]!="/"){++x;break e}if(f&&f.cellStyles){if(_=Ue(m.slice(q,x),!0),A=_.r!=null?parseInt(_.r,10):A+1,F=-1,f.sheetRows&&f.sheetRows<A)continue;K={},se=!1,_.ht&&(se=!0,K.hpt=parseFloat(_.ht),K.hpx=ll(K.hpt)),_.hidden=="1"&&(se=!0,K.hidden=!0),_.outlineLevel!=null&&(se=!0,K.level=+_.outlineLevel),se&&(z[A-1]=K)}break;case"<":q=x;break}if(q>=x)break;if(_=Ue(m.slice(q,x),!0),A=_.r!=null?parseInt(_.r,10):A+1,F=-1,!(f.sheetRows&&f.sheetRows<A)){d.s.r>A-1&&(d.s.r=A-1),d.e.r<A-1&&(d.e.r=A-1),f&&f.cellStyles&&(K={},se=!1,_.ht&&(se=!0,K.hpt=parseFloat(_.ht),K.hpx=ll(K.hpt)),_.hidden=="1"&&(se=!0,K.hidden=!0),_.outlineLevel!=null&&(se=!0,K.level=+_.outlineLevel),se&&(z[A-1]=K)),v=m.slice(x).split(e);for(var H=0;H!=v.length&&v[H].trim().charAt(0)=="<";++H);for(v=v.slice(H),x=0;x!=v.length;++x)if(m=v[x].trim(),m.length!==0){if(g=m.match(r),w=x,y=0,k=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,g!=null&&g.length===2){for(w=0,E=g[1],y=0;y!=E.length&&!((k=E.charCodeAt(y)-64)<1||k>26);++y)w=26*w+k;--w,F=w}else++F;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,_=Ue(m.slice(0,y),!0),_.r||(_.r=Be({r:A-1,c:F})),E=m.slice(y),S={t:""},(g=E.match(a))!=null&&g[1]!==""&&(S.v=xt(g[1])),f.cellFormula){if((g=E.match(i))!=null&&g[1]!==""){if(S.f=xt(St(g[1])).replace(/\r\n/g,`
`),f.xlfn||(S.f=vy(S.f)),g[0].indexOf('t="array"')>-1)S.F=(E.match(s)||[])[1],S.F.indexOf(":")>-1&&Z.push([ct(S.F),S.F]);else if(g[0].indexOf('t="shared"')>-1){V=Ue(g[0]);var Q=xt(St(g[1]));f.xlfn||(Q=vy(Q)),re[parseInt(V.si,10)]=[V,Q,_.r]}}else(g=E.match(/<f[^>]*\/>/))&&(V=Ue(g[0]),re[V.si]&&(S.f=N7(re[V.si][1],re[V.si][2],_.r)));var ee=Wt(_.r);for(y=0;y<Z.length;++y)ee.r>=Z[y][0].s.r&&ee.r<=Z[y][0].e.r&&ee.c>=Z[y][0].s.c&&ee.c<=Z[y][0].e.c&&(S.F=Z[y][1])}if(_.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else if(P)S.t="z";else continue;else S.t=_.t||"n";switch(d.s.c>F&&(d.s.c=F),d.e.c<F&&(d.e.c=F),S.t){case"n":if(S.v==""||S.v==null){if(!P)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!P)continue;S.t="z"}else U=dc[parseInt(S.v,10)],S.v=U.t,S.r=U.r,f.cellHTML&&(S.h=U.h);break;case"str":S.t="s",S.v=S.v!=null?St(S.v):"",f.cellHTML&&(S.h=Fx(S.v));break;case"inlineStr":g=E.match(n),S.t="s",g!=null&&(U=Yx(g[1]))?(S.v=U.t,f.cellHTML&&(S.h=U.h)):S.v="";break;case"b":S.v=Pt(S.v);break;case"d":f.cellDates?S.v=Lt(S.v,1):(S.v=wr(Lt(S.v,1)),S.t="n");break;case"e":(!f||f.cellText!==!1)&&(S.w=S.v),S.v=Fb[S.v];break}if(N=X=0,J=null,le&&_.s!==void 0&&(J=p.CellXf[_.s],J!=null&&(J.numFmtId!=null&&(N=J.numFmtId),f.cellStyles&&J.fillId!=null&&(X=J.fillId))),AE(S,N,X,f,h,p),f.cellDates&&le&&S.t=="n"&&Ki(Pe[N])&&(S.t="d",S.v=r0(S.v)),_.cm&&f.xlmeta){var G=(f.xlmeta.Cell||[])[+_.cm-1];G&&G.type=="XLDAPR"&&(S.D=!0)}if(te){var C=Wt(_.r);u[C.r]||(u[C.r]=[]),u[C.r][C.c]=S}else u[_.r]=S}}}}z.length>0&&(u["!rows"]=z)}}();function R9(e,t,r,n){var s=[],a=[],i=ct(e["!ref"]),o="",c,u="",f=[],d=0,h=0,p=e["!rows"],x=Array.isArray(e),m={r:u},v,g=-1;for(h=i.s.c;h<=i.e.c;++h)f[h]=Ot(h);for(d=i.s.r;d<=i.e.r;++d){for(a=[],u=Zt(d),h=i.s.c;h<=i.e.c;++h){c=f[h]+u;var w=x?(e[d]||[])[h]:e[c];w!==void 0&&(o=D9(w,c,e,t))!=null&&a.push(o)}(a.length>0||p&&p[d])&&(m={r:u},p&&p[d]&&(v=p[d],v.hidden&&(m.hidden=1),g=-1,v.hpx?g=Qc(v.hpx):v.hpt&&(g=v.hpt),g>-1&&(m.ht=g,m.customHeight=1),v.level&&(m.outlineLevel=v.level)),s[s.length]=Se("row",a.join(""),m))}if(p)for(;d<p.length;++d)p&&p[d]&&(m={r:d+1},v=p[d],v.hidden&&(m.hidden=1),g=-1,v.hpx?g=Qc(v.hpx):v.hpt&&(g=v.hpt),g>-1&&(m.ht=g,m.customHeight=1),v.level&&(m.outlineLevel=v.level),s[s.length]=Se("row","",m));return s.join("")}function DE(e,t,r,n){var s=[ar,Se("worksheet",null,{xmlns:qi[0],"xmlns:r":vr.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",f=ct(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Ke(f)}n||(n={}),c["!comments"]=[];var d=[];g9(c,r,e,t,s),s[s.length]=Se("dimension",null,{ref:u}),s[s.length]=j9(c,t,e,r),t.sheetFormat&&(s[s.length]=Se("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=E9(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=R9(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=w9(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=C9(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=m9(c["!merges"]));var h=-1,p,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(x=yt(n,-1,wt(m[1].Target).replace(/#.*$/,""),et.HLINK),p["r:id"]="rId"+x),(h=m[1].Target.indexOf("#"))>-1&&(p.location=wt(m[1].Target.slice(h+1))),m[1].Tooltip&&(p.tooltip=wt(m[1].Tooltip)),s[s.length]=Se("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=k9(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Dr("ignoredErrors",Se("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(x=yt(n,-1,"../drawings/drawing"+(e+1)+".xml",et.DRAW),s[s.length]=Se("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=d),c["!comments"].length>0&&(x=yt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",et.VML),s[s.length]=Se("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function P9(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function I9(e,t,r){var n=de(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=Qc(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,h=-1,p=f<<10;p<f+1<<10;++p){u.c=p;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Be(u)];x&&(d<0&&(d=p),h=p)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,h))}var m=n.l;return n.l=c,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function O9(e,t,r,n){var s=I9(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&me(e,0,s)}var L9=Zi,M9=kl;function B9(){}function U9(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=W6(e),r}function $9(e,t,r){r==null&&(r=de(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return md({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Cb(e,r),r.slice(0,r.l)}function z9(e){var t=qn(e);return[t]}function W9(e,t,r){return r==null&&(r=de(8)),Yi(t,r)}function V9(e){var t=Ji(e);return[t]}function H9(e,t,r){return r==null&&(r=de(4)),Qi(t,r)}function G9(e){var t=qn(e),r=e.read_shift(1);return[t,r,"b"]}function X9(e,t,r){return r==null&&(r=de(9)),Yi(t,r),r.write_shift(1,e.v?1:0),r}function K9(e){var t=Ji(e),r=e.read_shift(1);return[t,r,"b"]}function q9(e,t,r){return r==null&&(r=de(5)),Qi(t,r),r.write_shift(1,e.v?1:0),r}function Y9(e){var t=qn(e),r=e.read_shift(1);return[t,r,"e"]}function J9(e,t,r){return r==null&&(r=de(9)),Yi(t,r),r.write_shift(1,e.v),r}function Q9(e){var t=Ji(e),r=e.read_shift(1);return[t,r,"e"]}function Z9(e,t,r){return r==null&&(r=de(8)),Qi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function eU(e){var t=qn(e),r=e.read_shift(4);return[t,r,"s"]}function tU(e,t,r){return r==null&&(r=de(12)),Yi(t,r),r.write_shift(4,t.v),r}function rU(e){var t=Ji(e),r=e.read_shift(4);return[t,r,"s"]}function nU(e,t,r){return r==null&&(r=de(8)),Qi(t,r),r.write_shift(4,t.v),r}function sU(e){var t=qn(e),r=Vr(e);return[t,r,"n"]}function aU(e,t,r){return r==null&&(r=de(16)),Yi(t,r),Mi(e.v,r),r}function FE(e){var t=Ji(e),r=Vr(e);return[t,r,"n"]}function iU(e,t,r){return r==null&&(r=de(12)),Qi(t,r),Mi(e.v,r),r}function oU(e){var t=qn(e),r=Hx(e);return[t,r,"n"]}function lU(e,t,r){return r==null&&(r=de(12)),Yi(t,r),Nb(e.v,r),r}function cU(e){var t=Ji(e),r=Hx(e);return[t,r,"n"]}function uU(e,t,r){return r==null&&(r=de(8)),Qi(t,r),Nb(e.v,r),r}function fU(e){var t=qn(e),r=zx(e);return[t,r,"is"]}function dU(e){var t=qn(e),r=Gr(e);return[t,r,"str"]}function hU(e,t,r){return r==null&&(r=de(12+4*e.v.length)),Yi(t,r),Tr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function pU(e){var t=Ji(e),r=Gr(e);return[t,r,"str"]}function mU(e,t,r){return r==null&&(r=de(8+4*e.v.length)),Qi(t,r),Tr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function xU(e,t,r){var n=e.l+t,s=qn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=$r(o,null,s,r.supbooks,r)}else e.l=n;return i}function gU(e,t,r){var n=e.l+t,s=qn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=$r(o,null,s,r.supbooks,r)}else e.l=n;return i}function vU(e,t,r){var n=e.l+t,s=qn(e);s.r=r["!row"];var a=Vr(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=$r(o,null,s,r.supbooks,r)}else e.l=n;return i}function yU(e,t,r){var n=e.l+t,s=qn(e);s.r=r["!row"];var a=Gr(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=$r(o,null,s,r.supbooks,r)}else e.l=n;return i}var wU=Zi,_U=kl;function SU(e,t){return t==null&&(t=de(4)),t.write_shift(4,e),t}function kU(e,t){var r=e.l+t,n=Zi(e),s=Wx(e),a=Gr(e),i=Gr(e),o=Gr(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function bU(e,t){var r=de(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));kl({s:Wt(e[0]),e:Wt(e[0])},r),Vx("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Tr(s||"",r),Tr(e[1].Tooltip||"",r),Tr("",r),r.slice(0,r.l)}function EU(){}function TU(e,t,r){var n=e.l+t,s=Ab(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=YB(e,n-e.l,r);i[1]=o}else e.l=n;return i}function CU(e,t,r){var n=e.l+t,s=Zi(e),a=[s];if(r.cellFormula){var i=QB(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function NU(e,t,r){r==null&&(r=de(18));var n=o0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var RE=["left","right","top","bottom","header","footer"];function AU(e){var t={};return RE.forEach(function(r){t[r]=Vr(e)}),t}function jU(e,t){return t==null&&(t=de(6*8)),Si(e),RE.forEach(function(r){Mi(e[r],t)}),t}function DU(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function FU(e,t,r){r==null&&(r=de(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function RU(e){var t=de(24);return t.write_shift(4,4),t.write_shift(4,1),kl(e,t),t}function PU(e,t){return t==null&&(t=de(16*4+2)),t.write_shift(2,e.password?Jx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function IU(){}function OU(){}function LU(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,p,x,m,v,g,w,y,k,E,S=[];o.biff=12,o["!row"]=0;var _=0,A=!1,F=[],U={},V=o.supbooks||s.supbooks||[[]];if(V.sharedf=U,V.arrayf=F,V.SheetNames=s.SheetNames||s.Sheets.map(function(te){return te.name}),!o.supbooks&&(o.supbooks=V,s.Names))for(var N=0;N<s.Names.length;++N)V[0][N+1]=s.Names[N];var X=[],le=[],J=!1;Zc[16]={n:"BrtShortReal",f:FE};var Z;if(ua(e,function(z,K,se){if(!h)switch(se){case 148:u=z;break;case 0:p=z,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),k=Zt(v=p.r),o["!row"]=p.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=ll(z.hpt)),le[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:z[2]},z[2]){case"n":x.v=z[1];break;case"s":y=dc[z[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!z[1];break;case"e":x.v=z[1],o.cellText!==!1&&(x.w=fa[x.v]);break;case"str":x.t="s",x.v=z[1];break;case"is":x.t="s",x.v=z[1].t;break}if((m=i.CellXf[z[0].iStyleRef])&&AE(x,m.numFmtId,null,o,a,i),g=z[0].c==-1?g+1:z[0].c,o.dense?(c[v]||(c[v]=[]),c[v][g]=x):c[Ot(g)+k]=x,o.cellFormula){for(A=!1,_=0;_<F.length;++_){var P=F[_];p.r>=P[0].s.r&&p.r<=P[0].e.r&&g>=P[0].s.c&&g<=P[0].e.c&&(x.F=Ke(P[0]),A=!0)}!A&&z.length>3&&(x.f=z[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>g&&(f.s.c=g),f.e.r<p.r&&(f.e.r=p.r),f.e.c<g&&(f.e.c=g),o.cellDates&&m&&x.t=="n"&&Ki(Pe[m.numFmtId])){var b=Ta(x.v);b&&(x.t="d",x.v=new Date(b.y,b.m-1,b.d,b.H,b.M,b.S,b.u))}Z&&(Z.type=="XLDAPR"&&(x.D=!0),Z=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;x={t:"z",v:void 0},g=z[0].c==-1?g+1:z[0].c,o.dense?(c[v]||(c[v]=[]),c[v][g]=x):c[Ot(g)+k]=x,f.s.r>p.r&&(f.s.r=p.r),f.s.c>g&&(f.s.c=g),f.e.r<p.r&&(f.e.r=p.r),f.e.c<g&&(f.e.c=g),Z&&(Z.type=="XLDAPR"&&(x.D=!0),Z=void 0);break;case 176:S.push(z);break;case 49:Z=((o.xlmeta||{}).Cell||[])[z-1];break;case 494:var D=n["!id"][z.relId];for(D?(z.Target=D.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=D):z.relId==""&&(z.Target="#"+z.loc),v=z.rfx.s.r;v<=z.rfx.e.r;++v)for(g=z.rfx.s.c;g<=z.rfx.e.c;++g)o.dense?(c[v]||(c[v]=[]),c[v][g]||(c[v][g]={t:"z",v:void 0}),c[v][g].l=z):(w=Be({c:g,r:v}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=z);break;case 426:if(!o.cellFormula)break;F.push(z),E=o.dense?c[v][g]:c[Ot(g)+k],E.f=$r(z[1],f,{r:p.r,c:g},V,o),E.F=Ke(z[0]);break;case 427:if(!o.cellFormula)break;U[Be(z[0].s)]=z[1],E=o.dense?c[v][g]:c[Ot(g)+k],E.f=$r(z[1],f,{r:p.r,c:g},V,o);break;case 60:if(!o.cellStyles)break;for(;z.e>=z.s;)X[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},J||(J=!0,Qx(z.w/256)),Ha(X[z.e+1]);break;case 161:c["!autofilter"]={ref:Ke(z)};break;case 476:c["!margins"]=z;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),z.name&&(s.Sheets[r].CodeName=z.name),(z.above||z.left)&&(c["!outline"]={above:z.above,left:z.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),z.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!K.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+se.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Ke(u||f)),o.sheetRows&&c["!ref"]){var re=ct(c["!ref"]);o.sheetRows<=+re.e.r&&(re.e.r=o.sheetRows-1,re.e.r>f.e.r&&(re.e.r=f.e.r),re.e.r<re.s.r&&(re.s.r=re.e.r),re.e.c>f.e.c&&(re.e.c=f.e.c),re.e.c<re.s.c&&(re.s.c=re.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ke(re))}return S.length>0&&(c["!merges"]=S),X.length>0&&(c["!cols"]=X),le.length>0&&(c["!rows"]=le),c}function MU(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Tt(t),t.z=t.z||Pe[14],t.v=wr(Lt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=ri(s.cellXfs,t,s),t.l&&a["!links"].push([Be(c),t.l]),t.c&&a["!comments"].push([Be(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=ng(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?me(e,18,nU(t,c)):me(e,7,tU(t,c))):(c.t="str",i?me(e,17,mU(t,c)):me(e,6,hU(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?me(e,13,uU(t,c)):me(e,2,lU(t,c)):i?me(e,16,iU(t,c)):me(e,5,aU(t,c)),!0;case"b":return c.t="b",i?me(e,15,q9(t,c)):me(e,4,X9(t,c)),!0;case"e":return c.t="e",i?me(e,14,Z9(t,c)):me(e,3,J9(t,c)),!0}return i?me(e,12,H9(t,c)):me(e,1,W9(t,c)),!0}function BU(e,t,r,n){var s=ct(t["!ref"]||"A1"),a,i="",o=[];me(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var f=s.s.r;f<=u;++f){i=Zt(f),O9(e,t,s,f);var d=!1;if(f<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){f===s.s.r&&(o[h]=Ot(h)),a=o[h]+i;var p=c?(t[f]||[])[h]:t[a];if(!p){d=!1;continue}d=MU(e,p,f,h,n,t,d)}}me(e,146)}function UU(e,t){!t||!t["!merges"]||(me(e,177,SU(t["!merges"].length)),t["!merges"].forEach(function(r){me(e,176,_U(r))}),me(e,178))}function $U(e,t){!t||!t["!cols"]||(me(e,390),t["!cols"].forEach(function(r,n){r&&me(e,60,NU(n,r))}),me(e,391))}function zU(e,t){!t||!t["!ref"]||(me(e,648),me(e,649,RU(ct(t["!ref"]))),me(e,650))}function WU(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=yt(r,-1,n[1].Target.replace(/#.*$/,""),et.HLINK);me(e,494,bU(n,s))}}),delete t["!links"]}function VU(e,t,r,n){if(t["!comments"].length>0){var s=yt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",et.VML);me(e,551,Vx("rId"+s)),t["!legacy"]=s}}function HU(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Ke(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=nn(a);o.s.r==o.e.r&&(o.e.r=nn(t["!ref"]).e.r,a=Ke(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),me(e,161,kl(ct(a))),me(e,162)}}function GU(e,t,r){me(e,133),me(e,137,FU(t,r)),me(e,138),me(e,134)}function XU(e,t){t["!protect"]&&me(e,535,PU(t["!protect"]))}function KU(e,t,r,n){var s=gn(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=ct(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],me(s,129),(r.vbaraw||i["!outline"])&&me(s,147,$9(o,i["!outline"])),me(s,148,M9(c)),GU(s,i,r.Workbook),$U(s,i),BU(s,i,e,t),XU(s,i),HU(s,i,r,e),UU(s,i),WU(s,i,n),i["!margins"]&&me(s,476,jU(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&zU(s,i),VU(s,i,e,n),me(s,130),s.end()}function qU(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=xt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function YU(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=qU(d);f.s.r=f.s.c=0,f.e.c=o,u=Ot(o),h[0].forEach(function(p,x){i[u+Zt(x)]={t:"n",v:p,z:h[1]},c=x}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(i["!ref"]=Ke(f)),i}function JU(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(jE);return o&&sg(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function QU(e,t){e.l+=10;var r=Gr(e);return{name:r}}function ZU(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ua(e,function(c,u,f){switch(f){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var ag=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],e$=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],t$=[],r$=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ky(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Pt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function by(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Pt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function PE(e){by(e.WBProps,ag),by(e.CalcPr,r$),ky(e.WBView,e$),ky(e.Sheets,t$),Xo.date1904=Pt(e.WBProps.date1904)}function n$(e){return!e.Workbook||!e.Workbook.WBProps?"false":Pt(e.Workbook.WBProps.date1904)?"true":"false"}var s$="][*?/\\".split("");function IE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return s$.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function a$(e,t,r){e.forEach(function(n,s){IE(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function OE(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];a$(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)n9(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var i$=/<\w+:workbook/;function o$(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(qr,function(c,u){var f=Ue(c);switch(Ls(f[0])){case"<?xml":break;case"<workbook":c.match(i$)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ag.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=Pt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=St(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=xt(St(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=St(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),Pt(f.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=xt(St(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),qi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return PE(r),r}function LE(e){var t=[ar];t[t.length]=Se("workbook",null,{xmlns:qi[0],"xmlns:r":vr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ag.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Se("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:wt(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Se("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Se("definedName",wt(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function l$(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Vp(e),r.name=Gr(e),r}function c$(e,t){return t||(t=de(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Vx(e.strRelID,t),Tr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function u$(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Gr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function f$(e,t){t||(t=de(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Cb(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function d$(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function h$(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=V6(e),i=JB(e,0,r),o=Wx(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function p$(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Zc[16]={n:"BrtFRTArchID$",f:d$},ua(e,function(c,u,f){switch(f){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=$r(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,c]):i[0]=[f,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),PE(r),r.Names=a,r.supbooks=i,r}function m$(e,t){me(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};me(e,156,c$(s))}me(e,144)}function x$(e,t){t||(t=de(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Tr("SheetJS",t),Tr(zc.version,t),Tr(zc.version,t),Tr("7262",t),t.length>t.l?t.slice(0,t.l):t}function g$(e,t){t||(t=de(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function v$(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(me(e,135),me(e,158,g$(s)),me(e,136))}}function y$(e,t){var r=gn();return me(r,131),me(r,128,x$()),me(r,153,f$(e.Workbook&&e.Workbook.WBProps||null)),v$(r,e),m$(r,e),me(r,132),r.end()}function w$(e,t,r){return t.slice(-4)===".bin"?p$(e,r):o$(e,r)}function _$(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?LU(e,n,r,s,a,i,o):p9(e,n,r,s,a,i,o)}function S$(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?ZU(e,n,r,s,a):JU(e,n,r,s,a)}function k$(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?T7():C7()}function b$(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?b7():E7()}function E$(e,t,r,n){return t.slice(-4)===".bin"?_M(e,r,n):cM(e,r,n)}function T$(e,t,r){return xE(e,r)}function C$(e,t,r){return t.slice(-4)===".bin"?NL(e,r):EL(e,r)}function N$(e,t,r){return t.slice(-4)===".bin"?y7(e,r):u7(e,r)}function A$(e,t,r){return t.slice(-4)===".bin"?o7(e):a7(e)}function j$(e,t,r,n){return r.slice(-4)===".bin"?l7(e,t,r,n):void 0}function D$(e,t,r){return t.slice(-4)===".bin"?r7(e,t,r):s7(e,t,r)}function F$(e,t,r){return(t.slice(-4)===".bin"?y$:LE)(e)}function R$(e,t,r,n,s){return(t.slice(-4)===".bin"?KU:DE)(e,r,n,s)}function P$(e,t,r){return(t.slice(-4)===".bin"?DM:pE)(e,r)}function I$(e,t,r){return(t.slice(-4)===".bin"?DL:iE)(e,r)}function O$(e,t,r){return(t.slice(-4)===".bin"?w7:yE)(e)}function L$(e){return(e.slice(-4)===".bin"?n7:gE)()}var ME=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,BE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(ME),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(BE),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function M$(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(ME),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(BE),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var pc;function B$(e,t){var r=pc[e]||xt(e);return r==="General"?Oi(t):jn(r,t)}function U$(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Pt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Lt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[xt(t)]=s}function $$(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||fa[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vc(e.v):e.w=Oi(e.v):e.w=B$(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=pc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ki(n)){var s=Ta(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function z$(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=tM[n.Pattern]||n.Pattern)}e[t.ID]=t}function W$(e,t,r,n,s,a,i,o,c,u){var f="General",d=n.StyleID,h={};u=u||{};var p=[],x=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);a[d]!==void 0&&(a[d].nf&&(f=a[d].nf),a[d].Interior&&p.push(a[d].Interior),!!a[d].Parent);)d=a[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Pt(e);break;case"String":n.t="s",n.r=$1(xt(e)),n.v=e.indexOf("<")>-1?xt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Lt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=xt(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Fb[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=$1(t||e));break}if($$(n,f,u),u.cellFormula!==!1)if(n.Formula){var m=xt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Go(m,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Go("RC:RC",s):n.ArrayRange&&(n.F=Go(n.ArrayRange,s),c.push([ct(n.F),n.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(n.F=c[x][1]);u.cellStyles&&(p.forEach(function(v){!h.patternType&&v.patternType&&(h.patternType=v.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function V$(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function gh(e,t){var r=t||{};wl();var n=Ro(Rx(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof ht<"u"?n=ht.utils.decode(65001,ld(n)):n=St(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Tt(r);return i.type="string",ol.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(xe){s.indexOf("<"+xe)>=0&&(a=!0)}),a)return Tz(n,r);pc={"General Number":"General","General Date":Pe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Pe[15],"Short Date":Pe[14],"Long Time":Pe[19],"Medium Time":Pe[18],"Short Time":Pe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Pe[2],Standard:Pe[4],Percent:Pe[10],Scientific:Pe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,f={},d=[],h=r.dense?[]:{},p="",x={},m={},v=Zn('<Data ss:Type="String">'),g=0,w=0,y=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},S={},_="",A=0,F=[],U={},V={},N=0,X=[],le=[],J={},Z=[],re,te=!1,z=[],K=[],se={},P=0,b=0,D={Sheets:[],WBProps:{date1904:!1}},R={};Xc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";o=Xc.exec(n);)switch(o[3]=(W=o[3]).toLowerCase()){case"data":if(W=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?W$(n.slice(g,o.index),_,v,c[c.length-1][0]=="comment"?J:x,{c:w,r:y},E,Z[w],m,z,r):(_="",v=Zn(o[0]),g=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(le.length>0&&(x.c=le),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][w]=x):h[Ot(w)+Zt(y)]=x),x.HRef&&(x.l={Target:xt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(P=w+(parseInt(x.MergeAcross,10)|0),b=y+(parseInt(x.MergeDown,10)|0),F.push({s:{c:w,r:y},e:{c:P,r:b}})),!r.sheetStubs)x.MergeAcross?w=P+1:++w;else if(x.MergeAcross||x.MergeDown){for(var q=w;q<=P;++q)for(var H=y;H<=b;++H)(q>w||H>y)&&(r.dense?(h[H]||(h[H]=[]),h[H][q]={t:"z"}):h[Ot(q)+Zt(H)]={t:"z"});w=P+1}else++w;else x=M$(o[0]),x.Index&&(w=+x.Index-1),w<k.s.c&&(k.s.c=w),w>k.e.c&&(k.e.c=w),o[0].slice(-2)==="/>"&&++w,le=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<k.s.r&&(k.s.r=y),y>k.e.r&&(k.e.r=y),o[0].slice(-2)==="/>"&&(m=Zn(o[0]),m.Index&&(y=+m.Index-1)),w=0,++y):(m=Zn(o[0]),m.Index&&(y=+m.Index-1),se={},(m.AutoFitHeight=="0"||m.Height)&&(se.hpx=parseInt(m.Height,10),se.hpt=Qc(se.hpx),K[y]=se),m.Hidden=="1"&&(se.hidden=!0,K[y]=se));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(p),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(h["!ref"]=Ke(k),r.sheetRows&&r.sheetRows<=k.e.r&&(h["!fullref"]=h["!ref"],k.e.r=r.sheetRows-1,h["!ref"]=Ke(k))),F.length&&(h["!merges"]=F),Z.length>0&&(h["!cols"]=Z),K.length>0&&(h["!rows"]=K),f[p]=h}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=w=0,c.push([o[3],!1]),u=Zn(o[0]),p=xt(u.Name),h=r.dense?[]:{},F=[],z=[],K=[],R={name:p,Hidden:0},D.Sheets.push(R);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Z=[],te=!1}break;case"style":o[1]==="/"?z$(E,S,r):S=Zn(o[0]);break;case"numberformat":S.nf=xt(Zn(o[0]).Format||"General"),pc[S.nf]&&(S.nf=pc[S.nf]);for(var Q=0;Q!=392&&Pe[Q]!=S.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(Pe[Q]==null){Rs(S.nf,Q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(re=Zn(o[0]),re.Hidden&&(re.hidden=!0,delete re.Hidden),re.Width&&(re.wpx=parseInt(re.Width,10)),!te&&re.wpx>10){te=!0,Wr=dE;for(var ee=0;ee<Z.length;++ee)Z[ee]&&Ha(Z[ee])}te&&Ha(re),Z[re.Index-1||Z.length]=re;for(var G=0;G<+re.Span;++G)Z[Z.length]=Tt(re);break;case"namedrange":if(o[1]==="/")break;D.Names||(D.Names=[]);var C=Ue(o[0]),pe={Name:C.Name,Ref:Go(C.RefersTo.slice(1),{r:0,c:0})};D.Sheets.length>0&&(pe.Sheet=D.Sheets.length-1),D.Names.push(pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?_+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;S.Interior=Zn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?mO(U,W,n.slice(N,o.index)):N=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));V$(J),le.push(J)}else c.push([o[3],!1]),u=Zn(o[0]),J={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var _e=Zn(o[0]);h["!autofilter"]={ref:Go(_e.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Ay(n,r);var Y=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Y=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Y=!1}break;case"excelworkbook":switch(o[3]){case"date1904":D.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Y=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Y=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(N,o.index)){case"SheetHidden":R.Hidden=1;break;case"SheetVeryHidden":R.Hidden=2;break}else N=o.index+o[0].length;break;case"header":h["!margins"]||Si(h["!margins"]={},"xlml"),isNaN(+Ue(o[0]).Margin)||(h["!margins"].header=+Ue(o[0]).Margin);break;case"footer":h["!margins"]||Si(h["!margins"]={},"xlml"),isNaN(+Ue(o[0]).Margin)||(h["!margins"].footer=+Ue(o[0]).Margin);break;case"pagemargins":var ae=Ue(o[0]);h["!margins"]||Si(h["!margins"]={},"xlml"),isNaN(+ae.Top)||(h["!margins"].top=+ae.Top),isNaN(+ae.Left)||(h["!margins"].left=+ae.Left),isNaN(+ae.Right)||(h["!margins"].right=+ae.Right),isNaN(+ae.Bottom)||(h["!margins"].bottom=+ae.Bottom);break;case"displayrighttoleft":D.Views||(D.Views=[]),D.Views[0]||(D.Views[0]={}),D.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Y=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Y=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Y=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Y=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Y=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Y=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Y=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Y=!1}break;case"smarttags":break;default:Y=!1;break}if(Y||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?U$(V,W,X,n.slice(N,o.index)):(X=o,N=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var ce={};return!r.bookSheets&&!r.bookProps&&(ce.Sheets=f),ce.SheetNames=d,ce.Workbook=D,ce.SSF=Tt(Pe),ce.Props=U,ce.Custprops=V,ce}function Jp(e,t){switch(lg(t=t||{}),t.type||"base64"){case"base64":return gh(An(e),t);case"binary":case"buffer":case"file":return gh(e,t);case"array":return gh(ei(e),t)}}function H$(e,t){var r=[];return e.Props&&r.push(xO(e.Props,t)),e.Custprops&&r.push(gO(e.Props,e.Custprops)),r.join("")}function G$(){return""}function X$(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Se("NumberFormat",null,{"ss:Format":wt(Pe[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(Se("Style",a.join(""),i))}),Se("Styles",r.join(""))}function UE(e){return Se("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+tg(e.Ref,{r:0,c:0})})}function K$(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(UE(s)))}return Se("Names",r.join(""))}function q$(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(UE(o)))}return a.join("")}function Y$(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Se("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Se("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Se("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Se("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Dr("ProtectContents","True")),e["!protect"].objects&&s.push(Dr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Dr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Dr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Dr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":Se("WorksheetOptions",s.join(""),{xmlns:_n.x})}function J$(e){return e.map(function(t){var r=y6(t.t||""),n=Se("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Se("Comment",n,{"ss:Author":t.a})}).join("")}function Q$(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+wt(tg(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=Wt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=wt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=wt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=i.c||u[f].s.r!=i.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=fa[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Pe[14]);break;case"s":d="String",h=v6(e.v||"");break}var p=ri(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var x=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+d+'">'+x+"</Data>";return(e.c||[]).length>0&&(m+=J$(e.c)),Se("Cell",m,o)}function Z$(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ll(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function ez(e,t,r,n){if(!e["!ref"])return"";var s=ct(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(v,g){Ha(v);var w=!!v.width,y=o0(g,v),k={"ss:Index":g+1};w&&(k["ss:Width"]=Yc(y.width)),v.hidden&&(k["ss:Hidden"]="1"),o.push(Se("Column",null,k))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var f=[Z$(u,(e["!rows"]||[])[u])],d=s.s.c;d<=s.e.c;++d){var h=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>d)&&!(a[i].s.r>u)&&!(a[i].e.c<d)&&!(a[i].e.r<u)){(a[i].s.c!=d||a[i].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:d},x=Be(p),m=c?(e[u]||[])[d]:e[x];f.push(Q$(m,x,e,t,r,n,p))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function tz(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?q$(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?ez(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(Y$(a,t,e,r)),n.join("")}function rz(e,t){t||(t={}),e.SSF||(e.SSF=Tt(Pe)),e.SSF&&(wl(),pu(e.SSF),t.revssf=t0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ri(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(H$(e,t)),r.push(G$()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Se("Worksheet",tz(n,t,e),{"ss:Name":wt(e.SheetNames[n])}));return r[2]=X$(e,t),r[3]=K$(e),ar+Se("Workbook",r.join(""),{xmlns:_n.ss,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:ss":_n.ss,"xmlns:dt":_n.dt,"xmlns:html":_n.html})}function nz(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=q6(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Y6(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var sz=[60,1084,2066,2165,2175];function az(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=Ks(r,r.l),u=Qp[c],f=0;u!=null&&sz.indexOf(c)>-1;)a=Ks(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+a),i.push(o),r.l+=4+a,u=Qp[c=Ks(r,r.l)];var d=Er(i);jr(d,0);var h=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(h),h+=i[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,s)}function vs(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Pe[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||fa[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vc(e.v):e.w=Oi(e.v):e.w=jn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Ki(Pe[n]||String(n))){var s=Ta(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function uf(e,t,r){return{v:e,ixfe:t,t:r}}function iz(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],u="",f={},d,h="",p,x,m,v,g={},w=[],y,k,E=[],S=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},F=function(We){return We<8?yi[We]:We<64&&S[We-8]||yi[We]},U=function(We,Mt,hr){var rr=Mt.XF.data;if(!(!rr||!rr.patternType||!hr||!hr.cellStyles)){Mt.s={},Mt.s.patternType=rr.patternType;var Bs;(Bs=qc(F(rr.icvFore)))&&(Mt.s.fgColor={rgb:Bs}),(Bs=qc(F(rr.icvBack)))&&(Mt.s.bgColor={rgb:Bs})}},V=function(We,Mt,hr){if(!(se>1)&&!(hr.sheetRows&&We.r>=hr.sheetRows)){if(hr.cellStyles&&Mt.XF&&Mt.XF.data&&U(We,Mt,hr),delete Mt.ixfe,delete Mt.XF,d=We,h=Be(We),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),We.r<i.s.r&&(i.s.r=We.r),We.c<i.s.c&&(i.s.c=We.c),We.r+1>i.e.r&&(i.e.r=We.r+1),We.c+1>i.e.c&&(i.e.c=We.c+1),hr.cellFormula&&Mt.f){for(var rr=0;rr<w.length;++rr)if(!(w[rr][0].s.c>We.c||w[rr][0].s.r>We.r)&&!(w[rr][0].e.c<We.c||w[rr][0].e.r<We.r)){Mt.F=Ke(w[rr][0]),(w[rr][0].s.c!=We.c||w[rr][0].s.r!=We.r)&&delete Mt.f,Mt.f&&(Mt.f=""+$r(w[rr][1],i,We,z,N));break}}hr.dense?(s[We.r]||(s[We.r]=[]),s[We.r][We.c]=Mt):s[h]=Mt}},N={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(N.password=t.password);var X,le=[],J=[],Z=[],re=[],te=!1,z=[];z.SheetNames=N.snames,z.sharedf=N.sharedf,z.arrayf=N.arrayf,z.names=[],z.XTI=[];var K=0,se=0,P=0,b=[],D=[],R;N.codepage=1200,zn(1200);for(var W=!1;e.l<e.length-1;){var q=e.l,H=e.read_shift(2);if(H===0&&K===10)break;var Q=e.l===e.length?0:e.read_shift(2),ee=Qp[H];if(ee&&ee.f){if(t.bookSheets&&K===133&&H!==133)break;if(K=H,ee.r===2||ee.r==12){var G=e.read_shift(2);if(Q-=2,!N.enc&&G!==H&&((G&255)<<8|G>>8)!==H)throw new Error("rt mismatch: "+G+"!="+H);ee.r==12&&(e.l+=10,Q-=10)}var C={};if(H===10?C=ee.f(e,Q,N):C=az(H,ee,e,Q,N),se==0&&[9,521,1033,2057].indexOf(K)===-1)continue;switch(H){case 34:r.opts.Date1904=_.WBProps.date1904=C;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(e.l=0),N.enc=C,!t.password)throw new Error("File is password-protected");if(C.valid==null)throw new Error("Encryption scheme unsupported");if(!C.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=C;break;case 66:var pe=Number(C);switch(pe){case 21010:pe=1200;break;case 32768:pe=1e4;break;case 32769:pe=1252;break}zn(N.codepage=pe),W=!0;break;case 317:N.rrtabid=C;break;case 25:N.winlocked=C;break;case 439:r.opts.RefreshAll=C;break;case 12:r.opts.CalcCount=C;break;case 16:r.opts.CalcDelta=C;break;case 17:r.opts.CalcIter=C;break;case 13:r.opts.CalcMode=C;break;case 14:r.opts.CalcPrecision=C;break;case 95:r.opts.CalcSaveRecalc=C;break;case 15:N.CalcRefMode=C;break;case 2211:r.opts.FullCalc=C;break;case 129:C.fDialog&&(s["!type"]="dialog"),C.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),C.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:E.push(C);break;case 430:z.push([C]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(C);break;case 24:case 536:R={Name:C.Name,Ref:$r(C.rgce,i,null,z,N)},C.itab>0&&(R.Sheet=C.itab-1),z.names.push(R),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(C),C.Name=="_xlnm._FilterDatabase"&&C.itab>0&&C.rgce&&C.rgce[0]&&C.rgce[0][0]&&C.rgce[0][0][0]=="PtgArea3d"&&(D[C.itab-1]={ref:Ke(C.rgce[0][0][1][2])});break;case 22:N.ExternCount=C;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(C),z.XTI=z.XTI.concat(C);break;case 2196:if(N.biff<8)break;R!=null&&(R.Comment=C[1]);break;case 18:s["!protect"]=C;break;case 19:C!==0&&N.WTF&&console.error("Password verifier: "+C);break;case 133:a[C.pos]=C,N.snames.push(C.name);break;case 10:{if(--se)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Ke(i),t.sheetRows&&t.sheetRows<=i.e.r){var _e=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ke(i),i.e.r=_e}i.e.r++,i.e.c++}le.length>0&&(s["!merges"]=le),J.length>0&&(s["!objects"]=J),Z.length>0&&(s["!cols"]=Z),re.length>0&&(s["!rows"]=re),_.Sheets.push(A)}u===""?f=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[C.BIFFVer]||8),N.biffguess=C.BIFFVer==0,C.BIFFVer==0&&C.dt==4096&&(N.biff=5,W=!0,zn(N.codepage=28591)),N.biff==8&&C.BIFFVer==0&&C.dt==16&&(N.biff=2),se++)break;if(s=t.dense?[]:{},N.biff<8&&!W&&(W=!0,zn(N.codepage=t.codepage||1252)),N.biff<5||C.BIFFVer==0&&C.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Y={pos:e.l-Q,name:u};a[Y.pos]=Y,N.snames.push(u)}else u=(a[q]||{name:""}).name;C.dt==32&&(s["!type"]="chart"),C.dt==64&&(s["!type"]="macro"),le=[],J=[],N.arrayf=w=[],Z=[],re=[],te=!1,A={Hidden:(a[q]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[C.r]||[])[C.c]:s[Be({c:C.c,r:C.r})])&&++C.c,y={ixfe:C.ixfe,XF:E[C.ixfe]||{},v:C.val,t:"n"},P>0&&(y.z=b[y.ixfe>>8&63]),vs(y,t,r.opts.Date1904),V({c:C.c,r:C.r},y,t);break;case 5:case 517:y={ixfe:C.ixfe,XF:E[C.ixfe],v:C.val,t:C.t},P>0&&(y.z=b[y.ixfe>>8&63]),vs(y,t,r.opts.Date1904),V({c:C.c,r:C.r},y,t);break;case 638:y={ixfe:C.ixfe,XF:E[C.ixfe],v:C.rknum,t:"n"},P>0&&(y.z=b[y.ixfe>>8&63]),vs(y,t,r.opts.Date1904),V({c:C.c,r:C.r},y,t);break;case 189:for(var ae=C.c;ae<=C.C;++ae){var ce=C.rkrec[ae-C.c][0];y={ixfe:ce,XF:E[ce],v:C.rkrec[ae-C.c][1],t:"n"},P>0&&(y.z=b[y.ixfe>>8&63]),vs(y,t,r.opts.Date1904),V({c:ae,r:C.r},y,t)}break;case 6:case 518:case 1030:{if(C.val=="String"){o=C;break}if(y=uf(C.val,C.cell.ixfe,C.tt),y.XF=E[y.ixfe],t.cellFormula){var xe=C.formula;if(xe&&xe[0]&&xe[0][0]&&xe[0][0][0]=="PtgExp"){var De=xe[0][0][1][0],Ve=xe[0][0][1][1],qe=Be({r:De,c:Ve});g[qe]?y.f=""+$r(C.formula,i,C.cell,z,N):y.F=((t.dense?(s[De]||[])[Ve]:s[qe])||{}).F}else y.f=""+$r(C.formula,i,C.cell,z,N)}P>0&&(y.z=b[y.ixfe>>8&63]),vs(y,t,r.opts.Date1904),V(C.cell,y,t),o=C}break;case 7:case 519:if(o)o.val=C,y=uf(C,o.cell.ixfe,"s"),y.XF=E[y.ixfe],t.cellFormula&&(y.f=""+$r(o.formula,i,o.cell,z,N)),P>0&&(y.z=b[y.ixfe>>8&63]),vs(y,t,r.opts.Date1904),V(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(C);var Oe=Be(C[0].s);if(p=t.dense?(s[C[0].s.r]||[])[C[0].s.c]:s[Oe],t.cellFormula&&p){if(!o||!Oe||!p)break;p.f=""+$r(C[1],i,C[0],z,N),p.F=Ke(C[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;g[Be(o.cell)]=C[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Be(o.cell)],(p||{}).f=""+$r(C[0],i,d,z,N)}}break;case 253:y=uf(c[C.isst].t,C.ixfe,"s"),c[C.isst].h&&(y.h=c[C.isst].h),y.XF=E[y.ixfe],P>0&&(y.z=b[y.ixfe>>8&63]),vs(y,t,r.opts.Date1904),V({c:C.c,r:C.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:C.ixfe,XF:E[C.ixfe],t:"z"},P>0&&(y.z=b[y.ixfe>>8&63]),vs(y,t,r.opts.Date1904),V({c:C.c,r:C.r},y,t));break;case 190:if(t.sheetStubs)for(var Ie=C.c;Ie<=C.C;++Ie){var ze=C.ixfe[Ie-C.c];y={ixfe:ze,XF:E[ze],t:"z"},P>0&&(y.z=b[y.ixfe>>8&63]),vs(y,t,r.opts.Date1904),V({c:Ie,r:C.r},y,t)}break;case 214:case 516:case 4:y=uf(C.val,C.ixfe,"s"),y.XF=E[y.ixfe],P>0&&(y.z=b[y.ixfe>>8&63]),vs(y,t,r.opts.Date1904),V({c:C.c,r:C.r},y,t);break;case 0:case 512:se===1&&(i=C);break;case 252:c=C;break;case 1054:if(N.biff==4){b[P++]=C[1];for(var Fe=0;Fe<P+163&&Pe[Fe]!=C[1];++Fe);Fe>=163&&Rs(C[1],P+163)}else Rs(C[1],C[0]);break;case 30:{b[P++]=C;for(var ft=0;ft<P+163&&Pe[ft]!=C;++ft);ft>=163&&Rs(C,P+163)}break;case 229:le=le.concat(C);break;case 93:J[C.cmo[0]]=N.lastobj=C;break;case 438:N.lastobj.TxO=C;break;case 127:N.lastobj.ImData=C;break;case 440:for(v=C[0].s.r;v<=C[0].e.r;++v)for(m=C[0].s.c;m<=C[0].e.c;++m)p=t.dense?(s[v]||[])[m]:s[Be({c:m,r:v})],p&&(p.l=C[1]);break;case 2048:for(v=C[0].s.r;v<=C[0].e.r;++v)for(m=C[0].s.c;m<=C[0].e.c;++m)p=t.dense?(s[v]||[])[m]:s[Be({c:m,r:v})],p&&p.l&&(p.l.Tooltip=C[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;p=t.dense?(s[C[0].r]||[])[C[0].c]:s[Be(C[0])];var ir=J[C[2]];p||(t.dense?(s[C[0].r]||(s[C[0].r]=[]),p=s[C[0].r][C[0].c]={t:"z"}):p=s[Be(C[0])]={t:"z"},i.e.r=Math.max(i.e.r,C[0].r),i.s.r=Math.min(i.s.r,C[0].r),i.e.c=Math.max(i.e.c,C[0].c),i.s.c=Math.min(i.s.c,C[0].c)),p.c||(p.c=[]),x={a:C[1],t:ir.TxO.t},p.c.push(x)}break;case 2173:KM(E[C.ixfe],C.ext);break;case 125:{if(!N.cellStyles)break;for(;C.e>=C.s;)Z[C.e--]={width:C.w/256,level:C.level||0,hidden:!!(C.flags&1)},te||(te=!0,Qx(C.w/256)),Ha(Z[C.e+1])}break;case 520:{var Gt={};C.level!=null&&(re[C.r]=Gt,Gt.level=C.level),C.hidden&&(re[C.r]=Gt,Gt.hidden=!0),C.hpt&&(re[C.r]=Gt,Gt.hpt=C.hpt,Gt.hpx=ll(C.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Si(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=C;break;case 161:s["!margins"]||Si(s["!margins"]={}),s["!margins"].header=C.header,s["!margins"].footer=C.footer;break;case 574:C.RTL&&(_.Views[0].RTL=!0);break;case 146:S=C;break;case 2198:X=C;break;case 140:k=C;break;case 442:u?A.CodeName=C||A.name:_.WBProps.CodeName=C||"ThisWorkbook";break}}else ee||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=Q}return r.SheetNames=tr(a).sort(function(on,We){return Number(on)-Number(We)}).map(function(on){return a[on].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&D.forEach(function(on,We){r.Sheets[r.SheetNames[We]]["!autofilter"]=on}),r.Strings=c,r.SSF=Tt(Pe),N.enc&&(r.Encryption=N.enc),X&&(r.Themes=X),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),z.names.length>0&&(_.Names=z.names),r.Workbook=_,r}var mc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function oz(e,t,r){var n=Re.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=ay(n,Hp,mc.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var i=Re.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=ay(i,Gp,mc.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Mb(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function lz(e,t){var r=[],n=[],s=[],a=0,i,o=I1(Hp,"n"),c=I1(Gp,"n");if(e.Props)for(i=tr(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=tr(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)Hb.indexOf(s[a][0])>-1||Lb.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Re.utils.cfb_add(t,"/SummaryInformation",iy(n,mc.SI,c,Gp)),(r.length||u.length)&&Re.utils.cfb_add(t,"/DocumentSummaryInformation",iy(r,mc.DSI,o,Hp,u.length?u:null,mc.UDI))}function ig(e,t){t||(t={}),lg(t),Zd(),t.codepage&&Qd(t.codepage);var r,n;if(e.FullPaths){if(Re.find(e,"/encryption"))throw new Error("File is password-protected");r=Re.find(e,"!CompObj"),n=Re.find(e,"/Workbook")||Re.find(e,"/Book")}else{switch(t.type){case"base64":e=Sn(An(e));break;case"binary":e=Sn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}jr(e,0),n={content:e}}var s,a;if(r&&nz(r),t.bookProps&&!t.bookSheets)s={};else{var i=Qe?"buffer":"array";if(n&&n.content)s=iz(n.content,t);else if((a=Re.find(e,"PerfectOffice_MAIN"))&&a.content)s=_i.to_workbook(a.content,(t.type=i,t));else if((a=Re.find(e,"NativeContent_MAIN"))&&a.content)s=_i.to_workbook(a.content,(t.type=i,t));else throw(a=Re.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Re.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=S7(e))}var o={};return e.FullPaths&&oz(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function cz(e,t){var r=t||{},n=Re.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Re.utils.cfb_add(n,s,$E(e,r)),r.biff==8&&(e.Props||e.Custprops)&&lz(e,n),r.biff==8&&e.vbaraw&&k7(n,Re.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Zc={0:{f:P9},1:{f:z9},2:{f:oU},3:{f:Y9},4:{f:G9},5:{f:sU},6:{f:dU},7:{f:eU},8:{f:yU},9:{f:vU},10:{f:xU},11:{f:gU},12:{f:V9},13:{f:cU},14:{f:Q9},15:{f:K9},16:{f:FE},17:{f:pU},18:{f:rU},19:{f:zx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:h$},40:{},42:{},43:{f:dM},44:{f:uM},45:{f:mM},46:{f:gM},47:{f:xM},48:{},49:{f:L6},50:{},51:{f:JM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rE},62:{f:fU},63:{f:i7},64:{f:IU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:DU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:U9},148:{f:L9,p:16},151:{f:EU},152:{},153:{f:u$},154:{},155:{},156:{f:l$},157:{},158:{},159:{T:1,f:CL},160:{T:-1},161:{T:1,f:Zi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:qM},336:{T:-1},337:{f:e7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:TU},427:{f:CU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:AU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:B9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:kU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:g7},633:{T:1},634:{T:-1},635:{T:1,f:m7},636:{T:-1},637:{f:$6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:QU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:OU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Qp={6:{f:mh},10:{f:ma},12:{f:ur},13:{f:ur},14:{f:nr},15:{f:nr},16:{f:Vr},17:{f:nr},18:{f:nr},19:{f:ur},20:{f:dy},21:{f:dy},23:{f:tE},24:{f:py},25:{f:nr},26:{},27:{},28:{f:O5},29:{},34:{f:nr},35:{f:hy},38:{f:Vr},39:{f:Vr},40:{f:Vr},41:{f:Vr},42:{f:nr},43:{f:nr},47:{f:KL},49:{f:c5},51:{f:ur},60:{},61:{f:s5},64:{f:nr},65:{f:l5},66:{f:ur},77:{},80:{},81:{},82:{},85:{f:ur},89:{},90:{},91:{},92:{f:XO},93:{f:B5},94:{},95:{f:nr},96:{},97:{},99:{f:nr},125:{f:rE},128:{f:b5},129:{f:qO},130:{f:ur},131:{f:nr},132:{f:nr},133:{f:YO},134:{},140:{f:X5},141:{f:ur},144:{},146:{f:Y5},151:{},152:{},153:{},154:{},155:{},156:{f:ur},157:{},158:{},160:{f:nL},161:{f:Z5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:w5},190:{f:_5},193:{f:ma},197:{},198:{},199:{},200:{},201:{},202:{f:nr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ur},220:{},221:{f:nr},222:{},224:{f:k5},225:{f:GO},226:{f:ma},227:{},229:{f:L5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:QO},253:{f:f5},255:{f:e5},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Gb},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:nr},353:{f:ma},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:A5},431:{f:nr},432:{},433:{},434:{},437:{},438:{f:z5},439:{f:nr},440:{f:W5},441:{},442:{f:gu},443:{},444:{f:ur},445:{},446:{},448:{f:ma},449:{f:n5,r:2},450:{f:ma},512:{f:cy},513:{f:rL},515:{f:C5},516:{f:h5},517:{f:fy},519:{f:sL},520:{f:t5},523:{},545:{f:my},549:{f:ly},566:{},574:{f:i5},638:{f:y5},659:{},1048:{},1054:{f:m5},1084:{},1212:{f:R5},2048:{f:H5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:of},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ma},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:J5,r:12},2173:{f:XM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:nr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:F5,r:12},2197:{},2198:{f:$M,r:12},2199:{},2200:{},2201:{},2202:{f:P5,r:12},2203:{f:ma},2204:{},2205:{},2206:{},2207:{},2211:{f:r5},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ur},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:eL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:q5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:cy},1:{},2:{f:cL},3:{f:oL},4:{f:iL},5:{f:fy},7:{f:fL},8:{},9:{f:of},11:{},22:{f:ur},30:{f:g5},31:{},32:{},33:{f:my},36:{},37:{f:ly},50:{f:dL},62:{},52:{},67:{},68:{f:ur},69:{},86:{},126:{},127:{f:aL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:hL},223:{},234:{},354:{},421:{},518:{f:mh},521:{f:of},536:{f:py},547:{f:hy},561:{},579:{},1030:{f:mh},1033:{f:of},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ke(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&Bx(r)&&e.push(r)}}function uz(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return ke(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,a),f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function _u(e,t,r){return e||(e=de(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function fz(e,t,r,n){var s=de(9);return _u(s,e,t),Xb(r,n||"b",s),s}function dz(e,t,r){var n=de(8+2*r.length);return _u(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function hz(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?wr(Lt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?ke(e,2,uL(r,n,s)):ke(e,3,lL(r,n,s));return;case"b":case"e":ke(e,5,fz(r,n,t.v,t.t));return;case"s":case"str":ke(e,4,dz(r,n,(t.v||"").slice(0,255)));return}ke(e,1,_u(null,r,n))}function pz(e,t,r,n){var s=Array.isArray(t),a=ct(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Ke(a)}for(var u=a.s.r;u<=a.e.r;++u){o=Zt(u);for(var f=a.s.c;f<=a.e.c;++f){u===a.s.r&&(c[f]=Ot(f)),i=c[f]+o;var d=s?(t[u]||[])[f]:t[i];d&&hz(e,d,u,f)}}}function mz(e,t){for(var r=t||{},n=gn(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ke(n,r.biff==4?1033:r.biff==3?521:9,qx(e,16,r)),pz(n,e.Sheets[e.SheetNames[s]],s,r),ke(n,10),n.end()}function xz(e,t,r){ke(e,49,u5({sz:12,name:"Arial"},r))}function gz(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&ke(e,1054,x5(s,t[s],r))})}function vz(e,t){var r=de(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ke(e,2151,r),r=de(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Qb(ct(t["!ref"]||"A1"),r),r.write_shift(4,4),ke(e,2152,r)}function yz(e,t){for(var r=0;r<16;++r)ke(e,224,uy({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ke(e,224,uy(n,0,t))})}function wz(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ke(e,440,V5(n)),n[1].Tooltip&&ke(e,2048,G5(n))}delete t["!links"]}function _z(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&ke(e,125,Q5(o0(s,n),s))})}}function Sz(e,t,r,n,s){var a=16+ri(s.cellXfs,t,s);if(t.v==null&&!t.bf){ke(e,513,Ui(r,n,a));return}if(t.bf)ke(e,6,qB(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?wr(Lt(t.v)):t.v;ke(e,515,N5(r,n,i,a));break;case"b":case"e":ke(e,517,T5(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=ng(s.Strings,t.v,s.revStrings);ke(e,253,d5(r,n,o,a))}else ke(e,516,p5(r,n,(t.v||"").slice(0,255),a,s));break;default:ke(e,513,Ui(r,n,a))}}function kz(e,t,r){var n=gn(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,f,d="",h=[],p=ct(a["!ref"]||"A1"),x=u?65536:16384;if(p.e.c>255||p.e.r>=x){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}ke(n,2057,qx(r,16,t)),ke(n,13,Mn(1)),ke(n,12,Mn(100)),ke(n,15,tn(!0)),ke(n,17,tn(!1)),ke(n,16,Mi(.001)),ke(n,95,tn(!0)),ke(n,42,tn(!1)),ke(n,43,tn(!1)),ke(n,130,Mn(1)),ke(n,128,E5()),ke(n,131,tn(!1)),ke(n,132,tn(!1)),u&&_z(n,a["!cols"]),ke(n,512,v5(p,t)),u&&(a["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){d=Zt(m);for(var v=p.s.c;v<=p.e.c;++v){m===p.s.r&&(h[v]=Ot(v)),f=h[v]+d;var g=c?(a[m]||[])[v]:a[f];g&&(Sz(n,g,m,v,t),u&&g.l&&a["!links"].push([f,g.l]))}}var w=o.CodeName||o.name||s;return u&&ke(n,574,o5((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&ke(n,229,M5(a["!merges"])),u&&wz(n,a),ke(n,442,Kb(w)),u&&vz(n,a),ke(n,10),n.end()}function bz(e,t,r){var n=gn(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(ke(n,2057,qx(e,5,r)),r.bookType=="xla"&&ke(n,135),ke(n,225,o?Mn(1200):null),ke(n,193,TO(2)),c&&ke(n,191),c&&ke(n,192),ke(n,226),ke(n,92,KO("SheetJS",r)),ke(n,66,Mn(o?1200:1252)),o&&ke(n,353,Mn(0)),o&&ke(n,448),ke(n,317,tL(e.SheetNames.length)),o&&e.vbaraw&&ke(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";ke(n,442,Kb(u))}ke(n,156,Mn(17)),ke(n,25,tn(!1)),ke(n,18,tn(!1)),ke(n,19,Mn(0)),o&&ke(n,431,tn(!1)),o&&ke(n,444,Mn(0)),ke(n,61,a5()),ke(n,64,tn(!1)),ke(n,141,Mn(0)),ke(n,34,tn(n$(e)=="true")),ke(n,14,tn(!0)),o&&ke(n,439,tn(!1)),ke(n,218,Mn(0)),xz(n,e,r),gz(n,e.SSF,r),yz(n,r),o&&ke(n,352,tn(!1));var f=n.end(),d=gn();o&&ke(d,140,K5()),o&&r.Strings&&uz(d,252,ZO(r.Strings)),ke(d,10);var h=d.end(),p=gn(),x=0,m=0;for(m=0;m<e.SheetNames.length;++m)x+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var v=f.length+x+h.length;for(m=0;m<e.SheetNames.length;++m){var g=a[m]||{};ke(p,133,JO({pos:v,hs:g.Hidden||0,dt:0,name:e.SheetNames[m]},r)),v+=t[m].length}var w=p.end();if(x!=w.length)throw new Error("BS8 "+x+" != "+w.length);var y=[];return f.length&&y.push(f),w.length&&y.push(w),h.length&&y.push(h),Er(y)}function Ez(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Tt(Pe)),e&&e.SSF&&(wl(),pu(e.SSF),r.revssf=t0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,cg(r),r.cellXfs=[],ri(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=kz(s,r,e);return n.unshift(bz(e,n,r)),Er(n)}function $E(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=nn(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return Ez(e,t);case 4:case 3:case 2:return mz(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Ey(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=u6(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<c.length;++i){var m=c[i].trim(),v=m.slice(0,3).toLowerCase();if(v=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(v!="<td"&&v!="<th")){var g=m.split(/<\/t[dh]>/i);for(o=0;o<g.length;++o){var w=g[o].trim();if(w.match(/<t[dh]/i)){for(var y=w,k=0;y.charAt(0)=="<"&&(k=y.indexOf(">"))>-1;)y=y.slice(k+1);for(var E=0;E<x.length;++E){var S=x[E];S.s.c==f&&S.s.r<u&&u<=S.e.r&&(f=S.e.c+1,E=-1)}var _=Ue(w.slice(0,w.indexOf(">")));h=_.colspan?+_.colspan:1,((d=+_.rowspan)>1||h>1)&&x.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+h-1}});var A=_.t||_["data-t"]||"";if(!y.length){f+=h;continue}if(y=mb(y),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!y.length){f+=h;continue}var F={t:"s",v:y};r.raw||!y.trim().length||A=="s"||(y==="TRUE"?F={t:"b",v:!0}:y==="FALSE"?F={t:"b",v:!1}:isNaN(us(y))?isNaN(il(y).getDate())||(F={t:"d",v:Lt(y)},r.cellDates||(F={t:"n",v:wr(F.v)}),F.z=r.dateNF||Pe[14]):F={t:"n",v:us(y)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=F):n[Be({r:u,c:f})]=F,f+=h}}}}return n["!ref"]=Ke(p),x.length&&(n["!merges"]=x),n}function zE(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var f=Be({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],h=d&&d.v!=null&&(d.h||Fx(d.w||(Is(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+f,a.push(Se("td",h,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var WE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',VE="</body></html>";function Tz(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ti(Ey(r[0],t),t);var n=pg();return r.forEach(function(s,a){mg(n,Ey(s,t),"Sheet"+(a+1))}),n}function HE(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function GE(e,t){var r=t||{},n=r.header!=null?r.header:WE,s=r.footer!=null?r.footer:VE,a=[n],i=nn(e["!ref"]);r.dense=Array.isArray(e),a.push(HE(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(zE(e,i,o,r));return a.push("</table>"+s),a.join("")}function XE(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Wt(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var f=nn(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),s==-1&&(u.e.r=s=f.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),x=0,m=0,v=0,g=0,w=0,y=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&m<c;++x){var k=o[x];if(Ty(k)){if(n.display)continue;p[m]={hidden:!0}}var E=k.children;for(v=g=0;v<E.length;++v){var S=E[v];if(!(n.display&&Ty(S))){var _=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):mb(S.innerHTML),A=S.getAttribute("data-z")||S.getAttribute("z");for(h=0;h<d.length;++h){var F=d[h];F.s.c==g+a&&F.s.r<m+s&&m+s<=F.e.r&&(g=F.e.c+1-a,h=-1)}y=+S.getAttribute("colspan")||1,((w=+S.getAttribute("rowspan")||1)>1||y>1)&&d.push({s:{r:m+s,c:g+a},e:{r:m+s+(w||1)-1,c:g+a+(y||1)-1}});var U={t:"s",v:_},V=S.getAttribute("data-t")||S.getAttribute("t")||"";_!=null&&(_.length==0?U.t=V||"z":n.raw||_.trim().length==0||V=="s"||(_==="TRUE"?U={t:"b",v:!0}:_==="FALSE"?U={t:"b",v:!1}:isNaN(us(_))?isNaN(il(_).getDate())||(U={t:"d",v:Lt(_)},n.cellDates||(U={t:"n",v:wr(U.v)}),U.z=n.dateNF||Pe[14]):U={t:"n",v:us(_)})),U.z===void 0&&A!=null&&(U.z=A);var N="",X=S.getElementsByTagName("A");if(X&&X.length)for(var le=0;le<X.length&&!(X[le].hasAttribute("href")&&(N=X[le].getAttribute("href"),N.charAt(0)!="#"));++le);N&&N.charAt(0)!="#"&&(U.l={Target:N}),n.dense?(e[m+s]||(e[m+s]=[]),e[m+s][g+a]=U):e[Be({c:g+a,r:m+s})]=U,u.e.c<g+a&&(u.e.c=g+a),g+=y}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,m-1+s),e["!ref"]=Ke(u),m>=c&&(e["!fullref"]=Ke((u.e.r=o.length-x+m-1+s,u))),e}function KE(e,t){var r=t||{},n=r.dense?[]:{};return XE(n,e,t)}function Cz(e,t){return ti(KE(e,t),t)}function Ty(e){var t="",r=Nz(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Nz(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Az(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=xt(t.replace(/<[^>]*>/g,""));return[r]}var Cy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function qE(e,t){var r=t||{},n=Rx(e),s=[],a,i,o={name:""},c="",u=0,f,d,h={},p=[],x=r.dense?[]:{},m,v,g={value:""},w="",y=0,k=[],E=-1,S=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,F={},U=[],V={},N=0,X=0,le=[],J=1,Z=1,re=[],te={Names:[]},z={},K=["",""],se=[],P={},b="",D=0,R=!1,W=!1,q=0;for(Xc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Xc.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?x["!ref"]=Ke(_):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(x["!fullref"]=x["!ref"],_.e.r=r.sheetRows-1,x["!ref"]=Ke(_)),U.length&&(x["!merges"]=U),le.length&&(x["!rows"]=le),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),h[f.name]=x,W=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Ue(m[0],!1),E=S=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,x=r.dense?[]:{},U=[],le=[],W=!0);break;case"table-row-group":m[1]==="/"?--A:++A;break;case"table-row":case"":if(m[1]==="/"){E+=J,J=1;break}if(d=Ue(m[0],!1),d.?E=d.-1:E==-1&&(E=0),J=+d["number-rows-repeated"]||1,J<10)for(q=0;q<J;++q)A>0&&(le[E+q]={level:A});S=-1;break;case"covered-table-cell":m[1]!=="/"&&++S,r.sheetStubs&&(r.dense?(x[E]||(x[E]=[]),x[E][S]={t:"z"}):x[Be({r:E,c:S})]={t:"z"}),w="",k=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++S,g=Ue(m[0],!1),Z=parseInt(g["number-columns-repeated"]||"1",10),v={t:"z",v:null},g.formula&&r.cellFormula!=!1&&(v.f=Sy(xt(g.formula))),(g.||g["value-type"])=="string"&&(v.t="s",v.v=xt(g["string-value"]||""),r.dense?(x[E]||(x[E]=[]),x[E][S]=v):x[Be({r:E,c:S})]=v),S+=Z-1;else if(m[1]!=="/"){++S,w="",y=0,k=[],Z=1;var H=J?E+J-1:E;if(S>_.e.c&&(_.e.c=S),S<_.s.c&&(_.s.c=S),E<_.s.r&&(_.s.r=E),H>_.e.r&&(_.e.r=H),g=Ue(m[0],!1),se=[],P={},v={t:g.||g["value-type"],v:null},r.cellFormula)if(g.formula&&(g.formula=xt(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(N=parseInt(g["number-matrix-rows-spanned"],10)||0,X=parseInt(g["number-matrix-columns-spanned"],10)||0,V={s:{r:E,c:S},e:{r:E+N-1,c:S+X-1}},v.F=Ke(V),re.push([V,v.F])),g.formula)v.f=Sy(g.formula);else for(q=0;q<re.length;++q)E>=re[q][0].s.r&&E<=re[q][0].e.r&&S>=re[q][0].s.c&&S<=re[q][0].e.c&&(v.F=re[q][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(N=parseInt(g["number-rows-spanned"],10)||0,X=parseInt(g["number-columns-spanned"],10)||0,V={s:{r:E,c:S},e:{r:E+N-1,c:S+X-1}},U.push(V)),g["number-columns-repeated"]&&(Z=parseInt(g["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=Pt(g["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(g.value);break;case"percentage":v.t="n",v.v=parseFloat(g.value);break;case"currency":v.t="n",v.v=parseFloat(g.value);break;case"date":v.t="d",v.v=Lt(g["date-value"]),r.cellDates||(v.t="n",v.v=wr(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=o6(g["time-value"])/86400,r.cellDates&&(v.t="d",v.v=r0(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(g.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",g["string-value"]!=null&&(w=xt(g["string-value"]),k=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(R=!1,v.t==="s"&&(v.v=w||"",k.length&&(v.R=k),R=y==0),z.Target&&(v.l=z),se.length>0&&(v.c=se,se=[]),w&&r.cellText!==!1&&(v.w=w),R&&(v.t="z",delete v.v),(!R||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var Q=0;Q<J;++Q){if(Z=parseInt(g["number-columns-repeated"]||"1",10),r.dense)for(x[E+Q]||(x[E+Q]=[]),x[E+Q][S]=Q==0?v:Tt(v);--Z>0;)x[E+Q][S+Z]=Tt(v);else for(x[Be({r:E+Q,c:S})]=v;--Z>0;)x[Be({r:E+Q,c:S+Z})]=Tt(v);_.e.c<=S&&(_.e.c=S)}Z=parseInt(g["number-columns-repeated"]||"1",10),S+=Z-1,Z=0,v={},w="",k=[]}z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((a=s.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((a=s.pop())[0]!==m[3])throw"Bad state: "+a;P.t=w,k.length&&(P.R=k),P.a=b,se.push(P)}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);b="",D=0,w="",y=0,k=[];break;case"creator":m[1]==="/"?b=n.slice(D,m.index):D=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((a=s.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);w="",y=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(F[o.name]=c,(a=s.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&(c="",o=Ue(m[0],!1),s.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Ue(m[0],!1),c+=Cy[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Ue(m[0],!1),c+=Cy[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":i=Ue(m[0],!1),K=xh(i["cell-range-address"]);var ee={Name:i.name,Ref:K[0]+"!"+K[1]};W&&(ee.Sheet=p.length),te.Names.push(ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(m[1]==="/"&&(!g||!g["string-value"])){var G=Az(n.slice(y,m.index));w=(w.length>0?w+`
`:"")+G[0]}else Ue(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{K=xh(Ue(m[0])["target-range-address"]),h[K[0]]["!autofilter"]={ref:K[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(z=Ue(m[0],!1),!z.href)break;z.Target=xt(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(K=xh(z.Target.slice(1)),z.Target="#"+K[0]+"!"+K[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var C={Sheets:h,SheetNames:p,Workbook:te};return r.bookSheets&&delete C.Sheets,C}function Ny(e,t){t=t||{},Ln(e,"META-INF/manifest.xml")&&oO(cr(e,"META-INF/manifest.xml"),t);var r=kn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=qE(St(r),t);return Ln(e,"meta.xml")&&(n.Props=Ib(cr(e,"meta.xml"))),n}function Ay(e,t){return qE(e,t)}var jz=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Gc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ar+t}}(),jy=function(){var e=function(a){return wt(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+wt(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=nn(a["!ref"]||"A1"),h=a["!merges"]||[],p=0,x=Array.isArray(a);if(a["!cols"])for(f=0;f<=d.e.c;++f)c.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",v=a["!rows"]||[];for(u=0;u<d.s.r;++u)m=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=d.e.r;++u){for(m=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+m+`>
`),f=0;f<d.s.c;++f)c.push(t);for(;f<=d.e.c;++f){var g=!1,w={},y="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>f)&&!(h[p].s.r>u)&&!(h[p].e.c<f)&&!(h[p].e.r<u)){(h[p].s.c!=f||h[p].s.r!=u)&&(g=!0),w["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,w["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(g){c.push(r);continue}var k=Be({r:u,c:f}),E=x?(a[u]||[])[f]:a[k];if(E&&E.f&&(w["table:formula"]=wt(t9(E.f)),E.F&&E.F.slice(0,k.length)==k)){var S=nn(E.F);w["table:number-matrix-columns-spanned"]=S.e.c-S.s.c+1,w["table:number-matrix-rows-spanned"]=S.e.r-S.s.r+1}if(!E){c.push(t);continue}switch(E.t){case"b":y=E.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=E.v?"true":"false";break;case"n":y=E.w||String(E.v||0),w["office:value-type"]="float",w["office:value"]=E.v||0;break;case"s":case"str":y=E.v==null?"":E.v,w["office:value-type"]="string";break;case"d":y=E.w||Lt(E.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=Lt(E.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var _=e(y);if(E.l&&E.l.Target){var A=E.l.Target;A=A.charAt(0)=="#"?"#"+r9(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),_=Se("text:a",_,{"xlink:href":A.replace(/&/g,"&amp;")})}c.push("          "+Se("table:table-cell",Se("text:p",_,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Ha(d),d.ods=o;var h=u["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=c;var d=u["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[ar],u=Gc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Gc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+f+`>
`),c.push(Pb().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=i.SheetNames.length;++d)c.push(n(i.Sheets[i.SheetNames[d]],i,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function YE(e,t){if(t.bookType=="fods")return jy(e,t);var r=Ax(),n="",s=[],a=[];return n="mimetype",Ye(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ye(r,n,jy(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Ye(r,n,jz(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Ye(r,n,ar+Pb()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Ye(r,n,uO(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ye(r,n,lO(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function $i(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Zp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):St(ei(e))}function Dz(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Sn(Cs(e))}function Fz(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Xa(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Dy(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Rz(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Pz(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function eu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function vt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function er(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function gt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=eu(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=eu(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function Nr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(vt(n*8+s.type)),s.type==2&&t.push(vt(s.data.length)),t.push(s.data))})}),Xa(t)}function og(e,t){return e?.map(function(r){return t(r.data)})||[]}function In(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=eu(e,n),a=gt(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:er(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=gt(o.data),u=er(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=er(a[3][0].data)>>>0>0),r.push(i)}return r}function mo(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:vt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:vt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:vt(i.data.length)}],n[2].push({data:Nr(i.meta),type:2})});var a=Nr(n);t.push(vt(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Xa(t)}function Iz(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=eu(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Xa(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var f=Xa(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function On(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Iz(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Xa(t)}function xo(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=vt(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Xa(t)}function Oz(e,t,r,n){var s=$i(e),a=s.getUint32(4,!0),i=(n>1?12:8)+Dy(a&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,f=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Dy(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[c]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(c>-1)d={t:"s",v:t[c]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function Lz(e,t,r){var n=$i(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,u=NaN,f=new Date(2001,0,1);s&1&&(c=Rz(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return d}function vh(e,t){var r=new Uint8Array(32),n=$i(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,Pz(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function yh(e,t){var r=new Uint8Array(32),n=$i(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Mz(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Oz(e,t,r,e[0]);case 5:return Lz(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ur(e){var t=gt(e);return eu(t[1][0].data)}function Fy(e,t){var r=gt(t.data),n=er(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=gt(i.data),c=er(o[1][0].data)>>>0;switch(n){case 1:a[c]=Zp(o[3][0].data);break;case 8:{var u=e[Ur(o[9][0].data)][0],f=gt(u.data),d=e[Ur(f[1][0].data)][0],h=er(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=gt(d.data);a[c]=p[3].map(function(x){return Zp(x.data)}).join("")}break}}),a}function Bz(e,t){var r,n,s,a,i,o,c,u,f,d,h,p,x,m,v=gt(e),g=er(v[1][0].data)>>>0,w=er(v[2][0].data)>>>0,y=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&er(v[8][0].data)>0||!1,k,E;if((a=(s=v[7])==null?void 0:s[0])!=null&&a.data&&t!=0)k=(o=(i=v[7])==null?void 0:i[0])==null?void 0:o.data,E=(u=(c=v[6])==null?void 0:c[0])==null?void 0:u.data;else if((d=(f=v[4])==null?void 0:f[0])!=null&&d.data&&t!=1)k=(p=(h=v[4])==null?void 0:h[0])==null?void 0:p.data,E=(m=(x=v[3])==null?void 0:x[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var S=y?4:1,_=$i(k),A=[],F=0;F<k.length/2;++F){var U=_.getUint16(F*2,!0);U<65535&&A.push([F,U])}if(A.length!=w)throw"Expected ".concat(w," cells, found ").concat(A.length);var V=[];for(F=0;F<A.length-1;++F)V[A[F][0]]=E.subarray(A[F][1]*S,A[F+1][1]*S);return A.length>=1&&(V[A[A.length-1][0]]=E.subarray(A[A.length-1][1]*S)),{R:g,cells:V}}function Uz(e,t){var r,n=gt(t.data),s=(r=n?.[7])!=null&&r[0]?er(n[7][0].data)>>>0>0?1:0:-1,a=og(n[5],function(i){return Bz(i,s)});return{nrows:er(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=c}),i},[])}}function $z(e,t,r){var n,s=gt(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(er(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(er(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Ke(a);var i=gt(s[4][0].data),o=Fy(e,e[Ur(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?Fy(e,e[Ur(i[17][0].data)][0]):[],u=gt(i[3][0].data),f=0;u[1].forEach(function(d){var h=gt(d.data),p=e[Ur(h[2][0].data)][0],x=er(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var m=Uz(e,p);m.data.forEach(function(v,g){v.forEach(function(w,y){var k=Be({r:f+g,c:y}),E=Mz(w,o,c);E&&(r[k]=E)})}),f+=m.nrows})}function zz(e,t){var r=gt(t.data),n={"!ref":"A1"},s=e[Ur(r[2][0].data)],a=er(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return $z(e,s[0],n),n}function Wz(e,t){var r,n=gt(t.data),s={name:(r=n[1])!=null&&r[0]?Zp(n[1][0].data):"",sheets:[]},a=og(n[2],Ur);return a.forEach(function(i){e[i].forEach(function(o){var c=er(o.meta[1][0].data);c==6e3&&s.sheets.push(zz(e,o))})}),s}function Vz(e,t){var r=pg(),n=gt(t.data),s=og(n[1],Ur);if(s.forEach(function(a){e[a].forEach(function(i){var o=er(i.meta[1][0].data);if(o==2){var c=Wz(e,i);c.sheets.forEach(function(u,f){mg(r,u,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function wh(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=On(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var f;try{f=In(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){a[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&er(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(u){var f=er(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Vz(a,o)}function Hz(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&er(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=$i(e[7][0].data),f=0,d=[],h=$i(e[4][0].data),p=0,x=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}u.setUint16(m*2,f,!0),h.setUint16(m*2,p,!0);var v,g;switch(typeof t[m]){case"string":v=vh({t:"s",v:t[m]},r),g=yh({t:"s",v:t[m]},r);break;case"number":v=vh({t:"n",v:t[m]},r),g=yh({t:"n",v:t[m]},r);break;case"boolean":v=vh({t:"b",v:t[m]},r),g=yh({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}d.push(v),f+=v.length,x.push(g),p+=g.length,++c}for(e[2][0].data=vt(c);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=Xa(d),e[3][0].data=Xa(x),c}function Gz(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=nn(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Ke(n)));var a=wd(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(b){return b.forEach(function(D){typeof D=="string"&&i.push(D)})});var o={},c=[],u=Re.read(t.numbers,{type:"base64"});u.FileIndex.map(function(b,D){return[b,u.FullPaths[D]]}).forEach(function(b){var D=b[0],R=b[1];if(D.type==2&&D.name.match(/\.iwa/)){var W=D.content,q=On(W),H=In(q);H.forEach(function(Q){c.push(Q.id),o[Q.id]={deps:[],location:R,type:er(Q.messages[0].meta[1][0].data)}})}}),c.sort(function(b,D){return b-D});var f=c.filter(function(b){return b>1}).map(function(b){return[b,vt(b)]});u.FileIndex.map(function(b,D){return[b,u.FullPaths[D]]}).forEach(function(b){var D=b[0];if(b[1],!!D.name.match(/\.iwa/)){var R=In(On(D.content));R.forEach(function(W){W.messages.forEach(function(q){f.forEach(function(H){W.messages.some(function(Q){return er(Q.meta[1][0].data)!=11006&&Fz(Q.data,H[1])})&&o[H[0]].deps.push(W.id)})})})}});for(var d=Re.find(u,o[1].location),h=In(On(d.content)),p,x=0;x<h.length;++x){var m=h[x];m.id==1&&(p=m)}var v=Ur(gt(p.messages[0].data)[1][0].data);for(d=Re.find(u,o[v].location),h=In(On(d.content)),x=0;x<h.length;++x)m=h[x],m.id==v&&(p=m);for(v=Ur(gt(p.messages[0].data)[2][0].data),d=Re.find(u,o[v].location),h=In(On(d.content)),x=0;x<h.length;++x)m=h[x],m.id==v&&(p=m);for(v=Ur(gt(p.messages[0].data)[2][0].data),d=Re.find(u,o[v].location),h=In(On(d.content)),x=0;x<h.length;++x)m=h[x],m.id==v&&(p=m);var g=gt(p.messages[0].data);{g[6][0].data=vt(n.e.r+1),g[7][0].data=vt(n.e.c+1);var w=Ur(g[46][0].data),y=Re.find(u,o[w].location),k=In(On(y.content));{for(var E=0;E<k.length&&k[E].id!=w;++E);if(k[E].id!=w)throw"Bad ColumnRowUIDMapArchive";var S=gt(k[E].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var _=0;_<=n.e.c;++_){var A=[];A[1]=A[2]=[{type:0,data:vt(_+420690)}],S[1].push({type:2,data:Nr(A)}),S[2].push({type:0,data:vt(_)}),S[3].push({type:0,data:vt(_)})}S[4]=[],S[5]=[],S[6]=[];for(var F=0;F<=n.e.r;++F)A=[],A[1]=A[2]=[{type:0,data:vt(F+726270)}],S[4].push({type:2,data:Nr(A)}),S[5].push({type:0,data:vt(F)}),S[6].push({type:0,data:vt(F)});k[E].messages[0].data=Nr(S)}y.content=xo(mo(k)),y.size=y.content.length,delete g[46];var U=gt(g[4][0].data);{U[7][0].data=vt(n.e.r+1);var V=gt(U[1][0].data),N=Ur(V[2][0].data);y=Re.find(u,o[N].location),k=In(On(y.content));{if(k[0].id!=N)throw"Bad HeaderStorageBucket";var X=gt(k[0].messages[0].data);for(F=0;F<a.length;++F){var le=gt(X[2][0].data);le[1][0].data=vt(F),le[4][0].data=vt(a[F].length),X[2][F]={type:X[2][0].type,data:Nr(le)}}k[0].messages[0].data=Nr(X)}y.content=xo(mo(k)),y.size=y.content.length;var J=Ur(U[2][0].data);y=Re.find(u,o[J].location),k=In(On(y.content));{if(k[0].id!=J)throw"Bad HeaderStorageBucket";for(X=gt(k[0].messages[0].data),_=0;_<=n.e.c;++_)le=gt(X[2][0].data),le[1][0].data=vt(_),le[4][0].data=vt(n.e.r+1),X[2][_]={type:X[2][0].type,data:Nr(le)};k[0].messages[0].data=Nr(X)}y.content=xo(mo(k)),y.size=y.content.length;var Z=Ur(U[4][0].data);(function(){for(var b=Re.find(u,o[Z].location),D=In(On(b.content)),R,W=0;W<D.length;++W){var q=D[W];q.id==Z&&(R=q)}var H=gt(R.messages[0].data);{H[3]=[];var Q=[];i.forEach(function(C,pe){Q[1]=[{type:0,data:vt(pe)}],Q[2]=[{type:0,data:vt(1)}],Q[3]=[{type:2,data:Dz(C)}],H[3].push({type:2,data:Nr(Q)})})}R.messages[0].data=Nr(H);var ee=mo(D),G=xo(ee);b.content=G,b.size=b.content.length})();var re=gt(U[3][0].data);{var te=re[1][0];delete re[2];var z=gt(te.data);{var K=Ur(z[2][0].data);(function(){for(var b=Re.find(u,o[K].location),D=In(On(b.content)),R,W=0;W<D.length;++W){var q=D[W];q.id==K&&(R=q)}var H=gt(R.messages[0].data);{delete H[6],delete re[7];var Q=new Uint8Array(H[5][0].data);H[5]=[];for(var ee=0,G=0;G<=n.e.r;++G){var C=gt(Q);ee+=Hz(C,a[G],i),C[1][0].data=vt(G),H[5].push({data:Nr(C),type:2})}H[1]=[{type:0,data:vt(n.e.c+1)}],H[2]=[{type:0,data:vt(n.e.r+1)}],H[3]=[{type:0,data:vt(ee)}],H[4]=[{type:0,data:vt(n.e.r+1)}]}R.messages[0].data=Nr(H);var pe=mo(D),_e=xo(pe);b.content=_e,b.size=b.content.length})()}te.data=Nr(z)}U[3][0].data=Nr(re)}g[4][0].data=Nr(U)}p.messages[0].data=Nr(g);var se=mo(h),P=xo(se);return d.content=P,d.size=d.content.length,u}function JE(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function lg(e){JE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function cg(e){JE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Xz(e){return et.WS.indexOf(e)>-1?"sheet":e==et.CS?"chart":e==et.DS?"dialog":e==et.MS?"macro":e&&e.length?e:"sheet"}function Kz(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Xz(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function qz(e,t,r,n,s,a,i,o,c,u,f,d){try{a[n]=fc(kn(e,r,!0),t);var h=cr(e,t),p;switch(o){case"sheet":p=_$(h,t,s,c,a[n],u,f,d);break;case"chart":if(p=S$(h,t,s,c,a[n],u,f,d),!p||!p["!drawel"])break;var x=Kl(p["!drawel"].Target,t),m=Kc(x),v=c7(kn(e,x,!0),fc(kn(e,m,!0),x)),g=Kl(v,x),w=Kc(g);p=YU(kn(e,g,!0),g,c,fc(kn(e,w,!0),g),u,p);break;case"macro":p=k$(h,t,s,c,a[n],u,f,d);break;case"dialog":p=b$(h,t,s,c,a[n],u,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var y=[];a&&a[n]&&tr(a[n]).forEach(function(k){var E="";if(a[n][k].Type==et.CMNT){E=Kl(a[n][k].Target,t);var S=N$(cr(e,E,!0),E,c);if(!S||!S.length)return;gy(p,S,!1)}a[n][k].Type==et.TCMNT&&(E=Kl(a[n][k].Target,t),y=y.concat(f7(cr(e,E,!0),c)))}),y&&y.length&&gy(p,y,!0,c.people||[])}catch(k){if(c.WTF)throw k}}function Rn(e){return e.charAt(0)=="/"?e.slice(1):e}function QE(e,t){if(wl(),t=t||{},lg(t),Ln(e,"META-INF/manifest.xml")||Ln(e,"objectdata.xml"))return Ny(e,t);if(Ln(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof wh<"u"){if(e.FileIndex)return wh(e);var r=Re.utils.cfb_new();return M1(e).forEach(function(le){Ye(r,le,d6(e,le))}),wh(r)}throw new Error("Unsupported NUMBERS file")}if(!Ln(e,"[Content_Types].xml"))throw Ln(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ln(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=M1(e),s=aO(kn(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",cr(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!cr(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(dc=[],s.sst)try{dc=C$(cr(e,Rn(s.sst)),s.sst,t)}catch(le){if(t.WTF)throw le}t.cellStyles&&s.themes.length&&(c=T$(kn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=E$(cr(e,Rn(s.style)),s.style,c,t))}s.links.map(function(le){try{var J=fc(kn(e,Kc(Rn(le))),le);return j$(cr(e,Rn(le)),J,le,t)}catch{}});var f=w$(cr(e,Rn(s.workbooks[0])),s.workbooks[0],t),d={},h="";s.coreprops.length&&(h=cr(e,Rn(s.coreprops[0]),!0),h&&(d=Ib(h)),s.extprops.length!==0&&(h=cr(e,Rn(s.extprops[0]),!0),h&&dO(h,d,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=kn(e,Rn(s.custprops[0]),!0),h&&(p=pO(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(J){return J.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(x.Props=d,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var m={};t.bookDeps&&s.calcchain&&(m=A$(cr(e,Rn(s.calcchain)),s.calcchain));var v=0,g={},w,y;{var k=f.Sheets;d.Worksheets=k.length,d.SheetNames=[];for(var E=0;E!=k.length;++E)d.SheetNames[E]=k[E].name}var S=a?"bin":"xml",_=s.workbooks[0].lastIndexOf("/"),A=(s.workbooks[0].slice(0,_+1)+"_rels/"+s.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");Ln(e,A)||(A="xl/_rels/workbook."+S+".rels");var F=fc(kn(e,A,!0),A.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=D$(cr(e,Rn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=h7(cr(e,Rn(s.people[0])),t)),F&&(F=Kz(F,f.Sheets));var U=cr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=d.Worksheets;++v){var V="sheet";if(F&&F[v]?(w="xl/"+F[v][1].replace(/[\/]?xl\//,""),Ln(e,w)||(w=F[v][1]),Ln(e,w)||(w=A.replace(/_rels\/.*$/,"")+F[v][1]),V=F[v][2]):(w="xl/worksheets/sheet"+(v+1-U)+"."+S,w=w.replace(/sheet0\./,"sheet.")),y=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(d.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var N=!1,X=0;X!=t.sheets.length;++X)typeof t.sheets[X]=="number"&&t.sheets[X]==v&&(N=1),typeof t.sheets[X]=="string"&&t.sheets[X].toLowerCase()==d.SheetNames[v].toLowerCase()&&(N=1);if(!N)continue e}}qz(e,w,y,d.SheetNames[v],v,g,i,V,t,f,c,u)}return x={Directory:s,Workbook:f,Props:d,Custprops:p,Deps:m,Sheets:i,SheetNames:d.SheetNames,Strings:dc,Styles:u,Themes:c,SSF:Tt(Pe)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(le,J){le=le.replace(/^Root Entry[\/]/,""),x.keys.push(le),x.files[le]=e.FileIndex[J]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=cr(e,Rn(s.vba[0]),!0):s.defaults&&s.defaults.bin===_7&&(x.vbaraw=cr(e,"xl/vbaProject.bin",!0))),x}function Yz(e,t){var r=t||{},n="Workbook",s=Re.find(e,n);try{if(n="/!DataSpaces/Version",s=Re.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(FL(s.content),n="/!DataSpaces/DataSpaceMap",s=Re.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=PL(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Re.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=IL(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Re.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);LL(s.content)}catch{}if(n="/EncryptionInfo",s=Re.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=ML(s.content);if(n="/EncryptedPackage",s=Re.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Jz(e,t){return t.bookType=="ods"?YE(e,t):t.bookType=="numbers"?Gz(e,t):t.bookType=="xlsb"?Qz(e,t):ZE(e,t)}function Qz(e,t){Po=1024,e&&!e.SSF&&(e.SSF=Tt(Pe)),e&&e.SSF&&(wl(),pu(e.SSF),t.revssf=t0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,hc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=wE.indexOf(t.bookType)>-1,s=Xx();cg(t=t||{});var a=Ax(),i="",o=0;if(t.cellXfs=[],ri(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ye(a,i,Ob(e.Props,t)),s.coreprops.push(i),yt(t.rels,2,i,et.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ye(a,i,Bb(e.Props)),s.extprops.push(i),yt(t.rels,3,i,et.EXT_PROPS),e.Custprops!==e.Props&&tr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ye(a,i,Ub(e.Custprops)),s.custprops.push(i),yt(t.rels,4,i,et.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Ye(a,i,R$(o-1,i,t,e,f)),s.sheets.push(i),yt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,et.WS[0])}if(d){var p=d["!comments"],x=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,Ye(a,m,O$(p,m)),s.comments.push(m),yt(f,-1,"../comments"+o+"."+r,et.CMNT),x=!0),d["!legacy"]&&x&&Ye(a,"xl/drawings/vmlDrawing"+o+".vml",vE(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Ye(a,Kc(i),Ho(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ye(a,i,I$(t.Strings,i,t)),s.strs.push(i),yt(t.wbrels,-1,"sharedStrings."+r,et.SST)),i="xl/workbook."+r,Ye(a,i,F$(e,i)),s.workbooks.push(i),yt(t.rels,1,i,et.WB),i="xl/theme/theme1.xml",Ye(a,i,Zx(e.Themes,t)),s.themes.push(i),yt(t.wbrels,-1,"theme/theme1.xml",et.THEME),i="xl/styles."+r,Ye(a,i,P$(e,i,t)),s.styles.push(i),yt(t.wbrels,-1,"styles."+r,et.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ye(a,i,e.vbaraw),s.vba.push(i),yt(t.wbrels,-1,"vbaProject.bin",et.VBA)),i="xl/metadata."+r,Ye(a,i,L$(i)),s.metadata.push(i),yt(t.wbrels,-1,"metadata."+r,et.XLMETA),Ye(a,"[Content_Types].xml",Rb(s,t)),Ye(a,"_rels/.rels",Ho(t.rels)),Ye(a,"xl/_rels/workbook."+r+".rels",Ho(t.wbrels)),delete t.revssf,delete t.ssf,a}function ZE(e,t){Po=1024,e&&!e.SSF&&(e.SSF=Tt(Pe)),e&&e.SSF&&(wl(),pu(e.SSF),t.revssf=t0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,hc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=wE.indexOf(t.bookType)>-1,s=Xx();cg(t=t||{});var a=Ax(),i="",o=0;if(t.cellXfs=[],ri(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ye(a,i,Ob(e.Props,t)),s.coreprops.push(i),yt(t.rels,2,i,et.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ye(a,i,Bb(e.Props)),s.extprops.push(i),yt(t.rels,3,i,et.EXT_PROPS),e.Custprops!==e.Props&&tr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ye(a,i,Ub(e.Custprops)),s.custprops.push(i),yt(t.rels,4,i,et.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Ye(a,i,DE(o-1,t,e,d)),s.sheets.push(i),yt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,et.WS[0])}if(h){var x=h["!comments"],m=!1,v="";if(x&&x.length>0){var g=!1;x.forEach(function(w){w[1].forEach(function(y){y.T==!0&&(g=!0)})}),g&&(v="xl/threadedComments/threadedComment"+o+"."+r,Ye(a,v,d7(x,f,t)),s.threadedcomments.push(v),yt(d,-1,"../threadedComments/threadedComment"+o+"."+r,et.TCMNT)),v="xl/comments"+o+"."+r,Ye(a,v,yE(x)),s.comments.push(v),yt(d,-1,"../comments"+o+"."+r,et.CMNT),m=!0}h["!legacy"]&&m&&Ye(a,"xl/drawings/vmlDrawing"+o+".vml",vE(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Ye(a,Kc(i),Ho(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ye(a,i,iE(t.Strings,t)),s.strs.push(i),yt(t.wbrels,-1,"sharedStrings."+r,et.SST)),i="xl/workbook."+r,Ye(a,i,LE(e)),s.workbooks.push(i),yt(t.rels,1,i,et.WB),i="xl/theme/theme1.xml",Ye(a,i,Zx(e.Themes,t)),s.themes.push(i),yt(t.wbrels,-1,"theme/theme1.xml",et.THEME),i="xl/styles."+r,Ye(a,i,pE(e,t)),s.styles.push(i),yt(t.wbrels,-1,"styles."+r,et.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ye(a,i,e.vbaraw),s.vba.push(i),yt(t.wbrels,-1,"vbaProject.bin",et.VBA)),i="xl/metadata."+r,Ye(a,i,gE()),s.metadata.push(i),yt(t.wbrels,-1,"metadata."+r,et.XLMETA),f.length>1&&(i="xl/persons/person.xml",Ye(a,i,p7(f)),s.people.push(i),yt(t.wbrels,-1,"persons/person.xml",et.PEOPLE)),Ye(a,"[Content_Types].xml",Rb(s,t)),Ye(a,"_rels/.rels",Ho(t.rels)),Ye(a,"xl/_rels/workbook."+r+".rels",Ho(t.wbrels)),delete t.revssf,delete t.ssf,a}function ug(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=An(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Zz(e,t){return Re.find(e,"EncryptedPackage")?Yz(e,t):ig(e,t)}function eW(e,t){var r,n=e,s=t||{};return s.type||(s.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r=db(n,s),QE(r,s)}function eT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Jp(e.slice(r),t);default:break e}return ol.to_workbook(e,t)}function tW(e,t){var r="",n=ug(e,t);switch(t.type){case"base64":r=An(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Li(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=St(r)),t.type="binary",eT(r,t)}function rW(e,t){var r=e;return t.type=="base64"&&(r=An(r)),r=ht.utils.decode(1200,r.slice(2),"str"),t.type="binary",eT(r,t)}function nW(e){return e.match(/[^\x00-\x7F]/)?Cs(e):e}function _h(e,t,r,n){return n?(r.type="string",ol.to_workbook(e,r)):ol.to_workbook(t,r)}function tu(e,t){Zd();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return tu(new Uint8Array(e),(r=Tt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Xo={},r.dateNF&&(Xo.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=s6(e),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=nW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Tt(r),r.type="array",tu(Ex(n),r)}switch((s=ug(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Zz(Re.read(n,r),r);break;case 9:if(s[1]<=8)return ig(n,r);break;case 60:return Jp(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return mL(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return sE.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?eW(n,r):_h(e,n,r,a);case 239:return s[3]===60?Jp(n,r):_h(e,n,r,a);case 255:if(s[1]===254)return rW(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return _i.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return _i.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Yp.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return fE.to_workbook(n,r);break;case 10:case 13:case 32:return tW(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return pL.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Yp.to_workbook(n,r):_h(e,n,r,a)}function Ry(e,t){var r=t||{};return r.type="file",tu(e,r)}function tT(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return mu(t.file,Re.write(e,{type:Qe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Re.write(e,t)}function sW(e,t){var r=Tt(t||{}),n=Jz(e,r);return rT(n,r)}function aW(e,t){var r=Tt(t||{}),n=ZE(e,r);return rT(n,r)}function rT(e,t){var r={},n=Qe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Re.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(hu(s))}return t.password&&typeof encrypt_agile<"u"?tT(encrypt_agile(s,t.password),t):t.type==="file"?mu(t.file,s):t.type=="string"?St(s):s}function iW(e,t){var r=t||{},n=cz(e,r);return tT(n,r)}function ws(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Wc(Cs(n));case"binary":return Cs(n);case"string":return e;case"file":return mu(t.file,n,"utf8");case"buffer":return Qe?ca(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ws(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function oW(e,t){switch(t.type){case"base64":return Wc(e);case"binary":return e;case"string":return e;case"file":return mu(t.file,e,"binary");case"buffer":return Qe?ca(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ff(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Wc(r):t.type=="string"?St(r):r;case"file":return mu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function fg(e,t){Zd(),OE(e);var r=Tt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=fg(e,r);return r.type="array",hu(n)}return aW(e,r)}function l0(e,t){Zd(),OE(e);var r=Tt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=l0(e,r);return r.type="array",hu(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ws(rz(e,r),r);case"slk":case"sylk":return ws(nE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return ws(GE(e.Sheets[e.SheetNames[s]],r),r);case"txt":return oW(aT(e.Sheets[e.SheetNames[s]],r),r);case"csv":return ws(hg(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return ws(sE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return ff(Yp.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return ws(ol.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return ws(fE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return ws(aE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return ws(YE(e,r),r);case"wk1":return ff(_i.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return ff(_i.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ff($E(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),iW(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return sW(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function dg(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Py(e,t,r){var n=r||{};return n.type="file",n.file=t,dg(n),l0(e,n)}function lW(e,t,r){var n=r||{};return n.type="file",n.file=t,dg(n),fg(e,n)}function cW(e,t,r,n){var s=r||{};s.type="file",s.file=e,dg(s),s.type="buffer";var a=n;return a instanceof Function||(a=r),Na.writeFile(e,l0(t,s),a)}function nT(e,t,r,n,s,a,i,o){var c=Zt(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;a[p]!=null&&(h[a[p]]=u);continue}var m=x.v;switch(x.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(m==null)if(x.t=="e"&&m===null)h[a[p]]=null;else if(u!==void 0)h[a[p]]=u;else if(f&&m===null)h[a[p]]=null;else continue;else h[a[p]]=f&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?m:Is(x,m,o);m!=null&&(d=!1)}}return{row:h,isempty:d}}function wd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":c=ct(f);break;case"number":c=ct(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(s=0);var d=Zt(c.s.r),h=[],p=[],x=0,m=0,v=Array.isArray(e),g=c.s.r,w=0,y={};v&&!e[g]&&(e[g]=[]);var k=u.skipHidden&&e["!cols"]||[],E=u.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(k[w]||{}).hidden)switch(h[w]=Ot(w),r=v?e[g][w]:e[h[w]+d],n){case 1:a[w]=w-c.s.c;break;case 2:a[w]=h[w];break;case 3:a[w]=u.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Is(r,null,u),m=y[i]||0,!m)y[i]=1;else{do o=i+"_"+m++;while(y[o]);y[i]=m,y[o]=1}a[w]=o}for(g=c.s.r+s;g<=c.e.r;++g)if(!(E[g]||{}).hidden){var S=nT(e,c,g,h,n,a,v,u);(S.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=S.row)}return p.length=x,p}var Iy=/"/g;function sT(e,t,r,n,s,a,i,o){for(var c=!0,u=[],f="",d=Zt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=o.dense?(e[r]||[])[h]:e[n[h]+d];if(p==null)f="";else if(p.v!=null){c=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:Is(p,null,o));for(var x=0,m=0;x!==f.length;++x)if((m=f.charCodeAt(x))===s||m===a||m===34||o.forceQuotes){f='"'+f.replace(Iy,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(c=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(Iy,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&c?null:u.join(i)}function hg(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=ct(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(d[x]=Ot(x));for(var m=0,v=s.s.r;v<=s.e.r;++v)(p[v]||{}).hidden||(f=sT(e,s,v,d,i,c,a,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function aT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=hg(e,t);if(typeof ht>"u"||t.type=="string")return r;var n=ht.utils.encode(1200,r,"str");return""+n}function uW(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=ct(e["!ref"]),a="",i=[],o,c=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Ot(o);for(var f=s.s.r;f<=s.e.r;++f)for(a=Zt(f),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function iT(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Wt(n.origin):n.origin;i=c.r,o=c.c}var u,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var d=ct(a["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+s)}else i==-1&&(i=0,f.e.r=t.length-1+s);var h=n.header||[],p=0;t.forEach(function(m,v){tr(m).forEach(function(g){(p=h.indexOf(g))==-1&&(h[p=h.length]=g);var w=m[g],y="z",k="",E=Be({c:o+p,r:i+v+s});u=ru(a,E),w&&typeof w=="object"&&!(w instanceof Date)?a[E]=w:(typeof w=="number"?y="n":typeof w=="boolean"?y="b":typeof w=="string"?y="s":w instanceof Date?(y="d",n.cellDates||(y="n",w=wr(w)),k=n.dateNF||Pe[14]):w===null&&n.nullError&&(y="e",w=0),u?(u.t=y,u.v=w,delete u.w,delete u.R,k&&(u.z=k)):a[E]=u={t:y,v:w},k&&(u.z=k))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var x=Zt(i);if(s)for(p=0;p<h.length;++p)a[Ot(p+o)+x]={t:"s",v:h[p]};return a["!ref"]=Ke(f),a}function fW(e,t){return iT(null,e,t)}function ru(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Wt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ru(e,Be(t)):ru(e,Be({r:t,c:r||0}))}function dW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function pg(){return{SheetNames:[],Sheets:{}}}function mg(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(IE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function hW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=dW(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function pW(e,t){return e.z=t,e}function oT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function mW(e,t,r){return oT(e,"#"+t,r)}function xW(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function gW(e,t,r,n){for(var s=typeof t!="string"?t:ct(t),a=typeof t=="string"?t:Ke(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=ru(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var lT={encode_col:Ot,encode_row:Zt,encode_cell:Be,encode_range:Ke,decode_col:$x,decode_row:Ux,split_cell:O6,decode_cell:Wt,decode_range:nn,format_cell:Is,sheet_add_aoa:Tb,sheet_add_json:iT,sheet_add_dom:XE,aoa_to_sheet:Sl,json_to_sheet:fW,table_to_sheet:KE,table_to_book:Cz,sheet_to_csv:hg,sheet_to_txt:aT,sheet_to_json:wd,sheet_to_html:GE,sheet_to_formulae:uW,sheet_to_row_object_array:wd,sheet_get_cell:ru,book_new:pg,book_append_sheet:mg,book_set_sheet_visibility:hW,cell_set_number_format:pW,cell_set_hyperlink:oT,cell_set_internal_link:mW,cell_add_comment:xW,sheet_set_array_formula:gW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},c0;function vW(e){c0=e}function yW(e,t){var r=c0(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var s=ct(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(d[x]=Ot(x));var m=s.s.r,v=!1,g=0;return r._read=function(){if(!v)return v=!0,r.push("\uFEFF");for(;m<=s.e.r;)if(++m,!(p[m-1]||{}).hidden&&(f=sT(e,s,m-1,d,i,c,a,n),f!=null&&(n.strip&&(f=f.replace(u,"")),f||n.blankrows!==!1)))return r.push((g++?o:"")+f);return r.push(null)},r}function wW(e,t){var r=c0(),n=t||{},s=n.header!=null?n.header:WE,a=n.footer!=null?n.footer:VE;r.push(s);var i=nn(e["!ref"]);n.dense=Array.isArray(e),r.push(HE(e,i,n));var o=i.s.r,c=!1;return r._read=function(){if(o>i.e.r)return c||(c=!0,r.push("</table>"+a)),r.push(null);for(;o<=i.e.r;){r.push(zE(e,i,o,n)),++o;break}},r}function _W(e,t){var r=c0({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},s=0,a=1,i=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?s=1:f.header==="A"?s=2:Array.isArray(f.header)&&(s=3),typeof d){case"string":u=ct(d);break;case"number":u=ct(e["!ref"]),u.s.r=d;break;default:u=d}s>0&&(a=0);var h=Zt(u.s.r),p=[],x=0,m=Array.isArray(e),v=u.s.r,g=0,w={};m&&!e[v]&&(e[v]=[]);var y=f.skipHidden&&e["!cols"]||[],k=f.skipHidden&&e["!rows"]||[];for(g=u.s.c;g<=u.e.c;++g)if(!(y[g]||{}).hidden)switch(p[g]=Ot(g),n=m?e[v][g]:e[p[g]+h],s){case 1:i[g]=g-u.s.c;break;case 2:i[g]=p[g];break;case 3:i[g]=f.header[g-u.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=o=Is(n,null,f),x=w[o]||0,!x)w[o]=1;else{do c=o+"_"+x++;while(w[c]);w[o]=x,w[c]=1}i[g]=c}return v=u.s.r+a,r._read=function(){for(;v<=u.e.r;)if(!(k[v-1]||{}).hidden){var E=nT(e,u,v,p,s,i,m,f);if(++v,E.isempty===!1||(s===1?f.blankrows!==!1:f.blankrows)){r.push(E.row);return}}return r.push(null)},r}var SW={to_json:_W,to_html:wW,to_csv:yW,set_readable:vW};const kW=zc.version,bW=Object.freeze(Object.defineProperty({__proto__:null,CFB:Re,SSF:ib,parse_xlscfb:ig,parse_zip:QE,read:tu,readFile:Ry,readFileSync:Ry,set_cptable:C8,set_fs:r6,stream:SW,utils:lT,version:kW,write:l0,writeFile:Py,writeFileAsync:cW,writeFileSync:Py,writeFileXLSX:lW,writeXLSX:fg},Symbol.toStringTag,{value:"Module"})),EW=[{field:"familyCode",variations:["family code","familycode","family_code"]},{field:"familyName",variations:["family name","familyname","family_name"]},{field:"classCode",variations:["class code","classcode","class_code"]},{field:"className",variations:["class name","classname","class_name"]},{field:"brandCode",variations:["brand code","brandcode","brand_code"]},{field:"brandName",variations:["brand name","brandname","brand_name"]},{field:"articleCode",variations:["article code","articlecode","article_code"]},{field:"articleDescription",variations:["article description","articledescription","article_description"]}],TW="Family Code,Family Name,Class Code,Class Name,Brand Code,Brand Name,Article Code,Article Description",CW=["familyCode","familyName","classCode","className","brandCode","brandName","articleCode","articleDescription"],NW={familyCode:"Family code",familyName:"Family name",classCode:"Class code",className:"Class name",brandCode:"Brand code",brandName:"Brand name",articleCode:"Article code",articleDescription:"Article description"},Oy=e=>e.toLowerCase().replace(/[^a-z]/g,"").trim(),AW=(e,t)=>{const r=Oy(t);return e.findIndex(n=>Oy(n)===r)},jW=e=>{const t={},r=[];for(const n of EW){let s=-1;for(const a of n.variations)if(s=AW(e,a),s!==-1)break;s!==-1?t[n.field]=s:r.push(n.variations[0])}return{mapping:t,missingHeaders:r}},DW=e=>{const t=[];for(const r of CW)e[r]||t.push(`${NW[r]} is required`);return t},FW=(e,t)=>{const r={familyCode:String(e[t.familyCode]||"").trim(),familyName:String(e[t.familyName]||"").trim(),classCode:String(e[t.classCode]||"").trim(),className:String(e[t.className]||"").trim(),brandCode:String(e[t.brandCode]||"").trim(),brandName:String(e[t.brandName]||"").trim(),articleCode:String(e[t.articleCode]||"").trim(),articleDescription:String(e[t.articleDescription]||"").trim(),errors:[]};return r.errors=DW(r),r},RW=e=>{const t=e.split(`
`).filter(s=>s.trim());if(t.length<2)throw new Error("CSV file must contain header and at least one data row");const r=t[0].split(",").map(s=>s.trim()),n=[];for(let s=1;s<t.length;s++)t[s].trim()!==""&&n.push(t[s].split(",").map(a=>a.trim()));return{headers:r,dataRows:n}},PW=e=>{const t=tu(e,{type:"array"}),r=t.SheetNames[0];if(!r)throw new Error("Excel file contains no sheets");const n=t.Sheets[r],s=lT.sheet_to_json(n,{header:1});if(s.length<2)throw new Error("Excel file must contain header and at least one data row");const a=s[0].map(o=>String(o||"").trim()),i=[];for(let o=1;o<s.length;o++){const c=s[o];c&&c.some(u=>String(u||"").trim())&&i.push(c.map(u=>String(u||"").trim()))}return{headers:a,dataRows:i}},IW=(e,t)=>{const{mapping:r,missingHeaders:n}=jW(e);if(n.length>0)throw new Error(`Missing required columns: ${n.join(", ")}`);const s=[],a=[];for(let i=0;i<t.length;i++){const o=t[i];if(o.length<Math.max(...Object.values(r))+1){a.push(`Row ${i+2}: Insufficient columns`);continue}const c=FW(o,r);s.push(c)}return{data:s,errors:a}},OW=e=>{const t=[...new Set(e.map(c=>c.familyName))].sort(),r=[...new Set(e.map(c=>c.className))].sort(),n=[...new Set(e.map(c=>c.brandName))].sort(),s={};e.forEach(c=>{s[c.familyName]||(s[c.familyName]=[]),s[c.familyName].includes(c.className)||s[c.familyName].push(c.className)});const a={};e.forEach(c=>{a[c.familyName]||(a[c.familyName]=[]),a[c.familyName].includes(c.brandName)||a[c.familyName].push(c.brandName)});const i={};e.forEach(c=>{i[c.className]||(i[c.className]=[]),i[c.className].includes(c.brandName)||i[c.className].push(c.brandName)});const o={};return e.forEach(c=>{o[c.articleCode]={familyName:c.familyName,className:c.className,brandName:c.brandName,familyCode:c.familyCode,classCode:c.classCode,brandCode:c.brandCode,articleDescription:c.articleDescription}}),{families:t,classes:r,brands:n,familyClassMapping:s,familyBrandMapping:a,classBrandMapping:i,articleMappings:o}},LW=e=>{try{const t=new Date(e);return{date:t.toLocaleDateString(),time:t.toLocaleTimeString(),relative:MW(t)}}catch{return{date:"Unknown",time:"Unknown",relative:"Unknown"}}},MW=e=>{const r=new Date().getTime()-e.getTime(),n=Math.floor(r/(1e3*60)),s=Math.floor(r/(1e3*60*60)),a=Math.floor(r/(1e3*60*60*24));return n<1?"just now":n<60?`${n} minutes ago`:s<24?`${s} hours ago`:`${a} days ago`},BW=async()=>{try{const e=Date.now(),t=Math.random().toString(36).substr(2,9),r=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/category-data?t=${e}&r=${t}`;console.log("Fetching category data with authentication...");const n=await at.makeAuthenticatedRequest(r,{method:"GET"});if(n.ok){const s=await n.json();if(s.success&&s.categoryData)return console.log("Successfully fetched category data for authenticated user"),s.categoryData}else n.status!==404&&console.error("Failed to fetch category data:",n.status,n.statusText);return null}catch(e){return console.error("Error fetching current category data:",e),null}},UW=async()=>{try{const e=Date.now(),t=Math.random().toString(36).substr(2,9),r=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/category-data-raw?t=${e}&r=${t}`;console.log("Fetching raw category data with authentication...");const n=await at.makeAuthenticatedRequest(r,{method:"GET"});if(n.ok){const s=await n.json();if(s.success&&s.rawData)return{rawData:s.rawData,fileName:s.fileName||"Unknown",uploadedAt:s.uploadedAt||new Date().toISOString()}}else n.status!==404&&console.error("Failed to fetch raw category data:",n.status,n.statusText);return null}catch(e){return console.error("Error fetching raw category data:",e),null}},$W=async e=>{try{console.log("Uploading category data with authentication...");const r=await(await at.makeAuthenticatedRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/upload-category-data`,{method:"POST",body:JSON.stringify(e)})).json();return console.log("Category data upload response:",r),r}catch(t){return console.error("Error uploading category data:",t),{success:!1,error:t instanceof Error?t.message:"Upload failed"}}},zW=async()=>{try{console.log("Deleting category data with authentication...");const e=await at.makeAuthenticatedRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/category-data`,{method:"DELETE"});if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return await e.json()}catch(e){throw console.error("Error deleting category data:",e),e}},WW=async()=>{try{const e=Date.now(),t=Math.random().toString(36).substr(2,9),r=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/category-data-raw?t=${e}&r=${t}`;console.log("Downloading category data with authentication...");const n=await at.makeAuthenticatedRequest(r,{method:"GET"});if(!n.ok)throw n.status===404?new Error("No category data available to download. Please upload category data first."):new Error(`HTTP ${n.status}: ${n.statusText}`);const s=await n.json();if(!s.success||!s.rawData||s.rawData.length===0)throw new Error("No category data available to download");return{rawData:s.rawData,fileName:s.fileName}}catch(e){throw console.error("Error downloading category data:",e),e}},VW=async()=>{try{const e=Date.now(),t=Math.random().toString(36).substr(2,9),r=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/debug/category-state?t=${e}&r=${t}`;console.log("Debugging category state with authentication...");const n=await at.makeAuthenticatedRequest(r,{method:"GET"});if(!n.ok)throw new Error("Failed to fetch debug info");return await n.json()}catch(e){throw console.error("Error debugging category state:",e),e}},HW=(e,t)=>{const r=e.map(u=>[u.familyCode||"",u.familyName||"",u.classCode||"",u.className||"",u.brandCode||"",u.brandName||"",u.articleCode||"",u.articleDescription||""].join(",")),n=[TW,...r].join(`
`),s=new Blob([n],{type:"text/csv"}),a=window.URL.createObjectURL(s),i=document.createElement("a");i.href=a;const o=t?.replace(/\.[^/.]+$/,"")||"category_data",c=new Date().toISOString().split("T")[0];i.download=`${o}_downloaded_${c}.csv`,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(a)};function GW({onCategoryDataUploaded:e,onCategoryDataDeleted:t}){const[r,n]=T.useState(null),[s,a]=T.useState(!1),[i,o]=T.useState(!1),[c,u]=T.useState("idle"),[f,d]=T.useState([]),[h,p]=T.useState([]),[x,m]=T.useState(null),[v,g]=T.useState(null),[w,y]=T.useState(0),[k,E]=T.useState(!1),[S,_]=T.useState(!1),A=T.useRef(null);T.useEffect(()=>{F(),U()},[]);const F=async(K=!1)=>{try{const se=Date.now();if(!K&&se-w<1e3){console.log("Skipping fetch - too recent");return}if(k&&!K){console.log("Manual refresh in progress - skipping automatic fetch");return}console.log("Fetching current category data with cache busting..."),m(null);const P=await BW();P?(console.log("Setting current category data:",{families:P.families?.length||0,classes:P.classes?.length||0,brands:P.brands?.length||0,articles:Object.keys(P.articleMappings||{}).length,uploadId:P.uploadId}),m(P),y(se)):(console.log("No category data available"),m(null))}catch(se){console.error("Error fetching current category data:",se),m(null)}},U=async(K=!1)=>{try{if(k&&!K){console.log("Manual refresh in progress - skipping automatic raw data fetch");return}console.log("Fetching raw category data with cache busting..."),g(null);const se=await UW();se?(console.log("Setting raw category data:",{fileName:se.fileName,recordCount:se.rawData.length,uploadedAt:se.uploadedAt}),g(se)):(console.log("No raw category data available"),g(null))}catch(se){console.error("Error fetching raw category data:",se),g(null)}},V=async()=>{o(!0);try{console.log("Downloading current category data...");const{rawData:K,fileName:se}=await WW();HW(K,se),fe.success(`Category data downloaded! (${K.length} records from ${se})`)}catch(K){console.error("Error downloading category data:",K),fe.error(K instanceof Error?K.message:"Failed to download category data. Please try again.")}finally{o(!1)}},N=async()=>{console.log("Force refreshing all category data..."),E(!0);try{m(null),g(null),y(0),await new Promise(K=>setTimeout(K,100)),await Promise.all([F(!0),U(!0)]),fe.success("Category data refreshed")}finally{E(!1)}},X=async()=>{try{console.log("Debugging backend category state...");const K=await VW();console.log("=== BACKEND DEBUG RESPONSE ==="),console.log(JSON.stringify(K.debugInfo,null,2)),fe.success(l.jsxs("div",{className:"max-w-md",children:[l.jsx("p",{className:"font-medium",children:"Backend State Debug"}),l.jsxs("div",{className:"text-xs mt-1 space-y-1",children:[l.jsxs("div",{children:["Main Data Families: ",K.debugInfo.mainCategoryData.families.join(", ")||"None"]}),l.jsxs("div",{children:["Upload ID: ",K.debugInfo.mainCategoryData.uploadId||"None"]}),l.jsxs("div",{children:["Total Uploads: ",K.debugInfo.totalUploads]})]})]}),{duration:8e3})}catch(K){console.error("Debug error:",K),fe.error("Debug request failed")}},le=async()=>{_(!0);try{console.log("=== STARTING CATEGORY DATA DELETION ===");const K=await zW();if(console.log("Delete category data response:",K),K.success)m(null),g(null),y(0),fe.success(l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"All Category Data Deleted Successfully!"}),l.jsxs("div",{className:"text-sm mt-1",children:[K.deletedUploadsCount," category uploads removed from database"]}),l.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Deleted at: ",new Date(K.deletedAt).toLocaleString()]})]}),{duration:5e3}),t&&(console.log("Notifying parent component about category data deletion..."),t()),console.log("=== CATEGORY DATA DELETION COMPLETED ===");else throw new Error(K.error||"Unknown deletion error")}catch(K){console.error("Error deleting category data:",K),fe.error(l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Failed to Delete Category Data"}),l.jsx("p",{className:"text-sm",children:K instanceof Error?K.message:"Unknown error occurred"})]}))}finally{_(!1)}},J=K=>{const se=K.target.files?.[0];se&&(n(se),u("idle"),d([]),p([]),se.name.endsWith(".csv")?Z(se):se.name.endsWith(".xlsx")||se.name.endsWith(".xls")?re(se):fe.error("Please upload a CSV or Excel file"))},Z=K=>{const se=new FileReader;se.onload=P=>{try{const b=P.target?.result,{headers:D,dataRows:R}=RW(b);console.log("CSV headers found:",D),te(D,R)}catch(b){console.error("Error parsing CSV file:",b),fe.error(b instanceof Error?b.message:"Failed to parse CSV file. Please check the file format.")}},se.onerror=()=>{fe.error("Error reading CSV file")},se.readAsText(K)},re=K=>{const se=new FileReader;se.onload=P=>{try{const b=new Uint8Array(P.target?.result),{headers:D,dataRows:R}=PW(b);console.log("Excel headers found:",D),te(D,R)}catch(b){console.error("Error parsing Excel file:",b),fe.error(b instanceof Error?b.message:"Failed to parse Excel file. Please check the file format.")}},se.onerror=()=>{fe.error("Error reading Excel file")},se.readAsArrayBuffer(K)},te=(K,se)=>{try{const{data:P,errors:b}=IW(K,se),D=[...b,...P.filter(R=>R.errors.length>0).map((R,W)=>`Row ${W+2}: ${R.errors.join(", ")}`)];d(P),p(D),D.length===0?fe.success(`Successfully parsed ${P.length} category records from ${r?.name}`):fe.warning(`Parsed ${P.length} records with ${D.length} validation errors from ${r?.name}`)}catch(P){console.error("Error processing file data:",P),fe.error(P instanceof Error?P.message:"Failed to process file data"),p([P instanceof Error?P.message:"Unknown processing error"])}},z=async()=>{if(!r||f.length===0){fe.error("Please select a valid file with category data");return}const K=f.filter(se=>se.errors.length===0);if(K.length===0){fe.error("No valid records found. Please fix the errors and try again.");return}a(!0);try{console.log("Starting category data upload...");const se=OW(K);console.log("Processed upload data:",{totalRecords:K.length,families:se.families.length,classes:se.classes.length,brands:se.brands.length,familiesList:se.families,classesList:se.classes,brandsList:se.brands});const P={fileName:r.name,...se,rawData:K,totalRecords:f.length,validRecords:K.length,errorCount:h.length};console.log("Sending upload request to backend...");const b=await $W(P);console.log("Upload response from backend:",b),b.success?(u("success"),console.log("Upload successful, uploadId:",b.uploadId),fe.success(l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Vn,{className:"h-5 w-5 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Category Data Uploaded Successfully!"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[K.length," records processed  ",se.families.length," families  ",se.classes.length," classes  ",se.brands.length," brands"]}),l.jsxs("p",{className:"text-xs text-blue-600 font-mono mt-1",children:["Upload ID: ",b.uploadId]})]})]}),{duration:6e3}),setTimeout(async()=>{console.log("Refreshing data after upload..."),await Promise.all([F(!0),U(!0)])},2e3),n(null),d([]),p([]),A.current&&(A.current.value=""),e&&(console.log("Notifying parent about category data upload..."),setTimeout(()=>{e()},2500))):(u("error"),fe.error(`Upload failed: ${b.error}`))}catch(se){console.error("Upload error:",se),u("error"),fe.error("Upload failed. Please check your connection and try again.")}finally{a(!1)}};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Upload Category Data"}),l.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Upload a CSV or Excel file containing family, class, brand, and article information. This data will be used for creating booster schemes with hierarchical filtering."})]}),l.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(Fs,{className:"h-10 w-10 mx-auto text-gray-400 mb-4"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Et,{ref:A,type:"file",accept:".csv,.xlsx,.xls",onChange:J,className:"hidden",id:"category-file-upload"}),l.jsxs("label",{htmlFor:"category-file-upload",className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[l.jsx(sl,{className:"h-4 w-4 mr-2"}),"Choose File"]}),l.jsx("p",{className:"text-xs text-gray-500",children:"CSV or Excel files only"})]})]}),r&&l.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(sl,{className:"h-4 w-4 text-blue-500"}),l.jsx("span",{className:"text-sm font-medium text-blue-900",children:r.name}),l.jsxs(pt,{variant:"secondary",className:"text-xs",children:[(r.size/1024).toFixed(1)," KB"]})]}),c==="success"&&l.jsx(Vn,{className:"h-4 w-4 text-green-500"}),c==="error"&&l.jsx(aa,{className:"h-4 w-4 text-red-500"})]})})]}),h.length>0&&l.jsxs(At,{className:"border-red-200 bg-red-50",children:[l.jsx(Ds,{className:"h-4 w-4 text-red-600"}),l.jsx(jt,{children:l.jsxs("div",{className:"space-y-1",children:[l.jsx("p",{className:"font-medium text-red-800",children:"Validation Errors Found:"}),l.jsxs("ul",{className:"text-sm text-red-700 space-y-1",children:[h.slice(0,10).map((K,se)=>l.jsx("li",{className:"list-disc list-inside",children:K},se)),h.length>10&&l.jsxs("li",{className:"text-xs text-red-600",children:["... and ",h.length-10," more errors"]})]})]})})]}),f.length>0&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("h4",{className:"font-medium",children:"Parsed Data Preview"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[f.length," total records  ",f.filter(K=>K.errors.length===0).length," valid  ",f.filter(K=>K.errors.length>0).length," with errors"]})]}),l.jsxs(be,{onClick:z,disabled:s||f.filter(K=>K.errors.length===0).length===0,className:"flex items-center space-x-2",children:[s?l.jsx(dr,{className:"h-4 w-4 animate-spin"}):l.jsx(Fs,{className:"h-4 w-4"}),l.jsx("span",{children:s?"Uploading...":"Upload Data"})]})]}),l.jsx("div",{className:"border rounded-lg max-h-64 overflow-auto",children:l.jsxs(Bc,{children:[l.jsx(Uc,{children:l.jsxs(is,{children:[l.jsx(dt,{children:"Family Code"}),l.jsx(dt,{children:"Family Name"}),l.jsx(dt,{children:"Class Code"}),l.jsx(dt,{children:"Class Name"}),l.jsx(dt,{children:"Brand Code"}),l.jsx(dt,{children:"Brand Name"}),l.jsx(dt,{children:"Article Code"}),l.jsx(dt,{children:"Article Description"}),l.jsx(dt,{children:"Status"})]})}),l.jsxs($c,{children:[f.slice(0,10).map((K,se)=>l.jsxs(is,{className:K.errors.length>0?"bg-red-50":"",children:[l.jsx(ut,{className:"font-mono text-xs",children:K.familyCode}),l.jsx(ut,{children:K.familyName}),l.jsx(ut,{className:"font-mono text-xs",children:K.classCode}),l.jsx(ut,{children:K.className}),l.jsx(ut,{className:"font-mono text-xs",children:K.brandCode}),l.jsx(ut,{children:K.brandName}),l.jsx(ut,{className:"font-mono text-xs",children:K.articleCode}),l.jsx(ut,{className:"truncate max-w-32",children:K.articleDescription}),l.jsx(ut,{children:K.errors.length===0?l.jsx(pt,{variant:"secondary",className:"bg-green-100 text-green-800",children:"Valid"}):l.jsxs(pt,{variant:"destructive",className:"text-xs",children:[K.errors.length," error",K.errors.length>1?"s":""]})})]},se)),f.length>10&&l.jsx(is,{children:l.jsxs(ut,{colSpan:9,className:"text-center text-gray-500 text-sm",children:["... and ",f.length-10," more records"]})})]})]})})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Current Category Data"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs(be,{onClick:N,variant:"outline",size:"sm",disabled:k,className:"flex items-center space-x-2",children:[l.jsx(dr,{className:`h-4 w-4 ${k?"animate-spin":""}`}),l.jsx("span",{children:"Refresh Data"})]}),l.jsxs(be,{onClick:X,variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[l.jsx(Ds,{className:"h-4 w-4"}),l.jsx("span",{children:"Debug State"})]})]})]}),x?l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ri,{className:"h-5 w-5 text-green-600"}),l.jsx("span",{children:"Active Category Data"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs(be,{onClick:V,variant:"outline",size:"sm",disabled:i,className:"flex items-center space-x-2",children:[i?l.jsx(dr,{className:"h-4 w-4 animate-spin"}):l.jsx(La,{className:"h-4 w-4"}),l.jsx("span",{children:"Download"})]}),l.jsxs(h8,{children:[l.jsx(p8,{asChild:!0,children:l.jsxs(be,{variant:"destructive",size:"sm",disabled:S,className:"flex items-center space-x-2",children:[S?l.jsx(dr,{className:"h-4 w-4 animate-spin"}):l.jsx(uu,{className:"h-4 w-4"}),l.jsx("span",{children:"Delete"})]})}),l.jsxs(g8,{children:[l.jsxs(v8,{children:[l.jsx(w8,{children:"Delete All Category Data"}),l.jsx(_8,{children:"This will permanently delete all category data from the database. This action cannot be undone and will affect all schemes that depend on this data."})]}),l.jsxs(y8,{children:[l.jsx(k8,{children:"Cancel"}),l.jsx(S8,{onClick:le,className:"bg-red-600 hover:bg-red-700",children:"Delete All Data"})]})]})]})]})]})}),l.jsxs(je,{children:[l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.families.length}),l.jsx("div",{className:"text-sm text-blue-700",children:"Families"})]}),l.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.classes.length}),l.jsx("div",{className:"text-sm text-green-700",children:"Classes"})]}),l.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:x.brands.length}),l.jsx("div",{className:"text-sm text-purple-700",children:"Brands"})]}),l.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-orange-600",children:Object.keys(x.articleMappings||{}).length}),l.jsx("div",{className:"text-sm text-orange-700",children:"Articles"})]})]}),v&&l.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"font-medium text-gray-900",children:["Last Upload: ",v.fileName]}),l.jsxs("div",{className:"text-gray-600",children:[v.rawData.length," records  ",LW(v.uploadedAt).relative]})]}),x.uploadId&&l.jsx(pt,{variant:"secondary",className:"font-mono text-xs",children:x.uploadId})]})})]})]}):l.jsx(Ae,{children:l.jsxs(je,{className:"text-center py-8",children:[l.jsx(Ri,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),l.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Category Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Upload a CSV or Excel file to get started with category data management."})]})})]})]})}const Sh=[{code:"P1",name:"National Distributor"},{code:"P2",name:"Regional Distributor"},{code:"P3",name:"Large Format Retailer"},{code:"P4",name:"Regional Retailer"},{code:"P5",name:"Direct Dealer"},{code:"P6",name:"PBG_Liquidation"},{code:"P7",name:"Advance Dealer-PBG"},{code:"P8",name:"Advance Dist-PBG"},{code:"P9",name:"Advance FOMT-PBG"},{code:"PD",name:"PBG DD Prime Partner"},{code:"PC",name:"PBG CDG Group"}],kh=["East","West","North1","North2","South"];function XW(){const[e,t]=T.useState("onboard"),[r,n]=T.useState([]),[s,a]=T.useState([]),[i,o]=T.useState(""),[c,u]=T.useState(!1),[f,d]=T.useState(null),[h,p]=T.useState({}),[x,m]=T.useState(null),[v,g]=T.useState(!1),[w,y]=T.useState("idle"),[k,E]=T.useState([]),[S,_]=T.useState([]),A=T.useRef(null),[F,U]=T.useState({id:"",name:"",type:"",zone:"",state:""});T.useEffect(()=>{N(),V()},[]);const V=async()=>{try{const Y=await at.makePublicRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/zone-state-mapping`,{method:"GET"}),ae=await Y.text();if(console.log("Raw zone-state mapping response:",ae),!Y.ok){console.error("Zone-state mapping response not ok:",Y.status,ae);return}let ce;try{ce=JSON.parse(ae)}catch(xe){console.error("Zone-state mapping JSON parse error:",xe,"Raw text:",ae);return}ce.success?p(ce.mapping||{}):console.error("Zone-state mapping API returned error:",ce.error)}catch(Y){console.error("Error fetching zone-state mapping:",Y)}},N=async()=>{try{console.log("Loading distributors...");const Y=await at.makeAuthenticatedRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/distributors`,{method:"GET"}),ae=await Y.text();if(console.log("Raw distributor response:",ae),!Y.ok){console.error("Distributor response not ok:",Y.status,ae),fe.error(`Failed to load distributors: ${Y.status} ${Y.statusText}`);return}let ce;try{ce=JSON.parse(ae)}catch(xe){console.error("Distributor JSON parse error:",xe,"Raw text:",ae),fe.error("Failed to parse distributors response");return}if(ce.success){const xe=ce.distributors?.map(De=>De.value)||[];console.log("Loaded distributors:",xe.length),n(xe),a(xe)}else console.error("API returned error:",ce.error),fe.error(`Failed to load distributors: ${ce.error}`)}catch(Y){console.error("Error fetching distributors:",Y),fe.error("Failed to load distributors")}},X=()=>!F.zone||F.zone==="all-zones"?Object.values(h).flat():h[F.zone]||[],le=Y=>{if(o(Y),!Y.trim()){a(r);return}const ae=Y.toLowerCase().trim(),ce=r.filter(xe=>xe.id?.toLowerCase().includes(ae)||xe.code?.toLowerCase().includes(ae)||xe.name?.toLowerCase().includes(ae));a(ce)};T.useEffect(()=>{i?le(i):a(r)},[r]);const J=(Y,ae)=>{U(ce=>{const xe={...ce,[Y]:ae};return Y==="zone"&&(xe.state=""),xe})},Z=(Y,ae,ce="")=>{const xe=ae||"DIST",De=Y.replace(/\s+/g,"").substring(0,3).toUpperCase(),Ve=ce||Date.now().toString().slice(-4);return`${xe}_${De}_${Ve}`},re=async Y=>{Y.preventDefault(),u(!0);try{const ae={id:F.id||`dist_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:F.name,code:Z(F.name,F.type,F.id),type:F.type,zone:F.zone,state:F.state,status:"active"},ce=f?`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/distributors/${f.id}`:`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/distributors`,De=await(await at.makeAuthenticatedRequest(ce,{method:f?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)})).json();De.success?(fe.success(f?"Distributor updated successfully!":"Distributor added successfully!"),te(),N(),t("manage")):fe.error(`Failed to ${f?"update":"add"} distributor: ${De.error}`)}catch(ae){console.error("Error submitting distributor:",ae),fe.error("Failed to process distributor data")}finally{u(!1)}},te=()=>{U({id:"",name:"",type:"",zone:"",state:""}),d(null)},z=Y=>{U({id:Y.code||Y.id,name:Y.name,type:Y.type,zone:Y.zone,state:Y.state}),d(Y),t("onboard")},K=async Y=>{if(confirm("Are you sure you want to delete this distributor?"))try{const ce=await(await at.makeAuthenticatedRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/distributors/${Y}`,{method:"DELETE"})).json();ce.success?(fe.success("Distributor deleted successfully!"),N()):fe.error(`Failed to delete distributor: ${ce.error}`)}catch(ae){console.error("Error deleting distributor:",ae),fe.error("Failed to delete distributor")}},se=async(Y,ae)=>{const ce=ae==="active"?"inactive":"active";try{const De=await(await at.makeAuthenticatedRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/distributors/${Y}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:ce})})).json();De.success?(fe.success(`Distributor ${ce==="active"?"activated":"deactivated"} successfully!`),N()):fe.error(`Failed to update distributor status: ${De.error}`)}catch(xe){console.error("Error updating distributor status:",xe),fe.error("Failed to update distributor status")}},P=()=>{const Y=["Distributor ID,Distributor Name,Type,Zone,State","DIST001,ABC Electronics Pvt Ltd,P1,North1,Delhi","DIST002,XYZ Distributors,P2,West,Maharashtra","DIST003,Regional Sales Corp,P3,South,Karnataka","DIST004,Metro Retail Chain,P4,East,West Bengal","DIST005,Direct Dealer Hub,P5,North2,Punjab"].join(`
`),ae=new Blob([Y],{type:"text/csv"}),ce=window.URL.createObjectURL(ae),xe=document.createElement("a");xe.href=ce,xe.download="distributor_bulk_upload_template.csv",xe.click(),window.URL.revokeObjectURL(ce),fe.success("Template downloaded successfully!")},b=Y=>Y.toLowerCase().replace(/[^a-z]/g,"").trim(),D=(Y,ae)=>{const ce=b(ae);return Y.findIndex(xe=>b(xe)===ce)},R=Y=>{console.log("Parsing CSV file:",Y.name);const ae=new FileReader;ae.onload=ce=>{try{const xe=ce.target?.result;console.log("CSV file content length:",xe.length);const De=xe.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`).filter(Ie=>Ie.trim());if(console.log("Total lines found:",De.length),De.length<2){fe.error("CSV file must contain header row and at least one data row");return}const Ve=Ie=>{const ze=[];let Fe="",ft=!1;for(let ir=0;ir<Ie.length;ir++){const Gt=Ie[ir];Gt==='"'?ft=!ft:Gt===","&&!ft?(ze.push(Fe.trim().replace(/^"|"$/g,"")),Fe=""):Fe+=Gt}return ze.push(Fe.trim().replace(/^"|"$/g,"")),ze},qe=Ve(De[0]);console.log("CSV headers found:",qe);const Oe=De.slice(1).filter(Ie=>Ie.trim()).map(Ie=>Ve(Ie)).filter(Ie=>Ie.some(ze=>ze.trim()!==""));if(console.log("CSV rows parsed:",Oe.length),console.log("Sample row:",Oe[0]),Oe.length===0){fe.error("No valid data rows found in CSV file");return}Q(qe,Oe)}catch(xe){console.error("CSV parsing error:",xe),fe.error("Failed to parse CSV file. Please check the file format.")}},ae.onerror=ce=>{console.error("FileReader error:",ce),fe.error("Error reading CSV file")},ae.readAsText(Y,"UTF-8")},W=async Y=>{try{console.log("Attempting to parse Excel file:",Y.name);let ae=null;try{ae=await gl(()=>Promise.resolve().then(()=>bW),void 0),console.log("Successfully loaded XLSX via dynamic import"),q(Y,ae)}catch{console.log("Dynamic import failed, trying alternative approaches");try{const xe=document.createElement("script");xe.src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js",xe.onload=()=>{console.log("XLSX loaded from CDN"),ae=window.XLSX,ae?q(Y,ae):H()},xe.onerror=()=>{console.error("Failed to load XLSX from CDN"),H()},document.head.appendChild(xe);return}catch(xe){console.error("CDN loading failed:",xe),H();return}}}catch(ae){console.error("Excel parsing setup error:",ae),H()}},q=(Y,ae)=>{const ce=new FileReader;ce.onload=xe=>{try{console.log("Reading Excel file data...");const De=new Uint8Array(xe.target?.result),Ve=ae.read(De,{type:"array"});if(!Ve.SheetNames||Ve.SheetNames.length===0){fe.error("Excel file contains no worksheets");return}const qe=Ve.SheetNames[0],Oe=Ve.Sheets[qe];console.log(`Processing worksheet: ${qe}`);const Ie=ae.utils.sheet_to_json(Oe,{header:1,defval:""});if(console.log("Raw Excel data:",Ie),!Ie||Ie.length<2){fe.error("Excel file must contain header row and at least one data row");return}const ze=Ie[0].map(ft=>{const ir=String(ft||"").trim();return console.log("Header:",ir),ir}),Fe=Ie.slice(1).filter(ft=>ft&&ft.some(ir=>String(ir||"").trim()!=="")).map(ft=>ft.map(ir=>String(ir||"").trim()));if(console.log("Parsed Excel headers:",ze),console.log("Parsed Excel rows:",Fe.length),console.log("Sample row:",Fe[0]),Fe.length===0){fe.error("No valid data rows found in Excel file");return}Q(ze,Fe)}catch(De){console.error("Excel parsing error:",De),fe.error("Failed to parse Excel file. Please check the file format and try again.")}},ce.onerror=xe=>{console.error("FileReader error:",xe),fe.error("Error reading Excel file")},ce.readAsArrayBuffer(Y)},H=()=>{fe.error("Excel parsing is not available. Please convert your file to CSV format and upload again.")},Q=(Y,ae)=>{console.log("Processing file data with headers:",Y),console.log("Processing file data with rows:",ae.length);const ce=[{field:"id",variations:["distributor id","distributorid","distributor_id","id"]},{field:"name",variations:["distributor name","distributorname","distributor_name","name"]},{field:"type",variations:["type","distributor type","distributortype","distributor_type"]},{field:"zone",variations:["zone"]},{field:"state",variations:["state"]}],xe={},De=[];for(const Ie of ce){let ze=-1;for(const Fe of Ie.variations)if(ze=D(Y,Fe),ze!==-1)break;ze!==-1?(xe[Ie.field]=ze,console.log(`Mapped ${Ie.field} to column ${ze} (${Y[ze]})`)):De.push(Ie.variations[0])}if(console.log("Header mapping:",xe),console.log("Missing headers:",De),De.length>0){fe.error(`Missing required columns: ${De.join(", ")}`),_([`Missing columns: ${De.join(", ")}`]);return}const Ve=[],qe=[];for(let Ie=0;Ie<ae.length;Ie++){const ze=ae[Ie];if(!ze||ze.every(ft=>!ft||ft.trim()===""))continue;if(ze.length<Math.max(...Object.values(xe))+1){qe.push(`Row ${Ie+2}: Insufficient columns`);continue}const Fe={id:ze[xe.id]||"",name:ze[xe.name]||"",type:ze[xe.type]||"",zone:ze[xe.zone]||"",state:ze[xe.state]||"",errors:[]};console.log(`Processing record ${Ie+1}:`,Fe),Fe.id||Fe.errors.push("Distributor ID is required"),Fe.name||Fe.errors.push("Distributor name is required"),Fe.type||Fe.errors.push("Type is required"),Fe.zone||Fe.errors.push("Zone is required"),Fe.state||Fe.errors.push("State is required"),Fe.type&&!Sh.find(ft=>ft.code===Fe.type)&&Fe.errors.push(`Invalid type: ${Fe.type}. Valid types: ${Sh.map(ft=>ft.code).join(", ")}`),Fe.zone&&!kh.includes(Fe.zone)&&Fe.errors.push(`Invalid zone: ${Fe.zone}. Valid zones: ${kh.join(", ")}`),Fe.zone&&Fe.state&&h[Fe.zone]&&(h[Fe.zone].includes(Fe.state)||Fe.errors.push(`State ${Fe.state} is not valid for zone ${Fe.zone}. Valid states: ${h[Fe.zone].join(", ")}`)),Ve.push(Fe)}const Oe=[...qe,...Ve.filter(Ie=>Ie.errors.length>0).map((Ie,ze)=>`Row ${ze+2}: ${Ie.errors.join(", ")}`)];console.log("Processed records:",Ve.length),console.log("Validation errors:",Oe.length),E(Ve),_(Oe),Oe.length===0?fe.success(`Successfully parsed ${Ve.length} distributor records`):fe.warning(`Parsed ${Ve.length} records with ${Oe.length} validation errors`)},ee=Y=>{const ae=Y.target.files?.[0];ae&&(console.log("File selected:",ae.name,"Size:",ae.size,"Type:",ae.type),m(ae),y("idle"),E([]),_([]),ae.name.endsWith(".csv")?(console.log("Processing as CSV file"),R(ae)):ae.name.endsWith(".xlsx")||ae.name.endsWith(".xls")?(console.log("Processing as Excel file"),W(ae)):fe.error("Please upload a CSV or Excel file"))},G=async()=>{if(console.log("=== STARTING BULK UPLOAD ==="),console.log("Selected file:",x?.name),console.log("Parsed data length:",k.length),console.log("Validation errors:",S.length),!x||k.length===0){fe.error("Please select a valid file with distributor data");return}const Y=k.filter(ae=>ae.errors.length===0);if(console.log("Valid records:",Y.length),console.log("Valid records sample:",Y.slice(0,2)),Y.length===0){fe.error("No valid records found. Please fix the errors and try again.");return}g(!0);try{console.log("Preparing distributors for upload...");const ae=Y.map(qe=>({id:qe.id,name:qe.name,code:Z(qe.name,qe.type,qe.id),type:qe.type,zone:qe.zone,state:qe.state,status:"active"}));console.log("Distributors to upload:",ae.length),console.log("Sample distributor to upload:",ae[0]);const ce=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/distributors/bulk`;console.log("Uploading to URL:",ce);const xe=await at.makeAuthenticatedRequest(ce,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({distributors:ae})});console.log("Upload response status:",xe.status),console.log("Upload response ok:",xe.ok);const De=await xe.text();console.log("Raw response:",De);let Ve;try{Ve=JSON.parse(De)}catch(qe){throw console.error("Failed to parse response JSON:",qe),console.error("Raw response text:",De),new Error("Server returned invalid JSON response")}console.log("Parsed result:",Ve),Ve.success?(y("success"),console.log(" Bulk upload successful!"),fe.success(l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Vn,{className:"h-5 w-5 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{children:"Distributors Uploaded Successfully!"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[Y.length," distributors processed and added to the system"]})]})]}),{duration:6e3}),m(null),E([]),_([]),A.current&&(A.current.value=""),console.log("Reloading distributors after successful upload..."),await N(),t("manage")):(y("error"),console.error(" Bulk upload failed:",Ve.error||Ve.message),fe.error(`Failed to upload distributors: ${Ve.error||Ve.message||"Unknown error"}`))}catch(ae){console.error(" Error during bulk upload:",ae),y("error"),ae instanceof Error?fe.error(`Upload failed: ${ae.message}`):fe.error("Failed to upload distributors - unknown error occurred")}finally{g(!1),console.log("=== BULK UPLOAD COMPLETED ===")}},C=Y=>{const ae={active:"bg-green-100 text-green-800",inactive:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800"};return l.jsx(pt,{className:ae[Y],children:Y.charAt(0).toUpperCase()+Y.slice(1)})},pe=k.filter(Y=>Y.errors.length===0),_e=k.filter(Y=>Y.errors.length>0);return l.jsxs("div",{className:"space-y-6",children:[l.jsxs(At,{children:[l.jsx(Ic,{className:"h-4 w-4"}),l.jsxs(jt,{children:[l.jsx("strong",{children:"Distributor Management for Scheme Calculations:"})," Upload distributors with essential information. Required fields: ID, Name, Type, Zone, and State. This data is used for scheme calculations and commission distribution."]})]}),l.jsxs(Hi,{value:e,onValueChange:t,className:"space-y-6",children:[l.jsxs(Gi,{className:"grid w-full grid-cols-3",children:[l.jsxs(kt,{value:"onboard",className:"flex items-center space-x-2",children:[l.jsx(Oc,{className:"h-4 w-4"}),l.jsx("span",{children:f?"Edit Distributor":"Add Distributor"})]}),l.jsxs(kt,{value:"bulk-upload",className:"flex items-center space-x-2",children:[l.jsx(Fs,{className:"h-4 w-4"}),l.jsx("span",{children:"Bulk Upload"})]}),l.jsxs(kt,{value:"manage",className:"flex items-center space-x-2",children:[l.jsx(Ma,{className:"h-4 w-4"}),l.jsxs("span",{children:["Manage (",s.length,i?`/${r.length}`:"",")"]})]})]}),l.jsx(bt,{value:"onboard",className:"space-y-6",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(qD,{className:"h-5 w-5"}),l.jsx("span",{children:f?"Edit Distributor":"Add New Distributor"})]})}),l.jsx(je,{children:l.jsxs("form",{onSubmit:re,className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"id",children:"Distributor ID"}),l.jsx(Et,{id:"id",value:F.id,onChange:Y=>J("id",Y.target.value),placeholder:"Enter distributor ID (e.g., DIST001)"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used for scheme calculations and sales data mapping"})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"name",children:"Distributor Name"}),l.jsx(Et,{id:"name",value:F.name,onChange:Y=>J("name",Y.target.value),placeholder:"Enter distributor name",required:!0})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"type",children:"Distributor Type"}),l.jsxs(Xt,{value:F.type,onValueChange:Y=>J("type",Y),children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select type"})}),l.jsx(Yt,{children:Sh.map(Y=>l.jsxs(Je,{value:Y.code,children:[Y.code,": ",Y.name]},Y.code))})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"zone",children:"Zone"}),l.jsxs(Xt,{value:F.zone,onValueChange:Y=>J("zone",Y),children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select zone"})}),l.jsx(Yt,{children:kh.map(Y=>l.jsx(Je,{value:Y,children:Y},Y))})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"state",children:"State"}),l.jsxs(Xt,{value:F.state,onValueChange:Y=>J("state",Y),disabled:!F.zone,children:[l.jsx(qt,{children:l.jsx(Kt,{placeholder:"Select state"})}),l.jsx(Yt,{children:X().map(Y=>l.jsx(Je,{value:Y,children:Y},Y))})]})]})]}),l.jsxs("div",{className:"flex justify-end space-x-4",children:[f&&l.jsx(be,{type:"button",onClick:te,variant:"outline",children:"Cancel"}),l.jsx(be,{type:"submit",disabled:c,children:c?"Processing...":f?"Update Distributor":"Add Distributor"})]})]})})]})}),l.jsx(bt,{value:"bulk-upload",className:"space-y-6",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(Fs,{className:"h-5 w-5"}),l.jsx("span",{children:"Bulk Upload Distributors"})]})}),l.jsxs(je,{className:"space-y-6",children:[l.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:l.jsxs("div",{className:"text-center",children:[l.jsx(sl,{className:"mx-auto h-12 w-12 text-gray-400"}),l.jsxs("div",{className:"mt-4",children:[l.jsx(Me,{htmlFor:"bulk-file-upload",className:"cursor-pointer",children:l.jsx("span",{className:"mt-2 block text-sm font-medium text-gray-900",children:"Upload CSV or Excel file"})}),l.jsx(Et,{ref:A,id:"bulk-file-upload",type:"file",className:"hidden",accept:".csv,.xlsx,.xls",onChange:ee}),l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"CSV, XLSX or XLS files up to 10MB"})]}),l.jsx("div",{className:"mt-4 flex justify-center",children:l.jsxs(be,{type:"button",onClick:()=>A.current?.click(),variant:"outline",children:[l.jsx(Fs,{className:"h-4 w-4 mr-2"}),"Choose File"]})}),l.jsx("div",{className:"mt-4 flex justify-center",children:l.jsxs(be,{type:"button",onClick:P,variant:"outline",size:"sm",children:[l.jsx(La,{className:"h-4 w-4 mr-2"}),"Download Template"]})})]})}),x&&l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(sl,{className:"h-5 w-5 text-blue-600"}),l.jsx("span",{className:"text-sm font-medium text-blue-900",children:x.name}),l.jsxs(pt,{variant:"secondary",children:[(x.size/1024).toFixed(1),"KB"]})]})}),k.length>0&&l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Validation Results"}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs(pt,{className:"bg-green-100 text-green-800",children:["Valid: ",pe.length]}),_e.length>0&&l.jsxs(pt,{className:"bg-red-100 text-red-800",children:["Invalid: ",_e.length]})]})]})}),l.jsxs(je,{children:[S.length>0&&l.jsxs(At,{className:"mb-4",children:[l.jsx(aa,{className:"h-4 w-4"}),l.jsxs(jt,{children:[l.jsx("strong",{children:"Validation Errors:"}),l.jsx("ul",{className:"mt-2 list-disc list-inside text-sm",children:S.map((Y,ae)=>l.jsx("li",{children:Y},ae))})]})]}),l.jsx("div",{className:"max-h-64 overflow-y-auto",children:l.jsxs(Bc,{children:[l.jsx(Uc,{children:l.jsxs(is,{children:[l.jsx(dt,{children:"Status"}),l.jsx(dt,{children:"ID"}),l.jsx(dt,{children:"Name"}),l.jsx(dt,{children:"Type"}),l.jsx(dt,{children:"Zone"}),l.jsx(dt,{children:"State"})]})}),l.jsx($c,{children:k.map((Y,ae)=>l.jsxs(is,{children:[l.jsx(ut,{children:Y.errors.length===0?l.jsx(Vn,{className:"h-4 w-4 text-green-600"}):l.jsx(aa,{className:"h-4 w-4 text-red-600"})}),l.jsx(ut,{children:Y.id}),l.jsx(ut,{children:Y.name}),l.jsx(ut,{children:Y.type}),l.jsx(ut,{children:Y.zone}),l.jsx(ut,{children:Y.state})]},ae))})]})}),l.jsxs("div",{className:"flex justify-between items-center mt-4",children:[l.jsxs("div",{className:"text-sm text-gray-600",children:[pe.length," valid record(s) ready for upload"]}),l.jsxs("div",{className:"space-x-2",children:[l.jsx(be,{onClick:()=>{m(null),E([]),_([]),A.current&&(A.current.value="")},variant:"outline",disabled:v,children:"Clear"}),l.jsx(be,{onClick:G,disabled:v||pe.length===0,children:v?"Uploading...":`Upload ${pe.length} Distributors`})]})]})]})]}),w==="success"&&l.jsxs(At,{className:"border-green-200 bg-green-50",children:[l.jsx(Vn,{className:"h-4 w-4 text-green-600"}),l.jsx(jt,{className:"text-green-800",children:"Distributors uploaded successfully! Check the 'Manage' tab to view them."})]})]})]})}),l.jsx(bt,{value:"manage",className:"space-y-6",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ma,{className:"h-5 w-5"}),l.jsxs("span",{children:["Manage Distributors (",s.length,")"]})]}),l.jsx("div",{className:"flex items-center space-x-2",children:l.jsxs("div",{className:"relative",children:[l.jsx(zF,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-400"}),l.jsx(Et,{placeholder:"Search distributors...",value:i,onChange:Y=>le(Y.target.value),className:"pl-8 w-64"})]})})]})}),l.jsx(je,{children:s.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Ma,{className:"mx-auto h-12 w-12 text-gray-400"}),l.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No distributors found"}),l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:i?"No distributors match your search criteria.":"Get started by adding your first distributor."}),l.jsx("div",{className:"mt-6",children:l.jsxs(be,{onClick:()=>t("onboard"),children:[l.jsx(Oc,{className:"h-4 w-4 mr-2"}),"Add Distributor"]})})]}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(Bc,{children:[l.jsx(Uc,{children:l.jsxs(is,{children:[l.jsx(dt,{children:"ID"}),l.jsx(dt,{children:"Code"}),l.jsx(dt,{children:"Name"}),l.jsx(dt,{children:"Type"}),l.jsx(dt,{children:"Zone"}),l.jsx(dt,{children:"State"}),l.jsx(dt,{children:"Status"}),l.jsx(dt,{children:"Onboarded"}),l.jsx(dt,{className:"text-right",children:"Actions"})]})}),l.jsx($c,{children:s.map(Y=>l.jsxs(is,{children:[l.jsx(ut,{className:"font-mono text-sm",children:Y.id}),l.jsx(ut,{className:"font-mono text-sm",children:Y.code}),l.jsx(ut,{children:Y.name}),l.jsx(ut,{children:Y.type}),l.jsx(ut,{children:Y.zone}),l.jsx(ut,{children:Y.state}),l.jsx(ut,{children:C(Y.status)}),l.jsx(ut,{children:new Date(Y.onboardedAt).toLocaleDateString()}),l.jsx(ut,{className:"text-right",children:l.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[l.jsx(be,{size:"sm",variant:"outline",onClick:()=>z(Y),children:l.jsx(JF,{className:"h-4 w-4"})}),l.jsx(be,{size:"sm",variant:Y.status==="active"?"outline":"default",onClick:()=>se(Y.id,Y.status),children:Y.status==="active"?l.jsx(sd,{className:"h-4 w-4"}):l.jsx(hx,{className:"h-4 w-4"})}),l.jsx(be,{size:"sm",variant:"outline",onClick:()=>K(Y.id),className:"text-red-600 hover:text-red-700",children:l.jsx(uu,{className:"h-4 w-4"})})]})})]},Y.id))})]})})})]})})]})]})}var u0="Collapsible",[KW,OV]=oa(u0),[qW,xg]=KW(u0),cT=T.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:s,disabled:a,onOpenChange:i,...o}=e,[c,u]=Ai({prop:n,defaultProp:s??!1,onChange:i,caller:u0});return l.jsx(qW,{scope:r,disabled:a,contentId:Ys(),open:c,onOpenToggle:T.useCallback(()=>u(f=>!f),[u]),children:l.jsx(Ze.div,{"data-state":vg(c),"data-disabled":a?"":void 0,...o,ref:t})})});cT.displayName=u0;var uT="CollapsibleTrigger",YW=T.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,s=xg(uT,r);return l.jsx(Ze.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":vg(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...n,ref:t,onClick:nt(e.onClick,s.onOpenToggle)})});YW.displayName=uT;var gg="CollapsibleContent",fT=T.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=xg(gg,e.__scopeCollapsible);return l.jsx(hl,{present:r||s.open,children:({present:a})=>l.jsx(JW,{...n,ref:t,present:a})})});fT.displayName=gg;var JW=T.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:s,...a}=e,i=xg(gg,r),[o,c]=T.useState(n),u=T.useRef(null),f=Ct(t,u),d=T.useRef(0),h=d.current,p=T.useRef(0),x=p.current,m=i.open||o,v=T.useRef(m),g=T.useRef(void 0);return T.useEffect(()=>{const w=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(w)},[]),Ir(()=>{const w=u.current;if(w){g.current=g.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const y=w.getBoundingClientRect();d.current=y.height,p.current=y.width,v.current||(w.style.transitionDuration=g.current.transitionDuration,w.style.animationName=g.current.animationName),c(n)}},[i.open,n]),l.jsx(Ze.div,{"data-state":vg(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!m,...a,ref:f,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":x?`${x}px`:void 0,...e.style},children:m&&s})});function vg(e){return e?"open":"closed"}var QW=cT;function ZW({...e}){return l.jsx(QW,{"data-slot":"collapsible",...e})}function eV({...e}){return l.jsx(fT,{"data-slot":"collapsible-content",...e})}const dT=T.forwardRef(({shouldRefresh:e},t)=>{const[r,n]=T.useState([]),[s,a]=T.useState([]),[i,o]=T.useState([]),[c,u]=T.useState([]),[f,d]=T.useState(!1),[h,p]=T.useState(new Set),[x,m]=T.useState({}),[v,g]=T.useState({}),[w,y]=T.useState(""),[k,E]=T.useState([]),[S,_]=T.useState(null),A=async()=>{console.log("=== ManageSchemes: Starting fetchAllData ==="),d(!0),E([]);const b=new Date().toISOString();y(b);const D={fetchStartTime:b,projectId:$e,baseUrl:`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43`,authToken:await at.getAccessToken()?"Present":"Missing"};try{const R=await Promise.allSettled([F(),U(),V()]);D.fetchResults=R.map((H,Q)=>({endpoint:["schemes","uploads","calculations"][Q],status:H.status,...H.status==="rejected"?{error:H.reason}:{}}));let W=0,q=0;R.forEach((H,Q)=>{const ee=["schemes","uploads","calculations"][Q];if(H.status==="rejected"){q++;const G=`Failed to fetch ${ee}: ${H.reason}`;console.error(G),E(C=>[...C,G])}else W++,console.log(` Successfully fetched ${ee}`)}),console.log(`Fetch summary: ${W} successful, ${q} failed`),R[0].status==="fulfilled"?console.log("Core scheme data loaded successfully"):console.error("Failed to load core scheme data")}catch(R){console.error("Error in fetchAllData:",R),D.fetchError=R?.toString()||"Unknown error",E(W=>[...W,`General fetch error: ${R}`])}finally{D.fetchEndTime=new Date().toISOString(),D.processingTimeMs=new Date().getTime()-new Date(b).getTime(),g(D),d(!1),console.log(`=== ManageSchemes: Completed fetchAllData in ${D.processingTimeMs}ms ===`,D)}};T.useImperativeHandle(t,()=>({refresh:A})),T.useEffect(()=>{console.log("ManageSchemes mounted, fetching data..."),A()},[]),T.useEffect(()=>{e&&(console.log("shouldRefresh prop changed, fetching data..."),A())},[e]),T.useEffect(()=>{console.log("Dependencies changed, organizing scheme data..."),N()},[r,i]);const F=async()=>{try{console.log("Fetching schemes with authentication...");const b=`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/schemes`,D=await at.makeAuthenticatedRequest(b,{method:"GET"});if(!D.ok){const W=await D.text();throw new Error(`HTTP ${D.status}: ${W}`)}const R=await D.json();if(R.success&&R.schemes){const W=R.schemes.map(q=>q.value||q).filter(Boolean);return n(W),W}else return n([]),[]}catch(b){throw console.error("Error fetching schemes:",b),n([]),b}},U=async()=>{try{console.log("Fetching sales data with authentication...");const b=await at.makeAuthenticatedRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/sales-data`,{method:"GET"});if(!b.ok)throw new Error(`HTTP ${b.status}: ${b.statusText}`);const D=await b.json();if(D.success){if(!D.salesData||!Array.isArray(D.salesData)||D.salesData.length===0)return a([]),[];const R=[],W=new Map;D.salesData.forEach(H=>{const Q=H.uploadMonth||"Unknown",ee=H.uploadYear||new Date().getFullYear(),G=H.fileName||"sales_data.csv",C=H.uploadedAt?H.uploadedAt.split("T")[0]:new Date().toISOString().split("T")[0],pe=`${Q}_${ee}_${G}_${C}`;W.has(pe)||W.set(pe,[]),W.get(pe).push(H)});let q=0;return W.forEach((H,Q)=>{const ee=H[0]||{},G={id:`upload_${q}_${ee.uploadMonth||"unknown"}_${ee.uploadYear||"unknown"}`,fileName:ee.fileName||"sales_data.csv",month:ee.uploadMonth||"Unknown",year:Number(ee.uploadYear)||new Date().getFullYear(),uploadedAt:ee.uploadedAt||new Date().toISOString(),data:H};R.push(G),q++}),a(R),R}else return a([]),[]}catch(b){throw console.error("Error fetching sales data:",b),a([]),b}},V=async(b=0)=>{try{const W=new AbortController,q=setTimeout(()=>W.abort(),3e4);console.log(`Fetching calculations (attempt ${b+1}/4)...`);const H=await at.makeAuthenticatedRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/calculations`,{method:"GET",signal:W.signal});if(clearTimeout(q),!H.ok)throw new Error(`HTTP ${H.status}: ${H.statusText}`);const Q=await H.json();if(console.log("Raw calculations response:",Q),Q.success&&Array.isArray(Q.calculations)){const ee=Q.calculations.filter(G=>G&&typeof G=="object").map(G=>{const C=G.value||G;if(!C||typeof C!="object")return console.warn("Invalid calculation item:",C),null;let pe=0;return typeof C.totalCommission=="number"?pe=C.totalCommission:C.summary?.totalCommission&&typeof C.summary.totalCommission=="number"?pe=C.summary.totalCommission:C.calculations&&Array.isArray(C.calculations)&&(pe=C.calculations.reduce((_e,Y)=>_e+(Number(Y?.commission)||0),0)),console.log(`Calculation ${C.id||"unknown"}: totalCommission = ${pe}`),{...C,id:C.id||`calc_${Date.now()}_${Math.random()}`,schemeId:C.schemeId||"unknown",uploadId:C.uploadId||"all-sales-data",calculations:Array.isArray(C.calculations)?C.calculations:[],totalCommission:pe||0,calculatedAt:C.calculatedAt||C.createdAt||new Date().toISOString()}}).filter(Boolean);return console.log("Processed calculations:",ee),o(ee),ee}else return console.log("No calculations found or invalid response format"),o([]),[]}catch(W){return console.error("Error fetching calculations:",W),W.name==="AbortError"&&console.log(`Fetch calculations was aborted due to timeout (attempt ${b+1})`),b<3&&(W.name==="AbortError"||W.message.includes("500")||W.message.includes("timeout"))?(console.log(`Retrying calculations fetch in ${(b+1)*2} seconds...`),await new Promise(q=>setTimeout(q,(b+1)*2e3)),V(b+1)):(console.error("All calculation fetch attempts failed, continuing with empty calculations"),o([]),[])}},N=()=>{console.log("Organizing scheme data..."),console.log("Schemes:",r.length),console.log("Calculations:",i.length);const b=r.map(D=>{r.indexOf(D)<2&&P(D);const R=i.filter(H=>H.schemeId===D.id);console.log(`Scheme ${D.name} (${D.id}): Found ${R.length} calculations`);const W=R.reduce((H,Q)=>{const ee=Q.totalCommission||0;return console.log(`  Calculation ${Q.id}: adding ${ee} to total`),H+ee},0);console.log(`Scheme ${D.name}: Total commission = ${W}`);const q=R.length>0?R.sort((H,Q)=>new Date(Q.calculatedAt).getTime()-new Date(H.calculatedAt).getTime())[0]?.calculatedAt:void 0;return{...D,calculations:R,totalCommission:W||0,lastCalculated:q}}).sort((D,R)=>new Date(R.createdAt).getTime()-new Date(D.createdAt).getTime());console.log("Final organized schemes:",b.map(D=>({name:D.name,totalCommission:D.totalCommission}))),u(b)},X=b=>{p(D=>{const R=new Set(D);return R.has(b)?R.delete(b):R.add(b),R})},le=async(b,D)=>{if(s.length===0){fe.error("No sales data available. Please upload sales data first.");return}_(b);const R=Date.now();try{const W={schemeId:b};D&&D!=="all-sales-data"&&(W.uploadId=D),console.log("Starting scheme calculation with increased timeout...");const q=new AbortController,Q=setTimeout(()=>{console.log("Calculation timeout reached, aborting request..."),q.abort()},6e4),ee=await at.makeAuthenticatedRequest(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/calculate`,{method:"POST",body:JSON.stringify(W),signal:q.signal});if(clearTimeout(Q),!ee.ok){const C=await ee.text();throw new Error(`HTTP ${ee.status}: ${C}`)}const G=await ee.json();if(G.success){const C=Date.now()-R,pe=r.find(Y=>Y.id===b),_e=G.summary?.totalCommission||0;fe.success(l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ts,{className:"h-5 w-5 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Calculation Completed!"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[pe?.name,"  Commission: ",_e.toLocaleString()," ",G.calculations?.length||0," records  ",(C/1e3).toFixed(1),"s"]})]})]}),{duration:6e3}),await V()}else fe.error(`Calculation failed: ${G.error}`)}catch(W){console.error("Error calculating scheme:",W);let q="Failed to calculate scheme",H=!1;W instanceof Error?(q=W.message,H=W.name==="AbortError"||W.message.includes("timeout")):typeof W=="string"&&(q=W,H=W.includes("timeout")),H?fe.error(l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Calculation Timeout"}),l.jsx("p",{className:"text-sm text-gray-600",children:"The calculation is taking longer than expected. This may be due to large datasets. Try reducing the dataset size or try again later."})]}),{duration:1e4}):fe.error(l.jsxs("div",{children:[l.jsx("p",{className:"font-medium",children:"Calculation Error"}),l.jsx("p",{className:"text-sm text-gray-600",children:q})]}),{duration:8e3})}finally{_(null)}},J=b=>{if(b.calculations.length===0){fe.error("No calculations found for this scheme");return}const R=["Scheme Name,Calculation Date,Distributor ID,Distributor Name,Product,Article ID,Quantity,Value,Commission,Scheme Type",...b.calculations.flatMap(Q=>Q.calculations||[]).map(Q=>`${b.name},${b.lastCalculated||""},${Q.distributorId||""},${Q.distributorName||""},${Q.product||""},${Q.articleId||""},${Q.quantity||0},${Q.value||0},${Q.commission||0},${Q.schemeType||""}`)].join(`
`),W=new Blob([R],{type:"text/csv"}),q=window.URL.createObjectURL(W),H=document.createElement("a");H.href=q,H.download=`scheme_${b.name.replace(/\s+/g,"_")}_calculations.csv`,H.click(),window.URL.revokeObjectURL(q)},Z=b=>{const D=new Date,R=new Date(b.startDate),W=new Date(b.endDate);return D<R?{status:"upcoming",label:"Upcoming",color:"bg-blue-100 text-blue-800"}:D>W?{status:"expired",label:"Expired",color:"bg-gray-100 text-gray-800"}:{status:"active",label:"Active",color:"bg-green-100 text-green-800"}},re=b=>{const D=[];if(b.distIds?.type==="other"&&b.distIds?.specificIds?.length>0)D.push(`Specific Distributors: ${b.distIds.specificIds.length} IDs`);else{const R=b.distributorData||b.basicInfo||{},W=Q=>Q!=null&&Q!==""&&Q.toString().trim()!=="";W(R.zone)&&D.push(`Zone: ${R.zone}`);const q=R.state||R.stateData||R.stateName;W(q)&&D.push(`State: ${q}`);const H=R.distributorType||R.partnerType||R.type||R.distributorTypeData||R.partnerTypeData;W(H)&&D.push(`Type: ${H}`),R.allDistributors===!0&&D.push("Selection: All Distributors")}return b.articles?.type==="other"&&b.articles?.specificIds?.length>0?D.push(`Specific Articles: ${b.articles.specificIds.length} IDs`):(b.catalogType?.family&&D.push(`Family: ${b.catalogType.family}`),b.catalogType?.class&&D.push(`Class: ${b.catalogType.class}`),b.catalogType?.brand&&D.push(`Brand: ${b.catalogType.brand}`)),D.length>0?D.join("  "):"All criteria"},te=(b,D,R)=>{if(b.from!==void 0&&b.to!==void 0){const W=Number(b.from)||0,q=Number(b.to)||0;return`${W} to ${q}`}if(b.minQuantity!==void 0&&b.maxQuantity!==void 0){const W=Number(b.minQuantity)||0,q=Number(b.maxQuantity)||0;return`${W} to ${q}`}if(b.min!==void 0&&b.max!==void 0){const W=Number(b.min)||0,q=b.max===null?"":Number(b.max)||0;return q===""?`${W}+`:`${W} to ${q}`}if(b.quantity!==void 0){const W=Number(b.quantity)||0;return D===0?`0 to ${W}`:D===R-1?`${W}+`:`${W}+`}return"Range not specified"},z=(b,D)=>b.rate!==void 0?D==="percentage"?`${b.rate}%`:D==="fixed"?`${b.rate.toLocaleString()}`:D==="absolute_per_unit"||D==="absolute(per unit)"?`${b.rate}/unit`:`${b.rate}`:b.commission!==void 0?D==="percentage"?`${b.commission}%`:D==="fixed"?`${b.commission.toLocaleString()}`:D==="absolute_per_unit"||D==="absolute(per unit)"?`${b.commission}/unit`:`${b.commission}`:"Not specified",K=b=>{const D=[];b.distIds?.type==="other"&&b.distIds?.specificIds?.length>0&&D.push({title:"Specific Distributors",ids:b.distIds.specificIds,count:b.distIds.specificIds.length});const R=[],W=b.distributorData||b.basicInfo||{};console.log("Distributor data debug:",{schemeName:b.name,distributorData:W,basicInfo:b.basicInfo,rawScheme:b});const q=ee=>ee!=null&&ee!==""&&ee.toString().trim()!=="";q(W.zone)&&R.push(`Zone: ${W.zone}`);const H=W.state||W.stateData||W.stateName;q(H)&&R.push(`State: ${H}`);const Q=W.distributorType||W.partnerType||W.type||W.distributorTypeData||W.partnerTypeData;return q(Q)&&R.push(`Type: ${Q}`),W.allDistributors===!0&&R.push("Selection: All Distributors"),R.length>0?D.push({title:"Distributor Criteria",criteria:R.join("  "),count:"All matching"}):console.warn("No distributor criteria found for scheme:",b.name,{distributorData:W,availableKeys:Object.keys(W)}),D.length>0?D:[{title:"All Distributors",count:"No restrictions"}]},se=b=>{const D=[];if(b.articles?.type==="other"&&b.articles?.specificIds?.length>0&&D.push({title:"Specific Articles (Excel Upload)",ids:b.articles.specificIds,count:b.articles.specificIds.length}),b.articles?.articleCommissions&&Array.isArray(b.articles.articleCommissions)&&b.articles.articleCommissions.length>0){const W=b.articles.articleCommissions.map(q=>q.articleId||q.Article_ID).filter(Boolean);D.push({title:"Article Commission Data",ids:W,count:W.length})}const R=[];return b.catalogType?.family&&R.push(`Family: ${b.catalogType.family}`),b.catalogType?.class&&R.push(`Class: ${b.catalogType.class}`),b.catalogType?.brand&&R.push(`Brand: ${b.catalogType.brand}`),R.length>0&&D.push({title:"Catalog Criteria",criteria:R.join("  "),count:"All matching"}),D.length>0?D:[{title:"All Articles",count:"No restrictions"}]},P=b=>{console.log("=== Scheme Data Debug ===",{schemeName:b.name,schemeId:b.id,topLevelKeys:Object.keys(b),distributorData:{exists:!!b.distributorData,keys:b.distributorData?Object.keys(b.distributorData):[],values:b.distributorData},basicInfo:{exists:!!b.basicInfo,keys:b.basicInfo?Object.keys(b.basicInfo):[],values:b.basicInfo},distIds:b.distIds,catalogType:b.catalogType})};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold",children:"Scheme Management"}),l.jsx("p",{className:"text-gray-600",children:"Manage your schemes and view calculation outputs"})]}),l.jsx("div",{className:"flex items-center space-x-2",children:l.jsxs(be,{onClick:A,disabled:f,variant:"outline",children:[l.jsx(dr,{className:`h-4 w-4 mr-2 ${f?"animate-spin":""}`}),"Refresh Data"]})})]}),k.some(b=>b.includes("timeout")||b.includes("AbortError"))&&l.jsxs(At,{className:"border-amber-200 bg-amber-50 mb-4",children:[l.jsx(aa,{className:"h-4 w-4 text-amber-600"}),l.jsx(jt,{className:"text-amber-800",children:l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"font-medium",children:"Performance Notice: Database Timeout Detected"}),l.jsxs("div",{className:"text-sm",children:["The system is experiencing longer response times due to large datasets. This may affect:",l.jsxs("ul",{className:"mt-1 ml-4 space-y-1",children:[l.jsx("li",{children:" Loading calculation results"}),l.jsx("li",{children:" Running new calculations"}),l.jsx("li",{children:" Fetching scheme data"})]})]}),l.jsxs("div",{className:"text-sm",children:[l.jsx("strong",{children:"Recommendations:"}),l.jsxs("ul",{className:"mt-1 ml-4 space-y-1",children:[l.jsx("li",{children:" Try refreshing the page after a few moments"}),l.jsx("li",{children:" For new calculations, consider using smaller datasets"}),l.jsx("li",{children:" The system will automatically retry failed operations"})]})]})]})})]}),(k.length>0||Object.keys(v).length>0)&&l.jsxs(Ae,{className:"border-orange-200 bg-orange-50",children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2 text-orange-800",children:[l.jsx(dx,{className:"h-5 w-5"}),l.jsx("span",{children:"System Information"})]})}),l.jsxs(je,{className:"space-y-2",children:[k.length>0&&l.jsxs(At,{className:"border-red-200 bg-red-50",children:[l.jsx(aa,{className:"h-4 w-4"}),l.jsxs(jt,{className:"text-red-800",children:[l.jsx("strong",{children:"Connection Issues:"}),l.jsx("ul",{className:"mt-1 space-y-1",children:k.map((b,D)=>l.jsxs("li",{className:"text-sm",children:[" ",b.includes("timeout")?"Database timeout - operations taking longer than expected":b]},D))})]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-xs",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Last Fetch:"}),l.jsx("br",{}),w?new Date(w).toLocaleTimeString():"Never"]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Schemes Found:"}),l.jsx("br",{}),r.length]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Sales Data Uploads:"}),l.jsx("br",{}),s.length]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Auth Token:"}),l.jsx("br",{}),v.authToken||"Missing"]})]}),l.jsx("div",{className:"mt-4 p-3 bg-yellow-50 rounded-md border border-yellow-200",children:l.jsxs("div",{className:"text-xs space-y-1",children:[l.jsx("div",{children:l.jsx("strong",{children:"Commission Debug:"})}),l.jsxs("div",{children:["Total schemes with calculations: ",c.filter(b=>b.calculations.length>0).length]}),l.jsxs("div",{children:["Individual scheme commissions: ",c.map(b=>`${b.name}: ${b.totalCommission?.toLocaleString()||0}`).join(", ")]}),l.jsxs("div",{children:["Overall total: ",c.reduce((b,D)=>b+(D.totalCommission||0),0).toLocaleString()]})]})})]})]}),s.length===0&&l.jsxs(At,{className:"border-blue-200 bg-blue-50",children:[l.jsx(Fs,{className:"h-4 w-4 text-blue-600"}),l.jsxs(jt,{className:"text-blue-800",children:[l.jsx("strong",{children:"No Sales Data Available:"}),' You need to upload sales data before you can run calculations. Please go to the "Upload Data" tab to upload your sales data first.']})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(nl,{className:"h-5 w-5 text-blue-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Total Schemes"}),l.jsx("p",{className:"text-2xl font-bold",children:r.length})]})]})})}),l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ZF,{className:"h-5 w-5 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Active Schemes"}),l.jsx("p",{className:"text-2xl font-bold",children:c.filter(b=>Z(b).status==="active").length})]})]})})}),l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ts,{className:"h-5 w-5 text-purple-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Total Calculations"}),l.jsx("p",{className:"text-2xl font-bold",children:i.length})]})]})})}),l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(WS,{className:"h-5 w-5 text-orange-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Total Commission"}),l.jsxs("p",{className:"text-2xl font-bold",children:["",c.reduce((b,D)=>b+(D.totalCommission||0),0).toLocaleString()]})]})]})})})]}),s.length>0&&l.jsxs(Ae,{className:"border-green-200 bg-green-50",children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2 text-green-800",children:[l.jsx(Fo,{className:"h-5 w-5"}),l.jsx("span",{children:"Available Sales Data"})]})}),l.jsx(je,{children:l.jsxs("div",{className:"text-sm text-green-700",children:[l.jsxs("p",{className:"mb-2",children:[l.jsx("strong",{children:"Ready for calculation:"})," ",s.length," sales data upload(s) available"]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:s.map(b=>l.jsxs("div",{className:"bg-white rounded-md p-3 border border-green-200",children:[l.jsxs("div",{className:"font-medium",children:[b.month," ",b.year]}),l.jsxs("div",{className:"text-xs text-gray-600",children:[b.data?.length||0," records"]}),l.jsxs("div",{className:"text-xs text-gray-500",children:["Uploaded: ",new Date(b.uploadedAt).toLocaleDateString()]})]},b.id))})]})})]}),f&&r.length===0?l.jsx(Ae,{children:l.jsxs(je,{className:"p-8 text-center",children:[l.jsx(dr,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),l.jsx("p",{children:"Loading schemes..."})]})}):r.length===0?l.jsx(Ae,{children:l.jsxs(je,{className:"p-8 text-center",children:[l.jsx(nl,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"No schemes found. Create your first scheme to get started."})]})}):l.jsx("div",{className:"space-y-4",children:c.map(b=>{const D=Z(b),R=h.has(b.id),W=K(b),q=se(b);return l.jsxs(Ae,{className:`${R?"ring-2 ring-blue-200":""}`,children:[l.jsx(st,{className:"pb-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"flex items-center space-x-3",children:l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("h3",{className:"text-lg font-semibold",children:b.name}),l.jsx(pt,{className:D.color,children:D.label}),l.jsx(pt,{variant:"outline",className:"capitalize",children:b.type})]}),l.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-500",children:[l.jsxs("span",{children:["ID: ",b.id]}),l.jsx("span",{children:""}),l.jsx("span",{children:re(b)})]})]})}),l.jsxs("div",{className:"flex items-center space-x-2",children:[b.totalCommission>0&&l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"text-lg font-bold text-green-600",children:["",b.totalCommission.toLocaleString()]}),l.jsx("div",{className:"text-xs text-gray-500",children:"Total Commission"})]}),l.jsx(be,{variant:"ghost",size:"sm",onClick:()=>X(b.id),children:R?l.jsx(MS,{className:"h-4 w-4"}):l.jsx(px,{className:"h-4 w-4"})})]})]})}),l.jsx(ZW,{open:R,onOpenChange:()=>X(b.id),children:l.jsx(eV,{children:l.jsx(je,{className:"pt-0",children:l.jsxs(Hi,{defaultValue:"details",className:"w-full",children:[l.jsxs(Gi,{className:"grid w-full grid-cols-4",children:[l.jsx(kt,{value:"details",children:"Details"}),l.jsx(kt,{value:"distributors",children:"Distributors"}),l.jsx(kt,{value:"articles",children:"Articles"}),l.jsx(kt,{value:"calculations",children:"Calculations"})]}),l.jsxs(bt,{value:"details",className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Start Date"}),l.jsx("p",{children:new Date(b.startDate).toLocaleDateString()})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500",children:"End Date"}),l.jsx("p",{children:new Date(b.endDate).toLocaleDateString()})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Slab Type"}),l.jsx("p",{className:"capitalize",children:b.slabType})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Commission Type"}),l.jsx("p",{className:"capitalize",children:b.commissionType})]})]}),b.slabs&&b.slabs.length>0&&l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium mb-3",children:"Commission Slabs"}),l.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:l.jsxs(Bc,{children:[l.jsx(Uc,{children:l.jsxs(is,{children:[l.jsx(dt,{children:"Range"}),l.jsx(dt,{children:"Commission"})]})}),l.jsx($c,{children:b.slabs.map((H,Q)=>l.jsxs(is,{children:[l.jsx(ut,{children:te(H,Q,b.slabs.length)}),l.jsx(ut,{children:z(H,b.commissionType)})]},Q))})]})})]}),l.jsxs("div",{className:"flex items-center space-x-2 pt-4",children:[l.jsxs(Xt,{value:x[b.id]||"all-sales-data",onValueChange:H=>m(Q=>({...Q,[b.id]:H})),children:[l.jsx(qt,{className:"w-48",children:l.jsx(Kt,{placeholder:"Select sales data"})}),l.jsxs(Yt,{children:[l.jsx(Je,{value:"all-sales-data",children:"All Sales Data"}),s.map(H=>l.jsxs(Je,{value:H.id,children:[H.month," ",H.year," (",H.data?.length||0," records)"]},H.id))]})]}),l.jsxs(be,{onClick:()=>le(b.id,x[b.id]),disabled:S===b.id||s.length===0,children:[S===b.id?l.jsx(dr,{className:"h-4 w-4 mr-2 animate-spin"}):l.jsx(US,{className:"h-4 w-4 mr-2"}),"Calculate"]}),b.calculations.length>0&&l.jsxs(be,{variant:"outline",onClick:()=>J(b),children:[l.jsx(La,{className:"h-4 w-4 mr-2"}),"Export Results"]})]})]}),l.jsx(bt,{value:"distributors",className:"space-y-4",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx(Ma,{className:"h-5 w-5 text-blue-600"}),l.jsx("h4",{className:"font-medium",children:"Distributor Configuration"})]}),W.map((H,Q)=>l.jsx(Ae,{className:"bg-gray-50",children:l.jsxs(je,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h5",{className:"font-medium text-gray-800",children:H.title}),l.jsx(pt,{variant:"secondary",children:typeof H.count=="string"?H.count:`${H.count} IDs`})]}),H.criteria&&l.jsx("p",{className:"text-sm text-gray-600 mb-3",children:H.criteria}),H.ids&&H.ids.length>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Distributor IDs:"}),l.jsx("div",{className:"bg-white rounded border p-3 max-h-32 overflow-y-auto",children:l.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-2",children:[H.ids.slice(0,24).map((ee,G)=>l.jsx(pt,{variant:"outline",className:"text-xs",children:ee},G)),H.ids.length>24&&l.jsxs(pt,{variant:"secondary",className:"text-xs",children:["+",H.ids.length-24," more"]})]})})]})]})},Q))]})}),l.jsx(bt,{value:"articles",className:"space-y-4",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx(FF,{className:"h-5 w-5 text-green-600"}),l.jsx("h4",{className:"font-medium",children:"Article Configuration"})]}),q.map((H,Q)=>l.jsx(Ae,{className:"bg-gray-50",children:l.jsxs(je,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h5",{className:"font-medium text-gray-800",children:H.title}),l.jsx(pt,{variant:"secondary",children:typeof H.count=="string"?H.count:`${H.count} Articles`})]}),H.criteria&&l.jsx("p",{className:"text-sm text-gray-600 mb-3",children:H.criteria}),H.ids&&H.ids.length>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Article IDs:"}),l.jsx("div",{className:"bg-white rounded border p-3 max-h-32 overflow-y-auto",children:l.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-5 gap-2",children:[H.ids.slice(0,20).map((ee,G)=>l.jsx(pt,{variant:"outline",className:"text-xs",children:ee},G)),H.ids.length>20&&l.jsxs(pt,{variant:"secondary",className:"text-xs",children:["+",H.ids.length-20," more"]})]})})]})]})},Q))]})}),l.jsxs(bt,{value:"calculations",className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h4",{className:"font-medium",children:"Calculation Results"}),b.calculations.length>0&&l.jsxs(pt,{variant:"secondary",children:[b.calculations.length," calculation(s)"]})]}),b.calculations.length===0?l.jsxs("div",{className:"text-center py-8 text-gray-500",children:[l.jsx(Ts,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),l.jsx("p",{children:"No calculations performed yet"}),l.jsx("p",{className:"text-sm",children:"Run a calculation to see results here"})]}):l.jsx("div",{className:"space-y-4",children:b.calculations.map(H=>l.jsx(Ae,{className:"bg-gray-50",children:l.jsxs(je,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium",children:"Calculation ID:"}),l.jsx("code",{className:"text-xs bg-white px-2 py-1 rounded",children:H.id})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"font-medium text-green-600",children:["",H.totalCommission.toLocaleString()]}),l.jsxs("div",{className:"text-xs text-gray-500",children:[H.calculations?.length||0," records"]})]})]}),l.jsxs("div",{className:"text-xs text-gray-500",children:["Calculated: ",new Date(H.calculatedAt).toLocaleString()]})]})},H.id))})]})]})})})})]},b.id)})})]})});dT.displayName="ManageSchemes";var f0="Switch",[tV,LV]=oa(f0),[rV,nV]=tV(f0),hT=T.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:s,defaultChecked:a,required:i,disabled:o,value:c="on",onCheckedChange:u,form:f,...d}=e,[h,p]=T.useState(null),x=Ct(t,y=>p(y)),m=T.useRef(!1),v=h?f||!!h.closest("form"):!0,[g,w]=Ai({prop:s,defaultProp:a??!1,onChange:u,caller:f0});return l.jsxs(rV,{scope:r,checked:g,disabled:o,children:[l.jsx(Ze.button,{type:"button",role:"switch","aria-checked":g,"aria-required":i,"data-state":gT(g),"data-disabled":o?"":void 0,disabled:o,value:c,...d,ref:x,onClick:nt(e.onClick,y=>{w(k=>!k),v&&(m.current=y.isPropagationStopped(),m.current||y.stopPropagation())})}),v&&l.jsx(xT,{control:h,bubbles:!m.current,name:n,value:c,checked:g,required:i,disabled:o,form:f,style:{transform:"translateX(-100%)"}})]})});hT.displayName=f0;var pT="SwitchThumb",mT=T.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,s=nV(pT,r);return l.jsx(Ze.span,{"data-state":gT(s.checked),"data-disabled":s.disabled?"":void 0,...n,ref:t})});mT.displayName=pT;var sV="SwitchBubbleInput",xT=T.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:n=!0,...s},a)=>{const i=T.useRef(null),o=Ct(i,a),c=eS(r),u=W_(t);return T.useEffect(()=>{const f=i.current;if(!f)return;const d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"checked").set;if(c!==r&&p){const x=new Event("click",{bubbles:n});p.call(f,r),f.dispatchEvent(x)}},[c,r,n]),l.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:o,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});xT.displayName=sV;function gT(e){return e?"checked":"unchecked"}var aV=hT,iV=mT;function Nf({className:e,...t}){return l.jsx(aV,{"data-slot":"switch",className:tt("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-switch-background focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:l.jsx(iV,{"data-slot":"switch-thumb",className:tt("bg-card dark:data-[state=unchecked]:bg-card-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var oV="Separator",Ly="horizontal",lV=["horizontal","vertical"],vT=T.forwardRef((e,t)=>{const{decorative:r,orientation:n=Ly,...s}=e,a=cV(n)?n:Ly,o=r?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return l.jsx(Ze.div,{"data-orientation":a,...o,...s,ref:t})});vT.displayName=oV;function cV(e){return lV.includes(e)}var uV=vT;function ki({className:e,orientation:t="horizontal",decorative:r=!0,...n}){return l.jsx(uV,{"data-slot":"separator-root",decorative:r,orientation:t,className:tt("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...n})}const fV=[{id:"article-scheme",name:"article-scheme",label:"Article Scheme",description:"Schemes focused on specific article management through Excel upload",enabled:!0,fields:[{id:"scheme-name",name:"schemeName",label:"Scheme Name",type:"text",required:!0,validation:{minLength:3,maxLength:100},description:"Unique name for the scheme",group:"basic"},{id:"description",name:"description",label:"Description",type:"textarea",required:!1,validation:{maxLength:500},description:"Optional description for the scheme",group:"basic"},{id:"commission-type",name:"commissionType",label:"Commission Type",type:"select",required:!0,options:["Fixed","Absolute (per unit)","Percentage"],description:"Type of commission calculation",group:"commission"}],workflow:["Basic Info","Distributor Criteria","Article Scheme Definition"],commissionTypes:["Fixed","Absolute (per unit)","Percentage"],slabSupported:!1,excelRequired:!0},{id:"booster-scheme",name:"booster-scheme",label:"Booster Scheme",description:"Schemes using hierarchical dropdown filtering with slab-based calculations",enabled:!0,fields:[{id:"scheme-name",name:"schemeName",label:"Scheme Name",type:"text",required:!0,validation:{minLength:3,maxLength:100},description:"Unique name for the scheme",group:"basic"},{id:"description",name:"description",label:"Description",type:"textarea",required:!1,validation:{maxLength:500},description:"Optional description for the scheme",group:"basic"},{id:"commission-type",name:"commissionType",label:"Commission Type",type:"select",required:!0,options:["Fixed","Percentage","Absolute Per Unit"],description:"Type of commission calculation",group:"commission"},{id:"slab-type",name:"slabType",label:"Slab Type",type:"select",required:!0,options:["Quantity","Value"],description:"Type of slab calculation",group:"slab"}],workflow:["Basic Info","Distributor Criteria","Catalog Criteria","Slab Configuration"],commissionTypes:["Fixed","Percentage","Absolute Per Unit"],slabSupported:!0,excelRequired:!1}],dV=[{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"select",label:"Select Dropdown"},{value:"multiselect",label:"Multi-Select"},{value:"boolean",label:"Boolean (Switch)"},{value:"textarea",label:"Text Area"},{value:"file",label:"File Upload"}];function hV(){const[e,t]=T.useState(fV),[r,n]=T.useState(null),[s,a]=T.useState(null),[i,o]=T.useState(!1),[c,u]=T.useState(!1),[f,d]=T.useState(!1);T.useEffect(()=>{h()},[]);const h=async()=>{u(!0);try{const S=await fetch(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/moderation/config`,{method:"GET",headers:{Authorization:`Bearer ${Fr}`,"Content-Type":"application/json"}});if(S.ok){const _=await S.json();_.schemeTypes&&_.schemeTypes.length>0&&t(_.schemeTypes),fe.success("Configuration loaded successfully")}else console.log("No existing configuration found, using defaults")}catch(S){console.error("Error loading configuration:",S),fe.error("Failed to load configuration")}finally{u(!1)}},p=async()=>{d(!0);try{if((await fetch(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/moderation/config`,{method:"POST",headers:{Authorization:`Bearer ${Fr}`,"Content-Type":"application/json"},body:JSON.stringify({schemeTypes:e})})).ok)fe.success("Configuration saved successfully");else throw new Error("Failed to save configuration")}catch(S){console.error("Error saving configuration:",S),fe.error("Failed to save configuration")}finally{d(!1)}},x=()=>{const S={id:`custom-scheme-${Date.now()}`,name:`custom-scheme-${Date.now()}`,label:"New Scheme Type",description:"Custom scheme type",enabled:!0,fields:[],workflow:["Basic Info"],commissionTypes:["Fixed"],slabSupported:!1,excelRequired:!1};t([...e,S]),n(S.id)},m=(S,_)=>{t(A=>A.map(F=>F.id===S?{...F,..._}:F))},v=S=>{t(_=>_.filter(A=>A.id!==S)),r===S&&n(null)},g=(S,_)=>{m(S,{fields:[...e.find(A=>A.id===S)?.fields||[],_]}),o(!1),a(null)},w=(S,_,A)=>{const F=e.find(U=>U.id===S);if(F){const U=F.fields.map(V=>V.id===_?{...V,...A}:V);m(S,{fields:U})}a(null)},y=(S,_)=>{const A=e.find(F=>F.id===S);if(A){const F=A.fields.filter(U=>U.id!==_);m(S,{fields:F})}},k=S=>{const _=e.find(A=>A.id===S);if(_){const A={..._,id:`${_.id}-copy-${Date.now()}`,name:`${_.name}-copy`,label:`${_.label} (Copy)`};t([...e,A])}},E=e.find(S=>S.id===r);return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Moderation Panel"}),l.jsx("p",{className:"text-gray-600",children:"Configure scheme types and their associated fields"})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs(be,{onClick:p,disabled:f,children:[l.jsx($S,{className:"h-4 w-4 mr-2"}),f?"Saving...":"Save Configuration"]}),l.jsxs(be,{variant:"outline",onClick:h,disabled:c,children:[l.jsx(Ri,{className:"h-4 w-4 mr-2"}),c?"Loading...":"Reload"]})]})]}),l.jsxs(Hi,{defaultValue:"scheme-types",className:"space-y-6",children:[l.jsxs(Gi,{children:[l.jsx(kt,{value:"scheme-types",children:"Scheme Types"}),l.jsx(kt,{value:"field-management",children:"Field Management"}),l.jsx(kt,{value:"export-import",children:"Export/Import"})]}),l.jsx(bt,{value:"scheme-types",className:"space-y-6",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsx("div",{className:"lg:col-span-1",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(wF,{className:"h-5 w-5"}),l.jsx("span",{children:"Scheme Types"})]}),l.jsx(be,{size:"sm",onClick:x,children:l.jsx(Oc,{className:"h-4 w-4"})})]})}),l.jsx(je,{className:"space-y-2",children:e.map(S=>l.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${r===S.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,onClick:()=>n(S.id),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-medium",children:S.label}),!S.enabled&&l.jsx(pt,{variant:"secondary",children:"Disabled"})]}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:S.description})]}),l.jsxs("div",{className:"flex space-x-1",children:[l.jsx(be,{size:"sm",variant:"ghost",onClick:_=>{_.stopPropagation(),k(S.id)},children:l.jsx(Cf,{className:"h-3 w-3"})}),l.jsx(be,{size:"sm",variant:"ghost",onClick:_=>{_.stopPropagation(),v(S.id)},children:l.jsx(uu,{className:"h-3 w-3"})})]})]})},S.id))})]})}),l.jsx("div",{className:"lg:col-span-2",children:E?l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{children:["Configure: ",E.label]})}),l.jsxs(je,{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Basic Settings"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"type-name",children:"Type Name"}),l.jsx(Et,{id:"type-name",value:E.name,onChange:S=>m(E.id,{name:S.target.value})})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"type-label",children:"Display Label"}),l.jsx(Et,{id:"type-label",value:E.label,onChange:S=>m(E.id,{label:S.target.value})})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"type-description",children:"Description"}),l.jsx(Lc,{id:"type-description",value:E.description,onChange:S=>m(E.id,{description:S.target.value})})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Nf,{checked:E.enabled,onCheckedChange:S=>m(E.id,{enabled:S})}),l.jsx(Me,{children:"Enabled"})]})]}),l.jsx(ki,{}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Advanced Settings"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Nf,{checked:E.slabSupported,onCheckedChange:S=>m(E.id,{slabSupported:S})}),l.jsx(Me,{children:"Slab Support"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Nf,{checked:E.excelRequired,onCheckedChange:S=>m(E.id,{excelRequired:S})}),l.jsx(Me,{children:"Excel Required"})]})]})]}),l.jsx(ki,{}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Commission Types"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:E.commissionTypes.map((S,_)=>l.jsx(pt,{variant:"outline",children:S},_))})]}),l.jsx(ki,{}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Workflow Steps"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:E.workflow.map((S,_)=>l.jsx(pt,{children:S},_))})]})]})]}):l.jsx(Ae,{children:l.jsx(je,{className:"flex items-center justify-center h-64",children:l.jsxs("div",{className:"text-center",children:[l.jsx(GF,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Select a scheme type to configure"})]})})})})]})}),l.jsx(bt,{value:"field-management",className:"space-y-6",children:E?l.jsx(pV,{schemeType:E,onAddField:S=>g(E.id,S),onUpdateField:(S,_)=>w(E.id,S,_),onDeleteField:S=>y(E.id,S),editingField:s,setEditingField:a,isAddingField:i,setIsAddingField:o}):l.jsxs(At,{children:[l.jsx(aa,{className:"h-4 w-4"}),l.jsx(jt,{children:"Please select a scheme type from the Scheme Types tab to manage its fields."})]})}),l.jsx(bt,{value:"export-import",className:"space-y-6",children:l.jsx(xV,{schemeTypes:e,onImport:t})})]})]})}function pV({schemeType:e,onAddField:t,onUpdateField:r,onDeleteField:n,editingField:s,setEditingField:a,isAddingField:i,setIsAddingField:o}){return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("h3",{className:"text-xl font-semibold",children:["Fields for ",e.label]}),l.jsxs(be,{onClick:()=>o(!0),children:[l.jsx(Oc,{className:"h-4 w-4 mr-2"}),"Add Field"]})]}),l.jsx("div",{className:"space-y-4",children:e.fields.map(c=>l.jsx(Ae,{children:l.jsx(je,{className:"p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-medium",children:c.label}),l.jsx(pt,{variant:"outline",children:c.type}),c.required&&l.jsx(pt,{variant:"destructive",children:"Required"}),c.group&&l.jsx(pt,{variant:"secondary",children:c.group})]}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:c.description}),l.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Name: ",c.name]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx(be,{size:"sm",variant:"ghost",onClick:()=>a(c),children:l.jsx(PF,{className:"h-4 w-4"})}),l.jsx(be,{size:"sm",variant:"ghost",onClick:()=>n(c.id),children:l.jsx(uu,{className:"h-4 w-4"})})]})]})})},c.id))}),(i||s)&&l.jsx(mV,{field:s,onSave:c=>{s?r(s.id,c):t({...c,id:`field-${Date.now()}`})},onCancel:()=>{o(!1),a(null)}})]})}function mV({field:e,onSave:t,onCancel:r}){const[n,s]=T.useState(e||{name:"",label:"",type:"text",required:!1,description:"",group:"basic"}),a=()=>{if(!n.name||!n.label){fe.error("Name and label are required");return}t(n)};return l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsx(lt,{children:e?"Edit Field":"Add New Field"})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"field-name",children:"Field Name"}),l.jsx(Et,{id:"field-name",value:n.name||"",onChange:i=>s({...n,name:i.target.value}),placeholder:"fieldName"})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"field-label",children:"Display Label"}),l.jsx(Et,{id:"field-label",value:n.label||"",onChange:i=>s({...n,label:i.target.value}),placeholder:"Field Label"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"field-type",children:"Field Type"}),l.jsxs(Xt,{value:n.type||"text",onValueChange:i=>s({...n,type:i}),children:[l.jsx(qt,{children:l.jsx(Kt,{})}),l.jsx(Yt,{children:dV.map(i=>l.jsx(Je,{value:i.value,children:i.label},i.value))})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"field-group",children:"Group"}),l.jsx(Et,{id:"field-group",value:n.group||"",onChange:i=>s({...n,group:i.target.value}),placeholder:"basic"})]})]}),l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"field-description",children:"Description"}),l.jsx(Lc,{id:"field-description",value:n.description||"",onChange:i=>s({...n,description:i.target.value}),placeholder:"Field description"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Nf,{checked:n.required||!1,onCheckedChange:i=>s({...n,required:i})}),l.jsx(Me,{children:"Required Field"})]}),(n.type==="select"||n.type==="multiselect")&&l.jsxs("div",{children:[l.jsx(Me,{htmlFor:"field-options",children:"Options (one per line)"}),l.jsx(Lc,{id:"field-options",value:n.options?.join(`
`)||"",onChange:i=>s({...n,options:i.target.value.split(`
`).filter(o=>o.trim())}),placeholder:`Option 1
Option 2
Option 3`})]}),l.jsxs("div",{className:"flex justify-end space-x-2",children:[l.jsxs(be,{variant:"outline",onClick:r,children:[l.jsx(sd,{className:"h-4 w-4 mr-2"}),"Cancel"]}),l.jsxs(be,{onClick:a,children:[l.jsx($S,{className:"h-4 w-4 mr-2"}),"Save Field"]})]})]})]})}function xV({schemeTypes:e,onImport:t}){const r=()=>{const s=JSON.stringify(e,null,2),a=new Blob([s],{type:"application/json"}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download="scheme-configuration.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),fe.success("Configuration exported successfully")},n=s=>{const a=s.target.files?.[0];if(!a)return;const i=new FileReader;i.onload=o=>{try{const c=JSON.parse(o.target?.result);t(c),fe.success("Configuration imported successfully")}catch{fe.error("Invalid configuration file")}},i.readAsText(a)};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsx(lt,{children:"Export Configuration"})}),l.jsxs(je,{children:[l.jsx("p",{className:"text-gray-600 mb-4",children:"Export your current scheme configuration as a JSON file for backup or sharing."}),l.jsxs(be,{onClick:r,children:[l.jsx(Ri,{className:"h-4 w-4 mr-2"}),"Export Configuration"]})]})]}),l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsx(lt,{children:"Import Configuration"})}),l.jsxs(je,{children:[l.jsx("p",{className:"text-gray-600 mb-4",children:"Import a previously exported configuration file. This will replace your current configuration."}),l.jsx(Et,{type:"file",accept:".json",onChange:n})]})]}),l.jsxs(At,{children:[l.jsx(aa,{className:"h-4 w-4"}),l.jsx(jt,{children:"Remember to save your configuration after importing to persist the changes."})]})]})}function gV(){const[e,t]=T.useState([]),[r,n]=T.useState(!1),[s,a]=T.useState("test@example.com"),[i,o]=T.useState("password123"),c=(p,x,m)=>{t(v=>[...v,{test:p,success:x,data:m,timestamp:new Date().toISOString()}])},u=async()=>{try{const p=await fetch(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/auth/health`,{headers:{Authorization:`Bearer ${Fr}`,"Content-Type":"application/json"}}),x=await p.json();c("Auth Health Check",p.ok,{status:p.status,result:x})}catch(p){c("Auth Health Check",!1,{error:p instanceof Error?p.message:"Unknown error"})}},f=async()=>{try{const p=await fetch(`https://${$e}.supabase.co/functions/v1/make-server-ce8ebc43/auth/signup`,{method:"POST",headers:{Authorization:`Bearer ${Fr}`,"Content-Type":"application/json"},body:JSON.stringify({email:`test_${Date.now()}@example.com`,password:"testpassword123",name:"Test User"})}),x=p.headers.get("content-type");let m;x&&x.includes("application/json")?m=await p.json():m=await p.text(),c("Server Signup Test",p.ok,{status:p.status,contentType:x,result:typeof m=="string"?m.substring(0,500):m})}catch(p){c("Server Signup Test",!1,{error:p instanceof Error?p.message:"Unknown error"})}},d=async()=>{try{const p=await at.signUpWithServerAutoConfirm(`test_${Date.now()}@example.com`,"testpassword123","Test User");c("AuthService Signup Test",!p.error,p)}catch(p){c("AuthService Signup Test",!1,{error:p instanceof Error?p.message:"Unknown error"})}},h=async()=>{n(!0),t([]),await u(),await new Promise(p=>setTimeout(p,1e3)),await f(),await new Promise(p=>setTimeout(p,1e3)),await d(),n(!1)};return l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsx(lt,{children:"Authentication Debug Tests"})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm mb-1",children:"Test Email"}),l.jsx(Et,{value:s,onChange:p=>a(p.target.value),placeholder:"test@example.com"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm mb-1",children:"Test Password"}),l.jsx(Et,{type:"password",value:i,onChange:p=>o(p.target.value),placeholder:"password123"})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx(be,{onClick:h,disabled:r,children:r?"Running Tests...":"Run All Tests"}),l.jsx(be,{variant:"outline",onClick:u,disabled:r,children:"Test Health"}),l.jsx(be,{variant:"outline",onClick:f,disabled:r,children:"Test Signup"})]}),l.jsxs("div",{className:"text-sm space-y-2",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Project ID:"})," ",$e]}),l.jsxs("div",{children:[l.jsx("strong",{children:"API Key:"})," ",Fr.substring(0,20),"..."]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Signup URL:"})," https://",$e,".supabase.co/functions/v1/make-server-ce8ebc43/auth/signup"]})]})]})]}),l.jsx("div",{className:"space-y-2",children:e.map((p,x)=>l.jsx(At,{className:p.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:l.jsx(jt,{children:l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("strong",{children:p.test}),l.jsx("span",{className:p.success?"text-green-600":"text-red-600",children:p.success?" SUCCESS":" FAILED"})]}),l.jsx("pre",{className:"text-xs overflow-auto bg-white p-2 rounded border",children:JSON.stringify(p.data,null,2)}),l.jsx("div",{className:"text-xs text-gray-500",children:p.timestamp})]})})},x))})]})}function vV(){const[e,t]=T.useState(!1),[r,n]=T.useState([]),s=async(i,o={})=>{const c=Date.now();try{console.log(`Testing endpoint: ${i}`);const u=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",...o.headers},...o}),f=Date.now()-c;let d;try{d=await u.json()}catch{d=await u.text()}return{endpoint:i,method:o.method||"GET",status:u.status,success:u.ok,responseTime:f,response:d}}catch(u){const f=Date.now()-c;return{endpoint:i,method:o.method||"GET",success:!1,responseTime:f,error:u instanceof Error?u.message:"Unknown error"}}},a=async()=>{t(!0),n([]);const i=xi,o=`${i}/health`,c=`${i}/test`;console.log("=== COMPREHENSIVE CONNECTION TEST ==="),console.log("Backend URL:",i),console.log("Project ID:",$e);const u=[];console.log("Test 1: Health endpoint (no auth)");const f=await s(o);u.push(f),console.log("Test 2: Test endpoint (no auth)");const d=await s(c);u.push(d),console.log("Test 3: Test endpoint (with anon key)");const h=await s(c,{headers:{Authorization:`Bearer ${Fr}`}});u.push(h),console.log("Test 4: Basic connectivity test");const p=await s(i.replace(/\/[^/]*$/,""));u.push(p),n(u),t(!1)};return l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(Ic,{className:"h-5 w-5"}),l.jsx("span",{children:"Connection Test Debug"})]})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"This tool tests various connection scenarios to help diagnose backend connectivity issues."}),l.jsxs("div",{className:"text-xs space-y-1",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Backend URL:"})," ",xi]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Project ID:"})," ",$e]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Anon Key Length:"})," ",Fr?.length||0," characters"]})]})]}),l.jsx(be,{onClick:a,disabled:e,className:"w-full",children:e?l.jsxs(l.Fragment,{children:[l.jsx(dr,{className:"h-4 w-4 mr-2 animate-spin"}),"Testing Connection..."]}):l.jsxs(l.Fragment,{children:[l.jsx(dr,{className:"h-4 w-4 mr-2"}),"Run Connection Test"]})}),r.length>0&&l.jsxs("div",{className:"space-y-3",children:[l.jsx("h4",{className:"font-medium",children:"Test Results:"}),r.map((i,o)=>l.jsx(At,{className:i.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[i.success?l.jsx(Vn,{className:"h-4 w-4 text-green-600"}):l.jsx(Ds,{className:"h-4 w-4 text-red-600"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("span",{className:"font-medium text-sm",children:[i.method," ",i.endpoint]}),i.status&&l.jsx(pt,{variant:i.success?"default":"destructive",children:i.status}),l.jsxs(pt,{variant:"outline",children:[i.responseTime,"ms"]})]}),i.error&&l.jsxs(jt,{className:"text-red-700 mt-1",children:["Error: ",i.error]}),i.response&&i.success&&l.jsxs("div",{className:"text-xs mt-1 text-gray-600",children:["Response: ",typeof i.response=="string"?i.response.substring(0,100)+(i.response.length>100?"...":""):JSON.stringify(i.response).substring(0,100)]})]})]})},o)),l.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[l.jsx("h5",{className:"font-medium text-blue-900",children:"Diagnosis:"}),l.jsx("div",{className:"text-sm text-blue-800 mt-1",children:(()=>{const i=r.find(u=>u.endpoint.includes("/health"))?.success,o=r.some(u=>u.endpoint.includes("/test")&&u.success),c=r.some(u=>u.success);return i?" Backend is healthy and accessible. Connection should work properly.":o?" Health endpoint failed but test endpoint works. This is normal for some configurations.":c?" Some connectivity detected but API endpoints may not be configured correctly.":" No successful connections. Backend may not be deployed or URL is incorrect."})()})]})]})]})]})}function yV(){const[e,t]=T.useState([]),[r,n]=T.useState({}),[s,a]=T.useState(!1),i=["/make-server-ce8ebc43/health","/make-server-ce8ebc43/test","/make-server-ce8ebc43/auth/health","/make-server-ce8ebc43/distributors","/make-server-ce8ebc43/schemes","/make-server-ce8ebc43/category-data","/make-server-ce8ebc43/moderation/config"];T.useEffect(()=>{o(),c()},[]);const o=()=>{const x={userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,url:window.location.href,origin:window.location.origin,timestamp:new Date().toISOString(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,projectId:$e,hasApiKey:!0,apiKeyPrefix:`${Fr.substring(0,20)}...`};n(x)},c=()=>{const x=i.map(m=>({endpoint:m,status:"pending"}));t(x)},u=async x=>{const m=Date.now(),v=`https://${$e}.supabase.co/functions/v1${x}`;try{console.log(`Testing endpoint: ${v}`);const g={"Content-Type":"application/json"};x.includes("/health")||(g.Authorization=`Bearer ${Fr}`);const w=fetch(v,{method:"GET",headers:g}),y=new Promise((S,_)=>{setTimeout(()=>_(new Error("Request timeout after 10 seconds")),1e4)}),k=await Promise.race([w,y]),E=Date.now()-m;if(k.ok){let S;try{S=await k.json()}catch{S=await k.text()}return{endpoint:x,status:"success",response:S,duration:E}}else{let S=k.statusText;try{S=await k.text()}catch{}return{endpoint:x,status:"error",error:`HTTP ${k.status}: ${S}`,duration:E}}}catch(g){const w=Date.now()-m;return{endpoint:x,status:"error",error:g instanceof Error?g.message:"Unknown error",duration:w}}},f=async()=>{a(!0);const x=[];for(const g of i){const w=await u(g);x.push(w),t(y=>y.map(k=>k.endpoint===g?w:k))}a(!1);const m=x.filter(g=>g.status==="success").length,v=x.filter(g=>g.status==="error").length;m===x.length?fe.success(`All ${m} endpoints are working correctly!`):m>0?fe.warning(`${m} endpoints working, ${v} failing`):fe.error(`All ${v} endpoints are failing - backend may not be deployed`)},d=x=>{navigator.clipboard.writeText(x),fe.success("Copied to clipboard")},h=()=>{const x=JSON.stringify(r,null,2);d(x)},p=()=>{const x=JSON.stringify(e,null,2);d(x)};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Debug Panel"}),l.jsx("p",{className:"text-gray-600",children:"Troubleshoot backend connectivity and system information"})]}),l.jsxs(be,{onClick:f,disabled:s,children:[l.jsx(dr,{className:`h-4 w-4 mr-2 ${s?"animate-spin":""}`}),s?"Testing...":"Test All Endpoints"]})]}),l.jsxs(Hi,{defaultValue:"connection-tests",className:"space-y-6",children:[l.jsxs(Gi,{children:[l.jsx(kt,{value:"connection-tests",children:"Connection Tests"}),l.jsx(kt,{value:"auth-tests",children:"Auth Tests"}),l.jsx(kt,{value:"system-info",children:"System Info"}),l.jsx(kt,{value:"deployment-guide",children:"Deployment Guide"}),l.jsx(kt,{value:"troubleshooting",children:"Troubleshooting"})]}),l.jsx(bt,{value:"auth-tests",className:"space-y-6",children:l.jsx(gV,{})}),l.jsxs(bt,{value:"connection-tests",className:"space-y-6",children:[l.jsx(vV,{}),l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(bF,{className:"h-5 w-5"}),l.jsx("span",{children:"Endpoint Connection Tests"})]}),l.jsxs(be,{variant:"outline",size:"sm",onClick:p,children:[l.jsx(Cf,{className:"h-4 w-4 mr-2"}),"Copy Results"]})]})}),l.jsx(je,{className:"space-y-4",children:e.map((x,m)=>l.jsxs("div",{className:"border rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs(pt,{variant:x.status==="success"?"default":x.status==="error"?"destructive":"secondary",children:[x.status==="success"&&l.jsx(sc,{className:"h-3 w-3 mr-1"}),x.status==="error"&&l.jsx(Ds,{className:"h-3 w-3 mr-1"}),x.status==="pending"&&l.jsx(oF,{className:"h-3 w-3 mr-1"}),x.status.toUpperCase()]}),l.jsx("code",{className:"text-sm bg-gray-100 px-2 py-1 rounded",children:x.endpoint}),x.duration&&l.jsxs("span",{className:"text-xs text-gray-500",children:["(",x.duration,"ms)"]})]}),l.jsx(be,{variant:"ghost",size:"sm",onClick:()=>d(`https://${$e}.supabase.co/functions/v1${x.endpoint}`),children:l.jsx(Cf,{className:"h-3 w-3"})})]}),x.error&&l.jsxs(At,{className:"mt-2",children:[l.jsx(Ds,{className:"h-4 w-4"}),l.jsxs(jt,{children:[l.jsx("strong",{children:"Error:"})," ",x.error]})]}),x.response&&l.jsx("div",{className:"mt-2",children:l.jsxs("details",{className:"bg-gray-50 rounded p-2",children:[l.jsx("summary",{className:"cursor-pointer text-sm font-medium",children:"Response Data"}),l.jsx("pre",{className:"mt-2 text-xs overflow-auto",children:JSON.stringify(x.response,null,2)})]})})]},m))})]})]}),l.jsx(bt,{value:"system-info",className:"space-y-6",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(Ic,{className:"h-5 w-5"}),l.jsx("span",{children:"System Information"})]}),l.jsxs(be,{variant:"outline",size:"sm",onClick:h,children:[l.jsx(Cf,{className:"h-4 w-4 mr-2"}),"Copy Info"]})]})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold mb-2",children:"Application Info"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Project ID:"})," ",r.projectId]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Has API Key:"})," ",r.hasApiKey?"Yes":"No"]}),l.jsxs("div",{children:[l.jsx("strong",{children:"API Key:"})," ",r.apiKeyPrefix]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Current URL:"})," ",r.url]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Origin:"})," ",r.origin]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold mb-2",children:"Browser Info"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Platform:"})," ",r.platform]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Language:"})," ",r.language]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Timezone:"})," ",r.timezone]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Online:"})," ",r.onLine?"Yes":"No"]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Cookies:"})," ",r.cookieEnabled?"Enabled":"Disabled"]})]})]})]}),l.jsx(ki,{}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold mb-2",children:"User Agent"}),l.jsx("code",{className:"text-xs bg-gray-100 p-2 rounded block break-all",children:r.userAgent})]})]})]})}),l.jsx(bt,{value:"deployment-guide",className:"space-y-6",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(VF,{className:"h-5 w-5"}),l.jsx("span",{children:"Supabase Edge Function Deployment"})]})}),l.jsxs(je,{className:"space-y-4",children:[l.jsxs(At,{children:[l.jsx(Ic,{className:"h-4 w-4"}),l.jsx(jt,{children:"If you're seeing connection errors, the Supabase Edge Function may not be deployed."})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold mb-2",children:"1. Install Supabase CLI"}),l.jsx("code",{className:"bg-gray-100 p-2 rounded block",children:"npm install -g supabase"})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold mb-2",children:"2. Login to Supabase"}),l.jsx("code",{className:"bg-gray-100 p-2 rounded block",children:"supabase login"})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold mb-2",children:"3. Link to your project"}),l.jsxs("code",{className:"bg-gray-100 p-2 rounded block",children:["supabase link --project-ref ",$e]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold mb-2",children:"4. Deploy the Edge Function"}),l.jsx("code",{className:"bg-gray-100 p-2 rounded block",children:"supabase functions deploy server"})]})]}),l.jsx("div",{className:"mt-4",children:l.jsx(be,{variant:"outline",asChild:!0,children:l.jsxs("a",{href:"https://supabase.com/docs/guides/functions/quickstart",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2",children:[l.jsx(J0,{className:"h-4 w-4"}),l.jsx("span",{children:"View Official Documentation"})]})})})]})]})}),l.jsx(bt,{value:"troubleshooting",className:"space-y-6",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(dx,{className:"h-5 w-5"}),l.jsx("span",{children:"Common Issues & Solutions"})]})}),l.jsxs(je,{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"border-l-4 border-red-500 pl-4",children:[l.jsx("h4",{className:"font-semibold text-red-700",children:"404 Not Found"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"The Edge Function is not deployed or the function name is incorrect."}),l.jsxs("ul",{className:"text-sm text-gray-600 mt-2 list-disc list-inside",children:[l.jsx("li",{children:"Deploy the Edge Function using the deployment guide above"}),l.jsx("li",{children:'Verify the function name matches "server"'}),l.jsx("li",{children:"Check the Supabase Dashboard Functions section"})]})]}),l.jsxs("div",{className:"border-l-4 border-yellow-500 pl-4",children:[l.jsx("h4",{className:"font-semibold text-yellow-700",children:"Connection Timeout"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"The function is deployed but taking too long to respond."}),l.jsxs("ul",{className:"text-sm text-gray-600 mt-2 list-disc list-inside",children:[l.jsx("li",{children:"The function might be cold starting (first request)"}),l.jsx("li",{children:"Check the function logs in Supabase Dashboard"}),l.jsx("li",{children:"Verify environment variables are set correctly"})]})]}),l.jsxs("div",{className:"border-l-4 border-orange-500 pl-4",children:[l.jsx("h4",{className:"font-semibold text-orange-700",children:"403 Forbidden"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Authentication or permission issues."}),l.jsxs("ul",{className:"text-sm text-gray-600 mt-2 list-disc list-inside",children:[l.jsx("li",{children:"Check if the API key is valid and not expired"}),l.jsx("li",{children:"Verify RLS policies allow function access"}),l.jsx("li",{children:"Ensure the function has proper CORS configuration"})]})]}),l.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[l.jsx("h4",{className:"font-semibold text-blue-700",children:"Network Error"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Unable to reach the Supabase servers."}),l.jsxs("ul",{className:"text-sm text-gray-600 mt-2 list-disc list-inside",children:[l.jsx("li",{children:"Check your internet connection"}),l.jsx("li",{children:"Verify the project ID is correct"}),l.jsx("li",{children:"Try accessing the Supabase Dashboard directly"}),l.jsx("li",{children:"Check if your network blocks Supabase domains"})]})]})]}),l.jsx(ki,{}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold mb-2",children:"Environment Variables Required"}),l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Make sure these environment variables are set in your Supabase project:"}),l.jsxs("div",{className:"bg-gray-100 p-3 rounded text-sm font-mono space-y-1",children:[l.jsx("div",{children:"SUPABASE_URL"}),l.jsx("div",{children:"SUPABASE_ANON_KEY"}),l.jsx("div",{children:"SUPABASE_SERVICE_ROLE_KEY"}),l.jsx("div",{children:"SUPABASE_DB_URL"})]})]}),l.jsx(ki,{}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold mb-2 text-green-700",children:"Email Authentication Configuration"}),l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"This application uses server-side signup with automatic email confirmation:"}),l.jsxs("ul",{className:"text-sm text-gray-600 mb-3 list-disc list-inside space-y-1",children:[l.jsxs("li",{children:[l.jsx("strong",{children:"No email verification required:"})," New user accounts are automatically confirmed"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Server-side signup:"})," Uses admin API to create accounts with email_confirm: true"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Immediate access:"})," Users can sign in immediately after account creation"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Secure:"})," Uses service role key on backend, public key on frontend"]})]}),l.jsxs(At,{className:"mt-3 mb-6",children:[l.jsx(sc,{className:"h-4 w-4"}),l.jsxs(jt,{children:[l.jsx("strong",{children:"Email confirmation is disabled by design."})," This simplifies the user onboarding process by eliminating the need for email server setup and verification steps."]})]}),l.jsx("h4",{className:"font-semibold mb-2 text-purple-700",children:"SMS Authentication Setup"}),l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Phone authentication requires SMS provider configuration in Supabase:"}),l.jsxs("ul",{className:"text-sm text-gray-600 mb-3 list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Go to your Supabase Dashboard  Authentication  Settings"}),l.jsx("li",{children:'Navigate to the "Phone Auth" section'}),l.jsx("li",{children:"Configure an SMS provider (Twilio, MessageBird, Textlocal, Vonage)"}),l.jsx("li",{children:"Add your provider credentials and enable phone authentication"}),l.jsx("li",{children:'Enable phone authentication in the "Providers" section'})]}),l.jsxs("div",{className:"space-x-2",children:[l.jsx(be,{variant:"outline",size:"sm",asChild:!0,children:l.jsxs("a",{href:"https://supabase.com/docs/guides/auth/phone-login",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2",children:[l.jsx(J0,{className:"h-3 w-3"}),l.jsx("span",{children:"Phone Auth Setup Guide"})]})}),l.jsx(be,{variant:"outline",size:"sm",asChild:!0,children:l.jsxs("a",{href:"https://supabase.com/docs/guides/auth/phone-login/twilio",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2",children:[l.jsx(J0,{className:"h-3 w-3"}),l.jsx("span",{children:"Twilio Setup"})]})})]})]})]})]})})]})]})}function wV(){const e=xi,t=e.includes("workers.dev")||e.includes("pages.dev"),r=e.includes("supabase.co"),n=e.includes("your-subdomain")||e.includes("your_");return r&&!n?l.jsx("div",{className:"bg-blue-50 border-b border-blue-200",children:l.jsx("div",{className:"container mx-auto px-4 py-2",children:l.jsxs(At,{className:"border-blue-200 bg-blue-50",children:[l.jsx(sc,{className:"h-4 w-4 text-blue-600"}),l.jsx(jt,{className:"text-blue-800",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1 mr-4",children:[l.jsx("strong",{children:" Using Supabase Backend"})," - Ready to upgrade to Cloudflare for better performance!",l.jsxs("div",{className:"text-xs opacity-75 mt-1",children:["Current: ",e]})]}),l.jsxs(be,{onClick:()=>{navigator.clipboard.writeText("npm run deploy-now"),alert('Deployment command copied! Run "npm run deploy-now" in your terminal to upgrade to Cloudflare.')},variant:"outline",size:"sm",className:"text-blue-700 border-blue-300 hover:bg-blue-100",children:[l.jsx(Z0,{className:"h-4 w-4 mr-1"}),"Upgrade to Cloudflare"]})]})})]})})}):t&&!n?l.jsx("div",{className:"bg-green-50 border-b border-green-200",children:l.jsx("div",{className:"container mx-auto px-4 py-2",children:l.jsxs("div",{className:"flex items-center text-green-800 text-sm",children:[l.jsx(sc,{className:"h-4 w-4 mr-2 text-green-600"}),l.jsx("span",{children:" Powered by Cloudflare Workers"}),l.jsx("div",{className:"ml-4 text-xs opacity-75",children:"Edge computing for optimal performance"})]})})}):n?l.jsx("div",{className:"bg-blue-50 border-b border-blue-200",children:l.jsx("div",{className:"container mx-auto px-4 py-3",children:l.jsxs(At,{className:"border-blue-200 bg-blue-50",children:[l.jsx(Z0,{className:"h-4 w-4 text-blue-600"}),l.jsx(jt,{className:"text-blue-800",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1 mr-4",children:[l.jsx("strong",{children:" Ready to Deploy to Cloudflare!"}),l.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[l.jsx("div",{children:"Your app is configured to use Cloudflare Workers + Pages for better performance."}),l.jsxs("div",{className:"text-xs opacity-75",children:["Current backend: ",e]}),l.jsx("div",{className:"text-xs opacity-75",children:"Run the deployment command to get your app live on Cloudflare's edge network!"})]})]}),l.jsxs("div",{className:"flex flex-col space-y-2",children:[l.jsxs(be,{onClick:async()=>{try{(await fetch("/setup-for-figma.sh")).ok?(navigator.clipboard.writeText("npm run setup-local"),alert('Setup command copied! Run "npm run setup-local" in your terminal to configure for current environment.')):(navigator.clipboard.writeText("npm run setup-local"),alert('Setup command copied! Run "npm run setup-local" to configure for current environment.'))}catch{navigator.clipboard.writeText("npm run setup-local"),alert('Setup command copied! Run "npm run setup-local" to configure for current environment.')}},variant:"default",size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:[l.jsx(sc,{className:"h-4 w-4 mr-2"}),"Quick Fix"]}),l.jsxs(be,{onClick:()=>{navigator.clipboard.writeText("npm run deploy-now"),alert('Deployment command copied! Run "npm run deploy-now" for full Cloudflare deployment.')},variant:"outline",size:"sm",children:[l.jsx(Z0,{className:"h-4 w-4 mr-2"}),"Deploy to Cloudflare"]})]})]})})]})})}):null}function _V({onLoginSuccess:e}){const[t,r]=T.useState("email"),[n,s]=T.useState(!1),[a,i]=T.useState(!1),[o,c]=T.useState(""),[u,f]=T.useState(!1),[d,h]=T.useState(!1),[p,x]=T.useState({email:"",password:"",confirmPassword:"",name:""}),[m,v]=T.useState({phone:"",otp:"",otpSent:!1}),g=async S=>{S.preventDefault(),c(""),s(!0);try{if(d){if(p.password!==p.confirmPassword){c("Passwords do not match");return}if(p.password.length<6){c("Password must be at least 6 characters long");return}const _=await at.signUpWithServerAutoConfirm(p.email,p.password,p.name);if(_.error){console.log("Server signup failed, trying client-side fallback:",_.error);try{const{data:A,error:F}=await at.signUpWithEmail(p.email,p.password,p.name);if(F){c(`Account creation failed: ${_.error}. Fallback method also failed: ${F}`);return}fe.success("Account created! Please check your email to confirm your account before signing in."),h(!1),x({email:"",password:"",confirmPassword:"",name:""});return}catch(A){console.error("Client-side signup fallback failed:",A),c(`Account creation failed: ${_.error}`);return}}fe.success(_.message||"Account created successfully! You are now signed in."),x({email:"",password:"",confirmPassword:"",name:""}),e()}else{const{data:_,error:A}=await at.signInWithEmail(p.email,p.password);if(A){A.toLowerCase().includes("email not confirmed")?(c("This account requires email confirmation. You can resend the confirmation email or create a new account with the improved signup system."),f(!0)):A.toLowerCase().includes("invalid login credentials")?c("Invalid email or password. Please check your credentials and try again. If you just created an account, try using the new signup system above."):(c(A),f(!1));return}f(!1),fe.success("Login successful!"),e()}}catch(_){console.error("Email auth error:",_),c(_ instanceof Error?_.message:"Authentication failed")}finally{s(!1)}},w=async()=>{c(""),s(!0);try{let S=m.phone.trim();S.startsWith("+")||(S=`+${S}`);const{data:_,error:A}=await at.sendPhoneOTP(S);if(A){A.toLowerCase().includes("unsupported phone provider")||A.toLowerCase().includes("sms provider")||A.toLowerCase().includes("phone provider not configured")||A.toLowerCase().includes("sms authentication is not set up")?(c("SMS authentication is not configured for this application. Please use email authentication instead or contact your administrator to set up an SMS provider."),setTimeout(()=>{r("email"),c("")},3e3)):A.toLowerCase().includes("invalid phone number")||A.toLowerCase().includes("phone number")?c("Please enter a valid phone number with country code (e.g., +1234567890, +91987654321)"):A.toLowerCase().includes("rate limit")||A.toLowerCase().includes("too many")?c("Too many attempts. Please wait a few minutes before trying again."):c(A);return}v(F=>({...F,otpSent:!0,phone:S})),fe.success("OTP sent to your phone number!")}catch(S){console.error("Send OTP error:",S);const _=S instanceof Error?S.message:"Failed to send OTP";_.toLowerCase().includes("unsupported phone provider")||_.toLowerCase().includes("sms provider")||_.toLowerCase().includes("sms authentication is not set up")?(c("SMS authentication is not configured for this application. Please use email authentication instead."),setTimeout(()=>{r("email"),c("")},3e3)):_.toLowerCase().includes("network")?c("Network error occurred. Please check your connection and try again."):c(_)}finally{s(!1)}},y=async S=>{S.preventDefault(),c(""),s(!0);try{const{data:_,error:A}=await at.verifyPhoneOTP(m.phone,m.otp);if(A){c(A);return}fe.success("Phone verification successful!"),e()}catch(_){console.error("Verify OTP error:",_),c(_ instanceof Error?_.message:"OTP verification failed")}finally{s(!1)}},k=()=>{v({phone:"",otp:"",otpSent:!1}),c("")},E=async()=>{if(!p.email){c("Please enter your email address first");return}s(!0),c("");try{const{error:S}=await at.resendConfirmationEmail(p.email);if(S){c(S);return}fe.success("Confirmation email sent! Please check your inbox."),f(!1)}catch(S){console.error("Resend confirmation error:",S),c(S instanceof Error?S.message:"Failed to resend confirmation email")}finally{s(!1)}};return l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:l.jsxs(Ae,{className:"w-full max-w-md shadow-xl",children:[l.jsxs(st,{className:"text-center space-y-2",children:[l.jsx("div",{className:"flex items-center justify-center mb-4",children:l.jsx(zS,{className:"h-12 w-12 text-blue-600"})}),l.jsx(lt,{className:"text-2xl",children:"Schemes Management Platform"}),l.jsx("p",{className:"text-muted-foreground",children:"Sign in to access your distribution schemes"})]}),l.jsxs(je,{className:"space-y-6",children:[o&&l.jsx(At,{className:"border-red-200 bg-red-50",children:l.jsxs(jt,{className:"text-red-800",children:[o,u&&l.jsx("div",{className:"mt-3",children:l.jsxs(be,{variant:"outline",size:"sm",onClick:E,disabled:n||!p.email,className:"w-full",children:[l.jsx(l1,{className:"h-4 w-4 mr-2"}),"Resend Confirmation Email"]})})]})}),l.jsxs(Hi,{value:t,onValueChange:r,className:"w-full",children:[l.jsxs(Gi,{className:"grid w-full grid-cols-2",children:[l.jsxs(kt,{value:"email",className:"flex items-center space-x-2",children:[l.jsx(l1,{className:"h-4 w-4"}),l.jsx("span",{children:"Email"})]}),l.jsxs(kt,{value:"phone",className:"flex items-center space-x-2",children:[l.jsx(c1,{className:"h-4 w-4"}),l.jsx("span",{children:"Phone"})]})]}),l.jsxs(bt,{value:"email",className:"space-y-4 mt-6",children:[l.jsxs("form",{onSubmit:g,className:"space-y-4",children:[d&&l.jsxs("div",{className:"space-y-2",children:[l.jsx(Me,{htmlFor:"name",children:"Full Name"}),l.jsx(Et,{id:"name",type:"text",placeholder:"Enter your full name",value:p.name,onChange:S=>x(_=>({..._,name:S.target.value})),required:d,disabled:n})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Me,{htmlFor:"email",children:"Email Address"}),l.jsx(Et,{id:"email",type:"email",placeholder:"Enter your email",value:p.email,onChange:S=>x(_=>({..._,email:S.target.value})),required:!0,disabled:n})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(Me,{htmlFor:"password",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(Et,{id:"password",type:a?"text":"password",placeholder:"Enter your password",value:p.password,onChange:S=>x(_=>({..._,password:S.target.value})),required:!0,disabled:n,className:"pr-10"}),l.jsx(be,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8 p-0",onClick:()=>i(!a),disabled:n,children:a?l.jsx(hF,{className:"h-4 w-4"}):l.jsx(mF,{className:"h-4 w-4"})})]})]}),d&&l.jsxs("div",{className:"space-y-2",children:[l.jsx(Me,{htmlFor:"confirmPassword",children:"Confirm Password"}),l.jsx(Et,{id:"confirmPassword",type:"password",placeholder:"Confirm your password",value:p.confirmPassword,onChange:S=>x(_=>({..._,confirmPassword:S.target.value})),required:d,disabled:n})]}),l.jsxs(be,{type:"submit",className:"w-full",disabled:n,children:[n?l.jsx(Q0,{className:"h-4 w-4 animate-spin mr-2"}):l.jsx(o1,{className:"h-4 w-4 mr-2"}),d?"Create Account":"Sign In"]})]}),l.jsx(ki,{}),l.jsx("div",{className:"text-center",children:l.jsx(be,{variant:"link",onClick:()=>{h(!d),c(""),f(!1),x({email:"",password:"",confirmPassword:"",name:""})},disabled:n,className:"text-sm",children:d?"Already have an account? Sign in":"Don't have an account? Sign up"})})]}),l.jsxs(bt,{value:"phone",className:"space-y-4 mt-6",children:[l.jsx(At,{className:"border-amber-200 bg-amber-50",children:l.jsxs(jt,{className:"text-amber-800 text-sm",children:[l.jsx("strong",{children:"Notice:"})," Phone authentication requires SMS provider setup in Supabase Dashboard.",l.jsx("br",{}),"If you see errors, please use email authentication or contact your administrator."]})}),m.otpSent?l.jsxs("form",{onSubmit:y,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Me,{htmlFor:"otp",children:"Enter OTP"}),l.jsx(Et,{id:"otp",type:"text",placeholder:"Enter 6-digit OTP",value:m.otp,onChange:S=>v(_=>({..._,otp:S.target.value})),required:!0,disabled:n,maxLength:6}),l.jsxs("p",{className:"text-xs text-muted-foreground",children:["OTP sent to ",m.phone]})]}),l.jsxs(be,{type:"submit",className:"w-full",disabled:n||m.otp.length!==6,children:[n?l.jsx(Q0,{className:"h-4 w-4 animate-spin mr-2"}):l.jsx(o1,{className:"h-4 w-4 mr-2"}),"Verify & Sign In"]}),l.jsx(be,{type:"button",variant:"outline",onClick:k,disabled:n,className:"w-full",children:"Use Different Number"})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(Me,{htmlFor:"phone",children:"Phone Number"}),l.jsx(Et,{id:"phone",type:"tel",placeholder:"Enter phone number (e.g., +1234567890)",value:m.phone,onChange:S=>v(_=>({..._,phone:S.target.value})),required:!0,disabled:n}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Include country code. Examples: +1234567890 (US), +919876543210 (India), +447890123456 (UK)"})]}),l.jsxs(be,{onClick:w,className:"w-full",disabled:n||!m.phone.trim(),children:[n?l.jsx(Q0,{className:"h-4 w-4 animate-spin mr-2"}):l.jsx(c1,{className:"h-4 w-4 mr-2"}),"Send OTP"]}),l.jsx("div",{className:"text-center",children:l.jsx(be,{variant:"link",onClick:()=>r("email"),disabled:n,className:"text-sm text-blue-600",children:"Use Email Authentication Instead"})})]})]})]})]})]})})}function SV(){const[e,t]=T.useState("create-scheme"),[r,n]=T.useState("unknown"),[s,a]=T.useState(""),[i,o]=T.useState(0),c=T.useRef(null),u=T.useRef(null),[f,d]=T.useState({user:null,session:null,loading:!0}),[h,p]=T.useState(null),x=()=>{console.log("Scheme created, switching to manage-schemes and refreshing data"),t("manage-schemes"),c.current&&(console.log("Refreshing ManageSchemes to show newly created scheme..."),setTimeout(()=>{c.current&&c.current.refresh()},100))},m=()=>{console.log("=== CATEGORY DATA UPLOADED SUCCESSFULLY ==="),u.current&&(console.log("Refreshing CreateScheme category data after upload..."),u.current.refresh())},v=()=>{console.log("=== CATEGORY DATA DELETED SUCCESSFULLY ==="),u.current&&(console.log("Clearing CreateScheme category data after deletion..."),u.current.clearCategoryData())},g=async(S=!1)=>{n("checking"),S||(a(""),o(0));const _=xi,A=`${_}/health`,F=`${_}/test`,U=_.includes("workers.dev")||_.includes("pages.dev"),V=_.includes("supabase.co");console.log("=== CONNECTION CHECK DEBUG INFO ==="),console.log("Backend URL:",_),console.log("Health URL:",A),console.log("Test URL:",F),console.log("Using Cloudflare:",U),console.log("Using Supabase:",V),console.log("User ID:",f.user?.id),console.log("Access Token Length:",h?.length||0),console.log("Public Anon Key Length:",Fr?.length||0);try{console.log(`Checking backend connection... ${S?`(Retry attempt ${i+1})`:""}`),console.log("Connecting to health check:",A),console.log("Fallback test URL:",F),console.log("Project ID:",$e),console.log("Access Token Available:",!!h),console.log("User Authenticated:",!!f.user);let N;const X=Date.now();try{console.log("Trying simple health check...");const J=await fetch(A,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(J&&J.ok){console.log("Health check successful!");const Z=await J.json();console.log("Health check response:",Z),n("connected"),o(0),a("");return}else J&&J.status===401?console.log("Health check requires authentication, skipping to authenticated test..."):J&&J.status===404?console.log("Health endpoint not found, trying test endpoint..."):J?console.log("Health check failed with status:",J.status):console.log("Health check returned no response")}catch(J){J instanceof Error&&J.message.includes("Failed to fetch")?console.warn("Health check network error, trying authenticated test endpoint...",J):console.warn("Health check failed, trying authenticated test endpoint...",J)}if(!N||!N.ok){const J=new AbortController,Z=setTimeout(()=>{console.log("Test endpoint timeout reached, aborting..."),J.abort()},6e3);try{f.user&&h?(console.log("Making authenticated test request with user token..."),N=await at.makeAuthenticatedRequest(F,{method:"GET",signal:J.signal})):(console.log("Making public test request with anon key..."),N=await at.makePublicRequest(F,{method:"GET",signal:J.signal})),clearTimeout(Z)}catch(re){clearTimeout(Z),console.warn("Auth service test failed, trying direct fetch...",re);const te=new AbortController,z=setTimeout(()=>{console.log("Direct fetch timeout reached, aborting..."),te.abort()},6e3);try{const K=h||Fr;console.log("Making direct fetch with auth token:",K?"present":"missing"),N=await fetch(F,{method:"GET",signal:te.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${K}`,Accept:"application/json"}}),clearTimeout(z)}catch(K){clearTimeout(z),console.warn("Direct fetch also failed, trying without authorization...",K);try{N=await fetch(F,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}})}catch(se){console.error("Even request without auth failed:",se),N=void 0}}}}const le=Date.now()-X;if(console.log(`Connection test completed in ${le}ms`),!N){console.error("Response is undefined - all connection attempts failed"),n("error"),a("All connection attempts failed. The backend may not be accessible.");return}if(console.log("Response received:",{status:N.status,statusText:N.statusText,ok:N.ok,headers:Object.fromEntries(N.headers.entries())}),N.ok)try{const J=await N.json();console.log("Connection test successful:",J),n("connected"),o(0),a("")}catch(J){console.error("Failed to parse JSON response:",J),a("Server returned invalid JSON response. The Edge Function may be misconfigured."),n("error")}else{let J="Unknown error";try{const Z=N.headers.get("content-type");if(Z&&Z.includes("application/json")){const re=await N.json();J=re.message||re.error||JSON.stringify(re)}else J=await N.text()}catch(Z){console.error("Failed to read error response:",Z),J=`Failed to read error response: ${Z}`}console.error("Connection test failed:",{status:N.status,statusText:N.statusText,errorText:J}),n("error"),N.status===500?a(`Server error (${N.status}). The backend may be experiencing issues. Details: ${J}`):N.status===404?a(U?`Endpoint not found (${N.status}). The Cloudflare Worker may not be deployed yet. Run 'npm run deploy-now' to deploy.`:`Endpoint not found (${N.status}). The Supabase Edge Function 'make-server-ce8ebc43' may not be deployed or the '/test' route is missing.`):N.status===403?a(`Access forbidden (${N.status}). Check your API keys and configuration.`):N.status===401?a(U?`Unauthorized (${N.status}). The Cloudflare Worker may not be properly configured with Supabase credentials or the endpoint requires authentication.`:`Unauthorized (${N.status}). The Supabase API key may be invalid, expired, or the endpoint requires user authentication. Try logging in again.`):N.status===429?a(`Rate limited (${N.status}). Too many requests. Please wait before retrying.`):a(`HTTP ${N.status} ${N.statusText}: ${J}`)}}catch(N){if(console.error("Connection test error:",N),n("error"),N instanceof Error)if(console.error("Error details:",{name:N.name,message:N.message,stack:N.stack}),N.message.includes("timeout")||N.name==="AbortError"){console.log("Timeout detected, trying one more simple fetch without auth...");try{const X=await fetch(F,{method:"GET",headers:{Authorization:`Bearer ${Fr}`,"Content-Type":"application/json"}});if(X&&X.ok){console.log("Simple fetch succeeded, the issue was with timeout handling"),n("connected"),a("");return}else X?console.log("Simple fetch failed with status:",X.status):console.log("Simple fetch returned no response")}catch(X){console.log("Simple fetch also failed:",X)}a(U?"Connection timeout - the Cloudflare Worker took too long to respond. This usually means the worker is not deployed or there are network issues. Run 'npm run deploy-now' to deploy.":"Connection timeout - the server took more than 8 seconds to respond. This usually means the Supabase Edge Function is not deployed, not running, or there are network issues. Please check the Debug tab for deployment instructions.")}else if(N.message.includes("Failed to fetch")){let X="";U?X=`Cloudflare Worker connection failed. This could mean:
1. The Cloudflare Worker is not deployed yet
2. Run 'npm run deploy-now' to deploy to Cloudflare
3. The worker URL is incorrect: ${_}
4. Environment variables not configured
Please check the Debug tab or run the Cloudflare deployment.`:X=`Supabase connection failed. This could mean:
1. The Supabase Edge Function is not deployed
2. The project URL is incorrect: ${_}
3. Network connectivity issues
4. CORS configuration problems
Please check the Debug tab for deployment instructions.`,a(X)}else N.message.includes("NetworkError")||N.message.includes("network")?a(`Network error: ${N.message}. Please check if the Supabase Edge Function is deployed and accessible.`):N.message.includes("CORS")?a(`CORS error: ${N.message}. The backend may not be properly configured for cross-origin requests.`):a(`Connection error: ${N.message}`);else a("Unknown connection error occurred. Please check your network and try again.");response||(console.error("No response received from any connection attempt"),a("Unable to establish connection to backend. All connection attempts failed. Please check if the backend is deployed and accessible."))}},w=async()=>{i<5?(o(S=>S+1),await new Promise(S=>setTimeout(S,1e3)),await g(!0)):a(S=>`${S} (Maximum retry attempts reached - 5/5)`)};T.useEffect(()=>{(async()=>{console.log("Initializing authentication...");try{const{session:A,error:F}=await at.getSession();if(F){console.error("Failed to get session:",F),d(U=>({...U,loading:!1}));return}A?(console.log("Found existing session:",{userId:A.user.id,email:A.user.email,hasAccessToken:!!A.access_token,accessTokenLength:A.access_token?.length||0,tokenPrefix:A.access_token?.substring(0,20)||"none"}),d({user:A.user,session:A,loading:!1}),p(A.access_token)):(console.log("No existing session found"),d(U=>({...U,loading:!1})))}catch(A){console.error("Auth initialization error:",A),d(F=>({...F,loading:!1}))}})();const{data:{subscription:_}}=at.onAuthStateChange((A,F)=>{console.log("Auth state changed:",A,F?.user?.id),F?(console.log("Setting new session in auth state change:",{event:A,userId:F.user.id,hasAccessToken:!!F.access_token,tokenLength:F.access_token?.length||0}),d({user:F.user,session:F,loading:!1}),p(F.access_token)):(console.log("Clearing auth state:",A),d({user:null,session:null,loading:!1}),p(null))});return()=>{_.unsubscribe()}},[]),T.useEffect(()=>{if(!f.loading&&f.user){const S=setTimeout(()=>{g()},500);return()=>clearTimeout(S)}},[f.loading,f.user,h]);const y=S=>{console.log("Tab changed to:",S),t(S)};T.useEffect(()=>{if(e==="debug"&&r!=="connected"&&f.user){console.log("Checking connection when opening debug tab...");const S=setTimeout(()=>{g()},300);return()=>clearTimeout(S)}},[e,f.user]),T.useEffect(()=>{if(r==="connected"&&f.user){const S=setInterval(()=>{console.log("Performing periodic health check..."),g()},3e5);return()=>clearInterval(S)}},[r,f.user]);const k=()=>{console.log("Login successful, user authenticated"),fe.success("Welcome to Schemes Management Platform!")},E=async()=>{try{d(_=>({..._,loading:!0}));const{error:S}=await at.signOut();if(S){console.error("Logout error:",S),fe.error("Failed to logout: "+S),d(_=>({..._,loading:!1}));return}d({user:null,session:null,loading:!1}),p(null),n("unknown"),t("create-scheme"),fe.success("Logged out successfully")}catch(S){console.error("Logout error:",S),fe.error("Failed to logout"),d(_=>({..._,loading:!1}))}};return f.loading?l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:l.jsxs("div",{className:"text-center space-y-4",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),l.jsx("p",{className:"text-gray-600",children:"Initializing authentication..."})]})}):f.user?l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("header",{className:"bg-blue-600 text-white shadow-lg",children:l.jsx("div",{className:"container mx-auto px-4 py-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(KF,{className:"h-8 w-8"}),l.jsx("h1",{className:"text-2xl font-bold",children:"Schemes Management Platform"})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[l.jsx(aF,{className:"h-4 w-4"}),l.jsx("span",{children:f.user.user_metadata?.name||f.user.email||f.user.phone||"User"})]}),l.jsxs(be,{size:"sm",onClick:E,className:"bg-blue-700 hover:bg-blue-800 text-white border-blue-800 hover:border-blue-900 transition-all duration-200",children:[l.jsx(AF,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]})})}),l.jsx(wV,{}),r==="error"&&l.jsx("div",{className:"bg-red-50 border-b border-red-200",children:l.jsx("div",{className:"container mx-auto px-4 py-3",children:l.jsxs(At,{className:"border-red-200 bg-red-50",children:[l.jsx(Ds,{className:"h-4 w-4 text-red-600"}),l.jsx(jt,{className:"text-red-800",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1 mr-4",children:[l.jsx("strong",{children:"Backend Connection Failed:"})," ",s,l.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[l.jsx("div",{children:"Check the Debug tab for deployment instructions and troubleshooting."}),l.jsxs("div",{className:"text-xs opacity-75",children:["Backend: ",(()=>{const S=xi,_=S.includes("workers.dev")||S.includes("pages.dev"),A=S.includes("supabase.co");return _?"Cloudflare Worker":A?"Supabase Edge Function":"Unknown"})()," | Project: ",$e]}),l.jsxs("div",{className:"text-xs opacity-75",children:["Backend URL: ",xi]}),xi.includes("workers.dev")&&l.jsx("div",{className:"text-xs opacity-75 text-blue-600",children:" Deploy with: npm run deploy-now"})]})]}),l.jsxs("div",{className:"flex flex-col space-y-2",children:[l.jsxs(be,{onClick:()=>g(!1),variant:"outline",size:"sm",disabled:r==="checking",children:[l.jsx(dr,{className:`h-4 w-4 mr-2 ${r==="checking"?"animate-spin":""}`}),"Test Connection"]}),i>0&&i<5&&l.jsxs(be,{onClick:w,variant:"secondary",size:"sm",disabled:r==="checking",children:["Auto Retry (",i,"/5)"]})]})]})})]})})}),r==="connected"&&l.jsx("div",{className:"bg-green-50 border-b border-green-200",children:l.jsx("div",{className:"container mx-auto px-4 py-2",children:l.jsxs("div",{className:"flex items-center text-green-800 text-sm",children:[l.jsx(Vn,{className:"h-4 w-4 mr-2 text-green-600"}),l.jsx("span",{children:"Backend connected successfully"}),l.jsxs("div",{className:"ml-4 text-xs opacity-75",children:["Project: ",$e," | Health check every 5 minutes"]})]})})}),r==="checking"&&l.jsx("div",{className:"bg-blue-50 border-b border-blue-200",children:l.jsx("div",{className:"container mx-auto px-4 py-2",children:l.jsxs("div",{className:"flex items-center text-blue-800 text-sm",children:[l.jsx(dr,{className:"h-4 w-4 mr-2 text-blue-600 animate-spin"}),l.jsx("span",{children:"Checking backend connection..."}),i>0&&l.jsxs("div",{className:"ml-4 text-xs opacity-75",children:["Retry attempt ",i,"/5"]})]})})}),l.jsxs("main",{className:"container mx-auto px-4 py-8",children:[l.jsx("div",{className:"mb-8",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Manage Your Distribution Schemes"}),l.jsx("p",{className:"text-gray-600",children:"Create schemes, upload sales data, and verify calculations all in one place"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[r==="connected"&&l.jsxs("div",{className:"flex items-center text-green-600 text-sm",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"Backend Connected"]}),r==="checking"&&l.jsxs("div",{className:"flex items-center text-blue-600 text-sm",children:[l.jsx(dr,{className:"w-4 h-4 animate-spin mr-2"}),"Checking Connection"]}),r==="error"&&l.jsxs("div",{className:"flex items-center text-red-600 text-sm",children:[l.jsx(Ds,{className:"w-4 h-4 mr-2"}),"Connection Failed"]}),r==="unknown"&&l.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[l.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full mr-2"}),"Connection Unknown"]})]})]})}),l.jsxs(Hi,{value:e,onValueChange:y,className:"space-y-6",children:[l.jsxs(Gi,{className:"grid w-full grid-cols-8 lg:w-auto lg:grid-cols-8",children:[l.jsxs(kt,{value:"category-data-upload",className:"flex items-center space-x-2",children:[l.jsx(Ri,{className:"h-4 w-4"}),l.jsx("span",{children:"Category Data"})]}),l.jsxs(kt,{value:"distributor-manager",className:"flex items-center space-x-2",children:[l.jsx(Ma,{className:"h-4 w-4"}),l.jsx("span",{children:"Distributors"})]}),l.jsxs(kt,{value:"create-scheme",className:"flex items-center space-x-2",children:[l.jsx(nl,{className:"h-4 w-4"}),l.jsx("span",{children:"Create Scheme"})]}),l.jsxs(kt,{value:"manage-schemes",className:"flex items-center space-x-2",children:[l.jsx(BS,{className:"h-4 w-4"}),l.jsx("span",{children:"Manage Schemes"})]}),l.jsxs(kt,{value:"upload-data",className:"flex items-center space-x-2",children:[l.jsx(Fs,{className:"h-4 w-4"}),l.jsx("span",{children:"Upload Data"})]}),l.jsxs(kt,{value:"view-calculations",className:"flex items-center space-x-2",children:[l.jsx(Ts,{className:"h-4 w-4"}),l.jsx("span",{children:"View Calculations"})]}),l.jsxs(kt,{value:"moderation",className:"flex items-center space-x-2",children:[l.jsx(zS,{className:"h-4 w-4"}),l.jsx("span",{children:"Moderation"})]}),l.jsxs(kt,{value:"debug",className:"flex items-center space-x-2",children:[l.jsx(dx,{className:"h-4 w-4"}),l.jsx("span",{children:"Debug"})]})]}),l.jsx(bt,{value:"category-data-upload",className:"space-y-6",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(Ri,{className:"h-5 w-5"}),l.jsx("span",{children:"Category Data Management"})]})}),l.jsx(je,{children:l.jsx(GW,{onCategoryDataUploaded:m,onCategoryDataDeleted:v})})]})}),l.jsx(bt,{value:"distributor-manager",className:"space-y-6",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(Ma,{className:"h-5 w-5"}),l.jsx("span",{children:"Distributor Management"})]})}),l.jsx(je,{children:l.jsx(XW,{})})]})}),l.jsx(bt,{value:"create-scheme",className:"space-y-6",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(nl,{className:"h-5 w-5"}),l.jsx("span",{children:"Create New Scheme"})]})}),l.jsx(je,{children:l.jsx(hk,{ref:u,onSchemeCreated:x})})]})}),l.jsx(bt,{value:"manage-schemes",className:"space-y-6",children:l.jsx(dT,{ref:c})}),l.jsx(bt,{value:"upload-data",className:"space-y-6",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(Fs,{className:"h-5 w-5"}),l.jsx("span",{children:"Upload Sales Data"})]})}),l.jsx(je,{children:l.jsx(EI,{})})]})}),l.jsx(bt,{value:"view-calculations",className:"space-y-6",children:l.jsxs(Ae,{children:[l.jsx(st,{children:l.jsxs(lt,{className:"flex items-center space-x-2",children:[l.jsx(Ts,{className:"h-5 w-5"}),l.jsx("span",{children:"Scheme Calculations"})]})}),l.jsx(je,{children:l.jsx(DI,{})})]})}),l.jsx(bt,{value:"moderation",className:"space-y-6",children:l.jsx(hV,{})}),l.jsx(bt,{value:"debug",className:"space-y-6",children:l.jsx(yV,{})})]})]}),l.jsx(PA,{position:"top-right",richColors:!0,expand:!0,duration:4e3})]}):l.jsx(_V,{onLoginSuccess:k})}bh.createRoot(document.getElementById("root")).render(l.jsx(ye.StrictMode,{children:l.jsx(SV,{})}));
