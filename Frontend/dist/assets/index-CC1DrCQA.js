function CT(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function Nd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function NT(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){var s=!1;try{s=this instanceof n}catch{}return s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var Rh={exports:{}},Sc={},Ph={exports:{}},kt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zv;function AT(){if(Zv)return kt;Zv=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function g(V){return V===null||typeof V!="object"?null:(V=m&&V[m]||V["@@iterator"],typeof V=="function"?V:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,v={};function S(V,F,N){this.props=V,this.context=F,this.refs=v,this.updater=N||y}S.prototype.isReactComponent={},S.prototype.setState=function(V,F){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,F,"setState")},S.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function E(){}E.prototype=S.prototype;function A(V,F,N){this.props=V,this.context=F,this.refs=v,this.updater=N||y}var b=A.prototype=new E;b.constructor=A,w(b,S.prototype),b.isPureReactComponent=!0;var D=Array.isArray,O=Object.prototype.hasOwnProperty,C={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function U(V,F,N){var L,B={},q=null,ne=null;if(F!=null)for(L in F.ref!==void 0&&(ne=F.ref),F.key!==void 0&&(q=""+F.key),F)O.call(F,L)&&!T.hasOwnProperty(L)&&(B[L]=F[L]);var Y=arguments.length-2;if(Y===1)B.children=N;else if(1<Y){for(var oe=Array(Y),le=0;le<Y;le++)oe[le]=arguments[le+2];B.children=oe}if(V&&V.defaultProps)for(L in Y=V.defaultProps,Y)B[L]===void 0&&(B[L]=Y[L]);return{$$typeof:e,type:V,key:q,ref:ne,props:B,_owner:C.current}}function z(V,F){return{$$typeof:e,type:V.type,key:F,ref:V.ref,props:V.props,_owner:V._owner}}function Z(V){return typeof V=="object"&&V!==null&&V.$$typeof===e}function re(V){var F={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(N){return F[N]})}var P=/\/+/g;function se(V,F){return typeof V=="object"&&V!==null&&V.key!=null?re(""+V.key):F.toString(36)}function me(V,F,N,L,B){var q=typeof V;(q==="undefined"||q==="boolean")&&(V=null);var ne=!1;if(V===null)ne=!0;else switch(q){case"string":case"number":ne=!0;break;case"object":switch(V.$$typeof){case e:case t:ne=!0}}if(ne)return ne=V,B=B(ne),V=L===""?"."+se(ne,0):L,D(B)?(N="",V!=null&&(N=V.replace(P,"$&/")+"/"),me(B,F,N,"",function(le){return le})):B!=null&&(Z(B)&&(B=z(B,N+(!B.key||ne&&ne.key===B.key?"":(""+B.key).replace(P,"$&/")+"/")+V)),F.push(B)),1;if(ne=0,L=L===""?".":L+":",D(V))for(var Y=0;Y<V.length;Y++){q=V[Y];var oe=L+se(q,Y);ne+=me(q,F,N,oe,B)}else if(oe=g(V),typeof oe=="function")for(V=oe.call(V),Y=0;!(q=V.next()).done;)q=q.value,oe=L+se(q,Y++),ne+=me(q,F,N,oe,B);else if(q==="object")throw F=String(V),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.");return ne}function ce(V,F,N){if(V==null)return V;var L=[],B=0;return me(V,L,"","",function(q){return F.call(N,q,B++)}),L}function fe(V){if(V._status===-1){var F=V._result;F=F(),F.then(function(N){(V._status===0||V._status===-1)&&(V._status=1,V._result=N)},function(N){(V._status===0||V._status===-1)&&(V._status=2,V._result=N)}),V._status===-1&&(V._status=0,V._result=F)}if(V._status===1)return V._result.default;throw V._result}var de={current:null},he={transition:null},Q={ReactCurrentDispatcher:de,ReactCurrentBatchConfig:he,ReactCurrentOwner:C};function ee(){throw Error("act(...) is not supported in production builds of React.")}return kt.Children={map:ce,forEach:function(V,F,N){ce(V,function(){F.apply(this,arguments)},N)},count:function(V){var F=0;return ce(V,function(){F++}),F},toArray:function(V){return ce(V,function(F){return F})||[]},only:function(V){if(!Z(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},kt.Component=S,kt.Fragment=r,kt.Profiler=s,kt.PureComponent=A,kt.StrictMode=n,kt.Suspense=f,kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q,kt.act=ee,kt.cloneElement=function(V,F,N){if(V==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+V+".");var L=w({},V.props),B=V.key,q=V.ref,ne=V._owner;if(F!=null){if(F.ref!==void 0&&(q=F.ref,ne=C.current),F.key!==void 0&&(B=""+F.key),V.type&&V.type.defaultProps)var Y=V.type.defaultProps;for(oe in F)O.call(F,oe)&&!T.hasOwnProperty(oe)&&(L[oe]=F[oe]===void 0&&Y!==void 0?Y[oe]:F[oe])}var oe=arguments.length-2;if(oe===1)L.children=N;else if(1<oe){Y=Array(oe);for(var le=0;le<oe;le++)Y[le]=arguments[le+2];L.children=Y}return{$$typeof:e,type:V.type,key:B,ref:q,props:L,_owner:ne}},kt.createContext=function(V){return V={$$typeof:o,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},V.Provider={$$typeof:a,_context:V},V.Consumer=V},kt.createElement=U,kt.createFactory=function(V){var F=U.bind(null,V);return F.type=V,F},kt.createRef=function(){return{current:null}},kt.forwardRef=function(V){return{$$typeof:u,render:V}},kt.isValidElement=Z,kt.lazy=function(V){return{$$typeof:p,_payload:{_status:-1,_result:V},_init:fe}},kt.memo=function(V,F){return{$$typeof:d,type:V,compare:F===void 0?null:F}},kt.startTransition=function(V){var F=he.transition;he.transition={};try{V()}finally{he.transition=F}},kt.unstable_act=ee,kt.useCallback=function(V,F){return de.current.useCallback(V,F)},kt.useContext=function(V){return de.current.useContext(V)},kt.useDebugValue=function(){},kt.useDeferredValue=function(V){return de.current.useDeferredValue(V)},kt.useEffect=function(V,F){return de.current.useEffect(V,F)},kt.useId=function(){return de.current.useId()},kt.useImperativeHandle=function(V,F,N){return de.current.useImperativeHandle(V,F,N)},kt.useInsertionEffect=function(V,F){return de.current.useInsertionEffect(V,F)},kt.useLayoutEffect=function(V,F){return de.current.useLayoutEffect(V,F)},kt.useMemo=function(V,F){return de.current.useMemo(V,F)},kt.useReducer=function(V,F,N){return de.current.useReducer(V,F,N)},kt.useRef=function(V){return de.current.useRef(V)},kt.useState=function(V){return de.current.useState(V)},kt.useSyncExternalStore=function(V,F,N){return de.current.useSyncExternalStore(V,F,N)},kt.useTransition=function(){return de.current.useTransition()},kt.version="18.3.1",kt}var e1;function sm(){return e1||(e1=1,Ph.exports=AT()),Ph.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1;function jT(){if(t1)return Sc;t1=1;var e=sm(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(u,f,d){var p,m={},g=null,y=null;d!==void 0&&(g=""+d),f.key!==void 0&&(g=""+f.key),f.ref!==void 0&&(y=f.ref);for(p in f)n.call(f,p)&&!a.hasOwnProperty(p)&&(m[p]=f[p]);if(u&&u.defaultProps)for(p in f=u.defaultProps,f)m[p]===void 0&&(m[p]=f[p]);return{$$typeof:t,type:u,key:g,ref:y,props:m,_owner:s.current}}return Sc.Fragment=r,Sc.jsx=o,Sc.jsxs=o,Sc}var r1;function DT(){return r1||(r1=1,Rh.exports=jT()),Rh.exports}var c=DT(),j=sm();const Oe=Nd(j),Ew=CT({__proto__:null,default:Oe},[j]);var Df={},Ih={exports:{}},$n={},Oh={exports:{}},Lh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1;function FT(){return n1||(n1=1,(function(e){function t(he,Q){var ee=he.length;he.push(Q);e:for(;0<ee;){var V=ee-1>>>1,F=he[V];if(0<s(F,Q))he[V]=Q,he[ee]=F,ee=V;else break e}}function r(he){return he.length===0?null:he[0]}function n(he){if(he.length===0)return null;var Q=he[0],ee=he.pop();if(ee!==Q){he[0]=ee;e:for(var V=0,F=he.length,N=F>>>1;V<N;){var L=2*(V+1)-1,B=he[L],q=L+1,ne=he[q];if(0>s(B,ee))q<F&&0>s(ne,B)?(he[V]=ne,he[q]=ee,V=q):(he[V]=B,he[L]=ee,V=L);else if(q<F&&0>s(ne,ee))he[V]=ne,he[q]=ee,V=q;else break e}}return Q}function s(he,Q){var ee=he.sortIndex-Q.sortIndex;return ee!==0?ee:he.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var f=[],d=[],p=1,m=null,g=3,y=!1,w=!1,v=!1,S=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(he){for(var Q=r(d);Q!==null;){if(Q.callback===null)n(d);else if(Q.startTime<=he)n(d),Q.sortIndex=Q.expirationTime,t(f,Q);else break;Q=r(d)}}function D(he){if(v=!1,b(he),!w)if(r(f)!==null)w=!0,fe(O);else{var Q=r(d);Q!==null&&de(D,Q.startTime-he)}}function O(he,Q){w=!1,v&&(v=!1,E(U),U=-1),y=!0;var ee=g;try{for(b(Q),m=r(f);m!==null&&(!(m.expirationTime>Q)||he&&!re());){var V=m.callback;if(typeof V=="function"){m.callback=null,g=m.priorityLevel;var F=V(m.expirationTime<=Q);Q=e.unstable_now(),typeof F=="function"?m.callback=F:m===r(f)&&n(f),b(Q)}else n(f);m=r(f)}if(m!==null)var N=!0;else{var L=r(d);L!==null&&de(D,L.startTime-Q),N=!1}return N}finally{m=null,g=ee,y=!1}}var C=!1,T=null,U=-1,z=5,Z=-1;function re(){return!(e.unstable_now()-Z<z)}function P(){if(T!==null){var he=e.unstable_now();Z=he;var Q=!0;try{Q=T(!0,he)}finally{Q?se():(C=!1,T=null)}}else C=!1}var se;if(typeof A=="function")se=function(){A(P)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,ce=me.port2;me.port1.onmessage=P,se=function(){ce.postMessage(null)}}else se=function(){S(P,0)};function fe(he){T=he,C||(C=!0,se())}function de(he,Q){U=S(function(){he(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(he){he.callback=null},e.unstable_continueExecution=function(){w||y||(w=!0,fe(O))},e.unstable_forceFrameRate=function(he){0>he||125<he?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<he?Math.floor(1e3/he):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(f)},e.unstable_next=function(he){switch(g){case 1:case 2:case 3:var Q=3;break;default:Q=g}var ee=g;g=Q;try{return he()}finally{g=ee}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(he,Q){switch(he){case 1:case 2:case 3:case 4:case 5:break;default:he=3}var ee=g;g=he;try{return Q()}finally{g=ee}},e.unstable_scheduleCallback=function(he,Q,ee){var V=e.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?V+ee:V):ee=V,he){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=ee+F,he={id:p++,callback:Q,priorityLevel:he,startTime:ee,expirationTime:F,sortIndex:-1},ee>V?(he.sortIndex=ee,t(d,he),r(f)===null&&he===r(d)&&(v?(E(U),U=-1):v=!0,de(D,ee-V))):(he.sortIndex=F,t(f,he),w||y||(w=!0,fe(O))),he},e.unstable_shouldYield=re,e.unstable_wrapCallback=function(he){var Q=g;return function(){var ee=g;g=Q;try{return he.apply(this,arguments)}finally{g=ee}}}})(Lh)),Lh}var s1;function RT(){return s1||(s1=1,Oh.exports=FT()),Oh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a1;function PT(){if(a1)return $n;a1=1;var e=sm(),t=RT();function r(i){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(i,l){o(i,l),o(i+"Capture",l)}function o(i,l){for(s[i]=l,i=0;i<l.length;i++)n.add(l[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function g(i){return f.call(m,i)?!0:f.call(p,i)?!1:d.test(i)?m[i]=!0:(p[i]=!0,!1)}function y(i,l,h,x){if(h!==null&&h.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return x?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function w(i,l,h,x){if(l===null||typeof l>"u"||y(i,l,h,x))return!0;if(x)return!1;if(h!==null)switch(h.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function v(i,l,h,x,_,k,R){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=x,this.attributeNamespace=_,this.mustUseProperty=h,this.propertyName=i,this.type=l,this.sanitizeURL=k,this.removeEmptyString=R}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){S[i]=new v(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var l=i[0];S[l]=new v(l,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){S[i]=new v(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){S[i]=new v(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){S[i]=new v(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){S[i]=new v(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){S[i]=new v(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){S[i]=new v(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){S[i]=new v(i,5,!1,i.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function A(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var l=i.replace(E,A);S[l]=new v(l,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var l=i.replace(E,A);S[l]=new v(l,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var l=i.replace(E,A);S[l]=new v(l,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){S[i]=new v(i,1,!1,i.toLowerCase(),null,!1,!1)}),S.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){S[i]=new v(i,1,!1,i.toLowerCase(),null,!0,!0)});function b(i,l,h,x){var _=S.hasOwnProperty(l)?S[l]:null;(_!==null?_.type!==0:x||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(w(l,h,_,x)&&(h=null),x||_===null?g(l)&&(h===null?i.removeAttribute(l):i.setAttribute(l,""+h)):_.mustUseProperty?i[_.propertyName]=h===null?_.type===3?!1:"":h:(l=_.attributeName,x=_.attributeNamespace,h===null?i.removeAttribute(l):(_=_.type,h=_===3||_===4&&h===!0?"":""+h,x?i.setAttributeNS(x,l,h):i.setAttribute(l,h))))}var D=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),C=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),re=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),me=Symbol.for("react.suspense_list"),ce=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),de=Symbol.for("react.offscreen"),he=Symbol.iterator;function Q(i){return i===null||typeof i!="object"?null:(i=he&&i[he]||i["@@iterator"],typeof i=="function"?i:null)}var ee=Object.assign,V;function F(i){if(V===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);V=l&&l[1]||""}return`
`+V+i}var N=!1;function L(i,l){if(!i||N)return"";N=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(ke){var x=ke}Reflect.construct(i,[],l)}else{try{l.call()}catch(ke){x=ke}i.call(l.prototype)}else{try{throw Error()}catch(ke){x=ke}i()}}catch(ke){if(ke&&x&&typeof ke.stack=="string"){for(var _=ke.stack.split(`
`),k=x.stack.split(`
`),R=_.length-1,J=k.length-1;1<=R&&0<=J&&_[R]!==k[J];)J--;for(;1<=R&&0<=J;R--,J--)if(_[R]!==k[J]){if(R!==1||J!==1)do if(R--,J--,0>J||_[R]!==k[J]){var ae=`
`+_[R].replace(" at new "," at ");return i.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",i.displayName)),ae}while(1<=R&&0<=J);break}}}finally{N=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?F(i):""}function B(i){switch(i.tag){case 5:return F(i.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return i=L(i.type,!1),i;case 11:return i=L(i.type.render,!1),i;case 1:return i=L(i.type,!0),i;default:return""}}function q(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case T:return"Fragment";case C:return"Portal";case z:return"Profiler";case U:return"StrictMode";case se:return"Suspense";case me:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case re:return(i.displayName||"Context")+".Consumer";case Z:return(i._context.displayName||"Context")+".Provider";case P:var l=i.render;return i=i.displayName,i||(i=l.displayName||l.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case ce:return l=i.displayName||null,l!==null?l:q(i.type)||"Memo";case fe:l=i._payload,i=i._init;try{return q(i(l))}catch{}}return null}function ne(i){var l=i.type;switch(i.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=l.render,i=i.displayName||i.name||"",l.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(l);case 8:return l===U?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Y(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function oe(i){var l=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function le(i){var l=oe(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,l),x=""+i[l];if(!i.hasOwnProperty(l)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var _=h.get,k=h.set;return Object.defineProperty(i,l,{configurable:!0,get:function(){return _.call(this)},set:function(R){x=""+R,k.call(this,R)}}),Object.defineProperty(i,l,{enumerable:h.enumerable}),{getValue:function(){return x},setValue:function(R){x=""+R},stopTracking:function(){i._valueTracker=null,delete i[l]}}}}function te(i){i._valueTracker||(i._valueTracker=le(i))}function I(i){if(!i)return!1;var l=i._valueTracker;if(!l)return!0;var h=l.getValue(),x="";return i&&(x=oe(i)?i.checked?"true":"false":i.value),i=x,i!==h?(l.setValue(i),!0):!1}function Ce(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Ie(i,l){var h=l.checked;return ee({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function ue(i,l){var h=l.defaultValue==null?"":l.defaultValue,x=l.checked!=null?l.checked:l.defaultChecked;h=Y(l.value!=null?l.value:h),i._wrapperState={initialChecked:x,initialValue:h,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function ge(i,l){l=l.checked,l!=null&&b(i,"checked",l,!1)}function _e(i,l){ge(i,l);var h=Y(l.value),x=l.type;if(h!=null)x==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(x==="submit"||x==="reset"){i.removeAttribute("value");return}l.hasOwnProperty("value")?Ke(i,l.type,h):l.hasOwnProperty("defaultValue")&&Ke(i,l.type,Y(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(i.defaultChecked=!!l.defaultChecked)}function je(i,l,h){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var x=l.type;if(!(x!=="submit"&&x!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+i._wrapperState.initialValue,h||l===i.value||(i.value=l),i.defaultValue=l}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function Ke(i,l,h){(l!=="number"||Ce(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var ot=Array.isArray;function ft(i,l,h,x){if(i=i.options,l){l={};for(var _=0;_<h.length;_++)l["$"+h[_]]=!0;for(h=0;h<i.length;h++)_=l.hasOwnProperty("$"+i[h].value),i[h].selected!==_&&(i[h].selected=_),_&&x&&(i[h].defaultSelected=!0)}else{for(h=""+Y(h),l=null,_=0;_<i.length;_++){if(i[_].value===h){i[_].selected=!0,x&&(i[_].defaultSelected=!0);return}l!==null||i[_].disabled||(l=i[_])}l!==null&&(l.selected=!0)}}function et(i,l){if(l.dangerouslySetInnerHTML!=null)throw Error(r(91));return ee({},l,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function tt(i,l){var h=l.value;if(h==null){if(h=l.children,l=l.defaultValue,h!=null){if(l!=null)throw Error(r(92));if(ot(h)){if(1<h.length)throw Error(r(93));h=h[0]}l=h}l==null&&(l=""),h=l}i._wrapperState={initialValue:Y(h)}}function lt(i,l){var h=Y(l.value),x=Y(l.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),l.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),x!=null&&(i.defaultValue=""+x)}function Ye(i){var l=i.textContent;l===i._wrapperState.initialValue&&l!==""&&l!==null&&(i.value=l)}function Tt(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dr(i,l){return i==null||i==="http://www.w3.org/1999/xhtml"?Tt(l):i==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Kt,an=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,h,x,_){MSApp.execUnsafeLocalFunction(function(){return i(l,h,x,_)})}:i})(function(i,l){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=l;else{for(Kt=Kt||document.createElement("div"),Kt.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=Kt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;l.firstChild;)i.appendChild(l.firstChild)}});function at(i,l){if(l){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=l;return}}i.textContent=l}var zt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ar=["Webkit","ms","Moz","O"];Object.keys(zt).forEach(function(i){Ar.forEach(function(l){l=l+i.charAt(0).toUpperCase()+i.substring(1),zt[l]=zt[i]})});function hr(i,l,h){return l==null||typeof l=="boolean"||l===""?"":h||typeof l!="number"||l===0||zt.hasOwnProperty(i)&&zt[i]?(""+l).trim():l+"px"}function ns(i,l){i=i.style;for(var h in l)if(l.hasOwnProperty(h)){var x=h.indexOf("--")===0,_=hr(h,l[h],x);h==="float"&&(h="cssFloat"),x?i.setProperty(h,_):i[h]=_}}var Ai=ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Oa(i,l){if(l){if(Ai[i]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(r(137,i));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(r(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(r(61))}if(l.style!=null&&typeof l.style!="object")throw Error(r(62))}}function ji(i,l){if(i.indexOf("-")===-1)return typeof l.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bs=null;function Cn(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var La=null,Us=null,ws=null;function $s(i){if(i=oc(i)){if(typeof La!="function")throw Error(r(280));var l=i.stateNode;l&&(l=Hu(l),La(i.stateNode,i.type,l))}}function mt(i){Us?ws?ws.push(i):ws=[i]:Us=i}function mr(){if(Us){var i=Us,l=ws;if(ws=Us=null,$s(i),l)for(i=0;i<l.length;i++)$s(l[i])}}function jr(i,l){return i(l)}function qr(){}var zs=!1;function yr(i,l,h){if(zs)return i(l,h);zs=!0;try{return jr(i,l,h)}finally{zs=!1,(Us!==null||ws!==null)&&(qr(),mr())}}function Lr(i,l){var h=i.stateNode;if(h===null)return null;var x=Hu(h);if(x===null)return null;h=x[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(i=i.type,x=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!x;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(r(231,l,typeof h));return h}var Ws=!1;if(u)try{var Dr={};Object.defineProperty(Dr,"passive",{get:function(){Ws=!0}}),window.addEventListener("test",Dr,Dr),window.removeEventListener("test",Dr,Dr)}catch{Ws=!1}function Nn(i,l,h,x,_,k,R,J,ae){var ke=Array.prototype.slice.call(arguments,3);try{l.apply(h,ke)}catch(De){this.onError(De)}}var Vs=!1,In=null,M=!1,G=null,W={onError:function(i){Vs=!0,In=i}};function H(i,l,h,x,_,k,R,J,ae){Vs=!1,In=null,Nn.apply(W,arguments)}function X(i,l,h,x,_,k,R,J,ae){if(H.apply(this,arguments),Vs){if(Vs){var ke=In;Vs=!1,In=null}else throw Error(r(198));M||(M=!0,G=ke)}}function K(i){var l=i,h=i;if(i.alternate)for(;l.return;)l=l.return;else{i=l;do l=i,(l.flags&4098)!==0&&(h=l.return),i=l.return;while(i)}return l.tag===3?h:null}function ye(i){if(i.tag===13){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function Te(i){if(K(i)!==i)throw Error(r(188))}function ve(i){var l=i.alternate;if(!l){if(l=K(i),l===null)throw Error(r(188));return l!==i?null:i}for(var h=i,x=l;;){var _=h.return;if(_===null)break;var k=_.alternate;if(k===null){if(x=_.return,x!==null){h=x;continue}break}if(_.child===k.child){for(k=_.child;k;){if(k===h)return Te(_),i;if(k===x)return Te(_),l;k=k.sibling}throw Error(r(188))}if(h.return!==x.return)h=_,x=k;else{for(var R=!1,J=_.child;J;){if(J===h){R=!0,h=_,x=k;break}if(J===x){R=!0,x=_,h=k;break}J=J.sibling}if(!R){for(J=k.child;J;){if(J===h){R=!0,h=k,x=_;break}if(J===x){R=!0,x=k,h=_;break}J=J.sibling}if(!R)throw Error(r(189))}}if(h.alternate!==x)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?i:l}function we(i){return i=ve(i),i!==null?Se(i):null}function Se(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var l=Se(i);if(l!==null)return l;i=i.sibling}return null}var Fe=t.unstable_scheduleCallback,ze=t.unstable_cancelCallback,Ve=t.unstable_shouldYield,Le=t.unstable_requestPaint,Pe=t.unstable_now,xt=t.unstable_getCurrentPriorityLevel,qt=t.unstable_ImmediatePriority,tr=t.unstable_UserBlockingPriority,Fr=t.unstable_NormalPriority,Di=t.unstable_LowPriority,Ma=t.unstable_IdlePriority,Hs=null,Yr=null;function zl(i){if(Yr&&typeof Yr.onCommitFiberRoot=="function")try{Yr.onCommitFiberRoot(Hs,i,void 0,(i.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:Hb,Wb=Math.log,Vb=Math.LN2;function Hb(i){return i>>>=0,i===0?32:31-(Wb(i)/Vb|0)|0}var Cu=64,Nu=4194304;function Wl(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Au(i,l){var h=i.pendingLanes;if(h===0)return 0;var x=0,_=i.suspendedLanes,k=i.pingedLanes,R=h&268435455;if(R!==0){var J=R&~_;J!==0?x=Wl(J):(k&=R,k!==0&&(x=Wl(k)))}else R=h&~_,R!==0?x=Wl(R):k!==0&&(x=Wl(k));if(x===0)return 0;if(l!==0&&l!==x&&(l&_)===0&&(_=x&-x,k=l&-l,_>=k||_===16&&(k&4194240)!==0))return l;if((x&4)!==0&&(x|=h&16),l=i.entangledLanes,l!==0)for(i=i.entanglements,l&=x;0<l;)h=31-Rr(l),_=1<<h,x|=i[h],l&=~_;return x}function Gb(i,l){switch(i){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xb(i,l){for(var h=i.suspendedLanes,x=i.pingedLanes,_=i.expirationTimes,k=i.pendingLanes;0<k;){var R=31-Rr(k),J=1<<R,ae=_[R];ae===-1?((J&h)===0||(J&x)!==0)&&(_[R]=Gb(J,l)):ae<=l&&(i.expiredLanes|=J),k&=~J}}function e0(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function jx(){var i=Cu;return Cu<<=1,(Cu&4194240)===0&&(Cu=64),i}function t0(i){for(var l=[],h=0;31>h;h++)l.push(i);return l}function Vl(i,l,h){i.pendingLanes|=l,l!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,l=31-Rr(l),i[l]=h}function Kb(i,l){var h=i.pendingLanes&~l;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=l,i.mutableReadLanes&=l,i.entangledLanes&=l,l=i.entanglements;var x=i.eventTimes;for(i=i.expirationTimes;0<h;){var _=31-Rr(h),k=1<<_;l[_]=0,x[_]=-1,i[_]=-1,h&=~k}}function r0(i,l){var h=i.entangledLanes|=l;for(i=i.entanglements;h;){var x=31-Rr(h),_=1<<x;_&l|i[x]&l&&(i[x]|=l),h&=~_}}var Wt=0;function Dx(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Fx,n0,Rx,Px,Ix,s0=!1,ju=[],Ba=null,Ua=null,$a=null,Hl=new Map,Gl=new Map,za=[],qb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ox(i,l){switch(i){case"focusin":case"focusout":Ba=null;break;case"dragenter":case"dragleave":Ua=null;break;case"mouseover":case"mouseout":$a=null;break;case"pointerover":case"pointerout":Hl.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gl.delete(l.pointerId)}}function Xl(i,l,h,x,_,k){return i===null||i.nativeEvent!==k?(i={blockedOn:l,domEventName:h,eventSystemFlags:x,nativeEvent:k,targetContainers:[_]},l!==null&&(l=oc(l),l!==null&&n0(l)),i):(i.eventSystemFlags|=x,l=i.targetContainers,_!==null&&l.indexOf(_)===-1&&l.push(_),i)}function Yb(i,l,h,x,_){switch(l){case"focusin":return Ba=Xl(Ba,i,l,h,x,_),!0;case"dragenter":return Ua=Xl(Ua,i,l,h,x,_),!0;case"mouseover":return $a=Xl($a,i,l,h,x,_),!0;case"pointerover":var k=_.pointerId;return Hl.set(k,Xl(Hl.get(k)||null,i,l,h,x,_)),!0;case"gotpointercapture":return k=_.pointerId,Gl.set(k,Xl(Gl.get(k)||null,i,l,h,x,_)),!0}return!1}function Lx(i){var l=Fi(i.target);if(l!==null){var h=K(l);if(h!==null){if(l=h.tag,l===13){if(l=ye(h),l!==null){i.blockedOn=l,Ix(i.priority,function(){Rx(h)});return}}else if(l===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Du(i){if(i.blockedOn!==null)return!1;for(var l=i.targetContainers;0<l.length;){var h=i0(i.domEventName,i.eventSystemFlags,l[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var x=new h.constructor(h.type,h);Bs=x,h.target.dispatchEvent(x),Bs=null}else return l=oc(h),l!==null&&n0(l),i.blockedOn=h,!1;l.shift()}return!0}function Mx(i,l,h){Du(i)&&h.delete(l)}function Jb(){s0=!1,Ba!==null&&Du(Ba)&&(Ba=null),Ua!==null&&Du(Ua)&&(Ua=null),$a!==null&&Du($a)&&($a=null),Hl.forEach(Mx),Gl.forEach(Mx)}function Kl(i,l){i.blockedOn===l&&(i.blockedOn=null,s0||(s0=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Jb)))}function ql(i){function l(_){return Kl(_,i)}if(0<ju.length){Kl(ju[0],i);for(var h=1;h<ju.length;h++){var x=ju[h];x.blockedOn===i&&(x.blockedOn=null)}}for(Ba!==null&&Kl(Ba,i),Ua!==null&&Kl(Ua,i),$a!==null&&Kl($a,i),Hl.forEach(l),Gl.forEach(l),h=0;h<za.length;h++)x=za[h],x.blockedOn===i&&(x.blockedOn=null);for(;0<za.length&&(h=za[0],h.blockedOn===null);)Lx(h),h.blockedOn===null&&za.shift()}var Co=D.ReactCurrentBatchConfig,Fu=!0;function Qb(i,l,h,x){var _=Wt,k=Co.transition;Co.transition=null;try{Wt=1,a0(i,l,h,x)}finally{Wt=_,Co.transition=k}}function Zb(i,l,h,x){var _=Wt,k=Co.transition;Co.transition=null;try{Wt=4,a0(i,l,h,x)}finally{Wt=_,Co.transition=k}}function a0(i,l,h,x){if(Fu){var _=i0(i,l,h,x);if(_===null)k0(i,l,x,Ru,h),Ox(i,x);else if(Yb(_,i,l,h,x))x.stopPropagation();else if(Ox(i,x),l&4&&-1<qb.indexOf(i)){for(;_!==null;){var k=oc(_);if(k!==null&&Fx(k),k=i0(i,l,h,x),k===null&&k0(i,l,x,Ru,h),k===_)break;_=k}_!==null&&x.stopPropagation()}else k0(i,l,x,null,h)}}var Ru=null;function i0(i,l,h,x){if(Ru=null,i=Cn(x),i=Fi(i),i!==null)if(l=K(i),l===null)i=null;else if(h=l.tag,h===13){if(i=ye(l),i!==null)return i;i=null}else if(h===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;i=null}else l!==i&&(i=null);return Ru=i,null}function Bx(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xt()){case qt:return 1;case tr:return 4;case Fr:case Di:return 16;case Ma:return 536870912;default:return 16}default:return 16}}var Wa=null,o0=null,Pu=null;function Ux(){if(Pu)return Pu;var i,l=o0,h=l.length,x,_="value"in Wa?Wa.value:Wa.textContent,k=_.length;for(i=0;i<h&&l[i]===_[i];i++);var R=h-i;for(x=1;x<=R&&l[h-x]===_[k-x];x++);return Pu=_.slice(i,1<x?1-x:void 0)}function Iu(i){var l=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&l===13&&(i=13)):i=l,i===10&&(i=13),32<=i||i===13?i:0}function Ou(){return!0}function $x(){return!1}function Hn(i){function l(h,x,_,k,R){this._reactName=h,this._targetInst=_,this.type=x,this.nativeEvent=k,this.target=R,this.currentTarget=null;for(var J in i)i.hasOwnProperty(J)&&(h=i[J],this[J]=h?h(k):k[J]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Ou:$x,this.isPropagationStopped=$x,this}return ee(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Ou)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Ou)},persist:function(){},isPersistent:Ou}),l}var No={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},l0=Hn(No),Yl=ee({},No,{view:0,detail:0}),eE=Hn(Yl),c0,u0,Jl,Lu=ee({},Yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:d0,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Jl&&(Jl&&i.type==="mousemove"?(c0=i.screenX-Jl.screenX,u0=i.screenY-Jl.screenY):u0=c0=0,Jl=i),c0)},movementY:function(i){return"movementY"in i?i.movementY:u0}}),zx=Hn(Lu),tE=ee({},Lu,{dataTransfer:0}),rE=Hn(tE),nE=ee({},Yl,{relatedTarget:0}),f0=Hn(nE),sE=ee({},No,{animationName:0,elapsedTime:0,pseudoElement:0}),aE=Hn(sE),iE=ee({},No,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),oE=Hn(iE),lE=ee({},No,{data:0}),Wx=Hn(lE),cE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dE(i){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(i):(i=fE[i])?!!l[i]:!1}function d0(){return dE}var hE=ee({},Yl,{key:function(i){if(i.key){var l=cE[i.key]||i.key;if(l!=="Unidentified")return l}return i.type==="keypress"?(i=Iu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?uE[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:d0,charCode:function(i){return i.type==="keypress"?Iu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Iu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),pE=Hn(hE),mE=ee({},Lu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vx=Hn(mE),xE=ee({},Yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:d0}),gE=Hn(xE),vE=ee({},No,{propertyName:0,elapsedTime:0,pseudoElement:0}),yE=Hn(vE),wE=ee({},Lu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),_E=Hn(wE),SE=[9,13,27,32],h0=u&&"CompositionEvent"in window,Ql=null;u&&"documentMode"in document&&(Ql=document.documentMode);var kE=u&&"TextEvent"in window&&!Ql,Hx=u&&(!h0||Ql&&8<Ql&&11>=Ql),Gx=" ",Xx=!1;function Kx(i,l){switch(i){case"keyup":return SE.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qx(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ao=!1;function bE(i,l){switch(i){case"compositionend":return qx(l);case"keypress":return l.which!==32?null:(Xx=!0,Gx);case"textInput":return i=l.data,i===Gx&&Xx?null:i;default:return null}}function EE(i,l){if(Ao)return i==="compositionend"||!h0&&Kx(i,l)?(i=Ux(),Pu=o0=Wa=null,Ao=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Hx&&l.locale!=="ko"?null:l.data;default:return null}}var TE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yx(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l==="input"?!!TE[i.type]:l==="textarea"}function Jx(i,l,h,x){mt(x),l=zu(l,"onChange"),0<l.length&&(h=new l0("onChange","change",null,h,x),i.push({event:h,listeners:l}))}var Zl=null,ec=null;function CE(i){mg(i,0)}function Mu(i){var l=Po(i);if(I(l))return i}function NE(i,l){if(i==="change")return l}var Qx=!1;if(u){var p0;if(u){var m0="oninput"in document;if(!m0){var Zx=document.createElement("div");Zx.setAttribute("oninput","return;"),m0=typeof Zx.oninput=="function"}p0=m0}else p0=!1;Qx=p0&&(!document.documentMode||9<document.documentMode)}function eg(){Zl&&(Zl.detachEvent("onpropertychange",tg),ec=Zl=null)}function tg(i){if(i.propertyName==="value"&&Mu(ec)){var l=[];Jx(l,ec,i,Cn(i)),yr(CE,l)}}function AE(i,l,h){i==="focusin"?(eg(),Zl=l,ec=h,Zl.attachEvent("onpropertychange",tg)):i==="focusout"&&eg()}function jE(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Mu(ec)}function DE(i,l){if(i==="click")return Mu(l)}function FE(i,l){if(i==="input"||i==="change")return Mu(l)}function RE(i,l){return i===l&&(i!==0||1/i===1/l)||i!==i&&l!==l}var _s=typeof Object.is=="function"?Object.is:RE;function tc(i,l){if(_s(i,l))return!0;if(typeof i!="object"||i===null||typeof l!="object"||l===null)return!1;var h=Object.keys(i),x=Object.keys(l);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var _=h[x];if(!f.call(l,_)||!_s(i[_],l[_]))return!1}return!0}function rg(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function ng(i,l){var h=rg(i);i=0;for(var x;h;){if(h.nodeType===3){if(x=i+h.textContent.length,i<=l&&x>=l)return{node:h,offset:l-i};i=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=rg(h)}}function sg(i,l){return i&&l?i===l?!0:i&&i.nodeType===3?!1:l&&l.nodeType===3?sg(i,l.parentNode):"contains"in i?i.contains(l):i.compareDocumentPosition?!!(i.compareDocumentPosition(l)&16):!1:!1}function ag(){for(var i=window,l=Ce();l instanceof i.HTMLIFrameElement;){try{var h=typeof l.contentWindow.location.href=="string"}catch{h=!1}if(h)i=l.contentWindow;else break;l=Ce(i.document)}return l}function x0(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l&&(l==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||l==="textarea"||i.contentEditable==="true")}function PE(i){var l=ag(),h=i.focusedElem,x=i.selectionRange;if(l!==h&&h&&h.ownerDocument&&sg(h.ownerDocument.documentElement,h)){if(x!==null&&x0(h)){if(l=x.start,i=x.end,i===void 0&&(i=l),"selectionStart"in h)h.selectionStart=l,h.selectionEnd=Math.min(i,h.value.length);else if(i=(l=h.ownerDocument||document)&&l.defaultView||window,i.getSelection){i=i.getSelection();var _=h.textContent.length,k=Math.min(x.start,_);x=x.end===void 0?k:Math.min(x.end,_),!i.extend&&k>x&&(_=x,x=k,k=_),_=ng(h,k);var R=ng(h,x);_&&R&&(i.rangeCount!==1||i.anchorNode!==_.node||i.anchorOffset!==_.offset||i.focusNode!==R.node||i.focusOffset!==R.offset)&&(l=l.createRange(),l.setStart(_.node,_.offset),i.removeAllRanges(),k>x?(i.addRange(l),i.extend(R.node,R.offset)):(l.setEnd(R.node,R.offset),i.addRange(l)))}}for(l=[],i=h;i=i.parentNode;)i.nodeType===1&&l.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<l.length;h++)i=l[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var IE=u&&"documentMode"in document&&11>=document.documentMode,jo=null,g0=null,rc=null,v0=!1;function ig(i,l,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;v0||jo==null||jo!==Ce(x)||(x=jo,"selectionStart"in x&&x0(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),rc&&tc(rc,x)||(rc=x,x=zu(g0,"onSelect"),0<x.length&&(l=new l0("onSelect","select",null,l,h),i.push({event:l,listeners:x}),l.target=jo)))}function Bu(i,l){var h={};return h[i.toLowerCase()]=l.toLowerCase(),h["Webkit"+i]="webkit"+l,h["Moz"+i]="moz"+l,h}var Do={animationend:Bu("Animation","AnimationEnd"),animationiteration:Bu("Animation","AnimationIteration"),animationstart:Bu("Animation","AnimationStart"),transitionend:Bu("Transition","TransitionEnd")},y0={},og={};u&&(og=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function Uu(i){if(y0[i])return y0[i];if(!Do[i])return i;var l=Do[i],h;for(h in l)if(l.hasOwnProperty(h)&&h in og)return y0[i]=l[h];return i}var lg=Uu("animationend"),cg=Uu("animationiteration"),ug=Uu("animationstart"),fg=Uu("transitionend"),dg=new Map,hg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Va(i,l){dg.set(i,l),a(l,[i])}for(var w0=0;w0<hg.length;w0++){var _0=hg[w0],OE=_0.toLowerCase(),LE=_0[0].toUpperCase()+_0.slice(1);Va(OE,"on"+LE)}Va(lg,"onAnimationEnd"),Va(cg,"onAnimationIteration"),Va(ug,"onAnimationStart"),Va("dblclick","onDoubleClick"),Va("focusin","onFocus"),Va("focusout","onBlur"),Va(fg,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ME=new Set("cancel close invalid load scroll toggle".split(" ").concat(nc));function pg(i,l,h){var x=i.type||"unknown-event";i.currentTarget=h,X(x,l,void 0,i),i.currentTarget=null}function mg(i,l){l=(l&4)!==0;for(var h=0;h<i.length;h++){var x=i[h],_=x.event;x=x.listeners;e:{var k=void 0;if(l)for(var R=x.length-1;0<=R;R--){var J=x[R],ae=J.instance,ke=J.currentTarget;if(J=J.listener,ae!==k&&_.isPropagationStopped())break e;pg(_,J,ke),k=ae}else for(R=0;R<x.length;R++){if(J=x[R],ae=J.instance,ke=J.currentTarget,J=J.listener,ae!==k&&_.isPropagationStopped())break e;pg(_,J,ke),k=ae}}}if(M)throw i=G,M=!1,G=null,i}function ir(i,l){var h=l[A0];h===void 0&&(h=l[A0]=new Set);var x=i+"__bubble";h.has(x)||(xg(l,i,2,!1),h.add(x))}function S0(i,l,h){var x=0;l&&(x|=4),xg(h,i,x,l)}var $u="_reactListening"+Math.random().toString(36).slice(2);function sc(i){if(!i[$u]){i[$u]=!0,n.forEach(function(h){h!=="selectionchange"&&(ME.has(h)||S0(h,!1,i),S0(h,!0,i))});var l=i.nodeType===9?i:i.ownerDocument;l===null||l[$u]||(l[$u]=!0,S0("selectionchange",!1,l))}}function xg(i,l,h,x){switch(Bx(l)){case 1:var _=Qb;break;case 4:_=Zb;break;default:_=a0}h=_.bind(null,l,h,i),_=void 0,!Ws||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(_=!0),x?_!==void 0?i.addEventListener(l,h,{capture:!0,passive:_}):i.addEventListener(l,h,!0):_!==void 0?i.addEventListener(l,h,{passive:_}):i.addEventListener(l,h,!1)}function k0(i,l,h,x,_){var k=x;if((l&1)===0&&(l&2)===0&&x!==null)e:for(;;){if(x===null)return;var R=x.tag;if(R===3||R===4){var J=x.stateNode.containerInfo;if(J===_||J.nodeType===8&&J.parentNode===_)break;if(R===4)for(R=x.return;R!==null;){var ae=R.tag;if((ae===3||ae===4)&&(ae=R.stateNode.containerInfo,ae===_||ae.nodeType===8&&ae.parentNode===_))return;R=R.return}for(;J!==null;){if(R=Fi(J),R===null)return;if(ae=R.tag,ae===5||ae===6){x=k=R;continue e}J=J.parentNode}}x=x.return}yr(function(){var ke=k,De=Cn(h),Re=[];e:{var Ae=dg.get(i);if(Ae!==void 0){var We=l0,Ge=i;switch(i){case"keypress":if(Iu(h)===0)break e;case"keydown":case"keyup":We=pE;break;case"focusin":Ge="focus",We=f0;break;case"focusout":Ge="blur",We=f0;break;case"beforeblur":case"afterblur":We=f0;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":We=zx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":We=rE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":We=gE;break;case lg:case cg:case ug:We=aE;break;case fg:We=yE;break;case"scroll":We=eE;break;case"wheel":We=_E;break;case"copy":case"cut":case"paste":We=oE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":We=Vx}var Xe=(l&4)!==0,Pr=!Xe&&i==="scroll",pe=Xe?Ae!==null?Ae+"Capture":null:Ae;Xe=[];for(var ie=ke,xe;ie!==null;){xe=ie;var Me=xe.stateNode;if(xe.tag===5&&Me!==null&&(xe=Me,pe!==null&&(Me=Lr(ie,pe),Me!=null&&Xe.push(ac(ie,Me,xe)))),Pr)break;ie=ie.return}0<Xe.length&&(Ae=new We(Ae,Ge,null,h,De),Re.push({event:Ae,listeners:Xe}))}}if((l&7)===0){e:{if(Ae=i==="mouseover"||i==="pointerover",We=i==="mouseout"||i==="pointerout",Ae&&h!==Bs&&(Ge=h.relatedTarget||h.fromElement)&&(Fi(Ge)||Ge[pa]))break e;if((We||Ae)&&(Ae=De.window===De?De:(Ae=De.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,We?(Ge=h.relatedTarget||h.toElement,We=ke,Ge=Ge?Fi(Ge):null,Ge!==null&&(Pr=K(Ge),Ge!==Pr||Ge.tag!==5&&Ge.tag!==6)&&(Ge=null)):(We=null,Ge=ke),We!==Ge)){if(Xe=zx,Me="onMouseLeave",pe="onMouseEnter",ie="mouse",(i==="pointerout"||i==="pointerover")&&(Xe=Vx,Me="onPointerLeave",pe="onPointerEnter",ie="pointer"),Pr=We==null?Ae:Po(We),xe=Ge==null?Ae:Po(Ge),Ae=new Xe(Me,ie+"leave",We,h,De),Ae.target=Pr,Ae.relatedTarget=xe,Me=null,Fi(De)===ke&&(Xe=new Xe(pe,ie+"enter",Ge,h,De),Xe.target=xe,Xe.relatedTarget=Pr,Me=Xe),Pr=Me,We&&Ge)t:{for(Xe=We,pe=Ge,ie=0,xe=Xe;xe;xe=Fo(xe))ie++;for(xe=0,Me=pe;Me;Me=Fo(Me))xe++;for(;0<ie-xe;)Xe=Fo(Xe),ie--;for(;0<xe-ie;)pe=Fo(pe),xe--;for(;ie--;){if(Xe===pe||pe!==null&&Xe===pe.alternate)break t;Xe=Fo(Xe),pe=Fo(pe)}Xe=null}else Xe=null;We!==null&&gg(Re,Ae,We,Xe,!1),Ge!==null&&Pr!==null&&gg(Re,Pr,Ge,Xe,!0)}}e:{if(Ae=ke?Po(ke):window,We=Ae.nodeName&&Ae.nodeName.toLowerCase(),We==="select"||We==="input"&&Ae.type==="file")var qe=NE;else if(Yx(Ae))if(Qx)qe=FE;else{qe=jE;var rt=AE}else(We=Ae.nodeName)&&We.toLowerCase()==="input"&&(Ae.type==="checkbox"||Ae.type==="radio")&&(qe=DE);if(qe&&(qe=qe(i,ke))){Jx(Re,qe,h,De);break e}rt&&rt(i,Ae,ke),i==="focusout"&&(rt=Ae._wrapperState)&&rt.controlled&&Ae.type==="number"&&Ke(Ae,"number",Ae.value)}switch(rt=ke?Po(ke):window,i){case"focusin":(Yx(rt)||rt.contentEditable==="true")&&(jo=rt,g0=ke,rc=null);break;case"focusout":rc=g0=jo=null;break;case"mousedown":v0=!0;break;case"contextmenu":case"mouseup":case"dragend":v0=!1,ig(Re,h,De);break;case"selectionchange":if(IE)break;case"keydown":case"keyup":ig(Re,h,De)}var nt;if(h0)e:{switch(i){case"compositionstart":var ht="onCompositionStart";break e;case"compositionend":ht="onCompositionEnd";break e;case"compositionupdate":ht="onCompositionUpdate";break e}ht=void 0}else Ao?Kx(i,h)&&(ht="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(ht="onCompositionStart");ht&&(Hx&&h.locale!=="ko"&&(Ao||ht!=="onCompositionStart"?ht==="onCompositionEnd"&&Ao&&(nt=Ux()):(Wa=De,o0="value"in Wa?Wa.value:Wa.textContent,Ao=!0)),rt=zu(ke,ht),0<rt.length&&(ht=new Wx(ht,i,null,h,De),Re.push({event:ht,listeners:rt}),nt?ht.data=nt:(nt=qx(h),nt!==null&&(ht.data=nt)))),(nt=kE?bE(i,h):EE(i,h))&&(ke=zu(ke,"onBeforeInput"),0<ke.length&&(De=new Wx("onBeforeInput","beforeinput",null,h,De),Re.push({event:De,listeners:ke}),De.data=nt))}mg(Re,l)})}function ac(i,l,h){return{instance:i,listener:l,currentTarget:h}}function zu(i,l){for(var h=l+"Capture",x=[];i!==null;){var _=i,k=_.stateNode;_.tag===5&&k!==null&&(_=k,k=Lr(i,h),k!=null&&x.unshift(ac(i,k,_)),k=Lr(i,l),k!=null&&x.push(ac(i,k,_))),i=i.return}return x}function Fo(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function gg(i,l,h,x,_){for(var k=l._reactName,R=[];h!==null&&h!==x;){var J=h,ae=J.alternate,ke=J.stateNode;if(ae!==null&&ae===x)break;J.tag===5&&ke!==null&&(J=ke,_?(ae=Lr(h,k),ae!=null&&R.unshift(ac(h,ae,J))):_||(ae=Lr(h,k),ae!=null&&R.push(ac(h,ae,J)))),h=h.return}R.length!==0&&i.push({event:l,listeners:R})}var BE=/\r\n?/g,UE=/\u0000|\uFFFD/g;function vg(i){return(typeof i=="string"?i:""+i).replace(BE,`
`).replace(UE,"")}function Wu(i,l,h){if(l=vg(l),vg(i)!==l&&h)throw Error(r(425))}function Vu(){}var b0=null,E0=null;function T0(i,l){return i==="textarea"||i==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var C0=typeof setTimeout=="function"?setTimeout:void 0,$E=typeof clearTimeout=="function"?clearTimeout:void 0,yg=typeof Promise=="function"?Promise:void 0,zE=typeof queueMicrotask=="function"?queueMicrotask:typeof yg<"u"?function(i){return yg.resolve(null).then(i).catch(WE)}:C0;function WE(i){setTimeout(function(){throw i})}function N0(i,l){var h=l,x=0;do{var _=h.nextSibling;if(i.removeChild(h),_&&_.nodeType===8)if(h=_.data,h==="/$"){if(x===0){i.removeChild(_),ql(l);return}x--}else h!=="$"&&h!=="$?"&&h!=="$!"||x++;h=_}while(h);ql(l)}function Ha(i){for(;i!=null;i=i.nextSibling){var l=i.nodeType;if(l===1||l===3)break;if(l===8){if(l=i.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return i}function wg(i){i=i.previousSibling;for(var l=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(l===0)return i;l--}else h==="/$"&&l++}i=i.previousSibling}return null}var Ro=Math.random().toString(36).slice(2),Gs="__reactFiber$"+Ro,ic="__reactProps$"+Ro,pa="__reactContainer$"+Ro,A0="__reactEvents$"+Ro,VE="__reactListeners$"+Ro,HE="__reactHandles$"+Ro;function Fi(i){var l=i[Gs];if(l)return l;for(var h=i.parentNode;h;){if(l=h[pa]||h[Gs]){if(h=l.alternate,l.child!==null||h!==null&&h.child!==null)for(i=wg(i);i!==null;){if(h=i[Gs])return h;i=wg(i)}return l}i=h,h=i.parentNode}return null}function oc(i){return i=i[Gs]||i[pa],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Po(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(r(33))}function Hu(i){return i[ic]||null}var j0=[],Io=-1;function Ga(i){return{current:i}}function or(i){0>Io||(i.current=j0[Io],j0[Io]=null,Io--)}function rr(i,l){Io++,j0[Io]=i.current,i.current=l}var Xa={},pn=Ga(Xa),On=Ga(!1),Ri=Xa;function Oo(i,l){var h=i.type.contextTypes;if(!h)return Xa;var x=i.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===l)return x.__reactInternalMemoizedMaskedChildContext;var _={},k;for(k in h)_[k]=l[k];return x&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=l,i.__reactInternalMemoizedMaskedChildContext=_),_}function Ln(i){return i=i.childContextTypes,i!=null}function Gu(){or(On),or(pn)}function _g(i,l,h){if(pn.current!==Xa)throw Error(r(168));rr(pn,l),rr(On,h)}function Sg(i,l,h){var x=i.stateNode;if(l=l.childContextTypes,typeof x.getChildContext!="function")return h;x=x.getChildContext();for(var _ in x)if(!(_ in l))throw Error(r(108,ne(i)||"Unknown",_));return ee({},h,x)}function Xu(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Xa,Ri=pn.current,rr(pn,i),rr(On,On.current),!0}function kg(i,l,h){var x=i.stateNode;if(!x)throw Error(r(169));h?(i=Sg(i,l,Ri),x.__reactInternalMemoizedMergedChildContext=i,or(On),or(pn),rr(pn,i)):or(On),rr(On,h)}var ma=null,Ku=!1,D0=!1;function bg(i){ma===null?ma=[i]:ma.push(i)}function GE(i){Ku=!0,bg(i)}function Ka(){if(!D0&&ma!==null){D0=!0;var i=0,l=Wt;try{var h=ma;for(Wt=1;i<h.length;i++){var x=h[i];do x=x(!0);while(x!==null)}ma=null,Ku=!1}catch(_){throw ma!==null&&(ma=ma.slice(i+1)),Fe(qt,Ka),_}finally{Wt=l,D0=!1}}return null}var Lo=[],Mo=0,qu=null,Yu=0,ss=[],as=0,Pi=null,xa=1,ga="";function Ii(i,l){Lo[Mo++]=Yu,Lo[Mo++]=qu,qu=i,Yu=l}function Eg(i,l,h){ss[as++]=xa,ss[as++]=ga,ss[as++]=Pi,Pi=i;var x=xa;i=ga;var _=32-Rr(x)-1;x&=~(1<<_),h+=1;var k=32-Rr(l)+_;if(30<k){var R=_-_%5;k=(x&(1<<R)-1).toString(32),x>>=R,_-=R,xa=1<<32-Rr(l)+_|h<<_|x,ga=k+i}else xa=1<<k|h<<_|x,ga=i}function F0(i){i.return!==null&&(Ii(i,1),Eg(i,1,0))}function R0(i){for(;i===qu;)qu=Lo[--Mo],Lo[Mo]=null,Yu=Lo[--Mo],Lo[Mo]=null;for(;i===Pi;)Pi=ss[--as],ss[as]=null,ga=ss[--as],ss[as]=null,xa=ss[--as],ss[as]=null}var Gn=null,Xn=null,pr=!1,Ss=null;function Tg(i,l){var h=cs(5,null,null,0);h.elementType="DELETED",h.stateNode=l,h.return=i,l=i.deletions,l===null?(i.deletions=[h],i.flags|=16):l.push(h)}function Cg(i,l){switch(i.tag){case 5:var h=i.type;return l=l.nodeType!==1||h.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(i.stateNode=l,Gn=i,Xn=Ha(l.firstChild),!0):!1;case 6:return l=i.pendingProps===""||l.nodeType!==3?null:l,l!==null?(i.stateNode=l,Gn=i,Xn=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(h=Pi!==null?{id:xa,overflow:ga}:null,i.memoizedState={dehydrated:l,treeContext:h,retryLane:1073741824},h=cs(18,null,null,0),h.stateNode=l,h.return=i,i.child=h,Gn=i,Xn=null,!0):!1;default:return!1}}function P0(i){return(i.mode&1)!==0&&(i.flags&128)===0}function I0(i){if(pr){var l=Xn;if(l){var h=l;if(!Cg(i,l)){if(P0(i))throw Error(r(418));l=Ha(h.nextSibling);var x=Gn;l&&Cg(i,l)?Tg(x,h):(i.flags=i.flags&-4097|2,pr=!1,Gn=i)}}else{if(P0(i))throw Error(r(418));i.flags=i.flags&-4097|2,pr=!1,Gn=i}}}function Ng(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Gn=i}function Ju(i){if(i!==Gn)return!1;if(!pr)return Ng(i),pr=!0,!1;var l;if((l=i.tag!==3)&&!(l=i.tag!==5)&&(l=i.type,l=l!=="head"&&l!=="body"&&!T0(i.type,i.memoizedProps)),l&&(l=Xn)){if(P0(i))throw Ag(),Error(r(418));for(;l;)Tg(i,l),l=Ha(l.nextSibling)}if(Ng(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,l=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(l===0){Xn=Ha(i.nextSibling);break e}l--}else h!=="$"&&h!=="$!"&&h!=="$?"||l++}i=i.nextSibling}Xn=null}}else Xn=Gn?Ha(i.stateNode.nextSibling):null;return!0}function Ag(){for(var i=Xn;i;)i=Ha(i.nextSibling)}function Bo(){Xn=Gn=null,pr=!1}function O0(i){Ss===null?Ss=[i]:Ss.push(i)}var XE=D.ReactCurrentBatchConfig;function lc(i,l,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(r(309));var x=h.stateNode}if(!x)throw Error(r(147,i));var _=x,k=""+i;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===k?l.ref:(l=function(R){var J=_.refs;R===null?delete J[k]:J[k]=R},l._stringRef=k,l)}if(typeof i!="string")throw Error(r(284));if(!h._owner)throw Error(r(290,i))}return i}function Qu(i,l){throw i=Object.prototype.toString.call(l),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":i))}function jg(i){var l=i._init;return l(i._payload)}function Dg(i){function l(pe,ie){if(i){var xe=pe.deletions;xe===null?(pe.deletions=[ie],pe.flags|=16):xe.push(ie)}}function h(pe,ie){if(!i)return null;for(;ie!==null;)l(pe,ie),ie=ie.sibling;return null}function x(pe,ie){for(pe=new Map;ie!==null;)ie.key!==null?pe.set(ie.key,ie):pe.set(ie.index,ie),ie=ie.sibling;return pe}function _(pe,ie){return pe=ri(pe,ie),pe.index=0,pe.sibling=null,pe}function k(pe,ie,xe){return pe.index=xe,i?(xe=pe.alternate,xe!==null?(xe=xe.index,xe<ie?(pe.flags|=2,ie):xe):(pe.flags|=2,ie)):(pe.flags|=1048576,ie)}function R(pe){return i&&pe.alternate===null&&(pe.flags|=2),pe}function J(pe,ie,xe,Me){return ie===null||ie.tag!==6?(ie=Ch(xe,pe.mode,Me),ie.return=pe,ie):(ie=_(ie,xe),ie.return=pe,ie)}function ae(pe,ie,xe,Me){var qe=xe.type;return qe===T?De(pe,ie,xe.props.children,Me,xe.key):ie!==null&&(ie.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===fe&&jg(qe)===ie.type)?(Me=_(ie,xe.props),Me.ref=lc(pe,ie,xe),Me.return=pe,Me):(Me=kf(xe.type,xe.key,xe.props,null,pe.mode,Me),Me.ref=lc(pe,ie,xe),Me.return=pe,Me)}function ke(pe,ie,xe,Me){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==xe.containerInfo||ie.stateNode.implementation!==xe.implementation?(ie=Nh(xe,pe.mode,Me),ie.return=pe,ie):(ie=_(ie,xe.children||[]),ie.return=pe,ie)}function De(pe,ie,xe,Me,qe){return ie===null||ie.tag!==7?(ie=Wi(xe,pe.mode,Me,qe),ie.return=pe,ie):(ie=_(ie,xe),ie.return=pe,ie)}function Re(pe,ie,xe){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return ie=Ch(""+ie,pe.mode,xe),ie.return=pe,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case O:return xe=kf(ie.type,ie.key,ie.props,null,pe.mode,xe),xe.ref=lc(pe,null,ie),xe.return=pe,xe;case C:return ie=Nh(ie,pe.mode,xe),ie.return=pe,ie;case fe:var Me=ie._init;return Re(pe,Me(ie._payload),xe)}if(ot(ie)||Q(ie))return ie=Wi(ie,pe.mode,xe,null),ie.return=pe,ie;Qu(pe,ie)}return null}function Ae(pe,ie,xe,Me){var qe=ie!==null?ie.key:null;if(typeof xe=="string"&&xe!==""||typeof xe=="number")return qe!==null?null:J(pe,ie,""+xe,Me);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case O:return xe.key===qe?ae(pe,ie,xe,Me):null;case C:return xe.key===qe?ke(pe,ie,xe,Me):null;case fe:return qe=xe._init,Ae(pe,ie,qe(xe._payload),Me)}if(ot(xe)||Q(xe))return qe!==null?null:De(pe,ie,xe,Me,null);Qu(pe,xe)}return null}function We(pe,ie,xe,Me,qe){if(typeof Me=="string"&&Me!==""||typeof Me=="number")return pe=pe.get(xe)||null,J(ie,pe,""+Me,qe);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case O:return pe=pe.get(Me.key===null?xe:Me.key)||null,ae(ie,pe,Me,qe);case C:return pe=pe.get(Me.key===null?xe:Me.key)||null,ke(ie,pe,Me,qe);case fe:var rt=Me._init;return We(pe,ie,xe,rt(Me._payload),qe)}if(ot(Me)||Q(Me))return pe=pe.get(xe)||null,De(ie,pe,Me,qe,null);Qu(ie,Me)}return null}function Ge(pe,ie,xe,Me){for(var qe=null,rt=null,nt=ie,ht=ie=0,Zr=null;nt!==null&&ht<xe.length;ht++){nt.index>ht?(Zr=nt,nt=null):Zr=nt.sibling;var Ut=Ae(pe,nt,xe[ht],Me);if(Ut===null){nt===null&&(nt=Zr);break}i&&nt&&Ut.alternate===null&&l(pe,nt),ie=k(Ut,ie,ht),rt===null?qe=Ut:rt.sibling=Ut,rt=Ut,nt=Zr}if(ht===xe.length)return h(pe,nt),pr&&Ii(pe,ht),qe;if(nt===null){for(;ht<xe.length;ht++)nt=Re(pe,xe[ht],Me),nt!==null&&(ie=k(nt,ie,ht),rt===null?qe=nt:rt.sibling=nt,rt=nt);return pr&&Ii(pe,ht),qe}for(nt=x(pe,nt);ht<xe.length;ht++)Zr=We(nt,pe,ht,xe[ht],Me),Zr!==null&&(i&&Zr.alternate!==null&&nt.delete(Zr.key===null?ht:Zr.key),ie=k(Zr,ie,ht),rt===null?qe=Zr:rt.sibling=Zr,rt=Zr);return i&&nt.forEach(function(ni){return l(pe,ni)}),pr&&Ii(pe,ht),qe}function Xe(pe,ie,xe,Me){var qe=Q(xe);if(typeof qe!="function")throw Error(r(150));if(xe=qe.call(xe),xe==null)throw Error(r(151));for(var rt=qe=null,nt=ie,ht=ie=0,Zr=null,Ut=xe.next();nt!==null&&!Ut.done;ht++,Ut=xe.next()){nt.index>ht?(Zr=nt,nt=null):Zr=nt.sibling;var ni=Ae(pe,nt,Ut.value,Me);if(ni===null){nt===null&&(nt=Zr);break}i&&nt&&ni.alternate===null&&l(pe,nt),ie=k(ni,ie,ht),rt===null?qe=ni:rt.sibling=ni,rt=ni,nt=Zr}if(Ut.done)return h(pe,nt),pr&&Ii(pe,ht),qe;if(nt===null){for(;!Ut.done;ht++,Ut=xe.next())Ut=Re(pe,Ut.value,Me),Ut!==null&&(ie=k(Ut,ie,ht),rt===null?qe=Ut:rt.sibling=Ut,rt=Ut);return pr&&Ii(pe,ht),qe}for(nt=x(pe,nt);!Ut.done;ht++,Ut=xe.next())Ut=We(nt,pe,ht,Ut.value,Me),Ut!==null&&(i&&Ut.alternate!==null&&nt.delete(Ut.key===null?ht:Ut.key),ie=k(Ut,ie,ht),rt===null?qe=Ut:rt.sibling=Ut,rt=Ut);return i&&nt.forEach(function(TT){return l(pe,TT)}),pr&&Ii(pe,ht),qe}function Pr(pe,ie,xe,Me){if(typeof xe=="object"&&xe!==null&&xe.type===T&&xe.key===null&&(xe=xe.props.children),typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case O:e:{for(var qe=xe.key,rt=ie;rt!==null;){if(rt.key===qe){if(qe=xe.type,qe===T){if(rt.tag===7){h(pe,rt.sibling),ie=_(rt,xe.props.children),ie.return=pe,pe=ie;break e}}else if(rt.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===fe&&jg(qe)===rt.type){h(pe,rt.sibling),ie=_(rt,xe.props),ie.ref=lc(pe,rt,xe),ie.return=pe,pe=ie;break e}h(pe,rt);break}else l(pe,rt);rt=rt.sibling}xe.type===T?(ie=Wi(xe.props.children,pe.mode,Me,xe.key),ie.return=pe,pe=ie):(Me=kf(xe.type,xe.key,xe.props,null,pe.mode,Me),Me.ref=lc(pe,ie,xe),Me.return=pe,pe=Me)}return R(pe);case C:e:{for(rt=xe.key;ie!==null;){if(ie.key===rt)if(ie.tag===4&&ie.stateNode.containerInfo===xe.containerInfo&&ie.stateNode.implementation===xe.implementation){h(pe,ie.sibling),ie=_(ie,xe.children||[]),ie.return=pe,pe=ie;break e}else{h(pe,ie);break}else l(pe,ie);ie=ie.sibling}ie=Nh(xe,pe.mode,Me),ie.return=pe,pe=ie}return R(pe);case fe:return rt=xe._init,Pr(pe,ie,rt(xe._payload),Me)}if(ot(xe))return Ge(pe,ie,xe,Me);if(Q(xe))return Xe(pe,ie,xe,Me);Qu(pe,xe)}return typeof xe=="string"&&xe!==""||typeof xe=="number"?(xe=""+xe,ie!==null&&ie.tag===6?(h(pe,ie.sibling),ie=_(ie,xe),ie.return=pe,pe=ie):(h(pe,ie),ie=Ch(xe,pe.mode,Me),ie.return=pe,pe=ie),R(pe)):h(pe,ie)}return Pr}var Uo=Dg(!0),Fg=Dg(!1),Zu=Ga(null),ef=null,$o=null,L0=null;function M0(){L0=$o=ef=null}function B0(i){var l=Zu.current;or(Zu),i._currentValue=l}function U0(i,l,h){for(;i!==null;){var x=i.alternate;if((i.childLanes&l)!==l?(i.childLanes|=l,x!==null&&(x.childLanes|=l)):x!==null&&(x.childLanes&l)!==l&&(x.childLanes|=l),i===h)break;i=i.return}}function zo(i,l){ef=i,L0=$o=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&l)!==0&&(Mn=!0),i.firstContext=null)}function is(i){var l=i._currentValue;if(L0!==i)if(i={context:i,memoizedValue:l,next:null},$o===null){if(ef===null)throw Error(r(308));$o=i,ef.dependencies={lanes:0,firstContext:i}}else $o=$o.next=i;return l}var Oi=null;function $0(i){Oi===null?Oi=[i]:Oi.push(i)}function Rg(i,l,h,x){var _=l.interleaved;return _===null?(h.next=h,$0(l)):(h.next=_.next,_.next=h),l.interleaved=h,va(i,x)}function va(i,l){i.lanes|=l;var h=i.alternate;for(h!==null&&(h.lanes|=l),h=i,i=i.return;i!==null;)i.childLanes|=l,h=i.alternate,h!==null&&(h.childLanes|=l),h=i,i=i.return;return h.tag===3?h.stateNode:null}var qa=!1;function z0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pg(i,l){i=i.updateQueue,l.updateQueue===i&&(l.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ya(i,l){return{eventTime:i,lane:l,tag:0,payload:null,callback:null,next:null}}function Ya(i,l,h){var x=i.updateQueue;if(x===null)return null;if(x=x.shared,(Lt&2)!==0){var _=x.pending;return _===null?l.next=l:(l.next=_.next,_.next=l),x.pending=l,va(i,h)}return _=x.interleaved,_===null?(l.next=l,$0(x)):(l.next=_.next,_.next=l),x.interleaved=l,va(i,h)}function tf(i,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194240)!==0)){var x=l.lanes;x&=i.pendingLanes,h|=x,l.lanes=h,r0(i,h)}}function Ig(i,l){var h=i.updateQueue,x=i.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var _=null,k=null;if(h=h.firstBaseUpdate,h!==null){do{var R={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};k===null?_=k=R:k=k.next=R,h=h.next}while(h!==null);k===null?_=k=l:k=k.next=l}else _=k=l;h={baseState:x.baseState,firstBaseUpdate:_,lastBaseUpdate:k,shared:x.shared,effects:x.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=l:i.next=l,h.lastBaseUpdate=l}function rf(i,l,h,x){var _=i.updateQueue;qa=!1;var k=_.firstBaseUpdate,R=_.lastBaseUpdate,J=_.shared.pending;if(J!==null){_.shared.pending=null;var ae=J,ke=ae.next;ae.next=null,R===null?k=ke:R.next=ke,R=ae;var De=i.alternate;De!==null&&(De=De.updateQueue,J=De.lastBaseUpdate,J!==R&&(J===null?De.firstBaseUpdate=ke:J.next=ke,De.lastBaseUpdate=ae))}if(k!==null){var Re=_.baseState;R=0,De=ke=ae=null,J=k;do{var Ae=J.lane,We=J.eventTime;if((x&Ae)===Ae){De!==null&&(De=De.next={eventTime:We,lane:0,tag:J.tag,payload:J.payload,callback:J.callback,next:null});e:{var Ge=i,Xe=J;switch(Ae=l,We=h,Xe.tag){case 1:if(Ge=Xe.payload,typeof Ge=="function"){Re=Ge.call(We,Re,Ae);break e}Re=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=Xe.payload,Ae=typeof Ge=="function"?Ge.call(We,Re,Ae):Ge,Ae==null)break e;Re=ee({},Re,Ae);break e;case 2:qa=!0}}J.callback!==null&&J.lane!==0&&(i.flags|=64,Ae=_.effects,Ae===null?_.effects=[J]:Ae.push(J))}else We={eventTime:We,lane:Ae,tag:J.tag,payload:J.payload,callback:J.callback,next:null},De===null?(ke=De=We,ae=Re):De=De.next=We,R|=Ae;if(J=J.next,J===null){if(J=_.shared.pending,J===null)break;Ae=J,J=Ae.next,Ae.next=null,_.lastBaseUpdate=Ae,_.shared.pending=null}}while(!0);if(De===null&&(ae=Re),_.baseState=ae,_.firstBaseUpdate=ke,_.lastBaseUpdate=De,l=_.shared.interleaved,l!==null){_=l;do R|=_.lane,_=_.next;while(_!==l)}else k===null&&(_.shared.lanes=0);Bi|=R,i.lanes=R,i.memoizedState=Re}}function Og(i,l,h){if(i=l.effects,l.effects=null,i!==null)for(l=0;l<i.length;l++){var x=i[l],_=x.callback;if(_!==null){if(x.callback=null,x=h,typeof _!="function")throw Error(r(191,_));_.call(x)}}}var cc={},Xs=Ga(cc),uc=Ga(cc),fc=Ga(cc);function Li(i){if(i===cc)throw Error(r(174));return i}function W0(i,l){switch(rr(fc,l),rr(uc,i),rr(Xs,cc),i=l.nodeType,i){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:dr(null,"");break;default:i=i===8?l.parentNode:l,l=i.namespaceURI||null,i=i.tagName,l=dr(l,i)}or(Xs),rr(Xs,l)}function Wo(){or(Xs),or(uc),or(fc)}function Lg(i){Li(fc.current);var l=Li(Xs.current),h=dr(l,i.type);l!==h&&(rr(uc,i),rr(Xs,h))}function V0(i){uc.current===i&&(or(Xs),or(uc))}var xr=Ga(0);function nf(i){for(var l=i;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var H0=[];function G0(){for(var i=0;i<H0.length;i++)H0[i]._workInProgressVersionPrimary=null;H0.length=0}var sf=D.ReactCurrentDispatcher,X0=D.ReactCurrentBatchConfig,Mi=0,gr=null,Wr=null,Jr=null,af=!1,dc=!1,hc=0,KE=0;function mn(){throw Error(r(321))}function K0(i,l){if(l===null)return!1;for(var h=0;h<l.length&&h<i.length;h++)if(!_s(i[h],l[h]))return!1;return!0}function q0(i,l,h,x,_,k){if(Mi=k,gr=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,sf.current=i===null||i.memoizedState===null?QE:ZE,i=h(x,_),dc){k=0;do{if(dc=!1,hc=0,25<=k)throw Error(r(301));k+=1,Jr=Wr=null,l.updateQueue=null,sf.current=eT,i=h(x,_)}while(dc)}if(sf.current=cf,l=Wr!==null&&Wr.next!==null,Mi=0,Jr=Wr=gr=null,af=!1,l)throw Error(r(300));return i}function Y0(){var i=hc!==0;return hc=0,i}function Ks(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jr===null?gr.memoizedState=Jr=i:Jr=Jr.next=i,Jr}function os(){if(Wr===null){var i=gr.alternate;i=i!==null?i.memoizedState:null}else i=Wr.next;var l=Jr===null?gr.memoizedState:Jr.next;if(l!==null)Jr=l,Wr=i;else{if(i===null)throw Error(r(310));Wr=i,i={memoizedState:Wr.memoizedState,baseState:Wr.baseState,baseQueue:Wr.baseQueue,queue:Wr.queue,next:null},Jr===null?gr.memoizedState=Jr=i:Jr=Jr.next=i}return Jr}function pc(i,l){return typeof l=="function"?l(i):l}function J0(i){var l=os(),h=l.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=i;var x=Wr,_=x.baseQueue,k=h.pending;if(k!==null){if(_!==null){var R=_.next;_.next=k.next,k.next=R}x.baseQueue=_=k,h.pending=null}if(_!==null){k=_.next,x=x.baseState;var J=R=null,ae=null,ke=k;do{var De=ke.lane;if((Mi&De)===De)ae!==null&&(ae=ae.next={lane:0,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),x=ke.hasEagerState?ke.eagerState:i(x,ke.action);else{var Re={lane:De,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null};ae===null?(J=ae=Re,R=x):ae=ae.next=Re,gr.lanes|=De,Bi|=De}ke=ke.next}while(ke!==null&&ke!==k);ae===null?R=x:ae.next=J,_s(x,l.memoizedState)||(Mn=!0),l.memoizedState=x,l.baseState=R,l.baseQueue=ae,h.lastRenderedState=x}if(i=h.interleaved,i!==null){_=i;do k=_.lane,gr.lanes|=k,Bi|=k,_=_.next;while(_!==i)}else _===null&&(h.lanes=0);return[l.memoizedState,h.dispatch]}function Q0(i){var l=os(),h=l.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=i;var x=h.dispatch,_=h.pending,k=l.memoizedState;if(_!==null){h.pending=null;var R=_=_.next;do k=i(k,R.action),R=R.next;while(R!==_);_s(k,l.memoizedState)||(Mn=!0),l.memoizedState=k,l.baseQueue===null&&(l.baseState=k),h.lastRenderedState=k}return[k,x]}function Mg(){}function Bg(i,l){var h=gr,x=os(),_=l(),k=!_s(x.memoizedState,_);if(k&&(x.memoizedState=_,Mn=!0),x=x.queue,Z0(zg.bind(null,h,x,i),[i]),x.getSnapshot!==l||k||Jr!==null&&Jr.memoizedState.tag&1){if(h.flags|=2048,mc(9,$g.bind(null,h,x,_,l),void 0,null),Qr===null)throw Error(r(349));(Mi&30)!==0||Ug(h,l,_)}return _}function Ug(i,l,h){i.flags|=16384,i={getSnapshot:l,value:h},l=gr.updateQueue,l===null?(l={lastEffect:null,stores:null},gr.updateQueue=l,l.stores=[i]):(h=l.stores,h===null?l.stores=[i]:h.push(i))}function $g(i,l,h,x){l.value=h,l.getSnapshot=x,Wg(l)&&Vg(i)}function zg(i,l,h){return h(function(){Wg(l)&&Vg(i)})}function Wg(i){var l=i.getSnapshot;i=i.value;try{var h=l();return!_s(i,h)}catch{return!0}}function Vg(i){var l=va(i,1);l!==null&&Ts(l,i,1,-1)}function Hg(i){var l=Ks();return typeof i=="function"&&(i=i()),l.memoizedState=l.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pc,lastRenderedState:i},l.queue=i,i=i.dispatch=JE.bind(null,gr,i),[l.memoizedState,i]}function mc(i,l,h,x){return i={tag:i,create:l,destroy:h,deps:x,next:null},l=gr.updateQueue,l===null?(l={lastEffect:null,stores:null},gr.updateQueue=l,l.lastEffect=i.next=i):(h=l.lastEffect,h===null?l.lastEffect=i.next=i:(x=h.next,h.next=i,i.next=x,l.lastEffect=i)),i}function Gg(){return os().memoizedState}function of(i,l,h,x){var _=Ks();gr.flags|=i,_.memoizedState=mc(1|l,h,void 0,x===void 0?null:x)}function lf(i,l,h,x){var _=os();x=x===void 0?null:x;var k=void 0;if(Wr!==null){var R=Wr.memoizedState;if(k=R.destroy,x!==null&&K0(x,R.deps)){_.memoizedState=mc(l,h,k,x);return}}gr.flags|=i,_.memoizedState=mc(1|l,h,k,x)}function Xg(i,l){return of(8390656,8,i,l)}function Z0(i,l){return lf(2048,8,i,l)}function Kg(i,l){return lf(4,2,i,l)}function qg(i,l){return lf(4,4,i,l)}function Yg(i,l){if(typeof l=="function")return i=i(),l(i),function(){l(null)};if(l!=null)return i=i(),l.current=i,function(){l.current=null}}function Jg(i,l,h){return h=h!=null?h.concat([i]):null,lf(4,4,Yg.bind(null,l,i),h)}function eh(){}function Qg(i,l){var h=os();l=l===void 0?null:l;var x=h.memoizedState;return x!==null&&l!==null&&K0(l,x[1])?x[0]:(h.memoizedState=[i,l],i)}function Zg(i,l){var h=os();l=l===void 0?null:l;var x=h.memoizedState;return x!==null&&l!==null&&K0(l,x[1])?x[0]:(i=i(),h.memoizedState=[i,l],i)}function ev(i,l,h){return(Mi&21)===0?(i.baseState&&(i.baseState=!1,Mn=!0),i.memoizedState=h):(_s(h,l)||(h=jx(),gr.lanes|=h,Bi|=h,i.baseState=!0),l)}function qE(i,l){var h=Wt;Wt=h!==0&&4>h?h:4,i(!0);var x=X0.transition;X0.transition={};try{i(!1),l()}finally{Wt=h,X0.transition=x}}function tv(){return os().memoizedState}function YE(i,l,h){var x=ei(i);if(h={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null},rv(i))nv(l,h);else if(h=Rg(i,l,h,x),h!==null){var _=jn();Ts(h,i,x,_),sv(h,l,x)}}function JE(i,l,h){var x=ei(i),_={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null};if(rv(i))nv(l,_);else{var k=i.alternate;if(i.lanes===0&&(k===null||k.lanes===0)&&(k=l.lastRenderedReducer,k!==null))try{var R=l.lastRenderedState,J=k(R,h);if(_.hasEagerState=!0,_.eagerState=J,_s(J,R)){var ae=l.interleaved;ae===null?(_.next=_,$0(l)):(_.next=ae.next,ae.next=_),l.interleaved=_;return}}catch{}finally{}h=Rg(i,l,_,x),h!==null&&(_=jn(),Ts(h,i,x,_),sv(h,l,x))}}function rv(i){var l=i.alternate;return i===gr||l!==null&&l===gr}function nv(i,l){dc=af=!0;var h=i.pending;h===null?l.next=l:(l.next=h.next,h.next=l),i.pending=l}function sv(i,l,h){if((h&4194240)!==0){var x=l.lanes;x&=i.pendingLanes,h|=x,l.lanes=h,r0(i,h)}}var cf={readContext:is,useCallback:mn,useContext:mn,useEffect:mn,useImperativeHandle:mn,useInsertionEffect:mn,useLayoutEffect:mn,useMemo:mn,useReducer:mn,useRef:mn,useState:mn,useDebugValue:mn,useDeferredValue:mn,useTransition:mn,useMutableSource:mn,useSyncExternalStore:mn,useId:mn,unstable_isNewReconciler:!1},QE={readContext:is,useCallback:function(i,l){return Ks().memoizedState=[i,l===void 0?null:l],i},useContext:is,useEffect:Xg,useImperativeHandle:function(i,l,h){return h=h!=null?h.concat([i]):null,of(4194308,4,Yg.bind(null,l,i),h)},useLayoutEffect:function(i,l){return of(4194308,4,i,l)},useInsertionEffect:function(i,l){return of(4,2,i,l)},useMemo:function(i,l){var h=Ks();return l=l===void 0?null:l,i=i(),h.memoizedState=[i,l],i},useReducer:function(i,l,h){var x=Ks();return l=h!==void 0?h(l):l,x.memoizedState=x.baseState=l,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:l},x.queue=i,i=i.dispatch=YE.bind(null,gr,i),[x.memoizedState,i]},useRef:function(i){var l=Ks();return i={current:i},l.memoizedState=i},useState:Hg,useDebugValue:eh,useDeferredValue:function(i){return Ks().memoizedState=i},useTransition:function(){var i=Hg(!1),l=i[0];return i=qE.bind(null,i[1]),Ks().memoizedState=i,[l,i]},useMutableSource:function(){},useSyncExternalStore:function(i,l,h){var x=gr,_=Ks();if(pr){if(h===void 0)throw Error(r(407));h=h()}else{if(h=l(),Qr===null)throw Error(r(349));(Mi&30)!==0||Ug(x,l,h)}_.memoizedState=h;var k={value:h,getSnapshot:l};return _.queue=k,Xg(zg.bind(null,x,k,i),[i]),x.flags|=2048,mc(9,$g.bind(null,x,k,h,l),void 0,null),h},useId:function(){var i=Ks(),l=Qr.identifierPrefix;if(pr){var h=ga,x=xa;h=(x&~(1<<32-Rr(x)-1)).toString(32)+h,l=":"+l+"R"+h,h=hc++,0<h&&(l+="H"+h.toString(32)),l+=":"}else h=KE++,l=":"+l+"r"+h.toString(32)+":";return i.memoizedState=l},unstable_isNewReconciler:!1},ZE={readContext:is,useCallback:Qg,useContext:is,useEffect:Z0,useImperativeHandle:Jg,useInsertionEffect:Kg,useLayoutEffect:qg,useMemo:Zg,useReducer:J0,useRef:Gg,useState:function(){return J0(pc)},useDebugValue:eh,useDeferredValue:function(i){var l=os();return ev(l,Wr.memoizedState,i)},useTransition:function(){var i=J0(pc)[0],l=os().memoizedState;return[i,l]},useMutableSource:Mg,useSyncExternalStore:Bg,useId:tv,unstable_isNewReconciler:!1},eT={readContext:is,useCallback:Qg,useContext:is,useEffect:Z0,useImperativeHandle:Jg,useInsertionEffect:Kg,useLayoutEffect:qg,useMemo:Zg,useReducer:Q0,useRef:Gg,useState:function(){return Q0(pc)},useDebugValue:eh,useDeferredValue:function(i){var l=os();return Wr===null?l.memoizedState=i:ev(l,Wr.memoizedState,i)},useTransition:function(){var i=Q0(pc)[0],l=os().memoizedState;return[i,l]},useMutableSource:Mg,useSyncExternalStore:Bg,useId:tv,unstable_isNewReconciler:!1};function ks(i,l){if(i&&i.defaultProps){l=ee({},l),i=i.defaultProps;for(var h in i)l[h]===void 0&&(l[h]=i[h]);return l}return l}function th(i,l,h,x){l=i.memoizedState,h=h(x,l),h=h==null?l:ee({},l,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var uf={isMounted:function(i){return(i=i._reactInternals)?K(i)===i:!1},enqueueSetState:function(i,l,h){i=i._reactInternals;var x=jn(),_=ei(i),k=ya(x,_);k.payload=l,h!=null&&(k.callback=h),l=Ya(i,k,_),l!==null&&(Ts(l,i,_,x),tf(l,i,_))},enqueueReplaceState:function(i,l,h){i=i._reactInternals;var x=jn(),_=ei(i),k=ya(x,_);k.tag=1,k.payload=l,h!=null&&(k.callback=h),l=Ya(i,k,_),l!==null&&(Ts(l,i,_,x),tf(l,i,_))},enqueueForceUpdate:function(i,l){i=i._reactInternals;var h=jn(),x=ei(i),_=ya(h,x);_.tag=2,l!=null&&(_.callback=l),l=Ya(i,_,x),l!==null&&(Ts(l,i,x,h),tf(l,i,x))}};function av(i,l,h,x,_,k,R){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(x,k,R):l.prototype&&l.prototype.isPureReactComponent?!tc(h,x)||!tc(_,k):!0}function iv(i,l,h){var x=!1,_=Xa,k=l.contextType;return typeof k=="object"&&k!==null?k=is(k):(_=Ln(l)?Ri:pn.current,x=l.contextTypes,k=(x=x!=null)?Oo(i,_):Xa),l=new l(h,k),i.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=uf,i.stateNode=l,l._reactInternals=i,x&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=_,i.__reactInternalMemoizedMaskedChildContext=k),l}function ov(i,l,h,x){i=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,x),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,x),l.state!==i&&uf.enqueueReplaceState(l,l.state,null)}function rh(i,l,h,x){var _=i.stateNode;_.props=h,_.state=i.memoizedState,_.refs={},z0(i);var k=l.contextType;typeof k=="object"&&k!==null?_.context=is(k):(k=Ln(l)?Ri:pn.current,_.context=Oo(i,k)),_.state=i.memoizedState,k=l.getDerivedStateFromProps,typeof k=="function"&&(th(i,l,k,h),_.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(l=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),l!==_.state&&uf.enqueueReplaceState(_,_.state,null),rf(i,h,_,x),_.state=i.memoizedState),typeof _.componentDidMount=="function"&&(i.flags|=4194308)}function Vo(i,l){try{var h="",x=l;do h+=B(x),x=x.return;while(x);var _=h}catch(k){_=`
Error generating stack: `+k.message+`
`+k.stack}return{value:i,source:l,stack:_,digest:null}}function nh(i,l,h){return{value:i,source:null,stack:h??null,digest:l??null}}function sh(i,l){try{console.error(l.value)}catch(h){setTimeout(function(){throw h})}}var tT=typeof WeakMap=="function"?WeakMap:Map;function lv(i,l,h){h=ya(-1,h),h.tag=3,h.payload={element:null};var x=l.value;return h.callback=function(){gf||(gf=!0,yh=x),sh(i,l)},h}function cv(i,l,h){h=ya(-1,h),h.tag=3;var x=i.type.getDerivedStateFromError;if(typeof x=="function"){var _=l.value;h.payload=function(){return x(_)},h.callback=function(){sh(i,l)}}var k=i.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(h.callback=function(){sh(i,l),typeof x!="function"&&(Qa===null?Qa=new Set([this]):Qa.add(this));var R=l.stack;this.componentDidCatch(l.value,{componentStack:R!==null?R:""})}),h}function uv(i,l,h){var x=i.pingCache;if(x===null){x=i.pingCache=new tT;var _=new Set;x.set(l,_)}else _=x.get(l),_===void 0&&(_=new Set,x.set(l,_));_.has(h)||(_.add(h),i=mT.bind(null,i,l,h),l.then(i,i))}function fv(i){do{var l;if((l=i.tag===13)&&(l=i.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return i;i=i.return}while(i!==null);return null}function dv(i,l,h,x,_){return(i.mode&1)===0?(i===l?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(l=ya(-1,1),l.tag=2,Ya(h,l,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=_,i)}var rT=D.ReactCurrentOwner,Mn=!1;function An(i,l,h,x){l.child=i===null?Fg(l,null,h,x):Uo(l,i.child,h,x)}function hv(i,l,h,x,_){h=h.render;var k=l.ref;return zo(l,_),x=q0(i,l,h,x,k,_),h=Y0(),i!==null&&!Mn?(l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~_,wa(i,l,_)):(pr&&h&&F0(l),l.flags|=1,An(i,l,x,_),l.child)}function pv(i,l,h,x,_){if(i===null){var k=h.type;return typeof k=="function"&&!Th(k)&&k.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(l.tag=15,l.type=k,mv(i,l,k,x,_)):(i=kf(h.type,null,x,l,l.mode,_),i.ref=l.ref,i.return=l,l.child=i)}if(k=i.child,(i.lanes&_)===0){var R=k.memoizedProps;if(h=h.compare,h=h!==null?h:tc,h(R,x)&&i.ref===l.ref)return wa(i,l,_)}return l.flags|=1,i=ri(k,x),i.ref=l.ref,i.return=l,l.child=i}function mv(i,l,h,x,_){if(i!==null){var k=i.memoizedProps;if(tc(k,x)&&i.ref===l.ref)if(Mn=!1,l.pendingProps=x=k,(i.lanes&_)!==0)(i.flags&131072)!==0&&(Mn=!0);else return l.lanes=i.lanes,wa(i,l,_)}return ah(i,l,h,x,_)}function xv(i,l,h){var x=l.pendingProps,_=x.children,k=i!==null?i.memoizedState:null;if(x.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},rr(Go,Kn),Kn|=h;else{if((h&1073741824)===0)return i=k!==null?k.baseLanes|h:h,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:i,cachePool:null,transitions:null},l.updateQueue=null,rr(Go,Kn),Kn|=i,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=k!==null?k.baseLanes:h,rr(Go,Kn),Kn|=x}else k!==null?(x=k.baseLanes|h,l.memoizedState=null):x=h,rr(Go,Kn),Kn|=x;return An(i,l,_,h),l.child}function gv(i,l){var h=l.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(l.flags|=512,l.flags|=2097152)}function ah(i,l,h,x,_){var k=Ln(h)?Ri:pn.current;return k=Oo(l,k),zo(l,_),h=q0(i,l,h,x,k,_),x=Y0(),i!==null&&!Mn?(l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~_,wa(i,l,_)):(pr&&x&&F0(l),l.flags|=1,An(i,l,h,_),l.child)}function vv(i,l,h,x,_){if(Ln(h)){var k=!0;Xu(l)}else k=!1;if(zo(l,_),l.stateNode===null)df(i,l),iv(l,h,x),rh(l,h,x,_),x=!0;else if(i===null){var R=l.stateNode,J=l.memoizedProps;R.props=J;var ae=R.context,ke=h.contextType;typeof ke=="object"&&ke!==null?ke=is(ke):(ke=Ln(h)?Ri:pn.current,ke=Oo(l,ke));var De=h.getDerivedStateFromProps,Re=typeof De=="function"||typeof R.getSnapshotBeforeUpdate=="function";Re||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(J!==x||ae!==ke)&&ov(l,R,x,ke),qa=!1;var Ae=l.memoizedState;R.state=Ae,rf(l,x,R,_),ae=l.memoizedState,J!==x||Ae!==ae||On.current||qa?(typeof De=="function"&&(th(l,h,De,x),ae=l.memoizedState),(J=qa||av(l,h,J,x,Ae,ae,ke))?(Re||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(l.flags|=4194308)):(typeof R.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=x,l.memoizedState=ae),R.props=x,R.state=ae,R.context=ke,x=J):(typeof R.componentDidMount=="function"&&(l.flags|=4194308),x=!1)}else{R=l.stateNode,Pg(i,l),J=l.memoizedProps,ke=l.type===l.elementType?J:ks(l.type,J),R.props=ke,Re=l.pendingProps,Ae=R.context,ae=h.contextType,typeof ae=="object"&&ae!==null?ae=is(ae):(ae=Ln(h)?Ri:pn.current,ae=Oo(l,ae));var We=h.getDerivedStateFromProps;(De=typeof We=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(J!==Re||Ae!==ae)&&ov(l,R,x,ae),qa=!1,Ae=l.memoizedState,R.state=Ae,rf(l,x,R,_);var Ge=l.memoizedState;J!==Re||Ae!==Ge||On.current||qa?(typeof We=="function"&&(th(l,h,We,x),Ge=l.memoizedState),(ke=qa||av(l,h,ke,x,Ae,Ge,ae)||!1)?(De||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(x,Ge,ae),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(x,Ge,ae)),typeof R.componentDidUpdate=="function"&&(l.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof R.componentDidUpdate!="function"||J===i.memoizedProps&&Ae===i.memoizedState||(l.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||J===i.memoizedProps&&Ae===i.memoizedState||(l.flags|=1024),l.memoizedProps=x,l.memoizedState=Ge),R.props=x,R.state=Ge,R.context=ae,x=ke):(typeof R.componentDidUpdate!="function"||J===i.memoizedProps&&Ae===i.memoizedState||(l.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||J===i.memoizedProps&&Ae===i.memoizedState||(l.flags|=1024),x=!1)}return ih(i,l,h,x,k,_)}function ih(i,l,h,x,_,k){gv(i,l);var R=(l.flags&128)!==0;if(!x&&!R)return _&&kg(l,h,!1),wa(i,l,k);x=l.stateNode,rT.current=l;var J=R&&typeof h.getDerivedStateFromError!="function"?null:x.render();return l.flags|=1,i!==null&&R?(l.child=Uo(l,i.child,null,k),l.child=Uo(l,null,J,k)):An(i,l,J,k),l.memoizedState=x.state,_&&kg(l,h,!0),l.child}function yv(i){var l=i.stateNode;l.pendingContext?_g(i,l.pendingContext,l.pendingContext!==l.context):l.context&&_g(i,l.context,!1),W0(i,l.containerInfo)}function wv(i,l,h,x,_){return Bo(),O0(_),l.flags|=256,An(i,l,h,x),l.child}var oh={dehydrated:null,treeContext:null,retryLane:0};function lh(i){return{baseLanes:i,cachePool:null,transitions:null}}function _v(i,l,h){var x=l.pendingProps,_=xr.current,k=!1,R=(l.flags&128)!==0,J;if((J=R)||(J=i!==null&&i.memoizedState===null?!1:(_&2)!==0),J?(k=!0,l.flags&=-129):(i===null||i.memoizedState!==null)&&(_|=1),rr(xr,_&1),i===null)return I0(l),i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((l.mode&1)===0?l.lanes=1:i.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(R=x.children,i=x.fallback,k?(x=l.mode,k=l.child,R={mode:"hidden",children:R},(x&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=R):k=bf(R,x,0,null),i=Wi(i,x,h,null),k.return=l,i.return=l,k.sibling=i,l.child=k,l.child.memoizedState=lh(h),l.memoizedState=oh,i):ch(l,R));if(_=i.memoizedState,_!==null&&(J=_.dehydrated,J!==null))return nT(i,l,R,x,J,_,h);if(k){k=x.fallback,R=l.mode,_=i.child,J=_.sibling;var ae={mode:"hidden",children:x.children};return(R&1)===0&&l.child!==_?(x=l.child,x.childLanes=0,x.pendingProps=ae,l.deletions=null):(x=ri(_,ae),x.subtreeFlags=_.subtreeFlags&14680064),J!==null?k=ri(J,k):(k=Wi(k,R,h,null),k.flags|=2),k.return=l,x.return=l,x.sibling=k,l.child=x,x=k,k=l.child,R=i.child.memoizedState,R=R===null?lh(h):{baseLanes:R.baseLanes|h,cachePool:null,transitions:R.transitions},k.memoizedState=R,k.childLanes=i.childLanes&~h,l.memoizedState=oh,x}return k=i.child,i=k.sibling,x=ri(k,{mode:"visible",children:x.children}),(l.mode&1)===0&&(x.lanes=h),x.return=l,x.sibling=null,i!==null&&(h=l.deletions,h===null?(l.deletions=[i],l.flags|=16):h.push(i)),l.child=x,l.memoizedState=null,x}function ch(i,l){return l=bf({mode:"visible",children:l},i.mode,0,null),l.return=i,i.child=l}function ff(i,l,h,x){return x!==null&&O0(x),Uo(l,i.child,null,h),i=ch(l,l.pendingProps.children),i.flags|=2,l.memoizedState=null,i}function nT(i,l,h,x,_,k,R){if(h)return l.flags&256?(l.flags&=-257,x=nh(Error(r(422))),ff(i,l,R,x)):l.memoizedState!==null?(l.child=i.child,l.flags|=128,null):(k=x.fallback,_=l.mode,x=bf({mode:"visible",children:x.children},_,0,null),k=Wi(k,_,R,null),k.flags|=2,x.return=l,k.return=l,x.sibling=k,l.child=x,(l.mode&1)!==0&&Uo(l,i.child,null,R),l.child.memoizedState=lh(R),l.memoizedState=oh,k);if((l.mode&1)===0)return ff(i,l,R,null);if(_.data==="$!"){if(x=_.nextSibling&&_.nextSibling.dataset,x)var J=x.dgst;return x=J,k=Error(r(419)),x=nh(k,x,void 0),ff(i,l,R,x)}if(J=(R&i.childLanes)!==0,Mn||J){if(x=Qr,x!==null){switch(R&-R){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(x.suspendedLanes|R))!==0?0:_,_!==0&&_!==k.retryLane&&(k.retryLane=_,va(i,_),Ts(x,i,_,-1))}return Eh(),x=nh(Error(r(421))),ff(i,l,R,x)}return _.data==="$?"?(l.flags|=128,l.child=i.child,l=xT.bind(null,i),_._reactRetry=l,null):(i=k.treeContext,Xn=Ha(_.nextSibling),Gn=l,pr=!0,Ss=null,i!==null&&(ss[as++]=xa,ss[as++]=ga,ss[as++]=Pi,xa=i.id,ga=i.overflow,Pi=l),l=ch(l,x.children),l.flags|=4096,l)}function Sv(i,l,h){i.lanes|=l;var x=i.alternate;x!==null&&(x.lanes|=l),U0(i.return,l,h)}function uh(i,l,h,x,_){var k=i.memoizedState;k===null?i.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:_}:(k.isBackwards=l,k.rendering=null,k.renderingStartTime=0,k.last=x,k.tail=h,k.tailMode=_)}function kv(i,l,h){var x=l.pendingProps,_=x.revealOrder,k=x.tail;if(An(i,l,x.children,h),x=xr.current,(x&2)!==0)x=x&1|2,l.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=l.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Sv(i,h,l);else if(i.tag===19)Sv(i,h,l);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break e;for(;i.sibling===null;){if(i.return===null||i.return===l)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}x&=1}if(rr(xr,x),(l.mode&1)===0)l.memoizedState=null;else switch(_){case"forwards":for(h=l.child,_=null;h!==null;)i=h.alternate,i!==null&&nf(i)===null&&(_=h),h=h.sibling;h=_,h===null?(_=l.child,l.child=null):(_=h.sibling,h.sibling=null),uh(l,!1,_,h,k);break;case"backwards":for(h=null,_=l.child,l.child=null;_!==null;){if(i=_.alternate,i!==null&&nf(i)===null){l.child=_;break}i=_.sibling,_.sibling=h,h=_,_=i}uh(l,!0,h,null,k);break;case"together":uh(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function df(i,l){(l.mode&1)===0&&i!==null&&(i.alternate=null,l.alternate=null,l.flags|=2)}function wa(i,l,h){if(i!==null&&(l.dependencies=i.dependencies),Bi|=l.lanes,(h&l.childLanes)===0)return null;if(i!==null&&l.child!==i.child)throw Error(r(153));if(l.child!==null){for(i=l.child,h=ri(i,i.pendingProps),l.child=h,h.return=l;i.sibling!==null;)i=i.sibling,h=h.sibling=ri(i,i.pendingProps),h.return=l;h.sibling=null}return l.child}function sT(i,l,h){switch(l.tag){case 3:yv(l),Bo();break;case 5:Lg(l);break;case 1:Ln(l.type)&&Xu(l);break;case 4:W0(l,l.stateNode.containerInfo);break;case 10:var x=l.type._context,_=l.memoizedProps.value;rr(Zu,x._currentValue),x._currentValue=_;break;case 13:if(x=l.memoizedState,x!==null)return x.dehydrated!==null?(rr(xr,xr.current&1),l.flags|=128,null):(h&l.child.childLanes)!==0?_v(i,l,h):(rr(xr,xr.current&1),i=wa(i,l,h),i!==null?i.sibling:null);rr(xr,xr.current&1);break;case 19:if(x=(h&l.childLanes)!==0,(i.flags&128)!==0){if(x)return kv(i,l,h);l.flags|=128}if(_=l.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),rr(xr,xr.current),x)break;return null;case 22:case 23:return l.lanes=0,xv(i,l,h)}return wa(i,l,h)}var bv,fh,Ev,Tv;bv=function(i,l){for(var h=l.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},fh=function(){},Ev=function(i,l,h,x){var _=i.memoizedProps;if(_!==x){i=l.stateNode,Li(Xs.current);var k=null;switch(h){case"input":_=Ie(i,_),x=Ie(i,x),k=[];break;case"select":_=ee({},_,{value:void 0}),x=ee({},x,{value:void 0}),k=[];break;case"textarea":_=et(i,_),x=et(i,x),k=[];break;default:typeof _.onClick!="function"&&typeof x.onClick=="function"&&(i.onclick=Vu)}Oa(h,x);var R;h=null;for(ke in _)if(!x.hasOwnProperty(ke)&&_.hasOwnProperty(ke)&&_[ke]!=null)if(ke==="style"){var J=_[ke];for(R in J)J.hasOwnProperty(R)&&(h||(h={}),h[R]="")}else ke!=="dangerouslySetInnerHTML"&&ke!=="children"&&ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&ke!=="autoFocus"&&(s.hasOwnProperty(ke)?k||(k=[]):(k=k||[]).push(ke,null));for(ke in x){var ae=x[ke];if(J=_?.[ke],x.hasOwnProperty(ke)&&ae!==J&&(ae!=null||J!=null))if(ke==="style")if(J){for(R in J)!J.hasOwnProperty(R)||ae&&ae.hasOwnProperty(R)||(h||(h={}),h[R]="");for(R in ae)ae.hasOwnProperty(R)&&J[R]!==ae[R]&&(h||(h={}),h[R]=ae[R])}else h||(k||(k=[]),k.push(ke,h)),h=ae;else ke==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,J=J?J.__html:void 0,ae!=null&&J!==ae&&(k=k||[]).push(ke,ae)):ke==="children"?typeof ae!="string"&&typeof ae!="number"||(k=k||[]).push(ke,""+ae):ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&(s.hasOwnProperty(ke)?(ae!=null&&ke==="onScroll"&&ir("scroll",i),k||J===ae||(k=[])):(k=k||[]).push(ke,ae))}h&&(k=k||[]).push("style",h);var ke=k;(l.updateQueue=ke)&&(l.flags|=4)}},Tv=function(i,l,h,x){h!==x&&(l.flags|=4)};function xc(i,l){if(!pr)switch(i.tailMode){case"hidden":l=i.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?l||i.tail===null?i.tail=null:i.tail.sibling=null:x.sibling=null}}function xn(i){var l=i.alternate!==null&&i.alternate.child===i.child,h=0,x=0;if(l)for(var _=i.child;_!==null;)h|=_.lanes|_.childLanes,x|=_.subtreeFlags&14680064,x|=_.flags&14680064,_.return=i,_=_.sibling;else for(_=i.child;_!==null;)h|=_.lanes|_.childLanes,x|=_.subtreeFlags,x|=_.flags,_.return=i,_=_.sibling;return i.subtreeFlags|=x,i.childLanes=h,l}function aT(i,l,h){var x=l.pendingProps;switch(R0(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xn(l),null;case 1:return Ln(l.type)&&Gu(),xn(l),null;case 3:return x=l.stateNode,Wo(),or(On),or(pn),G0(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(i===null||i.child===null)&&(Ju(l)?l.flags|=4:i===null||i.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Ss!==null&&(Sh(Ss),Ss=null))),fh(i,l),xn(l),null;case 5:V0(l);var _=Li(fc.current);if(h=l.type,i!==null&&l.stateNode!=null)Ev(i,l,h,x,_),i.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!x){if(l.stateNode===null)throw Error(r(166));return xn(l),null}if(i=Li(Xs.current),Ju(l)){x=l.stateNode,h=l.type;var k=l.memoizedProps;switch(x[Gs]=l,x[ic]=k,i=(l.mode&1)!==0,h){case"dialog":ir("cancel",x),ir("close",x);break;case"iframe":case"object":case"embed":ir("load",x);break;case"video":case"audio":for(_=0;_<nc.length;_++)ir(nc[_],x);break;case"source":ir("error",x);break;case"img":case"image":case"link":ir("error",x),ir("load",x);break;case"details":ir("toggle",x);break;case"input":ue(x,k),ir("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!k.multiple},ir("invalid",x);break;case"textarea":tt(x,k),ir("invalid",x)}Oa(h,k),_=null;for(var R in k)if(k.hasOwnProperty(R)){var J=k[R];R==="children"?typeof J=="string"?x.textContent!==J&&(k.suppressHydrationWarning!==!0&&Wu(x.textContent,J,i),_=["children",J]):typeof J=="number"&&x.textContent!==""+J&&(k.suppressHydrationWarning!==!0&&Wu(x.textContent,J,i),_=["children",""+J]):s.hasOwnProperty(R)&&J!=null&&R==="onScroll"&&ir("scroll",x)}switch(h){case"input":te(x),je(x,k,!0);break;case"textarea":te(x),Ye(x);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(x.onclick=Vu)}x=_,l.updateQueue=x,x!==null&&(l.flags|=4)}else{R=_.nodeType===9?_:_.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Tt(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=R.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof x.is=="string"?i=R.createElement(h,{is:x.is}):(i=R.createElement(h),h==="select"&&(R=i,x.multiple?R.multiple=!0:x.size&&(R.size=x.size))):i=R.createElementNS(i,h),i[Gs]=l,i[ic]=x,bv(i,l,!1,!1),l.stateNode=i;e:{switch(R=ji(h,x),h){case"dialog":ir("cancel",i),ir("close",i),_=x;break;case"iframe":case"object":case"embed":ir("load",i),_=x;break;case"video":case"audio":for(_=0;_<nc.length;_++)ir(nc[_],i);_=x;break;case"source":ir("error",i),_=x;break;case"img":case"image":case"link":ir("error",i),ir("load",i),_=x;break;case"details":ir("toggle",i),_=x;break;case"input":ue(i,x),_=Ie(i,x),ir("invalid",i);break;case"option":_=x;break;case"select":i._wrapperState={wasMultiple:!!x.multiple},_=ee({},x,{value:void 0}),ir("invalid",i);break;case"textarea":tt(i,x),_=et(i,x),ir("invalid",i);break;default:_=x}Oa(h,_),J=_;for(k in J)if(J.hasOwnProperty(k)){var ae=J[k];k==="style"?ns(i,ae):k==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&an(i,ae)):k==="children"?typeof ae=="string"?(h!=="textarea"||ae!=="")&&at(i,ae):typeof ae=="number"&&at(i,""+ae):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(s.hasOwnProperty(k)?ae!=null&&k==="onScroll"&&ir("scroll",i):ae!=null&&b(i,k,ae,R))}switch(h){case"input":te(i),je(i,x,!1);break;case"textarea":te(i),Ye(i);break;case"option":x.value!=null&&i.setAttribute("value",""+Y(x.value));break;case"select":i.multiple=!!x.multiple,k=x.value,k!=null?ft(i,!!x.multiple,k,!1):x.defaultValue!=null&&ft(i,!!x.multiple,x.defaultValue,!0);break;default:typeof _.onClick=="function"&&(i.onclick=Vu)}switch(h){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return xn(l),null;case 6:if(i&&l.stateNode!=null)Tv(i,l,i.memoizedProps,x);else{if(typeof x!="string"&&l.stateNode===null)throw Error(r(166));if(h=Li(fc.current),Li(Xs.current),Ju(l)){if(x=l.stateNode,h=l.memoizedProps,x[Gs]=l,(k=x.nodeValue!==h)&&(i=Gn,i!==null))switch(i.tag){case 3:Wu(x.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Wu(x.nodeValue,h,(i.mode&1)!==0)}k&&(l.flags|=4)}else x=(h.nodeType===9?h:h.ownerDocument).createTextNode(x),x[Gs]=l,l.stateNode=x}return xn(l),null;case 13:if(or(xr),x=l.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(pr&&Xn!==null&&(l.mode&1)!==0&&(l.flags&128)===0)Ag(),Bo(),l.flags|=98560,k=!1;else if(k=Ju(l),x!==null&&x.dehydrated!==null){if(i===null){if(!k)throw Error(r(318));if(k=l.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(r(317));k[Gs]=l}else Bo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;xn(l),k=!1}else Ss!==null&&(Sh(Ss),Ss=null),k=!0;if(!k)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=h,l):(x=x!==null,x!==(i!==null&&i.memoizedState!==null)&&x&&(l.child.flags|=8192,(l.mode&1)!==0&&(i===null||(xr.current&1)!==0?Vr===0&&(Vr=3):Eh())),l.updateQueue!==null&&(l.flags|=4),xn(l),null);case 4:return Wo(),fh(i,l),i===null&&sc(l.stateNode.containerInfo),xn(l),null;case 10:return B0(l.type._context),xn(l),null;case 17:return Ln(l.type)&&Gu(),xn(l),null;case 19:if(or(xr),k=l.memoizedState,k===null)return xn(l),null;if(x=(l.flags&128)!==0,R=k.rendering,R===null)if(x)xc(k,!1);else{if(Vr!==0||i!==null&&(i.flags&128)!==0)for(i=l.child;i!==null;){if(R=nf(i),R!==null){for(l.flags|=128,xc(k,!1),x=R.updateQueue,x!==null&&(l.updateQueue=x,l.flags|=4),l.subtreeFlags=0,x=h,h=l.child;h!==null;)k=h,i=x,k.flags&=14680066,R=k.alternate,R===null?(k.childLanes=0,k.lanes=i,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=R.childLanes,k.lanes=R.lanes,k.child=R.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=R.memoizedProps,k.memoizedState=R.memoizedState,k.updateQueue=R.updateQueue,k.type=R.type,i=R.dependencies,k.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return rr(xr,xr.current&1|2),l.child}i=i.sibling}k.tail!==null&&Pe()>Xo&&(l.flags|=128,x=!0,xc(k,!1),l.lanes=4194304)}else{if(!x)if(i=nf(R),i!==null){if(l.flags|=128,x=!0,h=i.updateQueue,h!==null&&(l.updateQueue=h,l.flags|=4),xc(k,!0),k.tail===null&&k.tailMode==="hidden"&&!R.alternate&&!pr)return xn(l),null}else 2*Pe()-k.renderingStartTime>Xo&&h!==1073741824&&(l.flags|=128,x=!0,xc(k,!1),l.lanes=4194304);k.isBackwards?(R.sibling=l.child,l.child=R):(h=k.last,h!==null?h.sibling=R:l.child=R,k.last=R)}return k.tail!==null?(l=k.tail,k.rendering=l,k.tail=l.sibling,k.renderingStartTime=Pe(),l.sibling=null,h=xr.current,rr(xr,x?h&1|2:h&1),l):(xn(l),null);case 22:case 23:return bh(),x=l.memoizedState!==null,i!==null&&i.memoizedState!==null!==x&&(l.flags|=8192),x&&(l.mode&1)!==0?(Kn&1073741824)!==0&&(xn(l),l.subtreeFlags&6&&(l.flags|=8192)):xn(l),null;case 24:return null;case 25:return null}throw Error(r(156,l.tag))}function iT(i,l){switch(R0(l),l.tag){case 1:return Ln(l.type)&&Gu(),i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 3:return Wo(),or(On),or(pn),G0(),i=l.flags,(i&65536)!==0&&(i&128)===0?(l.flags=i&-65537|128,l):null;case 5:return V0(l),null;case 13:if(or(xr),i=l.memoizedState,i!==null&&i.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Bo()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 19:return or(xr),null;case 4:return Wo(),null;case 10:return B0(l.type._context),null;case 22:case 23:return bh(),null;case 24:return null;default:return null}}var hf=!1,gn=!1,oT=typeof WeakSet=="function"?WeakSet:Set,He=null;function Ho(i,l){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(x){wr(i,l,x)}else h.current=null}function dh(i,l,h){try{h()}catch(x){wr(i,l,x)}}var Cv=!1;function lT(i,l){if(b0=Fu,i=ag(),x0(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var _=x.anchorOffset,k=x.focusNode;x=x.focusOffset;try{h.nodeType,k.nodeType}catch{h=null;break e}var R=0,J=-1,ae=-1,ke=0,De=0,Re=i,Ae=null;t:for(;;){for(var We;Re!==h||_!==0&&Re.nodeType!==3||(J=R+_),Re!==k||x!==0&&Re.nodeType!==3||(ae=R+x),Re.nodeType===3&&(R+=Re.nodeValue.length),(We=Re.firstChild)!==null;)Ae=Re,Re=We;for(;;){if(Re===i)break t;if(Ae===h&&++ke===_&&(J=R),Ae===k&&++De===x&&(ae=R),(We=Re.nextSibling)!==null)break;Re=Ae,Ae=Re.parentNode}Re=We}h=J===-1||ae===-1?null:{start:J,end:ae}}else h=null}h=h||{start:0,end:0}}else h=null;for(E0={focusedElem:i,selectionRange:h},Fu=!1,He=l;He!==null;)if(l=He,i=l.child,(l.subtreeFlags&1028)!==0&&i!==null)i.return=l,He=i;else for(;He!==null;){l=He;try{var Ge=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Ge!==null){var Xe=Ge.memoizedProps,Pr=Ge.memoizedState,pe=l.stateNode,ie=pe.getSnapshotBeforeUpdate(l.elementType===l.type?Xe:ks(l.type,Xe),Pr);pe.__reactInternalSnapshotBeforeUpdate=ie}break;case 3:var xe=l.stateNode.containerInfo;xe.nodeType===1?xe.textContent="":xe.nodeType===9&&xe.documentElement&&xe.removeChild(xe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Me){wr(l,l.return,Me)}if(i=l.sibling,i!==null){i.return=l.return,He=i;break}He=l.return}return Ge=Cv,Cv=!1,Ge}function gc(i,l,h){var x=l.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var _=x=x.next;do{if((_.tag&i)===i){var k=_.destroy;_.destroy=void 0,k!==void 0&&dh(l,h,k)}_=_.next}while(_!==x)}}function pf(i,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var h=l=l.next;do{if((h.tag&i)===i){var x=h.create;h.destroy=x()}h=h.next}while(h!==l)}}function hh(i){var l=i.ref;if(l!==null){var h=i.stateNode;switch(i.tag){case 5:i=h;break;default:i=h}typeof l=="function"?l(i):l.current=i}}function Nv(i){var l=i.alternate;l!==null&&(i.alternate=null,Nv(l)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(l=i.stateNode,l!==null&&(delete l[Gs],delete l[ic],delete l[A0],delete l[VE],delete l[HE])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Av(i){return i.tag===5||i.tag===3||i.tag===4}function jv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Av(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function ph(i,l,h){var x=i.tag;if(x===5||x===6)i=i.stateNode,l?h.nodeType===8?h.parentNode.insertBefore(i,l):h.insertBefore(i,l):(h.nodeType===8?(l=h.parentNode,l.insertBefore(i,h)):(l=h,l.appendChild(i)),h=h._reactRootContainer,h!=null||l.onclick!==null||(l.onclick=Vu));else if(x!==4&&(i=i.child,i!==null))for(ph(i,l,h),i=i.sibling;i!==null;)ph(i,l,h),i=i.sibling}function mh(i,l,h){var x=i.tag;if(x===5||x===6)i=i.stateNode,l?h.insertBefore(i,l):h.appendChild(i);else if(x!==4&&(i=i.child,i!==null))for(mh(i,l,h),i=i.sibling;i!==null;)mh(i,l,h),i=i.sibling}var on=null,bs=!1;function Ja(i,l,h){for(h=h.child;h!==null;)Dv(i,l,h),h=h.sibling}function Dv(i,l,h){if(Yr&&typeof Yr.onCommitFiberUnmount=="function")try{Yr.onCommitFiberUnmount(Hs,h)}catch{}switch(h.tag){case 5:gn||Ho(h,l);case 6:var x=on,_=bs;on=null,Ja(i,l,h),on=x,bs=_,on!==null&&(bs?(i=on,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):on.removeChild(h.stateNode));break;case 18:on!==null&&(bs?(i=on,h=h.stateNode,i.nodeType===8?N0(i.parentNode,h):i.nodeType===1&&N0(i,h),ql(i)):N0(on,h.stateNode));break;case 4:x=on,_=bs,on=h.stateNode.containerInfo,bs=!0,Ja(i,l,h),on=x,bs=_;break;case 0:case 11:case 14:case 15:if(!gn&&(x=h.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){_=x=x.next;do{var k=_,R=k.destroy;k=k.tag,R!==void 0&&((k&2)!==0||(k&4)!==0)&&dh(h,l,R),_=_.next}while(_!==x)}Ja(i,l,h);break;case 1:if(!gn&&(Ho(h,l),x=h.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=h.memoizedProps,x.state=h.memoizedState,x.componentWillUnmount()}catch(J){wr(h,l,J)}Ja(i,l,h);break;case 21:Ja(i,l,h);break;case 22:h.mode&1?(gn=(x=gn)||h.memoizedState!==null,Ja(i,l,h),gn=x):Ja(i,l,h);break;default:Ja(i,l,h)}}function Fv(i){var l=i.updateQueue;if(l!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new oT),l.forEach(function(x){var _=gT.bind(null,i,x);h.has(x)||(h.add(x),x.then(_,_))})}}function Es(i,l){var h=l.deletions;if(h!==null)for(var x=0;x<h.length;x++){var _=h[x];try{var k=i,R=l,J=R;e:for(;J!==null;){switch(J.tag){case 5:on=J.stateNode,bs=!1;break e;case 3:on=J.stateNode.containerInfo,bs=!0;break e;case 4:on=J.stateNode.containerInfo,bs=!0;break e}J=J.return}if(on===null)throw Error(r(160));Dv(k,R,_),on=null,bs=!1;var ae=_.alternate;ae!==null&&(ae.return=null),_.return=null}catch(ke){wr(_,l,ke)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Rv(l,i),l=l.sibling}function Rv(i,l){var h=i.alternate,x=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Es(l,i),qs(i),x&4){try{gc(3,i,i.return),pf(3,i)}catch(Xe){wr(i,i.return,Xe)}try{gc(5,i,i.return)}catch(Xe){wr(i,i.return,Xe)}}break;case 1:Es(l,i),qs(i),x&512&&h!==null&&Ho(h,h.return);break;case 5:if(Es(l,i),qs(i),x&512&&h!==null&&Ho(h,h.return),i.flags&32){var _=i.stateNode;try{at(_,"")}catch(Xe){wr(i,i.return,Xe)}}if(x&4&&(_=i.stateNode,_!=null)){var k=i.memoizedProps,R=h!==null?h.memoizedProps:k,J=i.type,ae=i.updateQueue;if(i.updateQueue=null,ae!==null)try{J==="input"&&k.type==="radio"&&k.name!=null&&ge(_,k),ji(J,R);var ke=ji(J,k);for(R=0;R<ae.length;R+=2){var De=ae[R],Re=ae[R+1];De==="style"?ns(_,Re):De==="dangerouslySetInnerHTML"?an(_,Re):De==="children"?at(_,Re):b(_,De,Re,ke)}switch(J){case"input":_e(_,k);break;case"textarea":lt(_,k);break;case"select":var Ae=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!k.multiple;var We=k.value;We!=null?ft(_,!!k.multiple,We,!1):Ae!==!!k.multiple&&(k.defaultValue!=null?ft(_,!!k.multiple,k.defaultValue,!0):ft(_,!!k.multiple,k.multiple?[]:"",!1))}_[ic]=k}catch(Xe){wr(i,i.return,Xe)}}break;case 6:if(Es(l,i),qs(i),x&4){if(i.stateNode===null)throw Error(r(162));_=i.stateNode,k=i.memoizedProps;try{_.nodeValue=k}catch(Xe){wr(i,i.return,Xe)}}break;case 3:if(Es(l,i),qs(i),x&4&&h!==null&&h.memoizedState.isDehydrated)try{ql(l.containerInfo)}catch(Xe){wr(i,i.return,Xe)}break;case 4:Es(l,i),qs(i);break;case 13:Es(l,i),qs(i),_=i.child,_.flags&8192&&(k=_.memoizedState!==null,_.stateNode.isHidden=k,!k||_.alternate!==null&&_.alternate.memoizedState!==null||(vh=Pe())),x&4&&Fv(i);break;case 22:if(De=h!==null&&h.memoizedState!==null,i.mode&1?(gn=(ke=gn)||De,Es(l,i),gn=ke):Es(l,i),qs(i),x&8192){if(ke=i.memoizedState!==null,(i.stateNode.isHidden=ke)&&!De&&(i.mode&1)!==0)for(He=i,De=i.child;De!==null;){for(Re=He=De;He!==null;){switch(Ae=He,We=Ae.child,Ae.tag){case 0:case 11:case 14:case 15:gc(4,Ae,Ae.return);break;case 1:Ho(Ae,Ae.return);var Ge=Ae.stateNode;if(typeof Ge.componentWillUnmount=="function"){x=Ae,h=Ae.return;try{l=x,Ge.props=l.memoizedProps,Ge.state=l.memoizedState,Ge.componentWillUnmount()}catch(Xe){wr(x,h,Xe)}}break;case 5:Ho(Ae,Ae.return);break;case 22:if(Ae.memoizedState!==null){Ov(Re);continue}}We!==null?(We.return=Ae,He=We):Ov(Re)}De=De.sibling}e:for(De=null,Re=i;;){if(Re.tag===5){if(De===null){De=Re;try{_=Re.stateNode,ke?(k=_.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(J=Re.stateNode,ae=Re.memoizedProps.style,R=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,J.style.display=hr("display",R))}catch(Xe){wr(i,i.return,Xe)}}}else if(Re.tag===6){if(De===null)try{Re.stateNode.nodeValue=ke?"":Re.memoizedProps}catch(Xe){wr(i,i.return,Xe)}}else if((Re.tag!==22&&Re.tag!==23||Re.memoizedState===null||Re===i)&&Re.child!==null){Re.child.return=Re,Re=Re.child;continue}if(Re===i)break e;for(;Re.sibling===null;){if(Re.return===null||Re.return===i)break e;De===Re&&(De=null),Re=Re.return}De===Re&&(De=null),Re.sibling.return=Re.return,Re=Re.sibling}}break;case 19:Es(l,i),qs(i),x&4&&Fv(i);break;case 21:break;default:Es(l,i),qs(i)}}function qs(i){var l=i.flags;if(l&2){try{e:{for(var h=i.return;h!==null;){if(Av(h)){var x=h;break e}h=h.return}throw Error(r(160))}switch(x.tag){case 5:var _=x.stateNode;x.flags&32&&(at(_,""),x.flags&=-33);var k=jv(i);mh(i,k,_);break;case 3:case 4:var R=x.stateNode.containerInfo,J=jv(i);ph(i,J,R);break;default:throw Error(r(161))}}catch(ae){wr(i,i.return,ae)}i.flags&=-3}l&4096&&(i.flags&=-4097)}function cT(i,l,h){He=i,Pv(i)}function Pv(i,l,h){for(var x=(i.mode&1)!==0;He!==null;){var _=He,k=_.child;if(_.tag===22&&x){var R=_.memoizedState!==null||hf;if(!R){var J=_.alternate,ae=J!==null&&J.memoizedState!==null||gn;J=hf;var ke=gn;if(hf=R,(gn=ae)&&!ke)for(He=_;He!==null;)R=He,ae=R.child,R.tag===22&&R.memoizedState!==null?Lv(_):ae!==null?(ae.return=R,He=ae):Lv(_);for(;k!==null;)He=k,Pv(k),k=k.sibling;He=_,hf=J,gn=ke}Iv(i)}else(_.subtreeFlags&8772)!==0&&k!==null?(k.return=_,He=k):Iv(i)}}function Iv(i){for(;He!==null;){var l=He;if((l.flags&8772)!==0){var h=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:gn||pf(5,l);break;case 1:var x=l.stateNode;if(l.flags&4&&!gn)if(h===null)x.componentDidMount();else{var _=l.elementType===l.type?h.memoizedProps:ks(l.type,h.memoizedProps);x.componentDidUpdate(_,h.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var k=l.updateQueue;k!==null&&Og(l,k,x);break;case 3:var R=l.updateQueue;if(R!==null){if(h=null,l.child!==null)switch(l.child.tag){case 5:h=l.child.stateNode;break;case 1:h=l.child.stateNode}Og(l,R,h)}break;case 5:var J=l.stateNode;if(h===null&&l.flags&4){h=J;var ae=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&h.focus();break;case"img":ae.src&&(h.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var ke=l.alternate;if(ke!==null){var De=ke.memoizedState;if(De!==null){var Re=De.dehydrated;Re!==null&&ql(Re)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}gn||l.flags&512&&hh(l)}catch(Ae){wr(l,l.return,Ae)}}if(l===i){He=null;break}if(h=l.sibling,h!==null){h.return=l.return,He=h;break}He=l.return}}function Ov(i){for(;He!==null;){var l=He;if(l===i){He=null;break}var h=l.sibling;if(h!==null){h.return=l.return,He=h;break}He=l.return}}function Lv(i){for(;He!==null;){var l=He;try{switch(l.tag){case 0:case 11:case 15:var h=l.return;try{pf(4,l)}catch(ae){wr(l,h,ae)}break;case 1:var x=l.stateNode;if(typeof x.componentDidMount=="function"){var _=l.return;try{x.componentDidMount()}catch(ae){wr(l,_,ae)}}var k=l.return;try{hh(l)}catch(ae){wr(l,k,ae)}break;case 5:var R=l.return;try{hh(l)}catch(ae){wr(l,R,ae)}}}catch(ae){wr(l,l.return,ae)}if(l===i){He=null;break}var J=l.sibling;if(J!==null){J.return=l.return,He=J;break}He=l.return}}var uT=Math.ceil,mf=D.ReactCurrentDispatcher,xh=D.ReactCurrentOwner,ls=D.ReactCurrentBatchConfig,Lt=0,Qr=null,Mr=null,ln=0,Kn=0,Go=Ga(0),Vr=0,vc=null,Bi=0,xf=0,gh=0,yc=null,Bn=null,vh=0,Xo=1/0,_a=null,gf=!1,yh=null,Qa=null,vf=!1,Za=null,yf=0,wc=0,wh=null,wf=-1,_f=0;function jn(){return(Lt&6)!==0?Pe():wf!==-1?wf:wf=Pe()}function ei(i){return(i.mode&1)===0?1:(Lt&2)!==0&&ln!==0?ln&-ln:XE.transition!==null?(_f===0&&(_f=jx()),_f):(i=Wt,i!==0||(i=window.event,i=i===void 0?16:Bx(i.type)),i)}function Ts(i,l,h,x){if(50<wc)throw wc=0,wh=null,Error(r(185));Vl(i,h,x),((Lt&2)===0||i!==Qr)&&(i===Qr&&((Lt&2)===0&&(xf|=h),Vr===4&&ti(i,ln)),Un(i,x),h===1&&Lt===0&&(l.mode&1)===0&&(Xo=Pe()+500,Ku&&Ka()))}function Un(i,l){var h=i.callbackNode;Xb(i,l);var x=Au(i,i===Qr?ln:0);if(x===0)h!==null&&ze(h),i.callbackNode=null,i.callbackPriority=0;else if(l=x&-x,i.callbackPriority!==l){if(h!=null&&ze(h),l===1)i.tag===0?GE(Bv.bind(null,i)):bg(Bv.bind(null,i)),zE(function(){(Lt&6)===0&&Ka()}),h=null;else{switch(Dx(x)){case 1:h=qt;break;case 4:h=tr;break;case 16:h=Fr;break;case 536870912:h=Ma;break;default:h=Fr}h=Xv(h,Mv.bind(null,i))}i.callbackPriority=l,i.callbackNode=h}}function Mv(i,l){if(wf=-1,_f=0,(Lt&6)!==0)throw Error(r(327));var h=i.callbackNode;if(Ko()&&i.callbackNode!==h)return null;var x=Au(i,i===Qr?ln:0);if(x===0)return null;if((x&30)!==0||(x&i.expiredLanes)!==0||l)l=Sf(i,x);else{l=x;var _=Lt;Lt|=2;var k=$v();(Qr!==i||ln!==l)&&(_a=null,Xo=Pe()+500,$i(i,l));do try{hT();break}catch(J){Uv(i,J)}while(!0);M0(),mf.current=k,Lt=_,Mr!==null?l=0:(Qr=null,ln=0,l=Vr)}if(l!==0){if(l===2&&(_=e0(i),_!==0&&(x=_,l=_h(i,_))),l===1)throw h=vc,$i(i,0),ti(i,x),Un(i,Pe()),h;if(l===6)ti(i,x);else{if(_=i.current.alternate,(x&30)===0&&!fT(_)&&(l=Sf(i,x),l===2&&(k=e0(i),k!==0&&(x=k,l=_h(i,k))),l===1))throw h=vc,$i(i,0),ti(i,x),Un(i,Pe()),h;switch(i.finishedWork=_,i.finishedLanes=x,l){case 0:case 1:throw Error(r(345));case 2:zi(i,Bn,_a);break;case 3:if(ti(i,x),(x&130023424)===x&&(l=vh+500-Pe(),10<l)){if(Au(i,0)!==0)break;if(_=i.suspendedLanes,(_&x)!==x){jn(),i.pingedLanes|=i.suspendedLanes&_;break}i.timeoutHandle=C0(zi.bind(null,i,Bn,_a),l);break}zi(i,Bn,_a);break;case 4:if(ti(i,x),(x&4194240)===x)break;for(l=i.eventTimes,_=-1;0<x;){var R=31-Rr(x);k=1<<R,R=l[R],R>_&&(_=R),x&=~k}if(x=_,x=Pe()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*uT(x/1960))-x,10<x){i.timeoutHandle=C0(zi.bind(null,i,Bn,_a),x);break}zi(i,Bn,_a);break;case 5:zi(i,Bn,_a);break;default:throw Error(r(329))}}}return Un(i,Pe()),i.callbackNode===h?Mv.bind(null,i):null}function _h(i,l){var h=yc;return i.current.memoizedState.isDehydrated&&($i(i,l).flags|=256),i=Sf(i,l),i!==2&&(l=Bn,Bn=h,l!==null&&Sh(l)),i}function Sh(i){Bn===null?Bn=i:Bn.push.apply(Bn,i)}function fT(i){for(var l=i;;){if(l.flags&16384){var h=l.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var x=0;x<h.length;x++){var _=h[x],k=_.getSnapshot;_=_.value;try{if(!_s(k(),_))return!1}catch{return!1}}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function ti(i,l){for(l&=~gh,l&=~xf,i.suspendedLanes|=l,i.pingedLanes&=~l,i=i.expirationTimes;0<l;){var h=31-Rr(l),x=1<<h;i[h]=-1,l&=~x}}function Bv(i){if((Lt&6)!==0)throw Error(r(327));Ko();var l=Au(i,0);if((l&1)===0)return Un(i,Pe()),null;var h=Sf(i,l);if(i.tag!==0&&h===2){var x=e0(i);x!==0&&(l=x,h=_h(i,x))}if(h===1)throw h=vc,$i(i,0),ti(i,l),Un(i,Pe()),h;if(h===6)throw Error(r(345));return i.finishedWork=i.current.alternate,i.finishedLanes=l,zi(i,Bn,_a),Un(i,Pe()),null}function kh(i,l){var h=Lt;Lt|=1;try{return i(l)}finally{Lt=h,Lt===0&&(Xo=Pe()+500,Ku&&Ka())}}function Ui(i){Za!==null&&Za.tag===0&&(Lt&6)===0&&Ko();var l=Lt;Lt|=1;var h=ls.transition,x=Wt;try{if(ls.transition=null,Wt=1,i)return i()}finally{Wt=x,ls.transition=h,Lt=l,(Lt&6)===0&&Ka()}}function bh(){Kn=Go.current,or(Go)}function $i(i,l){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,$E(h)),Mr!==null)for(h=Mr.return;h!==null;){var x=h;switch(R0(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&Gu();break;case 3:Wo(),or(On),or(pn),G0();break;case 5:V0(x);break;case 4:Wo();break;case 13:or(xr);break;case 19:or(xr);break;case 10:B0(x.type._context);break;case 22:case 23:bh()}h=h.return}if(Qr=i,Mr=i=ri(i.current,null),ln=Kn=l,Vr=0,vc=null,gh=xf=Bi=0,Bn=yc=null,Oi!==null){for(l=0;l<Oi.length;l++)if(h=Oi[l],x=h.interleaved,x!==null){h.interleaved=null;var _=x.next,k=h.pending;if(k!==null){var R=k.next;k.next=_,x.next=R}h.pending=x}Oi=null}return i}function Uv(i,l){do{var h=Mr;try{if(M0(),sf.current=cf,af){for(var x=gr.memoizedState;x!==null;){var _=x.queue;_!==null&&(_.pending=null),x=x.next}af=!1}if(Mi=0,Jr=Wr=gr=null,dc=!1,hc=0,xh.current=null,h===null||h.return===null){Vr=1,vc=l,Mr=null;break}e:{var k=i,R=h.return,J=h,ae=l;if(l=ln,J.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var ke=ae,De=J,Re=De.tag;if((De.mode&1)===0&&(Re===0||Re===11||Re===15)){var Ae=De.alternate;Ae?(De.updateQueue=Ae.updateQueue,De.memoizedState=Ae.memoizedState,De.lanes=Ae.lanes):(De.updateQueue=null,De.memoizedState=null)}var We=fv(R);if(We!==null){We.flags&=-257,dv(We,R,J,k,l),We.mode&1&&uv(k,ke,l),l=We,ae=ke;var Ge=l.updateQueue;if(Ge===null){var Xe=new Set;Xe.add(ae),l.updateQueue=Xe}else Ge.add(ae);break e}else{if((l&1)===0){uv(k,ke,l),Eh();break e}ae=Error(r(426))}}else if(pr&&J.mode&1){var Pr=fv(R);if(Pr!==null){(Pr.flags&65536)===0&&(Pr.flags|=256),dv(Pr,R,J,k,l),O0(Vo(ae,J));break e}}k=ae=Vo(ae,J),Vr!==4&&(Vr=2),yc===null?yc=[k]:yc.push(k),k=R;do{switch(k.tag){case 3:k.flags|=65536,l&=-l,k.lanes|=l;var pe=lv(k,ae,l);Ig(k,pe);break e;case 1:J=ae;var ie=k.type,xe=k.stateNode;if((k.flags&128)===0&&(typeof ie.getDerivedStateFromError=="function"||xe!==null&&typeof xe.componentDidCatch=="function"&&(Qa===null||!Qa.has(xe)))){k.flags|=65536,l&=-l,k.lanes|=l;var Me=cv(k,J,l);Ig(k,Me);break e}}k=k.return}while(k!==null)}Wv(h)}catch(qe){l=qe,Mr===h&&h!==null&&(Mr=h=h.return);continue}break}while(!0)}function $v(){var i=mf.current;return mf.current=cf,i===null?cf:i}function Eh(){(Vr===0||Vr===3||Vr===2)&&(Vr=4),Qr===null||(Bi&268435455)===0&&(xf&268435455)===0||ti(Qr,ln)}function Sf(i,l){var h=Lt;Lt|=2;var x=$v();(Qr!==i||ln!==l)&&(_a=null,$i(i,l));do try{dT();break}catch(_){Uv(i,_)}while(!0);if(M0(),Lt=h,mf.current=x,Mr!==null)throw Error(r(261));return Qr=null,ln=0,Vr}function dT(){for(;Mr!==null;)zv(Mr)}function hT(){for(;Mr!==null&&!Ve();)zv(Mr)}function zv(i){var l=Gv(i.alternate,i,Kn);i.memoizedProps=i.pendingProps,l===null?Wv(i):Mr=l,xh.current=null}function Wv(i){var l=i;do{var h=l.alternate;if(i=l.return,(l.flags&32768)===0){if(h=aT(h,l,Kn),h!==null){Mr=h;return}}else{if(h=iT(h,l),h!==null){h.flags&=32767,Mr=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Vr=6,Mr=null;return}}if(l=l.sibling,l!==null){Mr=l;return}Mr=l=i}while(l!==null);Vr===0&&(Vr=5)}function zi(i,l,h){var x=Wt,_=ls.transition;try{ls.transition=null,Wt=1,pT(i,l,h,x)}finally{ls.transition=_,Wt=x}return null}function pT(i,l,h,x){do Ko();while(Za!==null);if((Lt&6)!==0)throw Error(r(327));h=i.finishedWork;var _=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(r(177));i.callbackNode=null,i.callbackPriority=0;var k=h.lanes|h.childLanes;if(Kb(i,k),i===Qr&&(Mr=Qr=null,ln=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||vf||(vf=!0,Xv(Fr,function(){return Ko(),null})),k=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||k){k=ls.transition,ls.transition=null;var R=Wt;Wt=1;var J=Lt;Lt|=4,xh.current=null,lT(i,h),Rv(h,i),PE(E0),Fu=!!b0,E0=b0=null,i.current=h,cT(h),Le(),Lt=J,Wt=R,ls.transition=k}else i.current=h;if(vf&&(vf=!1,Za=i,yf=_),k=i.pendingLanes,k===0&&(Qa=null),zl(h.stateNode),Un(i,Pe()),l!==null)for(x=i.onRecoverableError,h=0;h<l.length;h++)_=l[h],x(_.value,{componentStack:_.stack,digest:_.digest});if(gf)throw gf=!1,i=yh,yh=null,i;return(yf&1)!==0&&i.tag!==0&&Ko(),k=i.pendingLanes,(k&1)!==0?i===wh?wc++:(wc=0,wh=i):wc=0,Ka(),null}function Ko(){if(Za!==null){var i=Dx(yf),l=ls.transition,h=Wt;try{if(ls.transition=null,Wt=16>i?16:i,Za===null)var x=!1;else{if(i=Za,Za=null,yf=0,(Lt&6)!==0)throw Error(r(331));var _=Lt;for(Lt|=4,He=i.current;He!==null;){var k=He,R=k.child;if((He.flags&16)!==0){var J=k.deletions;if(J!==null){for(var ae=0;ae<J.length;ae++){var ke=J[ae];for(He=ke;He!==null;){var De=He;switch(De.tag){case 0:case 11:case 15:gc(8,De,k)}var Re=De.child;if(Re!==null)Re.return=De,He=Re;else for(;He!==null;){De=He;var Ae=De.sibling,We=De.return;if(Nv(De),De===ke){He=null;break}if(Ae!==null){Ae.return=We,He=Ae;break}He=We}}}var Ge=k.alternate;if(Ge!==null){var Xe=Ge.child;if(Xe!==null){Ge.child=null;do{var Pr=Xe.sibling;Xe.sibling=null,Xe=Pr}while(Xe!==null)}}He=k}}if((k.subtreeFlags&2064)!==0&&R!==null)R.return=k,He=R;else e:for(;He!==null;){if(k=He,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:gc(9,k,k.return)}var pe=k.sibling;if(pe!==null){pe.return=k.return,He=pe;break e}He=k.return}}var ie=i.current;for(He=ie;He!==null;){R=He;var xe=R.child;if((R.subtreeFlags&2064)!==0&&xe!==null)xe.return=R,He=xe;else e:for(R=ie;He!==null;){if(J=He,(J.flags&2048)!==0)try{switch(J.tag){case 0:case 11:case 15:pf(9,J)}}catch(qe){wr(J,J.return,qe)}if(J===R){He=null;break e}var Me=J.sibling;if(Me!==null){Me.return=J.return,He=Me;break e}He=J.return}}if(Lt=_,Ka(),Yr&&typeof Yr.onPostCommitFiberRoot=="function")try{Yr.onPostCommitFiberRoot(Hs,i)}catch{}x=!0}return x}finally{Wt=h,ls.transition=l}}return!1}function Vv(i,l,h){l=Vo(h,l),l=lv(i,l,1),i=Ya(i,l,1),l=jn(),i!==null&&(Vl(i,1,l),Un(i,l))}function wr(i,l,h){if(i.tag===3)Vv(i,i,h);else for(;l!==null;){if(l.tag===3){Vv(l,i,h);break}else if(l.tag===1){var x=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Qa===null||!Qa.has(x))){i=Vo(h,i),i=cv(l,i,1),l=Ya(l,i,1),i=jn(),l!==null&&(Vl(l,1,i),Un(l,i));break}}l=l.return}}function mT(i,l,h){var x=i.pingCache;x!==null&&x.delete(l),l=jn(),i.pingedLanes|=i.suspendedLanes&h,Qr===i&&(ln&h)===h&&(Vr===4||Vr===3&&(ln&130023424)===ln&&500>Pe()-vh?$i(i,0):gh|=h),Un(i,l)}function Hv(i,l){l===0&&((i.mode&1)===0?l=1:(l=Nu,Nu<<=1,(Nu&130023424)===0&&(Nu=4194304)));var h=jn();i=va(i,l),i!==null&&(Vl(i,l,h),Un(i,h))}function xT(i){var l=i.memoizedState,h=0;l!==null&&(h=l.retryLane),Hv(i,h)}function gT(i,l){var h=0;switch(i.tag){case 13:var x=i.stateNode,_=i.memoizedState;_!==null&&(h=_.retryLane);break;case 19:x=i.stateNode;break;default:throw Error(r(314))}x!==null&&x.delete(l),Hv(i,h)}var Gv;Gv=function(i,l,h){if(i!==null)if(i.memoizedProps!==l.pendingProps||On.current)Mn=!0;else{if((i.lanes&h)===0&&(l.flags&128)===0)return Mn=!1,sT(i,l,h);Mn=(i.flags&131072)!==0}else Mn=!1,pr&&(l.flags&1048576)!==0&&Eg(l,Yu,l.index);switch(l.lanes=0,l.tag){case 2:var x=l.type;df(i,l),i=l.pendingProps;var _=Oo(l,pn.current);zo(l,h),_=q0(null,l,x,i,_,h);var k=Y0();return l.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Ln(x)?(k=!0,Xu(l)):k=!1,l.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,z0(l),_.updater=uf,l.stateNode=_,_._reactInternals=l,rh(l,x,i,h),l=ih(null,l,x,!0,k,h)):(l.tag=0,pr&&k&&F0(l),An(null,l,_,h),l=l.child),l;case 16:x=l.elementType;e:{switch(df(i,l),i=l.pendingProps,_=x._init,x=_(x._payload),l.type=x,_=l.tag=yT(x),i=ks(x,i),_){case 0:l=ah(null,l,x,i,h);break e;case 1:l=vv(null,l,x,i,h);break e;case 11:l=hv(null,l,x,i,h);break e;case 14:l=pv(null,l,x,ks(x.type,i),h);break e}throw Error(r(306,x,""))}return l;case 0:return x=l.type,_=l.pendingProps,_=l.elementType===x?_:ks(x,_),ah(i,l,x,_,h);case 1:return x=l.type,_=l.pendingProps,_=l.elementType===x?_:ks(x,_),vv(i,l,x,_,h);case 3:e:{if(yv(l),i===null)throw Error(r(387));x=l.pendingProps,k=l.memoizedState,_=k.element,Pg(i,l),rf(l,x,null,h);var R=l.memoizedState;if(x=R.element,k.isDehydrated)if(k={element:x,isDehydrated:!1,cache:R.cache,pendingSuspenseBoundaries:R.pendingSuspenseBoundaries,transitions:R.transitions},l.updateQueue.baseState=k,l.memoizedState=k,l.flags&256){_=Vo(Error(r(423)),l),l=wv(i,l,x,h,_);break e}else if(x!==_){_=Vo(Error(r(424)),l),l=wv(i,l,x,h,_);break e}else for(Xn=Ha(l.stateNode.containerInfo.firstChild),Gn=l,pr=!0,Ss=null,h=Fg(l,null,x,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Bo(),x===_){l=wa(i,l,h);break e}An(i,l,x,h)}l=l.child}return l;case 5:return Lg(l),i===null&&I0(l),x=l.type,_=l.pendingProps,k=i!==null?i.memoizedProps:null,R=_.children,T0(x,_)?R=null:k!==null&&T0(x,k)&&(l.flags|=32),gv(i,l),An(i,l,R,h),l.child;case 6:return i===null&&I0(l),null;case 13:return _v(i,l,h);case 4:return W0(l,l.stateNode.containerInfo),x=l.pendingProps,i===null?l.child=Uo(l,null,x,h):An(i,l,x,h),l.child;case 11:return x=l.type,_=l.pendingProps,_=l.elementType===x?_:ks(x,_),hv(i,l,x,_,h);case 7:return An(i,l,l.pendingProps,h),l.child;case 8:return An(i,l,l.pendingProps.children,h),l.child;case 12:return An(i,l,l.pendingProps.children,h),l.child;case 10:e:{if(x=l.type._context,_=l.pendingProps,k=l.memoizedProps,R=_.value,rr(Zu,x._currentValue),x._currentValue=R,k!==null)if(_s(k.value,R)){if(k.children===_.children&&!On.current){l=wa(i,l,h);break e}}else for(k=l.child,k!==null&&(k.return=l);k!==null;){var J=k.dependencies;if(J!==null){R=k.child;for(var ae=J.firstContext;ae!==null;){if(ae.context===x){if(k.tag===1){ae=ya(-1,h&-h),ae.tag=2;var ke=k.updateQueue;if(ke!==null){ke=ke.shared;var De=ke.pending;De===null?ae.next=ae:(ae.next=De.next,De.next=ae),ke.pending=ae}}k.lanes|=h,ae=k.alternate,ae!==null&&(ae.lanes|=h),U0(k.return,h,l),J.lanes|=h;break}ae=ae.next}}else if(k.tag===10)R=k.type===l.type?null:k.child;else if(k.tag===18){if(R=k.return,R===null)throw Error(r(341));R.lanes|=h,J=R.alternate,J!==null&&(J.lanes|=h),U0(R,h,l),R=k.sibling}else R=k.child;if(R!==null)R.return=k;else for(R=k;R!==null;){if(R===l){R=null;break}if(k=R.sibling,k!==null){k.return=R.return,R=k;break}R=R.return}k=R}An(i,l,_.children,h),l=l.child}return l;case 9:return _=l.type,x=l.pendingProps.children,zo(l,h),_=is(_),x=x(_),l.flags|=1,An(i,l,x,h),l.child;case 14:return x=l.type,_=ks(x,l.pendingProps),_=ks(x.type,_),pv(i,l,x,_,h);case 15:return mv(i,l,l.type,l.pendingProps,h);case 17:return x=l.type,_=l.pendingProps,_=l.elementType===x?_:ks(x,_),df(i,l),l.tag=1,Ln(x)?(i=!0,Xu(l)):i=!1,zo(l,h),iv(l,x,_),rh(l,x,_,h),ih(null,l,x,!0,i,h);case 19:return kv(i,l,h);case 22:return xv(i,l,h)}throw Error(r(156,l.tag))};function Xv(i,l){return Fe(i,l)}function vT(i,l,h,x){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cs(i,l,h,x){return new vT(i,l,h,x)}function Th(i){return i=i.prototype,!(!i||!i.isReactComponent)}function yT(i){if(typeof i=="function")return Th(i)?1:0;if(i!=null){if(i=i.$$typeof,i===P)return 11;if(i===ce)return 14}return 2}function ri(i,l){var h=i.alternate;return h===null?(h=cs(i.tag,l,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=l,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,l=i.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function kf(i,l,h,x,_,k){var R=2;if(x=i,typeof i=="function")Th(i)&&(R=1);else if(typeof i=="string")R=5;else e:switch(i){case T:return Wi(h.children,_,k,l);case U:R=8,_|=8;break;case z:return i=cs(12,h,l,_|2),i.elementType=z,i.lanes=k,i;case se:return i=cs(13,h,l,_),i.elementType=se,i.lanes=k,i;case me:return i=cs(19,h,l,_),i.elementType=me,i.lanes=k,i;case de:return bf(h,_,k,l);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Z:R=10;break e;case re:R=9;break e;case P:R=11;break e;case ce:R=14;break e;case fe:R=16,x=null;break e}throw Error(r(130,i==null?i:typeof i,""))}return l=cs(R,h,l,_),l.elementType=i,l.type=x,l.lanes=k,l}function Wi(i,l,h,x){return i=cs(7,i,x,l),i.lanes=h,i}function bf(i,l,h,x){return i=cs(22,i,x,l),i.elementType=de,i.lanes=h,i.stateNode={isHidden:!1},i}function Ch(i,l,h){return i=cs(6,i,null,l),i.lanes=h,i}function Nh(i,l,h){return l=cs(4,i.children!==null?i.children:[],i.key,l),l.lanes=h,l.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},l}function wT(i,l,h,x,_){this.tag=l,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=t0(0),this.expirationTimes=t0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=t0(0),this.identifierPrefix=x,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Ah(i,l,h,x,_,k,R,J,ae){return i=new wT(i,l,h,J,ae),l===1?(l=1,k===!0&&(l|=8)):l=0,k=cs(3,null,null,l),i.current=k,k.stateNode=i,k.memoizedState={element:x,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},z0(k),i}function _T(i,l,h){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:C,key:x==null?null:""+x,children:i,containerInfo:l,implementation:h}}function Kv(i){if(!i)return Xa;i=i._reactInternals;e:{if(K(i)!==i||i.tag!==1)throw Error(r(170));var l=i;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Ln(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(r(171))}if(i.tag===1){var h=i.type;if(Ln(h))return Sg(i,h,l)}return l}function qv(i,l,h,x,_,k,R,J,ae){return i=Ah(h,x,!0,i,_,k,R,J,ae),i.context=Kv(null),h=i.current,x=jn(),_=ei(h),k=ya(x,_),k.callback=l??null,Ya(h,k,_),i.current.lanes=_,Vl(i,_,x),Un(i,x),i}function Ef(i,l,h,x){var _=l.current,k=jn(),R=ei(_);return h=Kv(h),l.context===null?l.context=h:l.pendingContext=h,l=ya(k,R),l.payload={element:i},x=x===void 0?null:x,x!==null&&(l.callback=x),i=Ya(_,l,R),i!==null&&(Ts(i,_,R,k),tf(i,_,R)),R}function Tf(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Yv(i,l){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<l?h:l}}function jh(i,l){Yv(i,l),(i=i.alternate)&&Yv(i,l)}function ST(){return null}var Jv=typeof reportError=="function"?reportError:function(i){console.error(i)};function Dh(i){this._internalRoot=i}Cf.prototype.render=Dh.prototype.render=function(i){var l=this._internalRoot;if(l===null)throw Error(r(409));Ef(i,l,null,null)},Cf.prototype.unmount=Dh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var l=i.containerInfo;Ui(function(){Ef(null,i,null,null)}),l[pa]=null}};function Cf(i){this._internalRoot=i}Cf.prototype.unstable_scheduleHydration=function(i){if(i){var l=Px();i={blockedOn:null,target:i,priority:l};for(var h=0;h<za.length&&l!==0&&l<za[h].priority;h++);za.splice(h,0,i),h===0&&Lx(i)}};function Fh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Nf(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Qv(){}function kT(i,l,h,x,_){if(_){if(typeof x=="function"){var k=x;x=function(){var ke=Tf(R);k.call(ke)}}var R=qv(l,x,i,0,null,!1,!1,"",Qv);return i._reactRootContainer=R,i[pa]=R.current,sc(i.nodeType===8?i.parentNode:i),Ui(),R}for(;_=i.lastChild;)i.removeChild(_);if(typeof x=="function"){var J=x;x=function(){var ke=Tf(ae);J.call(ke)}}var ae=Ah(i,0,!1,null,null,!1,!1,"",Qv);return i._reactRootContainer=ae,i[pa]=ae.current,sc(i.nodeType===8?i.parentNode:i),Ui(function(){Ef(l,ae,h,x)}),ae}function Af(i,l,h,x,_){var k=h._reactRootContainer;if(k){var R=k;if(typeof _=="function"){var J=_;_=function(){var ae=Tf(R);J.call(ae)}}Ef(l,R,i,_)}else R=kT(h,l,i,_,x);return Tf(R)}Fx=function(i){switch(i.tag){case 3:var l=i.stateNode;if(l.current.memoizedState.isDehydrated){var h=Wl(l.pendingLanes);h!==0&&(r0(l,h|1),Un(l,Pe()),(Lt&6)===0&&(Xo=Pe()+500,Ka()))}break;case 13:Ui(function(){var x=va(i,1);if(x!==null){var _=jn();Ts(x,i,1,_)}}),jh(i,1)}},n0=function(i){if(i.tag===13){var l=va(i,134217728);if(l!==null){var h=jn();Ts(l,i,134217728,h)}jh(i,134217728)}},Rx=function(i){if(i.tag===13){var l=ei(i),h=va(i,l);if(h!==null){var x=jn();Ts(h,i,l,x)}jh(i,l)}},Px=function(){return Wt},Ix=function(i,l){var h=Wt;try{return Wt=i,l()}finally{Wt=h}},La=function(i,l,h){switch(l){case"input":if(_e(i,h),l=h.name,h.type==="radio"&&l!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<h.length;l++){var x=h[l];if(x!==i&&x.form===i.form){var _=Hu(x);if(!_)throw Error(r(90));I(x),_e(x,_)}}}break;case"textarea":lt(i,h);break;case"select":l=h.value,l!=null&&ft(i,!!h.multiple,l,!1)}},jr=kh,qr=Ui;var bT={usingClientEntryPoint:!1,Events:[oc,Po,Hu,mt,mr,kh]},_c={findFiberByHostInstance:Fi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ET={bundleType:_c.bundleType,version:_c.version,rendererPackageName:_c.rendererPackageName,rendererConfig:_c.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=we(i),i===null?null:i.stateNode},findFiberByHostInstance:_c.findFiberByHostInstance||ST,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jf.isDisabled&&jf.supportsFiber)try{Hs=jf.inject(ET),Yr=jf}catch{}}return $n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bT,$n.createPortal=function(i,l){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fh(l))throw Error(r(200));return _T(i,l,null,h)},$n.createRoot=function(i,l){if(!Fh(i))throw Error(r(299));var h=!1,x="",_=Jv;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(x=l.identifierPrefix),l.onRecoverableError!==void 0&&(_=l.onRecoverableError)),l=Ah(i,1,!1,null,null,h,!1,x,_),i[pa]=l.current,sc(i.nodeType===8?i.parentNode:i),new Dh(l)},$n.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var l=i._reactInternals;if(l===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=we(l),i=i===null?null:i.stateNode,i},$n.flushSync=function(i){return Ui(i)},$n.hydrate=function(i,l,h){if(!Nf(l))throw Error(r(200));return Af(null,i,l,!0,h)},$n.hydrateRoot=function(i,l,h){if(!Fh(i))throw Error(r(405));var x=h!=null&&h.hydratedSources||null,_=!1,k="",R=Jv;if(h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(k=h.identifierPrefix),h.onRecoverableError!==void 0&&(R=h.onRecoverableError)),l=qv(l,null,i,1,h??null,_,!1,k,R),i[pa]=l.current,sc(i),x)for(i=0;i<x.length;i++)h=x[i],_=h._getVersion,_=_(h._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[h,_]:l.mutableSourceEagerHydrationData.push(h,_);return new Cf(l)},$n.render=function(i,l,h){if(!Nf(l))throw Error(r(200));return Af(null,i,l,!1,h)},$n.unmountComponentAtNode=function(i){if(!Nf(i))throw Error(r(40));return i._reactRootContainer?(Ui(function(){Af(null,null,i,!1,function(){i._reactRootContainer=null,i[pa]=null})}),!0):!1},$n.unstable_batchedUpdates=kh,$n.unstable_renderSubtreeIntoContainer=function(i,l,h,x){if(!Nf(h))throw Error(r(200));if(i==null||i._reactInternals===void 0)throw Error(r(38));return Af(i,l,h,!1,x)},$n.version="18.3.1-next-f1338f8080-20240426",$n}var i1;function Tw(){if(i1)return Ih.exports;i1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Ih.exports=PT(),Ih.exports}var o1;function IT(){if(o1)return Df;o1=1;var e=Tw();return Df.createRoot=e.createRoot,Df.hydrateRoot=e.hydrateRoot,Df}var OT=IT();const LT=Nd(OT);function Cw(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=Cw(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Nw(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=Cw(e))&&(n&&(n+=" "),n+=t);return n}function MT(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=Aw(t))&&(n&&(n+=" "),n+=r);return n}function Aw(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=Aw(e[n]))&&(r&&(r+=" "),r+=t);return r}var am="-";function BT(e){var t=$T(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,s=n===void 0?{}:n;function a(u){var f=u.split(am);return f[0]===""&&f.length!==1&&f.shift(),jw(f,t)||UT(u)}function o(u,f){var d=r[u]||[];return f&&s[u]?[].concat(d,s[u]):d}return{getClassGroupId:a,getConflictingClassGroupIds:o}}function jw(e,t){if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),s=n?jw(e.slice(1),n):void 0;if(s)return s;if(t.validators.length!==0){var a=e.join(am);return t.validators.find(function(o){var u=o.validator;return u(a)})?.classGroupId}}var l1=/^\[(.+)\]$/;function UT(e){if(l1.test(e)){var t=l1.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function $T(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},s=WT(Object.entries(e.classGroups),r);return s.forEach(function(a){var o=a[0],u=a[1];_p(u,n,o,t)}),n}function _p(e,t,r,n){e.forEach(function(s){if(typeof s=="string"){var a=s===""?t:c1(t,s);a.classGroupId=r;return}if(typeof s=="function"){if(zT(s)){_p(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(function(o){var u=o[0],f=o[1];_p(f,c1(t,u),r,n)})})}function c1(e,t){var r=e;return t.split(am).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function zT(e){return e.isThemeGetter}function WT(e,t){return t?e.map(function(r){var n=r[0],s=r[1],a=s.map(function(o){return typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(u){var f=u[0],d=u[1];return[t+f,d]})):o});return[n,a]}):e}function VT(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function s(a,o){r.set(a,o),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(o){var u=r.get(o);if(u!==void 0)return u;if((u=n.get(o))!==void 0)return s(o,u),u},set:function(o,u){r.has(o)?r.set(o,u):s(o,u)}}}var Dw="!";function HT(e){var t=e.separator||":",r=t.length===1,n=t[0],s=t.length;return function(o){for(var u=[],f=0,d=0,p,m=0;m<o.length;m++){var g=o[m];if(f===0){if(g===n&&(r||o.slice(m,m+s)===t)){u.push(o.slice(d,m)),d=m+s;continue}if(g==="/"){p=m;continue}}g==="["?f++:g==="]"&&f--}var y=u.length===0?o:o.substring(d),w=y.startsWith(Dw),v=w?y.substring(1):y,S=p&&p>d?p-d:void 0;return{modifiers:u,hasImportantModifier:w,baseClassName:v,maybePostfixModifierPosition:S}}}function GT(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var s=n[0]==="[";s?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function XT(e){return{cache:VT(e.cacheSize),splitModifiers:HT(e),...BT(e)}}var KT=/\s+/;function qT(e,t){var r=t.splitModifiers,n=t.getClassGroupId,s=t.getConflictingClassGroupIds,a=new Set;return e.trim().split(KT).map(function(o){var u=r(o),f=u.modifiers,d=u.hasImportantModifier,p=u.baseClassName,m=u.maybePostfixModifierPosition,g=n(m?p.substring(0,m):p),y=!!m;if(!g){if(!m)return{isTailwindClass:!1,originalClassName:o};if(g=n(p),!g)return{isTailwindClass:!1,originalClassName:o};y=!1}var w=GT(f).join(":"),v=d?w+Dw:w;return{isTailwindClass:!0,modifierId:v,classGroupId:g,originalClassName:o,hasPostfixModifier:y}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var u=o.modifierId,f=o.classGroupId,d=o.hasPostfixModifier,p=u+f;return a.has(p)?!1:(a.add(p),s(f,d).forEach(function(m){return a.add(u+m)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function YT(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,s,a,o=u;function u(d){var p=t[0],m=t.slice(1),g=m.reduce(function(y,w){return w(y)},p());return n=XT(g),s=n.cache.get,a=n.cache.set,o=f,f(d)}function f(d){var p=s(d);if(p)return p;var m=qT(d,n);return a(d,m),m}return function(){return o(MT.apply(null,arguments))}}function lr(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var Fw=/^\[(?:([a-z-]+):)?(.+)\]$/i,JT=/^\d+\/\d+$/,QT=new Set(["px","full","screen"]),ZT=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,e4=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,t4=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Cs(e){return qi(e)||QT.has(e)||JT.test(e)||Sp(e)}function Sp(e){return xo(e,"length",o4)}function r4(e){return xo(e,"size",Rw)}function n4(e){return xo(e,"position",Rw)}function s4(e){return xo(e,"url",l4)}function Ff(e){return xo(e,"number",qi)}function qi(e){return!Number.isNaN(Number(e))}function a4(e){return e.endsWith("%")&&qi(e.slice(0,-1))}function kc(e){return u1(e)||xo(e,"number",u1)}function Dt(e){return Fw.test(e)}function bc(){return!0}function si(e){return ZT.test(e)}function i4(e){return xo(e,"",c4)}function xo(e,t,r){var n=Fw.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function o4(e){return e4.test(e)}function Rw(){return!1}function l4(e){return e.startsWith("url(")}function u1(e){return Number.isInteger(Number(e))}function c4(e){return t4.test(e)}function u4(){var e=lr("colors"),t=lr("spacing"),r=lr("blur"),n=lr("brightness"),s=lr("borderColor"),a=lr("borderRadius"),o=lr("borderSpacing"),u=lr("borderWidth"),f=lr("contrast"),d=lr("grayscale"),p=lr("hueRotate"),m=lr("invert"),g=lr("gap"),y=lr("gradientColorStops"),w=lr("gradientColorStopPositions"),v=lr("inset"),S=lr("margin"),E=lr("opacity"),A=lr("padding"),b=lr("saturate"),D=lr("scale"),O=lr("sepia"),C=lr("skew"),T=lr("space"),U=lr("translate"),z=function(){return["auto","contain","none"]},Z=function(){return["auto","hidden","clip","visible","scroll"]},re=function(){return["auto",Dt,t]},P=function(){return[Dt,t]},se=function(){return["",Cs]},me=function(){return["auto",qi,Dt]},ce=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},fe=function(){return["solid","dashed","dotted","double","none"]},de=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},he=function(){return["start","end","center","between","around","evenly","stretch"]},Q=function(){return["","0",Dt]},ee=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},V=function(){return[qi,Ff]},F=function(){return[qi,Dt]};return{cacheSize:500,theme:{colors:[bc],spacing:[Cs],blur:["none","",si,Dt],brightness:V(),borderColor:[e],borderRadius:["none","","full",si,Dt],borderSpacing:P(),borderWidth:se(),contrast:V(),grayscale:Q(),hueRotate:F(),invert:Q(),gap:P(),gradientColorStops:[e],gradientColorStopPositions:[a4,Sp],inset:re(),margin:re(),opacity:V(),padding:P(),saturate:V(),scale:V(),sepia:Q(),skew:F(),space:P(),translate:P()},classGroups:{aspect:[{aspect:["auto","square","video",Dt]}],container:["container"],columns:[{columns:[si]}],"break-after":[{"break-after":ee()}],"break-before":[{"break-before":ee()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(ce(),[Dt])}],overflow:[{overflow:Z()}],"overflow-x":[{"overflow-x":Z()}],"overflow-y":[{"overflow-y":Z()}],overscroll:[{overscroll:z()}],"overscroll-x":[{"overscroll-x":z()}],"overscroll-y":[{"overscroll-y":z()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",kc]}],basis:[{basis:re()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Dt]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",kc]}],"grid-cols":[{"grid-cols":[bc]}],"col-start-end":[{col:["auto",{span:["full",kc]},Dt]}],"col-start":[{"col-start":me()}],"col-end":[{"col-end":me()}],"grid-rows":[{"grid-rows":[bc]}],"row-start-end":[{row:["auto",{span:[kc]},Dt]}],"row-start":[{"row-start":me()}],"row-end":[{"row-end":me()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Dt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Dt]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal"].concat(he())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(he(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(he(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[A]}],px:[{px:[A]}],py:[{py:[A]}],ps:[{ps:[A]}],pe:[{pe:[A]}],pt:[{pt:[A]}],pr:[{pr:[A]}],pb:[{pb:[A]}],pl:[{pl:[A]}],m:[{m:[S]}],mx:[{mx:[S]}],my:[{my:[S]}],ms:[{ms:[S]}],me:[{me:[S]}],mt:[{mt:[S]}],mr:[{mr:[S]}],mb:[{mb:[S]}],ml:[{ml:[S]}],"space-x":[{"space-x":[T]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[T]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Dt,t]}],"min-w":[{"min-w":["min","max","fit",Dt,Cs]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[si]},si,Dt]}],h:[{h:[Dt,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Dt,Cs]}],"max-h":[{"max-h":[Dt,t,"min","max","fit"]}],"font-size":[{text:["base",si,Sp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ff]}],"font-family":[{font:[bc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Dt]}],"line-clamp":[{"line-clamp":["none",qi,Ff]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Dt,Cs]}],"list-image":[{"list-image":["none",Dt]}],"list-style-type":[{list:["none","disc","decimal",Dt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[E]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[E]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(fe(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Cs]}],"underline-offset":[{"underline-offset":["auto",Dt,Cs]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:P()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Dt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Dt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[E]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(ce(),[n4])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",r4]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},s4]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[y]}],"gradient-via":[{via:[y]}],"gradient-to":[{to:[y]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[u]}],"border-w-x":[{"border-x":[u]}],"border-w-y":[{"border-y":[u]}],"border-w-s":[{"border-s":[u]}],"border-w-e":[{"border-e":[u]}],"border-w-t":[{"border-t":[u]}],"border-w-r":[{"border-r":[u]}],"border-w-b":[{"border-b":[u]}],"border-w-l":[{"border-l":[u]}],"border-opacity":[{"border-opacity":[E]}],"border-style":[{border:[].concat(fe(),["hidden"])}],"divide-x":[{"divide-x":[u]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[u]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[E]}],"divide-style":[{divide:fe()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(fe())}],"outline-offset":[{"outline-offset":[Dt,Cs]}],"outline-w":[{outline:[Cs]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:se()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[E]}],"ring-offset-w":[{"ring-offset":[Cs]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",si,i4]}],"shadow-color":[{shadow:[bc]}],opacity:[{opacity:[E]}],"mix-blend":[{"mix-blend":de()}],"bg-blend":[{"bg-blend":de()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[f]}],"drop-shadow":[{"drop-shadow":["","none",si,Dt]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[p]}],invert:[{invert:[m]}],saturate:[{saturate:[b]}],sepia:[{sepia:[O]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[f]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[p]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[E]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[O]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Dt]}],duration:[{duration:F()}],ease:[{ease:["linear","in","out","in-out",Dt]}],delay:[{delay:F()}],animate:[{animate:["none","spin","ping","pulse","bounce",Dt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[D]}],"scale-x":[{"scale-x":[D]}],"scale-y":[{"scale-y":[D]}],rotate:[{rotate:[kc,Dt]}],"translate-x":[{"translate-x":[U]}],"translate-y":[{"translate-y":[U]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Dt]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Dt]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":P()}],"scroll-mx":[{"scroll-mx":P()}],"scroll-my":[{"scroll-my":P()}],"scroll-ms":[{"scroll-ms":P()}],"scroll-me":[{"scroll-me":P()}],"scroll-mt":[{"scroll-mt":P()}],"scroll-mr":[{"scroll-mr":P()}],"scroll-mb":[{"scroll-mb":P()}],"scroll-ml":[{"scroll-ml":P()}],"scroll-p":[{"scroll-p":P()}],"scroll-px":[{"scroll-px":P()}],"scroll-py":[{"scroll-py":P()}],"scroll-ps":[{"scroll-ps":P()}],"scroll-pe":[{"scroll-pe":P()}],"scroll-pt":[{"scroll-pt":P()}],"scroll-pr":[{"scroll-pr":P()}],"scroll-pb":[{"scroll-pb":P()}],"scroll-pl":[{"scroll-pl":P()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Dt]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Cs,Ff]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var f4=YT(u4);function Et(...e){return f4(Nw(e))}function Je({className:e,...t}){return c.jsx("div",{"data-slot":"card",className:Et("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",e),...t})}function At({className:e,...t}){return c.jsx("div",{"data-slot":"card-header",className:Et("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function Ft({className:e,...t}){return c.jsx("h4",{"data-slot":"card-title",className:Et("leading-none",e),...t})}function Qe({className:e,...t}){return c.jsx("div",{"data-slot":"card-content",className:Et("px-6 [&:last-child]:pb-6",e),...t})}function f1(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Pw(...e){return t=>{let r=!1;const n=e.map(s=>{const a=f1(s,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let s=0;s<n.length;s++){const a=n[s];typeof a=="function"?a():f1(e[s],null)}}}}function er(...e){return j.useCallback(Pw(...e),e)}function bl(e){const t=d4(e),r=j.forwardRef((n,s)=>{const{children:a,...o}=n,u=j.Children.toArray(a),f=u.find(p4);if(f){const d=f.props.children,p=u.map(m=>m===f?j.Children.count(d)>1?j.Children.only(null):j.isValidElement(d)?d.props.children:null:m);return c.jsx(t,{...o,ref:s,children:j.isValidElement(d)?j.cloneElement(d,void 0,p):null})}return c.jsx(t,{...o,ref:s,children:a})});return r.displayName=`${e}.Slot`,r}var Iw=bl("Slot");function d4(e){const t=j.forwardRef((r,n)=>{const{children:s,...a}=r;if(j.isValidElement(s)){const o=x4(s),u=m4(a,s.props);return s.type!==j.Fragment&&(u.ref=n?Pw(n,o):o),j.cloneElement(s,u)}return j.Children.count(s)>1?j.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Ow=Symbol("radix.slottable");function h4(e){const t=({children:r})=>c.jsx(c.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=Ow,t}function p4(e){return j.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Ow}function m4(e,t){const r={...t};for(const n in t){const s=e[n],a=t[n];/^on[A-Z]/.test(n)?s&&a?r[n]=(...u)=>{const f=a(...u);return s(...u),f}:s&&(r[n]=s):n==="style"?r[n]={...s,...a}:n==="className"&&(r[n]=[s,a].filter(Boolean).join(" "))}return{...e,...r}}function x4(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const d1=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,h1=Nw,im=(e,t)=>r=>{var n;if(t?.variants==null)return h1(e,r?.class,r?.className);const{variants:s,defaultVariants:a}=t,o=Object.keys(s).map(d=>{const p=r?.[d],m=a?.[d];if(p===null)return null;const g=d1(p)||d1(m);return s[d][g]}),u=r&&Object.entries(r).reduce((d,p)=>{let[m,g]=p;return g===void 0||(d[m]=g),d},{}),f=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,p)=>{let{class:m,className:g,...y}=p;return Object.entries(y).every(w=>{let[v,S]=w;return Array.isArray(S)?S.includes({...a,...u}[v]):{...a,...u}[v]===S})?[...d,m,g]:d},[]);return h1(e,o,f,r?.class,r?.className)},om=im("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),$e=j.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},a)=>{const o=n?Iw:"button";return c.jsx(o,{"data-slot":"button",className:Et(om({variant:t,size:r,className:e})),ref:a,...s})});$e.displayName="Button";function Nt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),r===!1||!s.defaultPrevented)return t?.(s)}}function g4(e,t){const r=j.createContext(t),n=a=>{const{children:o,...u}=a,f=j.useMemo(()=>u,Object.values(u));return c.jsx(r.Provider,{value:f,children:o})};n.displayName=e+"Provider";function s(a){const o=j.useContext(r);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${a}\` must be used within \`${e}\``)}return[n,s]}function Da(e,t=[]){let r=[];function n(a,o){const u=j.createContext(o),f=r.length;r=[...r,o];const d=m=>{const{scope:g,children:y,...w}=m,v=g?.[e]?.[f]||u,S=j.useMemo(()=>w,Object.values(w));return c.jsx(v.Provider,{value:S,children:y})};d.displayName=a+"Provider";function p(m,g){const y=g?.[e]?.[f]||u,w=j.useContext(y);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${m}\` must be used within \`${a}\``)}return[d,p]}const s=()=>{const a=r.map(o=>j.createContext(o));return function(u){const f=u?.[e]||a;return j.useMemo(()=>({[`__scope${e}`]:{...u,[e]:f}}),[u,f])}};return s.scopeName=e,[n,v4(s,...t)]}function v4(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const o=n.reduce((u,{useScope:f,scopeName:d})=>{const m=f(a)[`__scope${d}`];return{...u,...m}},{});return j.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function Lw(e){const t=e+"CollectionProvider",[r,n]=Da(t),[s,a]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=v=>{const{scope:S,children:E}=v,A=Oe.useRef(null),b=Oe.useRef(new Map).current;return c.jsx(s,{scope:S,itemMap:b,collectionRef:A,children:E})};o.displayName=t;const u=e+"CollectionSlot",f=bl(u),d=Oe.forwardRef((v,S)=>{const{scope:E,children:A}=v,b=a(u,E),D=er(S,b.collectionRef);return c.jsx(f,{ref:D,children:A})});d.displayName=u;const p=e+"CollectionItemSlot",m="data-radix-collection-item",g=bl(p),y=Oe.forwardRef((v,S)=>{const{scope:E,children:A,...b}=v,D=Oe.useRef(null),O=er(S,D),C=a(p,E);return Oe.useEffect(()=>(C.itemMap.set(D,{ref:D,...b}),()=>void C.itemMap.delete(D))),c.jsx(g,{[m]:"",ref:O,children:A})});y.displayName=p;function w(v){const S=a(e+"CollectionConsumer",v);return Oe.useCallback(()=>{const A=S.collectionRef.current;if(!A)return[];const b=Array.from(A.querySelectorAll(`[${m}]`));return Array.from(S.itemMap.values()).sort((C,T)=>b.indexOf(C.ref.current)-b.indexOf(T.ref.current))},[S.collectionRef,S.itemMap])}return[{Provider:o,Slot:d,ItemSlot:y},w,n]}var hn=globalThis?.document?j.useLayoutEffect:()=>{},y4=Ew[" useId ".trim().toString()]||(()=>{}),w4=0;function Ea(e){const[t,r]=j.useState(y4());return hn(()=>{r(n=>n??String(w4++))},[e]),e||(t?`radix-${t}`:"")}var hu=Tw();const Mw=Nd(hu);var _4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],St=_4.reduce((e,t)=>{const r=bl(`Primitive.${t}`),n=j.forwardRef((s,a)=>{const{asChild:o,...u}=s,f=o?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(f,{...u,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function S4(e,t){e&&hu.flushSync(()=>e.dispatchEvent(t))}function xi(e){const t=j.useRef(e);return j.useEffect(()=>{t.current=e}),j.useMemo(()=>(...r)=>t.current?.(...r),[])}var k4=Ew[" useInsertionEffect ".trim().toString()]||hn;function ro({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[s,a,o]=b4({defaultProp:t,onChange:r}),u=e!==void 0,f=u?e:s;{const p=j.useRef(e!==void 0);j.useEffect(()=>{const m=p.current;m!==u&&console.warn(`${n} is changing from ${m?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),p.current=u},[u,n])}const d=j.useCallback(p=>{if(u){const m=E4(p)?p(e):p;m!==e&&o.current?.(m)}else a(p)},[u,e,a,o]);return[f,d]}function b4({defaultProp:e,onChange:t}){const[r,n]=j.useState(e),s=j.useRef(r),a=j.useRef(t);return k4(()=>{a.current=t},[t]),j.useEffect(()=>{s.current!==r&&(a.current?.(r),s.current=r)},[r,s]),[r,n,a]}function E4(e){return typeof e=="function"}var T4=j.createContext(void 0);function lm(e){const t=j.useContext(T4);return e||t||"ltr"}var Mh="rovingFocusGroup.onEntryFocus",C4={bubbles:!1,cancelable:!0},pu="RovingFocusGroup",[kp,Bw,N4]=Lw(pu),[A4,Uw]=Da(pu,[N4]),[j4,D4]=A4(pu),$w=j.forwardRef((e,t)=>c.jsx(kp.Provider,{scope:e.__scopeRovingFocusGroup,children:c.jsx(kp.Slot,{scope:e.__scopeRovingFocusGroup,children:c.jsx(F4,{...e,ref:t})})}));$w.displayName=pu;var F4=j.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:a,currentTabStopId:o,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:f,onEntryFocus:d,preventScrollOnEntryFocus:p=!1,...m}=e,g=j.useRef(null),y=er(t,g),w=lm(a),[v,S]=ro({prop:o,defaultProp:u??null,onChange:f,caller:pu}),[E,A]=j.useState(!1),b=xi(d),D=Bw(r),O=j.useRef(!1),[C,T]=j.useState(0);return j.useEffect(()=>{const U=g.current;if(U)return U.addEventListener(Mh,b),()=>U.removeEventListener(Mh,b)},[b]),c.jsx(j4,{scope:r,orientation:n,dir:w,loop:s,currentTabStopId:v,onItemFocus:j.useCallback(U=>S(U),[S]),onItemShiftTab:j.useCallback(()=>A(!0),[]),onFocusableItemAdd:j.useCallback(()=>T(U=>U+1),[]),onFocusableItemRemove:j.useCallback(()=>T(U=>U-1),[]),children:c.jsx(St.div,{tabIndex:E||C===0?-1:0,"data-orientation":n,...m,ref:y,style:{outline:"none",...e.style},onMouseDown:Nt(e.onMouseDown,()=>{O.current=!0}),onFocus:Nt(e.onFocus,U=>{const z=!O.current;if(U.target===U.currentTarget&&z&&!E){const Z=new CustomEvent(Mh,C4);if(U.currentTarget.dispatchEvent(Z),!Z.defaultPrevented){const re=D().filter(fe=>fe.focusable),P=re.find(fe=>fe.active),se=re.find(fe=>fe.id===v),ce=[P,se,...re].filter(Boolean).map(fe=>fe.ref.current);Vw(ce,p)}}O.current=!1}),onBlur:Nt(e.onBlur,()=>A(!1))})})}),zw="RovingFocusGroupItem",Ww=j.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:a,children:o,...u}=e,f=Ea(),d=a||f,p=D4(zw,r),m=p.currentTabStopId===d,g=Bw(r),{onFocusableItemAdd:y,onFocusableItemRemove:w,currentTabStopId:v}=p;return j.useEffect(()=>{if(n)return y(),()=>w()},[n,y,w]),c.jsx(kp.ItemSlot,{scope:r,id:d,focusable:n,active:s,children:c.jsx(St.span,{tabIndex:m?0:-1,"data-orientation":p.orientation,...u,ref:t,onMouseDown:Nt(e.onMouseDown,S=>{n?p.onItemFocus(d):S.preventDefault()}),onFocus:Nt(e.onFocus,()=>p.onItemFocus(d)),onKeyDown:Nt(e.onKeyDown,S=>{if(S.key==="Tab"&&S.shiftKey){p.onItemShiftTab();return}if(S.target!==S.currentTarget)return;const E=I4(S,p.orientation,p.dir);if(E!==void 0){if(S.metaKey||S.ctrlKey||S.altKey||S.shiftKey)return;S.preventDefault();let b=g().filter(D=>D.focusable).map(D=>D.ref.current);if(E==="last")b.reverse();else if(E==="prev"||E==="next"){E==="prev"&&b.reverse();const D=b.indexOf(S.currentTarget);b=p.loop?O4(b,D+1):b.slice(D+1)}setTimeout(()=>Vw(b))}}),children:typeof o=="function"?o({isCurrentTabStop:m,hasTabStop:v!=null}):o})})});Ww.displayName=zw;var R4={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function P4(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function I4(e,t,r){const n=P4(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return R4[n]}function Vw(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function O4(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var L4=$w,M4=Ww;function B4(e,t){return j.useReducer((r,n)=>t[r][n]??r,e)}var Fl=e=>{const{present:t,children:r}=e,n=U4(t),s=typeof r=="function"?r({present:n.isPresent}):j.Children.only(r),a=er(n.ref,$4(s));return typeof r=="function"||n.isPresent?j.cloneElement(s,{ref:a}):null};Fl.displayName="Presence";function U4(e){const[t,r]=j.useState(),n=j.useRef(null),s=j.useRef(e),a=j.useRef("none"),o=e?"mounted":"unmounted",[u,f]=B4(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return j.useEffect(()=>{const d=Rf(n.current);a.current=u==="mounted"?d:"none"},[u]),hn(()=>{const d=n.current,p=s.current;if(p!==e){const g=a.current,y=Rf(d);e?f("MOUNT"):y==="none"||d?.display==="none"?f("UNMOUNT"):f(p&&g!==y?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,f]),hn(()=>{if(t){let d;const p=t.ownerDocument.defaultView??window,m=y=>{const v=Rf(n.current).includes(CSS.escape(y.animationName));if(y.target===t&&v&&(f("ANIMATION_END"),!s.current)){const S=t.style.animationFillMode;t.style.animationFillMode="forwards",d=p.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=S)})}},g=y=>{y.target===t&&(a.current=Rf(n.current))};return t.addEventListener("animationstart",g),t.addEventListener("animationcancel",m),t.addEventListener("animationend",m),()=>{p.clearTimeout(d),t.removeEventListener("animationstart",g),t.removeEventListener("animationcancel",m),t.removeEventListener("animationend",m)}}else f("ANIMATION_END")},[t,f]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:j.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function Rf(e){return e?.animationName||"none"}function $4(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Ad="Tabs",[z4,nz]=Da(Ad,[Uw]),Hw=Uw(),[W4,cm]=z4(Ad),Gw=j.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:a,orientation:o="horizontal",dir:u,activationMode:f="automatic",...d}=e,p=lm(u),[m,g]=ro({prop:n,onChange:s,defaultProp:a??"",caller:Ad});return c.jsx(W4,{scope:r,baseId:Ea(),value:m,onValueChange:g,orientation:o,dir:p,activationMode:f,children:c.jsx(St.div,{dir:p,"data-orientation":o,...d,ref:t})})});Gw.displayName=Ad;var Xw="TabsList",Kw=j.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...s}=e,a=cm(Xw,r),o=Hw(r);return c.jsx(L4,{asChild:!0,...o,orientation:a.orientation,dir:a.dir,loop:n,children:c.jsx(St.div,{role:"tablist","aria-orientation":a.orientation,...s,ref:t})})});Kw.displayName=Xw;var qw="TabsTrigger",Yw=j.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...a}=e,o=cm(qw,r),u=Hw(r),f=Zw(o.baseId,n),d=e2(o.baseId,n),p=n===o.value;return c.jsx(M4,{asChild:!0,...u,focusable:!s,active:p,children:c.jsx(St.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":d,"data-state":p?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:f,...a,ref:t,onMouseDown:Nt(e.onMouseDown,m=>{!s&&m.button===0&&m.ctrlKey===!1?o.onValueChange(n):m.preventDefault()}),onKeyDown:Nt(e.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&o.onValueChange(n)}),onFocus:Nt(e.onFocus,()=>{const m=o.activationMode!=="manual";!p&&!s&&m&&o.onValueChange(n)})})})});Yw.displayName=qw;var Jw="TabsContent",Qw=j.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:s,children:a,...o}=e,u=cm(Jw,r),f=Zw(u.baseId,n),d=e2(u.baseId,n),p=n===u.value,m=j.useRef(p);return j.useEffect(()=>{const g=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(g)},[]),c.jsx(Fl,{present:s||p,children:({present:g})=>c.jsx(St.div,{"data-state":p?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":f,hidden:!g,id:d,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:m.current?"0s":void 0},children:g&&a})})});Qw.displayName=Jw;function Zw(e,t){return`${e}-trigger-${t}`}function e2(e,t){return`${e}-content-${t}`}var V4=Gw,H4=Kw,G4=Yw,X4=Qw;function go({className:e,...t}){return c.jsx(V4,{"data-slot":"tabs",className:Et("flex flex-col gap-2",e),...t})}function vo({className:e,...t}){return c.jsx(H4,{"data-slot":"tabs-list",className:Et("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",e),...t})}function Yt({className:e,...t}){return c.jsx(G4,{"data-slot":"tabs-trigger",className:Et("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function Jt({className:e,...t}){return c.jsx(X4,{"data-slot":"tabs-content",className:Et("flex-1 outline-none",e),...t})}const K4=im("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function sr({className:e,variant:t,...r}){return c.jsx("div",{"data-slot":"alert",role:"alert",className:Et(K4({variant:t}),e),...r})}function ar({className:e,...t}){return c.jsx("div",{"data-slot":"alert-description",className:Et("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}var q4=(e,t,r,n,s,a,o,u)=>{let f=document.documentElement,d=["light","dark"];function p(y){(Array.isArray(e)?e:[e]).forEach(w=>{let v=w==="class",S=v&&a?s.map(E=>a[E]||E):s;v?(f.classList.remove(...S),f.classList.add(a&&a[y]?a[y]:y)):f.setAttribute(w,y)}),m(y)}function m(y){u&&d.includes(y)&&(f.style.colorScheme=y)}function g(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(n)p(n);else try{let y=localStorage.getItem(t)||r,w=o&&y==="system"?g():y;p(w)}catch{}},Y4=j.createContext(void 0),J4={setTheme:e=>{},themes:[]},Q4=()=>{var e;return(e=j.useContext(Y4))!=null?e:J4};j.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:s,defaultTheme:a,value:o,themes:u,nonce:f,scriptProps:d})=>{let p=JSON.stringify([r,t,a,e,u,o,n,s]).slice(1,-1);return j.createElement("script",{...d,suppressHydrationWarning:!0,nonce:typeof window>"u"?f:"",dangerouslySetInnerHTML:{__html:`(${q4.toString()})(${p})`}})});function Z4(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const eC=e=>{switch(e){case"success":return nC;case"info":return aC;case"warning":return sC;case"error":return iC;default:return null}},tC=Array(12).fill(0),rC=({visible:e,className:t})=>Oe.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Oe.createElement("div",{className:"sonner-spinner"},tC.map((r,n)=>Oe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),nC=Oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Oe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),sC=Oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Oe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),aC=Oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Oe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),iC=Oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Oe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),oC=Oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Oe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Oe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),lC=()=>{const[e,t]=Oe.useState(document.hidden);return Oe.useEffect(()=>{const r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e};let bp=1;class cC{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;const{message:n,...s}=t,a=typeof t?.id=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:bp++,o=this.toasts.find(f=>f.id===a),u=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),o?this.toasts=this.toasts.map(f=>f.id===a?(this.publish({...f,...t,id:a,title:n}),{...f,...t,id:a,dismissible:u,title:n}):f):this.addToast({title:n,...s,dismissible:u,id:a}),a},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:t,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let a=n!==void 0,o;const u=s.then(async d=>{if(o=["resolve",d],Oe.isValidElement(d))a=!1,this.create({id:n,type:"default",message:d});else if(fC(d)&&!d.ok){a=!1;const m=typeof r.error=="function"?await r.error(`HTTP error! status: ${d.status}`):r.error,g=typeof r.description=="function"?await r.description(`HTTP error! status: ${d.status}`):r.description,w=typeof m=="object"&&!Oe.isValidElement(m)?m:{message:m};this.create({id:n,type:"error",description:g,...w})}else if(d instanceof Error){a=!1;const m=typeof r.error=="function"?await r.error(d):r.error,g=typeof r.description=="function"?await r.description(d):r.description,w=typeof m=="object"&&!Oe.isValidElement(m)?m:{message:m};this.create({id:n,type:"error",description:g,...w})}else if(r.success!==void 0){a=!1;const m=typeof r.success=="function"?await r.success(d):r.success,g=typeof r.description=="function"?await r.description(d):r.description,w=typeof m=="object"&&!Oe.isValidElement(m)?m:{message:m};this.create({id:n,type:"success",description:g,...w})}}).catch(async d=>{if(o=["reject",d],r.error!==void 0){a=!1;const p=typeof r.error=="function"?await r.error(d):r.error,m=typeof r.description=="function"?await r.description(d):r.description,y=typeof p=="object"&&!Oe.isValidElement(p)?p:{message:p};this.create({id:n,type:"error",description:m,...y})}}).finally(()=>{a&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),f=()=>new Promise((d,p)=>u.then(()=>o[0]==="reject"?p(o[1]):d(o[1])).catch(p));return typeof n!="string"&&typeof n!="number"?{unwrap:f}:Object.assign(n,{unwrap:f})},this.custom=(t,r)=>{const n=r?.id||bp++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const zn=new cC,uC=(e,t)=>{const r=t?.id||bp++;return zn.addToast({title:e,...t,id:r}),r},fC=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",dC=uC,hC=()=>zn.toasts,pC=()=>zn.getActiveToasts(),be=Object.assign(dC,{success:zn.success,info:zn.info,warning:zn.warning,error:zn.error,custom:zn.custom,message:zn.message,promise:zn.promise,dismiss:zn.dismiss,loading:zn.loading},{getHistory:hC,getToasts:pC});Z4("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Pf(e){return e.label!==void 0}const mC=3,xC="24px",gC="16px",p1=4e3,vC=356,yC=14,wC=45,_C=200;function Ys(...e){return e.filter(Boolean).join(" ")}function SC(e){const[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}const kC=e=>{var t,r,n,s,a,o,u,f,d;const{invert:p,toast:m,unstyled:g,interacting:y,setHeights:w,visibleToasts:v,heights:S,index:E,toasts:A,expanded:b,removeToast:D,defaultRichColors:O,closeButton:C,style:T,cancelButtonStyle:U,actionButtonStyle:z,className:Z="",descriptionClassName:re="",duration:P,position:se,gap:me,expandByDefault:ce,classNames:fe,icons:de,closeButtonAriaLabel:he="Close toast"}=e,[Q,ee]=Oe.useState(null),[V,F]=Oe.useState(null),[N,L]=Oe.useState(!1),[B,q]=Oe.useState(!1),[ne,Y]=Oe.useState(!1),[oe,le]=Oe.useState(!1),[te,I]=Oe.useState(!1),[Ce,Ie]=Oe.useState(0),[ue,ge]=Oe.useState(0),_e=Oe.useRef(m.duration||P||p1),je=Oe.useRef(null),Ke=Oe.useRef(null),ot=E===0,ft=E+1<=v,et=m.type,tt=m.dismissible!==!1,lt=m.className||"",Ye=m.descriptionClassName||"",Tt=Oe.useMemo(()=>S.findIndex(mt=>mt.toastId===m.id)||0,[S,m.id]),dr=Oe.useMemo(()=>{var mt;return(mt=m.closeButton)!=null?mt:C},[m.closeButton,C]),Kt=Oe.useMemo(()=>m.duration||P||p1,[m.duration,P]),an=Oe.useRef(0),at=Oe.useRef(0),zt=Oe.useRef(0),Ar=Oe.useRef(null),[hr,ns]=se.split("-"),Ai=Oe.useMemo(()=>S.reduce((mt,mr,jr)=>jr>=Tt?mt:mt+mr.height,0),[S,Tt]),Oa=lC(),ji=m.invert||p,Bs=et==="loading";at.current=Oe.useMemo(()=>Tt*me+Ai,[Tt,Ai]),Oe.useEffect(()=>{_e.current=Kt},[Kt]),Oe.useEffect(()=>{L(!0)},[]),Oe.useEffect(()=>{const mt=Ke.current;if(mt){const mr=mt.getBoundingClientRect().height;return ge(mr),w(jr=>[{toastId:m.id,height:mr,position:m.position},...jr]),()=>w(jr=>jr.filter(qr=>qr.toastId!==m.id))}},[w,m.id]),Oe.useLayoutEffect(()=>{if(!N)return;const mt=Ke.current,mr=mt.style.height;mt.style.height="auto";const jr=mt.getBoundingClientRect().height;mt.style.height=mr,ge(jr),w(qr=>qr.find(yr=>yr.toastId===m.id)?qr.map(yr=>yr.toastId===m.id?{...yr,height:jr}:yr):[{toastId:m.id,height:jr,position:m.position},...qr])},[N,m.title,m.description,w,m.id,m.jsx,m.action,m.cancel]);const Cn=Oe.useCallback(()=>{q(!0),Ie(at.current),w(mt=>mt.filter(mr=>mr.toastId!==m.id)),setTimeout(()=>{D(m)},_C)},[m,D,w,at]);Oe.useEffect(()=>{if(m.promise&&et==="loading"||m.duration===1/0||m.type==="loading")return;let mt;return b||y||Oa?(()=>{if(zt.current<an.current){const qr=new Date().getTime()-an.current;_e.current=_e.current-qr}zt.current=new Date().getTime()})():(()=>{_e.current!==1/0&&(an.current=new Date().getTime(),mt=setTimeout(()=>{m.onAutoClose==null||m.onAutoClose.call(m,m),Cn()},_e.current))})(),()=>clearTimeout(mt)},[b,y,m,et,Oa,Cn]),Oe.useEffect(()=>{m.delete&&(Cn(),m.onDismiss==null||m.onDismiss.call(m,m))},[Cn,m.delete]);function La(){var mt;if(de?.loading){var mr;return Oe.createElement("div",{className:Ys(fe?.loader,m==null||(mr=m.classNames)==null?void 0:mr.loader,"sonner-loader"),"data-visible":et==="loading"},de.loading)}return Oe.createElement(rC,{className:Ys(fe?.loader,m==null||(mt=m.classNames)==null?void 0:mt.loader),visible:et==="loading"})}const Us=m.icon||de?.[et]||eC(et);var ws,$s;return Oe.createElement("li",{tabIndex:0,ref:Ke,className:Ys(Z,lt,fe?.toast,m==null||(t=m.classNames)==null?void 0:t.toast,fe?.default,fe?.[et],m==null||(r=m.classNames)==null?void 0:r[et]),"data-sonner-toast":"","data-rich-colors":(ws=m.richColors)!=null?ws:O,"data-styled":!(m.jsx||m.unstyled||g),"data-mounted":N,"data-promise":!!m.promise,"data-swiped":te,"data-removed":B,"data-visible":ft,"data-y-position":hr,"data-x-position":ns,"data-index":E,"data-front":ot,"data-swiping":ne,"data-dismissible":tt,"data-type":et,"data-invert":ji,"data-swipe-out":oe,"data-swipe-direction":V,"data-expanded":!!(b||ce&&N),"data-testid":m.testId,style:{"--index":E,"--toasts-before":E,"--z-index":A.length-E,"--offset":`${B?Ce:at.current}px`,"--initial-height":ce?"auto":`${ue}px`,...T,...m.style},onDragEnd:()=>{Y(!1),ee(null),Ar.current=null},onPointerDown:mt=>{mt.button!==2&&(Bs||!tt||(je.current=new Date,Ie(at.current),mt.target.setPointerCapture(mt.pointerId),mt.target.tagName!=="BUTTON"&&(Y(!0),Ar.current={x:mt.clientX,y:mt.clientY})))},onPointerUp:()=>{var mt,mr,jr;if(oe||!tt)return;Ar.current=null;const qr=Number(((mt=Ke.current)==null?void 0:mt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),zs=Number(((mr=Ke.current)==null?void 0:mr.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),yr=new Date().getTime()-((jr=je.current)==null?void 0:jr.getTime()),Lr=Q==="x"?qr:zs,Ws=Math.abs(Lr)/yr;if(Math.abs(Lr)>=wC||Ws>.11){Ie(at.current),m.onDismiss==null||m.onDismiss.call(m,m),F(Q==="x"?qr>0?"right":"left":zs>0?"down":"up"),Cn(),le(!0);return}else{var Dr,Nn;(Dr=Ke.current)==null||Dr.style.setProperty("--swipe-amount-x","0px"),(Nn=Ke.current)==null||Nn.style.setProperty("--swipe-amount-y","0px")}I(!1),Y(!1),ee(null)},onPointerMove:mt=>{var mr,jr,qr;if(!Ar.current||!tt||((mr=window.getSelection())==null?void 0:mr.toString().length)>0)return;const yr=mt.clientY-Ar.current.y,Lr=mt.clientX-Ar.current.x;var Ws;const Dr=(Ws=e.swipeDirections)!=null?Ws:SC(se);!Q&&(Math.abs(Lr)>1||Math.abs(yr)>1)&&ee(Math.abs(Lr)>Math.abs(yr)?"x":"y");let Nn={x:0,y:0};const Vs=In=>1/(1.5+Math.abs(In)/20);if(Q==="y"){if(Dr.includes("top")||Dr.includes("bottom"))if(Dr.includes("top")&&yr<0||Dr.includes("bottom")&&yr>0)Nn.y=yr;else{const In=yr*Vs(yr);Nn.y=Math.abs(In)<Math.abs(yr)?In:yr}}else if(Q==="x"&&(Dr.includes("left")||Dr.includes("right")))if(Dr.includes("left")&&Lr<0||Dr.includes("right")&&Lr>0)Nn.x=Lr;else{const In=Lr*Vs(Lr);Nn.x=Math.abs(In)<Math.abs(Lr)?In:Lr}(Math.abs(Nn.x)>0||Math.abs(Nn.y)>0)&&I(!0),(jr=Ke.current)==null||jr.style.setProperty("--swipe-amount-x",`${Nn.x}px`),(qr=Ke.current)==null||qr.style.setProperty("--swipe-amount-y",`${Nn.y}px`)}},dr&&!m.jsx&&et!=="loading"?Oe.createElement("button",{"aria-label":he,"data-disabled":Bs,"data-close-button":!0,onClick:Bs||!tt?()=>{}:()=>{Cn(),m.onDismiss==null||m.onDismiss.call(m,m)},className:Ys(fe?.closeButton,m==null||(n=m.classNames)==null?void 0:n.closeButton)},($s=de?.close)!=null?$s:oC):null,(et||m.icon||m.promise)&&m.icon!==null&&(de?.[et]!==null||m.icon)?Oe.createElement("div",{"data-icon":"",className:Ys(fe?.icon,m==null||(s=m.classNames)==null?void 0:s.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||La():null,m.type!=="loading"?Us:null):null,Oe.createElement("div",{"data-content":"",className:Ys(fe?.content,m==null||(a=m.classNames)==null?void 0:a.content)},Oe.createElement("div",{"data-title":"",className:Ys(fe?.title,m==null||(o=m.classNames)==null?void 0:o.title)},m.jsx?m.jsx:typeof m.title=="function"?m.title():m.title),m.description?Oe.createElement("div",{"data-description":"",className:Ys(re,Ye,fe?.description,m==null||(u=m.classNames)==null?void 0:u.description)},typeof m.description=="function"?m.description():m.description):null),Oe.isValidElement(m.cancel)?m.cancel:m.cancel&&Pf(m.cancel)?Oe.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||U,onClick:mt=>{Pf(m.cancel)&&tt&&(m.cancel.onClick==null||m.cancel.onClick.call(m.cancel,mt),Cn())},className:Ys(fe?.cancelButton,m==null||(f=m.classNames)==null?void 0:f.cancelButton)},m.cancel.label):null,Oe.isValidElement(m.action)?m.action:m.action&&Pf(m.action)?Oe.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||z,onClick:mt=>{Pf(m.action)&&(m.action.onClick==null||m.action.onClick.call(m.action,mt),!mt.defaultPrevented&&Cn())},className:Ys(fe?.actionButton,m==null||(d=m.classNames)==null?void 0:d.actionButton)},m.action.label):null)};function m1(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function bC(e,t){const r={};return[e,t].forEach((n,s)=>{const a=s===1,o=a?"--mobile-offset":"--offset",u=a?gC:xC;function f(d){["top","right","bottom","left"].forEach(p=>{r[`${o}-${p}`]=typeof d=="number"?`${d}px`:d})}typeof n=="number"||typeof n=="string"?f(n):typeof n=="object"?["top","right","bottom","left"].forEach(d=>{n[d]===void 0?r[`${o}-${d}`]=u:r[`${o}-${d}`]=typeof n[d]=="number"?`${n[d]}px`:n[d]}):f(u)}),r}const EC=Oe.forwardRef(function(t,r){const{id:n,invert:s,position:a="bottom-right",hotkey:o=["altKey","KeyT"],expand:u,closeButton:f,className:d,offset:p,mobileOffset:m,theme:g="light",richColors:y,duration:w,style:v,visibleToasts:S=mC,toastOptions:E,dir:A=m1(),gap:b=yC,icons:D,containerAriaLabel:O="Notifications"}=t,[C,T]=Oe.useState([]),U=Oe.useMemo(()=>n?C.filter(N=>N.toasterId===n):C.filter(N=>!N.toasterId),[C,n]),z=Oe.useMemo(()=>Array.from(new Set([a].concat(U.filter(N=>N.position).map(N=>N.position)))),[U,a]),[Z,re]=Oe.useState([]),[P,se]=Oe.useState(!1),[me,ce]=Oe.useState(!1),[fe,de]=Oe.useState(g!=="system"?g:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),he=Oe.useRef(null),Q=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),ee=Oe.useRef(null),V=Oe.useRef(!1),F=Oe.useCallback(N=>{T(L=>{var B;return(B=L.find(q=>q.id===N.id))!=null&&B.delete||zn.dismiss(N.id),L.filter(({id:q})=>q!==N.id)})},[]);return Oe.useEffect(()=>zn.subscribe(N=>{if(N.dismiss){requestAnimationFrame(()=>{T(L=>L.map(B=>B.id===N.id?{...B,delete:!0}:B))});return}setTimeout(()=>{Mw.flushSync(()=>{T(L=>{const B=L.findIndex(q=>q.id===N.id);return B!==-1?[...L.slice(0,B),{...L[B],...N},...L.slice(B+1)]:[N,...L]})})})}),[C]),Oe.useEffect(()=>{if(g!=="system"){de(g);return}if(g==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?de("dark"):de("light")),typeof window>"u")return;const N=window.matchMedia("(prefers-color-scheme: dark)");try{N.addEventListener("change",({matches:L})=>{de(L?"dark":"light")})}catch{N.addListener(({matches:B})=>{try{de(B?"dark":"light")}catch(q){console.error(q)}})}},[g]),Oe.useEffect(()=>{C.length<=1&&se(!1)},[C]),Oe.useEffect(()=>{const N=L=>{var B;if(o.every(Y=>L[Y]||L.code===Y)){var ne;se(!0),(ne=he.current)==null||ne.focus()}L.code==="Escape"&&(document.activeElement===he.current||(B=he.current)!=null&&B.contains(document.activeElement))&&se(!1)};return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},[o]),Oe.useEffect(()=>{if(he.current)return()=>{ee.current&&(ee.current.focus({preventScroll:!0}),ee.current=null,V.current=!1)}},[he.current]),Oe.createElement("section",{ref:r,"aria-label":`${O} ${Q}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},z.map((N,L)=>{var B;const[q,ne]=N.split("-");return U.length?Oe.createElement("ol",{key:N,dir:A==="auto"?m1():A,tabIndex:-1,ref:he,className:d,"data-sonner-toaster":!0,"data-sonner-theme":fe,"data-y-position":q,"data-x-position":ne,style:{"--front-toast-height":`${((B=Z[0])==null?void 0:B.height)||0}px`,"--width":`${vC}px`,"--gap":`${b}px`,...v,...bC(p,m)},onBlur:Y=>{V.current&&!Y.currentTarget.contains(Y.relatedTarget)&&(V.current=!1,ee.current&&(ee.current.focus({preventScroll:!0}),ee.current=null))},onFocus:Y=>{Y.target instanceof HTMLElement&&Y.target.dataset.dismissible==="false"||V.current||(V.current=!0,ee.current=Y.relatedTarget)},onMouseEnter:()=>se(!0),onMouseMove:()=>se(!0),onMouseLeave:()=>{me||se(!1)},onDragEnd:()=>se(!1),onPointerDown:Y=>{Y.target instanceof HTMLElement&&Y.target.dataset.dismissible==="false"||ce(!0)},onPointerUp:()=>ce(!1)},U.filter(Y=>!Y.position&&L===0||Y.position===N).map((Y,oe)=>{var le,te;return Oe.createElement(kC,{key:Y.id,icons:D,index:oe,toast:Y,defaultRichColors:y,duration:(le=E?.duration)!=null?le:w,className:E?.className,descriptionClassName:E?.descriptionClassName,invert:s,visibleToasts:S,closeButton:(te=E?.closeButton)!=null?te:f,interacting:me,position:N,style:E?.style,unstyled:E?.unstyled,classNames:E?.classNames,cancelButtonStyle:E?.cancelButtonStyle,actionButtonStyle:E?.actionButtonStyle,closeButtonAriaLabel:E?.closeButtonAriaLabel,removeToast:F,toasts:U.filter(I=>I.position==Y.position),heights:Z.filter(I=>I.position==Y.position),setHeights:re,expandByDefault:u,gap:b,expanded:P,swipeDirections:t.swipeDirections})})):null}))}),TC=({...e})=>{const{theme:t="system"}=Q4();return c.jsx(EC,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})},Qt=j.forwardRef(({className:e,type:t,...r},n)=>c.jsx("input",{type:t,"data-slot":"input",className:Et("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),ref:n,...r}));Qt.displayName="Input";var CC="Label",t2=j.forwardRef((e,t)=>c.jsx(St.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));t2.displayName=CC;var NC=t2;function ct({className:e,...t}){return c.jsx(NC,{"data-slot":"label",className:Et("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}function x1(e,[t,r]){return Math.min(r,Math.max(t,e))}function AC(e,t=globalThis?.document){const r=xi(e);j.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var jC="DismissableLayer",Ep="dismissableLayer.update",DC="dismissableLayer.pointerDownOutside",FC="dismissableLayer.focusOutside",g1,r2=j.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),um=j.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:o,onDismiss:u,...f}=e,d=j.useContext(r2),[p,m]=j.useState(null),g=p?.ownerDocument??globalThis?.document,[,y]=j.useState({}),w=er(t,T=>m(T)),v=Array.from(d.layers),[S]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),E=v.indexOf(S),A=p?v.indexOf(p):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,D=A>=E,O=IC(T=>{const U=T.target,z=[...d.branches].some(Z=>Z.contains(U));!D||z||(s?.(T),o?.(T),T.defaultPrevented||u?.())},g),C=OC(T=>{const U=T.target;[...d.branches].some(Z=>Z.contains(U))||(a?.(T),o?.(T),T.defaultPrevented||u?.())},g);return AC(T=>{A===d.layers.size-1&&(n?.(T),!T.defaultPrevented&&u&&(T.preventDefault(),u()))},g),j.useEffect(()=>{if(p)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(g1=g.body.style.pointerEvents,g.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(p)),d.layers.add(p),v1(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(g.body.style.pointerEvents=g1)}},[p,g,r,d]),j.useEffect(()=>()=>{p&&(d.layers.delete(p),d.layersWithOutsidePointerEventsDisabled.delete(p),v1())},[p,d]),j.useEffect(()=>{const T=()=>y({});return document.addEventListener(Ep,T),()=>document.removeEventListener(Ep,T)},[]),c.jsx(St.div,{...f,ref:w,style:{pointerEvents:b?D?"auto":"none":void 0,...e.style},onFocusCapture:Nt(e.onFocusCapture,C.onFocusCapture),onBlurCapture:Nt(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Nt(e.onPointerDownCapture,O.onPointerDownCapture)})});um.displayName=jC;var RC="DismissableLayerBranch",PC=j.forwardRef((e,t)=>{const r=j.useContext(r2),n=j.useRef(null),s=er(t,n);return j.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),c.jsx(St.div,{...e,ref:s})});PC.displayName=RC;function IC(e,t=globalThis?.document){const r=xi(e),n=j.useRef(!1),s=j.useRef(()=>{});return j.useEffect(()=>{const a=u=>{if(u.target&&!n.current){let f=function(){n2(DC,r,d,{discrete:!0})};const d={originalEvent:u};u.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=f,t.addEventListener("click",s.current,{once:!0})):f()}else t.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function OC(e,t=globalThis?.document){const r=xi(e),n=j.useRef(!1);return j.useEffect(()=>{const s=a=>{a.target&&!n.current&&n2(FC,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function v1(){const e=new CustomEvent(Ep);document.dispatchEvent(e)}function n2(e,t,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?S4(s,a):s.dispatchEvent(a)}var Bh=0;function s2(){j.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??y1()),document.body.insertAdjacentElement("beforeend",e[1]??y1()),Bh++,()=>{Bh===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Bh--}},[])}function y1(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Uh="focusScope.autoFocusOnMount",$h="focusScope.autoFocusOnUnmount",w1={bubbles:!1,cancelable:!0},LC="FocusScope",fm=j.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:a,...o}=e,[u,f]=j.useState(null),d=xi(s),p=xi(a),m=j.useRef(null),g=er(t,v=>f(v)),y=j.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;j.useEffect(()=>{if(n){let v=function(b){if(y.paused||!u)return;const D=b.target;u.contains(D)?m.current=D:oi(m.current,{select:!0})},S=function(b){if(y.paused||!u)return;const D=b.relatedTarget;D!==null&&(u.contains(D)||oi(m.current,{select:!0}))},E=function(b){if(document.activeElement===document.body)for(const O of b)O.removedNodes.length>0&&oi(u)};document.addEventListener("focusin",v),document.addEventListener("focusout",S);const A=new MutationObserver(E);return u&&A.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",S),A.disconnect()}}},[n,u,y.paused]),j.useEffect(()=>{if(u){S1.add(y);const v=document.activeElement;if(!u.contains(v)){const E=new CustomEvent(Uh,w1);u.addEventListener(Uh,d),u.dispatchEvent(E),E.defaultPrevented||(MC(WC(a2(u)),{select:!0}),document.activeElement===v&&oi(u))}return()=>{u.removeEventListener(Uh,d),setTimeout(()=>{const E=new CustomEvent($h,w1);u.addEventListener($h,p),u.dispatchEvent(E),E.defaultPrevented||oi(v??document.body,{select:!0}),u.removeEventListener($h,p),S1.remove(y)},0)}}},[u,d,p,y]);const w=j.useCallback(v=>{if(!r&&!n||y.paused)return;const S=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,E=document.activeElement;if(S&&E){const A=v.currentTarget,[b,D]=BC(A);b&&D?!v.shiftKey&&E===D?(v.preventDefault(),r&&oi(b,{select:!0})):v.shiftKey&&E===b&&(v.preventDefault(),r&&oi(D,{select:!0})):E===A&&v.preventDefault()}},[r,n,y.paused]);return c.jsx(St.div,{tabIndex:-1,...o,ref:g,onKeyDown:w})});fm.displayName=LC;function MC(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(oi(n,{select:t}),document.activeElement!==r)return}function BC(e){const t=a2(e),r=_1(t,e),n=_1(t.reverse(),e);return[r,n]}function a2(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function _1(e,t){for(const r of e)if(!UC(r,{upTo:t}))return r}function UC(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function $C(e){return e instanceof HTMLInputElement&&"select"in e}function oi(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&$C(e)&&t&&e.select()}}var S1=zC();function zC(){let e=[];return{add(t){const r=e[0];t!==r&&r?.pause(),e=k1(e,t),e.unshift(t)},remove(t){e=k1(e,t),e[0]?.resume()}}}function k1(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function WC(e){return e.filter(t=>t.tagName!=="A")}const VC=["top","right","bottom","left"],gi=Math.min,qn=Math.max,id=Math.round,If=Math.floor,aa=e=>({x:e,y:e}),HC={left:"right",right:"left",bottom:"top",top:"bottom"},GC={start:"end",end:"start"};function Tp(e,t,r){return qn(e,gi(t,r))}function Na(e,t){return typeof e=="function"?e(t):e}function Aa(e){return e.split("-")[0]}function Rl(e){return e.split("-")[1]}function dm(e){return e==="x"?"y":"x"}function hm(e){return e==="y"?"height":"width"}const XC=new Set(["top","bottom"]);function ra(e){return XC.has(Aa(e))?"y":"x"}function pm(e){return dm(ra(e))}function KC(e,t,r){r===void 0&&(r=!1);const n=Rl(e),s=pm(e),a=hm(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(o=od(o)),[o,od(o)]}function qC(e){const t=od(e);return[Cp(e),t,Cp(t)]}function Cp(e){return e.replace(/start|end/g,t=>GC[t])}const b1=["left","right"],E1=["right","left"],YC=["top","bottom"],JC=["bottom","top"];function QC(e,t,r){switch(e){case"top":case"bottom":return r?t?E1:b1:t?b1:E1;case"left":case"right":return t?YC:JC;default:return[]}}function ZC(e,t,r,n){const s=Rl(e);let a=QC(Aa(e),r==="start",n);return s&&(a=a.map(o=>o+"-"+s),t&&(a=a.concat(a.map(Cp)))),a}function od(e){return e.replace(/left|right|bottom|top/g,t=>HC[t])}function eN(e){return{top:0,right:0,bottom:0,left:0,...e}}function i2(e){return typeof e!="number"?eN(e):{top:e,right:e,bottom:e,left:e}}function ld(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function T1(e,t,r){let{reference:n,floating:s}=e;const a=ra(t),o=pm(t),u=hm(o),f=Aa(t),d=a==="y",p=n.x+n.width/2-s.width/2,m=n.y+n.height/2-s.height/2,g=n[u]/2-s[u]/2;let y;switch(f){case"top":y={x:p,y:n.y-s.height};break;case"bottom":y={x:p,y:n.y+n.height};break;case"right":y={x:n.x+n.width,y:m};break;case"left":y={x:n.x-s.width,y:m};break;default:y={x:n.x,y:n.y}}switch(Rl(t)){case"start":y[o]-=g*(r&&d?-1:1);break;case"end":y[o]+=g*(r&&d?-1:1);break}return y}const tN=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:a=[],platform:o}=r,u=a.filter(Boolean),f=await(o.isRTL==null?void 0:o.isRTL(t));let d=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:p,y:m}=T1(d,n,f),g=n,y={},w=0;for(let v=0;v<u.length;v++){const{name:S,fn:E}=u[v],{x:A,y:b,data:D,reset:O}=await E({x:p,y:m,initialPlacement:n,placement:g,strategy:s,middlewareData:y,rects:d,platform:o,elements:{reference:e,floating:t}});p=A??p,m=b??m,y={...y,[S]:{...y[S],...D}},O&&w<=50&&(w++,typeof O=="object"&&(O.placement&&(g=O.placement),O.rects&&(d=O.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):O.rects),{x:p,y:m}=T1(d,g,f)),v=-1)}return{x:p,y:m,placement:g,strategy:s,middlewareData:y}};async function Wc(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:a,rects:o,elements:u,strategy:f}=e,{boundary:d="clippingAncestors",rootBoundary:p="viewport",elementContext:m="floating",altBoundary:g=!1,padding:y=0}=Na(t,e),w=i2(y),S=u[g?m==="floating"?"reference":"floating":m],E=ld(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(S)))==null||r?S:S.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(u.floating)),boundary:d,rootBoundary:p,strategy:f})),A=m==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,b=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u.floating)),D=await(a.isElement==null?void 0:a.isElement(b))?await(a.getScale==null?void 0:a.getScale(b))||{x:1,y:1}:{x:1,y:1},O=ld(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:A,offsetParent:b,strategy:f}):A);return{top:(E.top-O.top+w.top)/D.y,bottom:(O.bottom-E.bottom+w.bottom)/D.y,left:(E.left-O.left+w.left)/D.x,right:(O.right-E.right+w.right)/D.x}}const rN=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:a,platform:o,elements:u,middlewareData:f}=t,{element:d,padding:p=0}=Na(e,t)||{};if(d==null)return{};const m=i2(p),g={x:r,y:n},y=pm(s),w=hm(y),v=await o.getDimensions(d),S=y==="y",E=S?"top":"left",A=S?"bottom":"right",b=S?"clientHeight":"clientWidth",D=a.reference[w]+a.reference[y]-g[y]-a.floating[w],O=g[y]-a.reference[y],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(d));let T=C?C[b]:0;(!T||!await(o.isElement==null?void 0:o.isElement(C)))&&(T=u.floating[b]||a.floating[w]);const U=D/2-O/2,z=T/2-v[w]/2-1,Z=gi(m[E],z),re=gi(m[A],z),P=Z,se=T-v[w]-re,me=T/2-v[w]/2+U,ce=Tp(P,me,se),fe=!f.arrow&&Rl(s)!=null&&me!==ce&&a.reference[w]/2-(me<P?Z:re)-v[w]/2<0,de=fe?me<P?me-P:me-se:0;return{[y]:g[y]+de,data:{[y]:ce,centerOffset:me-ce-de,...fe&&{alignmentOffset:de}},reset:fe}}}),nN=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:a,rects:o,initialPlacement:u,platform:f,elements:d}=t,{mainAxis:p=!0,crossAxis:m=!0,fallbackPlacements:g,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:v=!0,...S}=Na(e,t);if((r=a.arrow)!=null&&r.alignmentOffset)return{};const E=Aa(s),A=ra(u),b=Aa(u)===u,D=await(f.isRTL==null?void 0:f.isRTL(d.floating)),O=g||(b||!v?[od(u)]:qC(u)),C=w!=="none";!g&&C&&O.push(...ZC(u,v,w,D));const T=[u,...O],U=await Wc(t,S),z=[];let Z=((n=a.flip)==null?void 0:n.overflows)||[];if(p&&z.push(U[E]),m){const me=KC(s,o,D);z.push(U[me[0]],U[me[1]])}if(Z=[...Z,{placement:s,overflows:z}],!z.every(me=>me<=0)){var re,P;const me=(((re=a.flip)==null?void 0:re.index)||0)+1,ce=T[me];if(ce&&(!(m==="alignment"?A!==ra(ce):!1)||Z.every(he=>ra(he.placement)===A?he.overflows[0]>0:!0)))return{data:{index:me,overflows:Z},reset:{placement:ce}};let fe=(P=Z.filter(de=>de.overflows[0]<=0).sort((de,he)=>de.overflows[1]-he.overflows[1])[0])==null?void 0:P.placement;if(!fe)switch(y){case"bestFit":{var se;const de=(se=Z.filter(he=>{if(C){const Q=ra(he.placement);return Q===A||Q==="y"}return!0}).map(he=>[he.placement,he.overflows.filter(Q=>Q>0).reduce((Q,ee)=>Q+ee,0)]).sort((he,Q)=>he[1]-Q[1])[0])==null?void 0:se[0];de&&(fe=de);break}case"initialPlacement":fe=u;break}if(s!==fe)return{reset:{placement:fe}}}return{}}}};function C1(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function N1(e){return VC.some(t=>e[t]>=0)}const sN=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...s}=Na(e,t);switch(n){case"referenceHidden":{const a=await Wc(t,{...s,elementContext:"reference"}),o=C1(a,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:N1(o)}}}case"escaped":{const a=await Wc(t,{...s,altBoundary:!0}),o=C1(a,r.floating);return{data:{escapedOffsets:o,escaped:N1(o)}}}default:return{}}}}},o2=new Set(["left","top"]);async function aN(e,t){const{placement:r,platform:n,elements:s}=e,a=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=Aa(r),u=Rl(r),f=ra(r)==="y",d=o2.has(o)?-1:1,p=a&&f?-1:1,m=Na(t,e);let{mainAxis:g,crossAxis:y,alignmentAxis:w}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return u&&typeof w=="number"&&(y=u==="end"?w*-1:w),f?{x:y*p,y:g*d}:{x:g*d,y:y*p}}const iN=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:a,placement:o,middlewareData:u}=t,f=await aN(t,e);return o===((r=u.offset)==null?void 0:r.placement)&&(n=u.arrow)!=null&&n.alignmentOffset?{}:{x:s+f.x,y:a+f.y,data:{...f,placement:o}}}}},oN=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:s}=t,{mainAxis:a=!0,crossAxis:o=!1,limiter:u={fn:S=>{let{x:E,y:A}=S;return{x:E,y:A}}},...f}=Na(e,t),d={x:r,y:n},p=await Wc(t,f),m=ra(Aa(s)),g=dm(m);let y=d[g],w=d[m];if(a){const S=g==="y"?"top":"left",E=g==="y"?"bottom":"right",A=y+p[S],b=y-p[E];y=Tp(A,y,b)}if(o){const S=m==="y"?"top":"left",E=m==="y"?"bottom":"right",A=w+p[S],b=w-p[E];w=Tp(A,w,b)}const v=u.fn({...t,[g]:y,[m]:w});return{...v,data:{x:v.x-r,y:v.y-n,enabled:{[g]:a,[m]:o}}}}}},lN=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:s,rects:a,middlewareData:o}=t,{offset:u=0,mainAxis:f=!0,crossAxis:d=!0}=Na(e,t),p={x:r,y:n},m=ra(s),g=dm(m);let y=p[g],w=p[m];const v=Na(u,t),S=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(f){const b=g==="y"?"height":"width",D=a.reference[g]-a.floating[b]+S.mainAxis,O=a.reference[g]+a.reference[b]-S.mainAxis;y<D?y=D:y>O&&(y=O)}if(d){var E,A;const b=g==="y"?"width":"height",D=o2.has(Aa(s)),O=a.reference[m]-a.floating[b]+(D&&((E=o.offset)==null?void 0:E[m])||0)+(D?0:S.crossAxis),C=a.reference[m]+a.reference[b]+(D?0:((A=o.offset)==null?void 0:A[m])||0)-(D?S.crossAxis:0);w<O?w=O:w>C&&(w=C)}return{[g]:y,[m]:w}}}},cN=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:s,rects:a,platform:o,elements:u}=t,{apply:f=()=>{},...d}=Na(e,t),p=await Wc(t,d),m=Aa(s),g=Rl(s),y=ra(s)==="y",{width:w,height:v}=a.floating;let S,E;m==="top"||m==="bottom"?(S=m,E=g===(await(o.isRTL==null?void 0:o.isRTL(u.floating))?"start":"end")?"left":"right"):(E=m,S=g==="end"?"top":"bottom");const A=v-p.top-p.bottom,b=w-p.left-p.right,D=gi(v-p[S],A),O=gi(w-p[E],b),C=!t.middlewareData.shift;let T=D,U=O;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(U=b),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(T=A),C&&!g){const Z=qn(p.left,0),re=qn(p.right,0),P=qn(p.top,0),se=qn(p.bottom,0);y?U=w-2*(Z!==0||re!==0?Z+re:qn(p.left,p.right)):T=v-2*(P!==0||se!==0?P+se:qn(p.top,p.bottom))}await f({...t,availableWidth:U,availableHeight:T});const z=await o.getDimensions(u.floating);return w!==z.width||v!==z.height?{reset:{rects:!0}}:{}}}};function jd(){return typeof window<"u"}function Pl(e){return l2(e)?(e.nodeName||"").toLowerCase():"#document"}function Zn(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function fa(e){var t;return(t=(l2(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function l2(e){return jd()?e instanceof Node||e instanceof Zn(e).Node:!1}function Os(e){return jd()?e instanceof Element||e instanceof Zn(e).Element:!1}function ca(e){return jd()?e instanceof HTMLElement||e instanceof Zn(e).HTMLElement:!1}function A1(e){return!jd()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Zn(e).ShadowRoot}const uN=new Set(["inline","contents"]);function mu(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=Ls(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!uN.has(s)}const fN=new Set(["table","td","th"]);function dN(e){return fN.has(Pl(e))}const hN=[":popover-open",":modal"];function Dd(e){return hN.some(t=>{try{return e.matches(t)}catch{return!1}})}const pN=["transform","translate","scale","rotate","perspective"],mN=["transform","translate","scale","rotate","perspective","filter"],xN=["paint","layout","strict","content"];function mm(e){const t=xm(),r=Os(e)?Ls(e):e;return pN.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||mN.some(n=>(r.willChange||"").includes(n))||xN.some(n=>(r.contain||"").includes(n))}function gN(e){let t=vi(e);for(;ca(t)&&!El(t);){if(mm(t))return t;if(Dd(t))return null;t=vi(t)}return null}function xm(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const vN=new Set(["html","body","#document"]);function El(e){return vN.has(Pl(e))}function Ls(e){return Zn(e).getComputedStyle(e)}function Fd(e){return Os(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function vi(e){if(Pl(e)==="html")return e;const t=e.assignedSlot||e.parentNode||A1(e)&&e.host||fa(e);return A1(t)?t.host:t}function c2(e){const t=vi(e);return El(t)?e.ownerDocument?e.ownerDocument.body:e.body:ca(t)&&mu(t)?t:c2(t)}function Vc(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=c2(e),a=s===((n=e.ownerDocument)==null?void 0:n.body),o=Zn(s);if(a){const u=Np(o);return t.concat(o,o.visualViewport||[],mu(s)?s:[],u&&r?Vc(u):[])}return t.concat(s,Vc(s,[],r))}function Np(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function u2(e){const t=Ls(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=ca(e),a=s?e.offsetWidth:r,o=s?e.offsetHeight:n,u=id(r)!==a||id(n)!==o;return u&&(r=a,n=o),{width:r,height:n,$:u}}function gm(e){return Os(e)?e:e.contextElement}function gl(e){const t=gm(e);if(!ca(t))return aa(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:a}=u2(t);let o=(a?id(r.width):r.width)/n,u=(a?id(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!u||!Number.isFinite(u))&&(u=1),{x:o,y:u}}const yN=aa(0);function f2(e){const t=Zn(e);return!xm()||!t.visualViewport?yN:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function wN(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Zn(e)?!1:t}function no(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),a=gm(e);let o=aa(1);t&&(n?Os(n)&&(o=gl(n)):o=gl(e));const u=wN(a,r,n)?f2(a):aa(0);let f=(s.left+u.x)/o.x,d=(s.top+u.y)/o.y,p=s.width/o.x,m=s.height/o.y;if(a){const g=Zn(a),y=n&&Os(n)?Zn(n):n;let w=g,v=Np(w);for(;v&&n&&y!==w;){const S=gl(v),E=v.getBoundingClientRect(),A=Ls(v),b=E.left+(v.clientLeft+parseFloat(A.paddingLeft))*S.x,D=E.top+(v.clientTop+parseFloat(A.paddingTop))*S.y;f*=S.x,d*=S.y,p*=S.x,m*=S.y,f+=b,d+=D,w=Zn(v),v=Np(w)}}return ld({width:p,height:m,x:f,y:d})}function Rd(e,t){const r=Fd(e).scrollLeft;return t?t.left+r:no(fa(e)).left+r}function d2(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-Rd(e,r),s=r.top+t.scrollTop;return{x:n,y:s}}function _N(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const a=s==="fixed",o=fa(n),u=t?Dd(t.floating):!1;if(n===o||u&&a)return r;let f={scrollLeft:0,scrollTop:0},d=aa(1);const p=aa(0),m=ca(n);if((m||!m&&!a)&&((Pl(n)!=="body"||mu(o))&&(f=Fd(n)),ca(n))){const y=no(n);d=gl(n),p.x=y.x+n.clientLeft,p.y=y.y+n.clientTop}const g=o&&!m&&!a?d2(o,f):aa(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-f.scrollLeft*d.x+p.x+g.x,y:r.y*d.y-f.scrollTop*d.y+p.y+g.y}}function SN(e){return Array.from(e.getClientRects())}function kN(e){const t=fa(e),r=Fd(e),n=e.ownerDocument.body,s=qn(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=qn(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+Rd(e);const u=-r.scrollTop;return Ls(n).direction==="rtl"&&(o+=qn(t.clientWidth,n.clientWidth)-s),{width:s,height:a,x:o,y:u}}const j1=25;function bN(e,t){const r=Zn(e),n=fa(e),s=r.visualViewport;let a=n.clientWidth,o=n.clientHeight,u=0,f=0;if(s){a=s.width,o=s.height;const p=xm();(!p||p&&t==="fixed")&&(u=s.offsetLeft,f=s.offsetTop)}const d=Rd(n);if(d<=0){const p=n.ownerDocument,m=p.body,g=getComputedStyle(m),y=p.compatMode==="CSS1Compat"&&parseFloat(g.marginLeft)+parseFloat(g.marginRight)||0,w=Math.abs(n.clientWidth-m.clientWidth-y);w<=j1&&(a-=w)}else d<=j1&&(a+=d);return{width:a,height:o,x:u,y:f}}const EN=new Set(["absolute","fixed"]);function TN(e,t){const r=no(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,a=ca(e)?gl(e):aa(1),o=e.clientWidth*a.x,u=e.clientHeight*a.y,f=s*a.x,d=n*a.y;return{width:o,height:u,x:f,y:d}}function D1(e,t,r){let n;if(t==="viewport")n=bN(e,r);else if(t==="document")n=kN(fa(e));else if(Os(t))n=TN(t,r);else{const s=f2(e);n={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return ld(n)}function h2(e,t){const r=vi(e);return r===t||!Os(r)||El(r)?!1:Ls(r).position==="fixed"||h2(r,t)}function CN(e,t){const r=t.get(e);if(r)return r;let n=Vc(e,[],!1).filter(u=>Os(u)&&Pl(u)!=="body"),s=null;const a=Ls(e).position==="fixed";let o=a?vi(e):e;for(;Os(o)&&!El(o);){const u=Ls(o),f=mm(o);!f&&u.position==="fixed"&&(s=null),(a?!f&&!s:!f&&u.position==="static"&&!!s&&EN.has(s.position)||mu(o)&&!f&&h2(e,o))?n=n.filter(p=>p!==o):s=u,o=vi(o)}return t.set(e,n),n}function NN(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const o=[...r==="clippingAncestors"?Dd(t)?[]:CN(t,this._c):[].concat(r),n],u=o[0],f=o.reduce((d,p)=>{const m=D1(t,p,s);return d.top=qn(m.top,d.top),d.right=gi(m.right,d.right),d.bottom=gi(m.bottom,d.bottom),d.left=qn(m.left,d.left),d},D1(t,u,s));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function AN(e){const{width:t,height:r}=u2(e);return{width:t,height:r}}function jN(e,t,r){const n=ca(t),s=fa(t),a=r==="fixed",o=no(e,!0,a,t);let u={scrollLeft:0,scrollTop:0};const f=aa(0);function d(){f.x=Rd(s)}if(n||!n&&!a)if((Pl(t)!=="body"||mu(s))&&(u=Fd(t)),n){const y=no(t,!0,a,t);f.x=y.x+t.clientLeft,f.y=y.y+t.clientTop}else s&&d();a&&!n&&s&&d();const p=s&&!n&&!a?d2(s,u):aa(0),m=o.left+u.scrollLeft-f.x-p.x,g=o.top+u.scrollTop-f.y-p.y;return{x:m,y:g,width:o.width,height:o.height}}function zh(e){return Ls(e).position==="static"}function F1(e,t){if(!ca(e)||Ls(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return fa(e)===r&&(r=r.ownerDocument.body),r}function p2(e,t){const r=Zn(e);if(Dd(e))return r;if(!ca(e)){let s=vi(e);for(;s&&!El(s);){if(Os(s)&&!zh(s))return s;s=vi(s)}return r}let n=F1(e,t);for(;n&&dN(n)&&zh(n);)n=F1(n,t);return n&&El(n)&&zh(n)&&!mm(n)?r:n||gN(e)||r}const DN=async function(e){const t=this.getOffsetParent||p2,r=this.getDimensions,n=await r(e.floating);return{reference:jN(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function FN(e){return Ls(e).direction==="rtl"}const RN={convertOffsetParentRelativeRectToViewportRelativeRect:_N,getDocumentElement:fa,getClippingRect:NN,getOffsetParent:p2,getElementRects:DN,getClientRects:SN,getDimensions:AN,getScale:gl,isElement:Os,isRTL:FN};function m2(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function PN(e,t){let r=null,n;const s=fa(e);function a(){var u;clearTimeout(n),(u=r)==null||u.disconnect(),r=null}function o(u,f){u===void 0&&(u=!1),f===void 0&&(f=1),a();const d=e.getBoundingClientRect(),{left:p,top:m,width:g,height:y}=d;if(u||t(),!g||!y)return;const w=If(m),v=If(s.clientWidth-(p+g)),S=If(s.clientHeight-(m+y)),E=If(p),b={rootMargin:-w+"px "+-v+"px "+-S+"px "+-E+"px",threshold:qn(0,gi(1,f))||1};let D=!0;function O(C){const T=C[0].intersectionRatio;if(T!==f){if(!D)return o();T?o(!1,T):n=setTimeout(()=>{o(!1,1e-7)},1e3)}T===1&&!m2(d,e.getBoundingClientRect())&&o(),D=!1}try{r=new IntersectionObserver(O,{...b,root:s.ownerDocument})}catch{r=new IntersectionObserver(O,b)}r.observe(e)}return o(!0),a}function IN(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:f=!1}=n,d=gm(e),p=s||a?[...d?Vc(d):[],...Vc(t)]:[];p.forEach(E=>{s&&E.addEventListener("scroll",r,{passive:!0}),a&&E.addEventListener("resize",r)});const m=d&&u?PN(d,r):null;let g=-1,y=null;o&&(y=new ResizeObserver(E=>{let[A]=E;A&&A.target===d&&y&&(y.unobserve(t),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var b;(b=y)==null||b.observe(t)})),r()}),d&&!f&&y.observe(d),y.observe(t));let w,v=f?no(e):null;f&&S();function S(){const E=no(e);v&&!m2(v,E)&&r(),v=E,w=requestAnimationFrame(S)}return r(),()=>{var E;p.forEach(A=>{s&&A.removeEventListener("scroll",r),a&&A.removeEventListener("resize",r)}),m?.(),(E=y)==null||E.disconnect(),y=null,f&&cancelAnimationFrame(w)}}const ON=iN,LN=oN,MN=nN,BN=cN,UN=sN,R1=rN,$N=lN,zN=(e,t,r)=>{const n=new Map,s={platform:RN,...r},a={...s.platform,_c:n};return tN(e,t,{...s,platform:a})};var WN=typeof document<"u",VN=function(){},td=WN?j.useLayoutEffect:VN;function cd(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!cd(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const a=s[n];if(!(a==="_owner"&&e.$$typeof)&&!cd(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function x2(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function P1(e,t){const r=x2(e);return Math.round(t*r)/r}function Wh(e){const t=j.useRef(e);return td(()=>{t.current=e}),t}function HN(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:a,floating:o}={},transform:u=!0,whileElementsMounted:f,open:d}=e,[p,m]=j.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[g,y]=j.useState(n);cd(g,n)||y(n);const[w,v]=j.useState(null),[S,E]=j.useState(null),A=j.useCallback(he=>{he!==C.current&&(C.current=he,v(he))},[]),b=j.useCallback(he=>{he!==T.current&&(T.current=he,E(he))},[]),D=a||w,O=o||S,C=j.useRef(null),T=j.useRef(null),U=j.useRef(p),z=f!=null,Z=Wh(f),re=Wh(s),P=Wh(d),se=j.useCallback(()=>{if(!C.current||!T.current)return;const he={placement:t,strategy:r,middleware:g};re.current&&(he.platform=re.current),zN(C.current,T.current,he).then(Q=>{const ee={...Q,isPositioned:P.current!==!1};me.current&&!cd(U.current,ee)&&(U.current=ee,hu.flushSync(()=>{m(ee)}))})},[g,t,r,re,P]);td(()=>{d===!1&&U.current.isPositioned&&(U.current.isPositioned=!1,m(he=>({...he,isPositioned:!1})))},[d]);const me=j.useRef(!1);td(()=>(me.current=!0,()=>{me.current=!1}),[]),td(()=>{if(D&&(C.current=D),O&&(T.current=O),D&&O){if(Z.current)return Z.current(D,O,se);se()}},[D,O,se,Z,z]);const ce=j.useMemo(()=>({reference:C,floating:T,setReference:A,setFloating:b}),[A,b]),fe=j.useMemo(()=>({reference:D,floating:O}),[D,O]),de=j.useMemo(()=>{const he={position:r,left:0,top:0};if(!fe.floating)return he;const Q=P1(fe.floating,p.x),ee=P1(fe.floating,p.y);return u?{...he,transform:"translate("+Q+"px, "+ee+"px)",...x2(fe.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Q,top:ee}},[r,u,fe.floating,p.x,p.y]);return j.useMemo(()=>({...p,update:se,refs:ce,elements:fe,floatingStyles:de}),[p,se,ce,fe,de])}const GN=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?R1({element:n.current,padding:s}).fn(r):{}:n?R1({element:n,padding:s}).fn(r):{}}}},XN=(e,t)=>({...ON(e),options:[e,t]}),KN=(e,t)=>({...LN(e),options:[e,t]}),qN=(e,t)=>({...$N(e),options:[e,t]}),YN=(e,t)=>({...MN(e),options:[e,t]}),JN=(e,t)=>({...BN(e),options:[e,t]}),QN=(e,t)=>({...UN(e),options:[e,t]}),ZN=(e,t)=>({...GN(e),options:[e,t]});var eA="Arrow",g2=j.forwardRef((e,t)=>{const{children:r,width:n=10,height:s=5,...a}=e;return c.jsx(St.svg,{...a,ref:t,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:c.jsx("polygon",{points:"0,0 30,0 15,10"})})});g2.displayName=eA;var tA=g2;function v2(e){const[t,r]=j.useState(void 0);return hn(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const a=s[0];let o,u;if("borderBoxSize"in a){const f=a.borderBoxSize,d=Array.isArray(f)?f[0]:f;o=d.inlineSize,u=d.blockSize}else o=e.offsetWidth,u=e.offsetHeight;r({width:o,height:u})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var vm="Popper",[y2,w2]=Da(vm),[rA,_2]=y2(vm),S2=e=>{const{__scopePopper:t,children:r}=e,[n,s]=j.useState(null);return c.jsx(rA,{scope:t,anchor:n,onAnchorChange:s,children:r})};S2.displayName=vm;var k2="PopperAnchor",b2=j.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...s}=e,a=_2(k2,r),o=j.useRef(null),u=er(t,o),f=j.useRef(null);return j.useEffect(()=>{const d=f.current;f.current=n?.current||o.current,d!==f.current&&a.onAnchorChange(f.current)}),n?null:c.jsx(St.div,{...s,ref:u})});b2.displayName=k2;var ym="PopperContent",[nA,sA]=y2(ym),E2=j.forwardRef((e,t)=>{const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:a="center",alignOffset:o=0,arrowPadding:u=0,avoidCollisions:f=!0,collisionBoundary:d=[],collisionPadding:p=0,sticky:m="partial",hideWhenDetached:g=!1,updatePositionStrategy:y="optimized",onPlaced:w,...v}=e,S=_2(ym,r),[E,A]=j.useState(null),b=er(t,ne=>A(ne)),[D,O]=j.useState(null),C=v2(D),T=C?.width??0,U=C?.height??0,z=n+(a!=="center"?"-"+a:""),Z=typeof p=="number"?p:{top:0,right:0,bottom:0,left:0,...p},re=Array.isArray(d)?d:[d],P=re.length>0,se={padding:Z,boundary:re.filter(iA),altBoundary:P},{refs:me,floatingStyles:ce,placement:fe,isPositioned:de,middlewareData:he}=HN({strategy:"fixed",placement:z,whileElementsMounted:(...ne)=>IN(...ne,{animationFrame:y==="always"}),elements:{reference:S.anchor},middleware:[XN({mainAxis:s+U,alignmentAxis:o}),f&&KN({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?qN():void 0,...se}),f&&YN({...se}),JN({...se,apply:({elements:ne,rects:Y,availableWidth:oe,availableHeight:le})=>{const{width:te,height:I}=Y.reference,Ce=ne.floating.style;Ce.setProperty("--radix-popper-available-width",`${oe}px`),Ce.setProperty("--radix-popper-available-height",`${le}px`),Ce.setProperty("--radix-popper-anchor-width",`${te}px`),Ce.setProperty("--radix-popper-anchor-height",`${I}px`)}}),D&&ZN({element:D,padding:u}),oA({arrowWidth:T,arrowHeight:U}),g&&QN({strategy:"referenceHidden",...se})]}),[Q,ee]=N2(fe),V=xi(w);hn(()=>{de&&V?.()},[de,V]);const F=he.arrow?.x,N=he.arrow?.y,L=he.arrow?.centerOffset!==0,[B,q]=j.useState();return hn(()=>{E&&q(window.getComputedStyle(E).zIndex)},[E]),c.jsx("div",{ref:me.setFloating,"data-radix-popper-content-wrapper":"",style:{...ce,transform:de?ce.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:B,"--radix-popper-transform-origin":[he.transformOrigin?.x,he.transformOrigin?.y].join(" "),...he.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:c.jsx(nA,{scope:r,placedSide:Q,onArrowChange:O,arrowX:F,arrowY:N,shouldHideArrow:L,children:c.jsx(St.div,{"data-side":Q,"data-align":ee,...v,ref:b,style:{...v.style,animation:de?void 0:"none"}})})})});E2.displayName=ym;var T2="PopperArrow",aA={top:"bottom",right:"left",bottom:"top",left:"right"},C2=j.forwardRef(function(t,r){const{__scopePopper:n,...s}=t,a=sA(T2,n),o=aA[a.placedSide];return c.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:c.jsx(tA,{...s,ref:r,style:{...s.style,display:"block"}})})});C2.displayName=T2;function iA(e){return e!==null}var oA=e=>({name:"transformOrigin",options:e,fn(t){const{placement:r,rects:n,middlewareData:s}=t,o=s.arrow?.centerOffset!==0,u=o?0:e.arrowWidth,f=o?0:e.arrowHeight,[d,p]=N2(r),m={start:"0%",center:"50%",end:"100%"}[p],g=(s.arrow?.x??0)+u/2,y=(s.arrow?.y??0)+f/2;let w="",v="";return d==="bottom"?(w=o?m:`${g}px`,v=`${-f}px`):d==="top"?(w=o?m:`${g}px`,v=`${n.floating.height+f}px`):d==="right"?(w=`${-f}px`,v=o?m:`${y}px`):d==="left"&&(w=`${n.floating.width+f}px`,v=o?m:`${y}px`),{data:{x:w,y:v}}}});function N2(e){const[t,r="center"]=e.split("-");return[t,r]}var lA=S2,cA=b2,uA=E2,fA=C2,dA="Portal",wm=j.forwardRef((e,t)=>{const{container:r,...n}=e,[s,a]=j.useState(!1);hn(()=>a(!0),[]);const o=r||s&&globalThis?.document?.body;return o?Mw.createPortal(c.jsx(St.div,{...n,ref:t}),o):null});wm.displayName=dA;function A2(e){const t=j.useRef({value:e,previous:e});return j.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var j2=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),hA="VisuallyHidden",pA=j.forwardRef((e,t)=>c.jsx(St.span,{...e,ref:t,style:{...j2,...e.style}}));pA.displayName=hA;var mA=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},qo=new WeakMap,Of=new WeakMap,Lf={},Vh=0,D2=function(e){return e&&(e.host||D2(e.parentNode))},xA=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=D2(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},gA=function(e,t,r,n){var s=xA(t,Array.isArray(e)?e:[e]);Lf[r]||(Lf[r]=new WeakMap);var a=Lf[r],o=[],u=new Set,f=new Set(s),d=function(m){!m||u.has(m)||(u.add(m),d(m.parentNode))};s.forEach(d);var p=function(m){!m||f.has(m)||Array.prototype.forEach.call(m.children,function(g){if(u.has(g))p(g);else try{var y=g.getAttribute(n),w=y!==null&&y!=="false",v=(qo.get(g)||0)+1,S=(a.get(g)||0)+1;qo.set(g,v),a.set(g,S),o.push(g),v===1&&w&&Of.set(g,!0),S===1&&g.setAttribute(r,"true"),w||g.setAttribute(n,"true")}catch(E){console.error("aria-hidden: cannot operate on ",g,E)}})};return p(t),u.clear(),Vh++,function(){o.forEach(function(m){var g=qo.get(m)-1,y=a.get(m)-1;qo.set(m,g),a.set(m,y),g||(Of.has(m)||m.removeAttribute(n),Of.delete(m)),y||m.removeAttribute(r)}),Vh--,Vh||(qo=new WeakMap,qo=new WeakMap,Of=new WeakMap,Lf={})}},F2=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),s=mA(e);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),gA(n,s,r,"aria-hidden")):function(){return null}},ta=function(){return ta=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},ta.apply(this,arguments)};function R2(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function vA(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var rd="right-scroll-bar-position",nd="width-before-scroll-bar",yA="with-scroll-bars-hidden",wA="--removed-body-scroll-bar-size";function Hh(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function _A(e,t){var r=j.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=t,r.facade}var SA=typeof window<"u"?j.useLayoutEffect:j.useEffect,I1=new WeakMap;function kA(e,t){var r=_A(null,function(n){return e.forEach(function(s){return Hh(s,n)})});return SA(function(){var n=I1.get(r);if(n){var s=new Set(n),a=new Set(e),o=r.current;s.forEach(function(u){a.has(u)||Hh(u,null)}),a.forEach(function(u){s.has(u)||Hh(u,o)})}I1.set(r,e)},[e]),r}function bA(e){return e}function EA(e,t){t===void 0&&(t=bA);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(a){var o=t(a,n);return r.push(o),function(){r=r.filter(function(u){return u!==o})}},assignSyncMedium:function(a){for(n=!0;r.length;){var o=r;r=[],o.forEach(a)}r={push:function(u){return a(u)},filter:function(){return r}}},assignMedium:function(a){n=!0;var o=[];if(r.length){var u=r;r=[],u.forEach(a),o=r}var f=function(){var p=o;o=[],p.forEach(a)},d=function(){return Promise.resolve().then(f)};d(),r={push:function(p){o.push(p),d()},filter:function(p){return o=o.filter(p),r}}}};return s}function TA(e){e===void 0&&(e={});var t=EA(null);return t.options=ta({async:!0,ssr:!1},e),t}var P2=function(e){var t=e.sideCar,r=R2(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return j.createElement(n,ta({},r))};P2.isSideCarExport=!0;function CA(e,t){return e.useMedium(t),P2}var I2=TA(),Gh=function(){},Pd=j.forwardRef(function(e,t){var r=j.useRef(null),n=j.useState({onScrollCapture:Gh,onWheelCapture:Gh,onTouchMoveCapture:Gh}),s=n[0],a=n[1],o=e.forwardProps,u=e.children,f=e.className,d=e.removeScrollBar,p=e.enabled,m=e.shards,g=e.sideCar,y=e.noRelative,w=e.noIsolation,v=e.inert,S=e.allowPinchZoom,E=e.as,A=E===void 0?"div":E,b=e.gapMode,D=R2(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),O=g,C=kA([r,t]),T=ta(ta({},D),s);return j.createElement(j.Fragment,null,p&&j.createElement(O,{sideCar:I2,removeScrollBar:d,shards:m,noRelative:y,noIsolation:w,inert:v,setCallbacks:a,allowPinchZoom:!!S,lockRef:r,gapMode:b}),o?j.cloneElement(j.Children.only(u),ta(ta({},T),{ref:C})):j.createElement(A,ta({},T,{className:f,ref:C}),u))});Pd.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Pd.classNames={fullWidth:nd,zeroRight:rd};var NA=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function AA(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=NA();return t&&e.setAttribute("nonce",t),e}function jA(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function DA(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var FA=function(){var e=0,t=null;return{add:function(r){e==0&&(t=AA())&&(jA(t,r),DA(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},RA=function(){var e=FA();return function(t,r){j.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},O2=function(){var e=RA(),t=function(r){var n=r.styles,s=r.dynamic;return e(n,s),null};return t},PA={left:0,top:0,right:0,gap:0},Xh=function(e){return parseInt(e||"",10)||0},IA=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[Xh(r),Xh(n),Xh(s)]},OA=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return PA;var t=IA(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},LA=O2(),vl="data-scroll-locked",MA=function(e,t,r,n){var s=e.left,a=e.top,o=e.right,u=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(yA,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(u,"px ").concat(n,`;
  }
  body[`).concat(vl,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(u,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(rd,` {
    right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(nd,` {
    margin-right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(rd," .").concat(rd,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(nd," .").concat(nd,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(vl,`] {
    `).concat(wA,": ").concat(u,`px;
  }
`)},O1=function(){var e=parseInt(document.body.getAttribute(vl)||"0",10);return isFinite(e)?e:0},BA=function(){j.useEffect(function(){return document.body.setAttribute(vl,(O1()+1).toString()),function(){var e=O1()-1;e<=0?document.body.removeAttribute(vl):document.body.setAttribute(vl,e.toString())}},[])},UA=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,s=n===void 0?"margin":n;BA();var a=j.useMemo(function(){return OA(s)},[s]);return j.createElement(LA,{styles:MA(a,!t,s,r?"":"!important")})},Ap=!1;if(typeof window<"u")try{var Mf=Object.defineProperty({},"passive",{get:function(){return Ap=!0,!0}});window.addEventListener("test",Mf,Mf),window.removeEventListener("test",Mf,Mf)}catch{Ap=!1}var Yo=Ap?{passive:!1}:!1,$A=function(e){return e.tagName==="TEXTAREA"},L2=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!$A(e)&&r[t]==="visible")},zA=function(e){return L2(e,"overflowY")},WA=function(e){return L2(e,"overflowX")},L1=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=M2(e,n);if(s){var a=B2(e,n),o=a[1],u=a[2];if(o>u)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},VA=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},HA=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},M2=function(e,t){return e==="v"?zA(t):WA(t)},B2=function(e,t){return e==="v"?VA(t):HA(t)},GA=function(e,t){return e==="h"&&t==="rtl"?-1:1},XA=function(e,t,r,n,s){var a=GA(e,window.getComputedStyle(t).direction),o=a*n,u=r.target,f=t.contains(u),d=!1,p=o>0,m=0,g=0;do{if(!u)break;var y=B2(e,u),w=y[0],v=y[1],S=y[2],E=v-S-a*w;(w||E)&&M2(e,u)&&(m+=E,g+=w);var A=u.parentNode;u=A&&A.nodeType===Node.DOCUMENT_FRAGMENT_NODE?A.host:A}while(!f&&u!==document.body||f&&(t.contains(u)||t===u));return(p&&Math.abs(m)<1||!p&&Math.abs(g)<1)&&(d=!0),d},Bf=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},M1=function(e){return[e.deltaX,e.deltaY]},B1=function(e){return e&&"current"in e?e.current:e},KA=function(e,t){return e[0]===t[0]&&e[1]===t[1]},qA=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},YA=0,Jo=[];function JA(e){var t=j.useRef([]),r=j.useRef([0,0]),n=j.useRef(),s=j.useState(YA++)[0],a=j.useState(O2)[0],o=j.useRef(e);j.useEffect(function(){o.current=e},[e]),j.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var v=vA([e.lockRef.current],(e.shards||[]).map(B1),!0).filter(Boolean);return v.forEach(function(S){return S.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),v.forEach(function(S){return S.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var u=j.useCallback(function(v,S){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!o.current.allowPinchZoom;var E=Bf(v),A=r.current,b="deltaX"in v?v.deltaX:A[0]-E[0],D="deltaY"in v?v.deltaY:A[1]-E[1],O,C=v.target,T=Math.abs(b)>Math.abs(D)?"h":"v";if("touches"in v&&T==="h"&&C.type==="range")return!1;var U=L1(T,C);if(!U)return!0;if(U?O=T:(O=T==="v"?"h":"v",U=L1(T,C)),!U)return!1;if(!n.current&&"changedTouches"in v&&(b||D)&&(n.current=O),!O)return!0;var z=n.current||O;return XA(z,S,v,z==="h"?b:D)},[]),f=j.useCallback(function(v){var S=v;if(!(!Jo.length||Jo[Jo.length-1]!==a)){var E="deltaY"in S?M1(S):Bf(S),A=t.current.filter(function(O){return O.name===S.type&&(O.target===S.target||S.target===O.shadowParent)&&KA(O.delta,E)})[0];if(A&&A.should){S.cancelable&&S.preventDefault();return}if(!A){var b=(o.current.shards||[]).map(B1).filter(Boolean).filter(function(O){return O.contains(S.target)}),D=b.length>0?u(S,b[0]):!o.current.noIsolation;D&&S.cancelable&&S.preventDefault()}}},[]),d=j.useCallback(function(v,S,E,A){var b={name:v,delta:S,target:E,should:A,shadowParent:QA(E)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(D){return D!==b})},1)},[]),p=j.useCallback(function(v){r.current=Bf(v),n.current=void 0},[]),m=j.useCallback(function(v){d(v.type,M1(v),v.target,u(v,e.lockRef.current))},[]),g=j.useCallback(function(v){d(v.type,Bf(v),v.target,u(v,e.lockRef.current))},[]);j.useEffect(function(){return Jo.push(a),e.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:g}),document.addEventListener("wheel",f,Yo),document.addEventListener("touchmove",f,Yo),document.addEventListener("touchstart",p,Yo),function(){Jo=Jo.filter(function(v){return v!==a}),document.removeEventListener("wheel",f,Yo),document.removeEventListener("touchmove",f,Yo),document.removeEventListener("touchstart",p,Yo)}},[]);var y=e.removeScrollBar,w=e.inert;return j.createElement(j.Fragment,null,w?j.createElement(a,{styles:qA(s)}):null,y?j.createElement(UA,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function QA(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const ZA=CA(I2,JA);var _m=j.forwardRef(function(e,t){return j.createElement(Pd,ta({},e,{ref:t,sideCar:ZA}))});_m.classNames=Pd.classNames;var ej=[" ","Enter","ArrowUp","ArrowDown"],tj=[" ","Enter"],so="Select",[Id,Od,rj]=Lw(so),[Il,sz]=Da(so,[rj,w2]),Ld=w2(),[nj,ki]=Il(so),[sj,aj]=Il(so),U2=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:s,onOpenChange:a,value:o,defaultValue:u,onValueChange:f,dir:d,name:p,autoComplete:m,disabled:g,required:y,form:w}=e,v=Ld(t),[S,E]=j.useState(null),[A,b]=j.useState(null),[D,O]=j.useState(!1),C=lm(d),[T,U]=ro({prop:n,defaultProp:s??!1,onChange:a,caller:so}),[z,Z]=ro({prop:o,defaultProp:u,onChange:f,caller:so}),re=j.useRef(null),P=S?w||!!S.closest("form"):!0,[se,me]=j.useState(new Set),ce=Array.from(se).map(fe=>fe.props.value).join(";");return c.jsx(lA,{...v,children:c.jsxs(nj,{required:y,scope:t,trigger:S,onTriggerChange:E,valueNode:A,onValueNodeChange:b,valueNodeHasChildren:D,onValueNodeHasChildrenChange:O,contentId:Ea(),value:z,onValueChange:Z,open:T,onOpenChange:U,dir:C,triggerPointerDownPosRef:re,disabled:g,children:[c.jsx(Id.Provider,{scope:t,children:c.jsx(sj,{scope:e.__scopeSelect,onNativeOptionAdd:j.useCallback(fe=>{me(de=>new Set(de).add(fe))},[]),onNativeOptionRemove:j.useCallback(fe=>{me(de=>{const he=new Set(de);return he.delete(fe),he})},[]),children:r})}),P?c.jsxs(l_,{"aria-hidden":!0,required:y,tabIndex:-1,name:p,autoComplete:m,value:z,onChange:fe=>Z(fe.target.value),disabled:g,form:w,children:[z===void 0?c.jsx("option",{value:""}):null,Array.from(se)]},ce):null]})})};U2.displayName=so;var $2="SelectTrigger",z2=j.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...s}=e,a=Ld(r),o=ki($2,r),u=o.disabled||n,f=er(t,o.onTriggerChange),d=Od(r),p=j.useRef("touch"),[m,g,y]=u_(v=>{const S=d().filter(b=>!b.disabled),E=S.find(b=>b.value===o.value),A=f_(S,v,E);A!==void 0&&o.onValueChange(A.value)}),w=v=>{u||(o.onOpenChange(!0),y()),v&&(o.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return c.jsx(cA,{asChild:!0,...a,children:c.jsx(St.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:u,"data-disabled":u?"":void 0,"data-placeholder":c_(o.value)?"":void 0,...s,ref:f,onClick:Nt(s.onClick,v=>{v.currentTarget.focus(),p.current!=="mouse"&&w(v)}),onPointerDown:Nt(s.onPointerDown,v=>{p.current=v.pointerType;const S=v.target;S.hasPointerCapture(v.pointerId)&&S.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(w(v),v.preventDefault())}),onKeyDown:Nt(s.onKeyDown,v=>{const S=m.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&g(v.key),!(S&&v.key===" ")&&ej.includes(v.key)&&(w(),v.preventDefault())})})})});z2.displayName=$2;var W2="SelectValue",V2=j.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,children:a,placeholder:o="",...u}=e,f=ki(W2,r),{onValueNodeHasChildrenChange:d}=f,p=a!==void 0,m=er(t,f.onValueNodeChange);return hn(()=>{d(p)},[d,p]),c.jsx(St.span,{...u,ref:m,style:{pointerEvents:"none"},children:c_(f.value)?c.jsx(c.Fragment,{children:o}):a})});V2.displayName=W2;var ij="SelectIcon",H2=j.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...s}=e;return c.jsx(St.span,{"aria-hidden":!0,...s,ref:t,children:n||""})});H2.displayName=ij;var oj="SelectPortal",G2=e=>c.jsx(wm,{asChild:!0,...e});G2.displayName=oj;var ao="SelectContent",X2=j.forwardRef((e,t)=>{const r=ki(ao,e.__scopeSelect),[n,s]=j.useState();if(hn(()=>{s(new DocumentFragment)},[]),!r.open){const a=n;return a?hu.createPortal(c.jsx(K2,{scope:e.__scopeSelect,children:c.jsx(Id.Slot,{scope:e.__scopeSelect,children:c.jsx("div",{children:e.children})})}),a):null}return c.jsx(q2,{...e,ref:t})});X2.displayName=ao;var js=10,[K2,bi]=Il(ao),lj="SelectContentImpl",cj=bl("SelectContent.RemoveScroll"),q2=j.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:a,onPointerDownOutside:o,side:u,sideOffset:f,align:d,alignOffset:p,arrowPadding:m,collisionBoundary:g,collisionPadding:y,sticky:w,hideWhenDetached:v,avoidCollisions:S,...E}=e,A=ki(ao,r),[b,D]=j.useState(null),[O,C]=j.useState(null),T=er(t,ne=>D(ne)),[U,z]=j.useState(null),[Z,re]=j.useState(null),P=Od(r),[se,me]=j.useState(!1),ce=j.useRef(!1);j.useEffect(()=>{if(b)return F2(b)},[b]),s2();const fe=j.useCallback(ne=>{const[Y,...oe]=P().map(I=>I.ref.current),[le]=oe.slice(-1),te=document.activeElement;for(const I of ne)if(I===te||(I?.scrollIntoView({block:"nearest"}),I===Y&&O&&(O.scrollTop=0),I===le&&O&&(O.scrollTop=O.scrollHeight),I?.focus(),document.activeElement!==te))return},[P,O]),de=j.useCallback(()=>fe([U,b]),[fe,U,b]);j.useEffect(()=>{se&&de()},[se,de]);const{onOpenChange:he,triggerPointerDownPosRef:Q}=A;j.useEffect(()=>{if(b){let ne={x:0,y:0};const Y=le=>{ne={x:Math.abs(Math.round(le.pageX)-(Q.current?.x??0)),y:Math.abs(Math.round(le.pageY)-(Q.current?.y??0))}},oe=le=>{ne.x<=10&&ne.y<=10?le.preventDefault():b.contains(le.target)||he(!1),document.removeEventListener("pointermove",Y),Q.current=null};return Q.current!==null&&(document.addEventListener("pointermove",Y),document.addEventListener("pointerup",oe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Y),document.removeEventListener("pointerup",oe,{capture:!0})}}},[b,he,Q]),j.useEffect(()=>{const ne=()=>he(!1);return window.addEventListener("blur",ne),window.addEventListener("resize",ne),()=>{window.removeEventListener("blur",ne),window.removeEventListener("resize",ne)}},[he]);const[ee,V]=u_(ne=>{const Y=P().filter(te=>!te.disabled),oe=Y.find(te=>te.ref.current===document.activeElement),le=f_(Y,ne,oe);le&&setTimeout(()=>le.ref.current.focus())}),F=j.useCallback((ne,Y,oe)=>{const le=!ce.current&&!oe;(A.value!==void 0&&A.value===Y||le)&&(z(ne),le&&(ce.current=!0))},[A.value]),N=j.useCallback(()=>b?.focus(),[b]),L=j.useCallback((ne,Y,oe)=>{const le=!ce.current&&!oe;(A.value!==void 0&&A.value===Y||le)&&re(ne)},[A.value]),B=n==="popper"?jp:Y2,q=B===jp?{side:u,sideOffset:f,align:d,alignOffset:p,arrowPadding:m,collisionBoundary:g,collisionPadding:y,sticky:w,hideWhenDetached:v,avoidCollisions:S}:{};return c.jsx(K2,{scope:r,content:b,viewport:O,onViewportChange:C,itemRefCallback:F,selectedItem:U,onItemLeave:N,itemTextRefCallback:L,focusSelectedItem:de,selectedItemText:Z,position:n,isPositioned:se,searchRef:ee,children:c.jsx(_m,{as:cj,allowPinchZoom:!0,children:c.jsx(fm,{asChild:!0,trapped:A.open,onMountAutoFocus:ne=>{ne.preventDefault()},onUnmountAutoFocus:Nt(s,ne=>{A.trigger?.focus({preventScroll:!0}),ne.preventDefault()}),children:c.jsx(um,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:ne=>ne.preventDefault(),onDismiss:()=>A.onOpenChange(!1),children:c.jsx(B,{role:"listbox",id:A.contentId,"data-state":A.open?"open":"closed",dir:A.dir,onContextMenu:ne=>ne.preventDefault(),...E,...q,onPlaced:()=>me(!0),ref:T,style:{display:"flex",flexDirection:"column",outline:"none",...E.style},onKeyDown:Nt(E.onKeyDown,ne=>{const Y=ne.ctrlKey||ne.altKey||ne.metaKey;if(ne.key==="Tab"&&ne.preventDefault(),!Y&&ne.key.length===1&&V(ne.key),["ArrowUp","ArrowDown","Home","End"].includes(ne.key)){let le=P().filter(te=>!te.disabled).map(te=>te.ref.current);if(["ArrowUp","End"].includes(ne.key)&&(le=le.slice().reverse()),["ArrowUp","ArrowDown"].includes(ne.key)){const te=ne.target,I=le.indexOf(te);le=le.slice(I+1)}setTimeout(()=>fe(le)),ne.preventDefault()}})})})})})})});q2.displayName=lj;var uj="SelectItemAlignedPosition",Y2=j.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...s}=e,a=ki(ao,r),o=bi(ao,r),[u,f]=j.useState(null),[d,p]=j.useState(null),m=er(t,T=>p(T)),g=Od(r),y=j.useRef(!1),w=j.useRef(!0),{viewport:v,selectedItem:S,selectedItemText:E,focusSelectedItem:A}=o,b=j.useCallback(()=>{if(a.trigger&&a.valueNode&&u&&d&&v&&S&&E){const T=a.trigger.getBoundingClientRect(),U=d.getBoundingClientRect(),z=a.valueNode.getBoundingClientRect(),Z=E.getBoundingClientRect();if(a.dir!=="rtl"){const te=Z.left-U.left,I=z.left-te,Ce=T.left-I,Ie=T.width+Ce,ue=Math.max(Ie,U.width),ge=window.innerWidth-js,_e=x1(I,[js,Math.max(js,ge-ue)]);u.style.minWidth=Ie+"px",u.style.left=_e+"px"}else{const te=U.right-Z.right,I=window.innerWidth-z.right-te,Ce=window.innerWidth-T.right-I,Ie=T.width+Ce,ue=Math.max(Ie,U.width),ge=window.innerWidth-js,_e=x1(I,[js,Math.max(js,ge-ue)]);u.style.minWidth=Ie+"px",u.style.right=_e+"px"}const re=g(),P=window.innerHeight-js*2,se=v.scrollHeight,me=window.getComputedStyle(d),ce=parseInt(me.borderTopWidth,10),fe=parseInt(me.paddingTop,10),de=parseInt(me.borderBottomWidth,10),he=parseInt(me.paddingBottom,10),Q=ce+fe+se+he+de,ee=Math.min(S.offsetHeight*5,Q),V=window.getComputedStyle(v),F=parseInt(V.paddingTop,10),N=parseInt(V.paddingBottom,10),L=T.top+T.height/2-js,B=P-L,q=S.offsetHeight/2,ne=S.offsetTop+q,Y=ce+fe+ne,oe=Q-Y;if(Y<=L){const te=re.length>0&&S===re[re.length-1].ref.current;u.style.bottom="0px";const I=d.clientHeight-v.offsetTop-v.offsetHeight,Ce=Math.max(B,q+(te?N:0)+I+de),Ie=Y+Ce;u.style.height=Ie+"px"}else{const te=re.length>0&&S===re[0].ref.current;u.style.top="0px";const Ce=Math.max(L,ce+v.offsetTop+(te?F:0)+q)+oe;u.style.height=Ce+"px",v.scrollTop=Y-L+v.offsetTop}u.style.margin=`${js}px 0`,u.style.minHeight=ee+"px",u.style.maxHeight=P+"px",n?.(),requestAnimationFrame(()=>y.current=!0)}},[g,a.trigger,a.valueNode,u,d,v,S,E,a.dir,n]);hn(()=>b(),[b]);const[D,O]=j.useState();hn(()=>{d&&O(window.getComputedStyle(d).zIndex)},[d]);const C=j.useCallback(T=>{T&&w.current===!0&&(b(),A?.(),w.current=!1)},[b,A]);return c.jsx(dj,{scope:r,contentWrapper:u,shouldExpandOnScrollRef:y,onScrollButtonChange:C,children:c.jsx("div",{ref:f,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:D},children:c.jsx(St.div,{...s,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});Y2.displayName=uj;var fj="SelectPopperPosition",jp=j.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=js,...a}=e,o=Ld(r);return c.jsx(uA,{...o,...a,ref:t,align:n,collisionPadding:s,style:{boxSizing:"border-box",...a.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});jp.displayName=fj;var[dj,Sm]=Il(ao,{}),Dp="SelectViewport",J2=j.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...s}=e,a=bi(Dp,r),o=Sm(Dp,r),u=er(t,a.onViewportChange),f=j.useRef(0);return c.jsxs(c.Fragment,{children:[c.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),c.jsx(Id.Slot,{scope:r,children:c.jsx(St.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:u,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Nt(s.onScroll,d=>{const p=d.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:g}=o;if(g?.current&&m){const y=Math.abs(f.current-p.scrollTop);if(y>0){const w=window.innerHeight-js*2,v=parseFloat(m.style.minHeight),S=parseFloat(m.style.height),E=Math.max(v,S);if(E<w){const A=E+y,b=Math.min(w,A),D=A-b;m.style.height=b+"px",m.style.bottom==="0px"&&(p.scrollTop=D>0?D:0,m.style.justifyContent="flex-end")}}}f.current=p.scrollTop})})})]})});J2.displayName=Dp;var Q2="SelectGroup",[hj,pj]=Il(Q2),mj=j.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=Ea();return c.jsx(hj,{scope:r,id:s,children:c.jsx(St.div,{role:"group","aria-labelledby":s,...n,ref:t})})});mj.displayName=Q2;var Z2="SelectLabel",xj=j.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=pj(Z2,r);return c.jsx(St.div,{id:s.id,...n,ref:t})});xj.displayName=Z2;var ud="SelectItem",[gj,e_]=Il(ud),t_=j.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:a,...o}=e,u=ki(ud,r),f=bi(ud,r),d=u.value===n,[p,m]=j.useState(a??""),[g,y]=j.useState(!1),w=er(t,A=>f.itemRefCallback?.(A,n,s)),v=Ea(),S=j.useRef("touch"),E=()=>{s||(u.onValueChange(n),u.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return c.jsx(gj,{scope:r,value:n,disabled:s,textId:v,isSelected:d,onItemTextChange:j.useCallback(A=>{m(b=>b||(A?.textContent??"").trim())},[]),children:c.jsx(Id.ItemSlot,{scope:r,value:n,disabled:s,textValue:p,children:c.jsx(St.div,{role:"option","aria-labelledby":v,"data-highlighted":g?"":void 0,"aria-selected":d&&g,"data-state":d?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...o,ref:w,onFocus:Nt(o.onFocus,()=>y(!0)),onBlur:Nt(o.onBlur,()=>y(!1)),onClick:Nt(o.onClick,()=>{S.current!=="mouse"&&E()}),onPointerUp:Nt(o.onPointerUp,()=>{S.current==="mouse"&&E()}),onPointerDown:Nt(o.onPointerDown,A=>{S.current=A.pointerType}),onPointerMove:Nt(o.onPointerMove,A=>{S.current=A.pointerType,s?f.onItemLeave?.():S.current==="mouse"&&A.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Nt(o.onPointerLeave,A=>{A.currentTarget===document.activeElement&&f.onItemLeave?.()}),onKeyDown:Nt(o.onKeyDown,A=>{f.searchRef?.current!==""&&A.key===" "||(tj.includes(A.key)&&E(),A.key===" "&&A.preventDefault())})})})})});t_.displayName=ud;var Tc="SelectItemText",r_=j.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,...a}=e,o=ki(Tc,r),u=bi(Tc,r),f=e_(Tc,r),d=aj(Tc,r),[p,m]=j.useState(null),g=er(t,E=>m(E),f.onItemTextChange,E=>u.itemTextRefCallback?.(E,f.value,f.disabled)),y=p?.textContent,w=j.useMemo(()=>c.jsx("option",{value:f.value,disabled:f.disabled,children:y},f.value),[f.disabled,f.value,y]),{onNativeOptionAdd:v,onNativeOptionRemove:S}=d;return hn(()=>(v(w),()=>S(w)),[v,S,w]),c.jsxs(c.Fragment,{children:[c.jsx(St.span,{id:f.textId,...a,ref:g}),f.isSelected&&o.valueNode&&!o.valueNodeHasChildren?hu.createPortal(a.children,o.valueNode):null]})});r_.displayName=Tc;var n_="SelectItemIndicator",s_=j.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return e_(n_,r).isSelected?c.jsx(St.span,{"aria-hidden":!0,...n,ref:t}):null});s_.displayName=n_;var Fp="SelectScrollUpButton",a_=j.forwardRef((e,t)=>{const r=bi(Fp,e.__scopeSelect),n=Sm(Fp,e.__scopeSelect),[s,a]=j.useState(!1),o=er(t,n.onScrollButtonChange);return hn(()=>{if(r.viewport&&r.isPositioned){let u=function(){const d=f.scrollTop>0;a(d)};const f=r.viewport;return u(),f.addEventListener("scroll",u),()=>f.removeEventListener("scroll",u)}},[r.viewport,r.isPositioned]),s?c.jsx(o_,{...e,ref:o,onAutoScroll:()=>{const{viewport:u,selectedItem:f}=r;u&&f&&(u.scrollTop=u.scrollTop-f.offsetHeight)}}):null});a_.displayName=Fp;var Rp="SelectScrollDownButton",i_=j.forwardRef((e,t)=>{const r=bi(Rp,e.__scopeSelect),n=Sm(Rp,e.__scopeSelect),[s,a]=j.useState(!1),o=er(t,n.onScrollButtonChange);return hn(()=>{if(r.viewport&&r.isPositioned){let u=function(){const d=f.scrollHeight-f.clientHeight,p=Math.ceil(f.scrollTop)<d;a(p)};const f=r.viewport;return u(),f.addEventListener("scroll",u),()=>f.removeEventListener("scroll",u)}},[r.viewport,r.isPositioned]),s?c.jsx(o_,{...e,ref:o,onAutoScroll:()=>{const{viewport:u,selectedItem:f}=r;u&&f&&(u.scrollTop=u.scrollTop+f.offsetHeight)}}):null});i_.displayName=Rp;var o_=j.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=e,a=bi("SelectScrollButton",r),o=j.useRef(null),u=Od(r),f=j.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return j.useEffect(()=>()=>f(),[f]),hn(()=>{u().find(p=>p.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[u]),c.jsx(St.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Nt(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:Nt(s.onPointerMove,()=>{a.onItemLeave?.(),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:Nt(s.onPointerLeave,()=>{f()})})}),vj="SelectSeparator",yj=j.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return c.jsx(St.div,{"aria-hidden":!0,...n,ref:t})});yj.displayName=vj;var Pp="SelectArrow",wj=j.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=Ld(r),a=ki(Pp,r),o=bi(Pp,r);return a.open&&o.position==="popper"?c.jsx(fA,{...s,...n,ref:t}):null});wj.displayName=Pp;var _j="SelectBubbleInput",l_=j.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const s=j.useRef(null),a=er(n,s),o=A2(t);return j.useEffect(()=>{const u=s.current;if(!u)return;const f=window.HTMLSelectElement.prototype,p=Object.getOwnPropertyDescriptor(f,"value").set;if(o!==t&&p){const m=new Event("change",{bubbles:!0});p.call(u,t),u.dispatchEvent(m)}},[o,t]),c.jsx(St.select,{...r,style:{...j2,...r.style},ref:a,defaultValue:t})});l_.displayName=_j;function c_(e){return e===""||e===void 0}function u_(e){const t=xi(e),r=j.useRef(""),n=j.useRef(0),s=j.useCallback(o=>{const u=r.current+o;t(u),(function f(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>f(""),1e3))})(u)},[t]),a=j.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return j.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,a]}function f_(e,t,r){const s=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,a=r?e.indexOf(r):-1;let o=Sj(e,Math.max(a,0));s.length===1&&(o=o.filter(d=>d!==r));const f=o.find(d=>d.textValue.toLowerCase().startsWith(s.toLowerCase()));return f!==r?f:void 0}function Sj(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var kj=U2,bj=z2,Ej=V2,Tj=H2,Cj=G2,Nj=X2,Aj=J2,jj=t_,Dj=r_,Fj=s_,Rj=a_,Pj=i_;/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ij=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Oj=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),U1=e=>{const t=Oj(e);return t.charAt(0).toUpperCase()+t.slice(1)},d_=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lj={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mj=j.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:o,...u},f)=>j.createElement("svg",{ref:f,...Lj,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:d_("lucide",s),...u},[...o.map(([d,p])=>j.createElement(d,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=(e,t)=>{const r=j.forwardRef(({className:n,...s},a)=>j.createElement(Mj,{ref:a,iconNode:t,className:d_(`lucide-${Ij(U1(e))}`,`lucide-${e}`,n),...s}));return r.displayName=U1(e),r};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bj=[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]],km=it("bug",Bj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uj=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],$j=it("building-2",Uj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zj=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],na=it("calculator",zj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wj=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],pl=it("chart-column",Wj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vj=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],bm=it("check",Vj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hj=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Em=it("chevron-down",Hj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gj=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],h_=it("chevron-up",Gj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ja=it("circle-alert",Xj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kj=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],gs=it("circle-check-big",Kj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Dc=it("circle-check",qj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],Jj=it("circle-user",Yj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Zj=it("clock",Qj);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],sd=it("copy",e3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],io=it("database",t3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],pi=it("download",r3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Kh=it("external-link",n3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],a3=it("eye-off",s3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],o3=it("eye",i3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],c3=it("file-spreadsheet",l3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Tl=it("file-text",u3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 13v-1h6v1",key:"1bb014"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M11 18h2",key:"12mj7e"}]],d3=it("file-type",f3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Cl=it("file",h3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],p_=it("folder-open",p3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],x3=it("globe",m3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Hc=it("info",g3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],qh=it("loader-circle",v3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]],$1=it("log-in",y3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],_3=it("log-out",w3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],z1=it("mail",S3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],b3=it("package",k3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],T3=it("pen-line",E3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],W1=it("phone",C3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],m_=it("play",N3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Gc=it("plus",A3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],zr=it("refresh-cw",j3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Yh=it("rocket",D3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],x_=it("save",F3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],P3=it("search",R3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],O3=it("server",I3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],M3=it("settings-2",L3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],U3=it("settings",B3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],g_=it("shield",$3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],W3=it("square-pen",z3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],H3=it("target",V3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],xu=it("trash-2",G3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],v_=it("trending-up",X3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ia=it("triangle-alert",K3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],oa=it("upload",q3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],mi=it("users",Y3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],fd=it("x",J3);function _r({...e}){return c.jsx(kj,{"data-slot":"select",...e})}function Sr({...e}){return c.jsx(Ej,{"data-slot":"select-value",...e})}function kr({className:e,size:t="default",children:r,...n}){return c.jsxs(bj,{"data-slot":"select-trigger","data-size":t,className:Et("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...n,children:[r,c.jsx(Tj,{asChild:!0,children:c.jsx(Em,{className:"size-4 opacity-50"})})]})}function br({className:e,children:t,position:r="popper",...n}){return c.jsx(Cj,{children:c.jsxs(Nj,{"data-slot":"select-content",className:Et("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[c.jsx(Q3,{}),c.jsx(Aj,{className:Et("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),c.jsx(Z3,{})]})})}function wt({className:e,children:t,...r}){return c.jsxs(jj,{"data-slot":"select-item",className:Et("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...r,children:[c.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:c.jsx(Fj,{children:c.jsx(bm,{className:"size-4"})})}),c.jsx(Dj,{children:t})]})}function Q3({className:e,...t}){return c.jsx(Rj,{"data-slot":"select-scroll-up-button",className:Et("flex cursor-default items-center justify-center py-1",e),...t,children:c.jsx(h_,{className:"size-4"})})}function Z3({className:e,...t}){return c.jsx(Pj,{"data-slot":"select-scroll-down-button",className:Et("flex cursor-default items-center justify-center py-1",e),...t,children:c.jsx(Em,{className:"size-4"})})}const eD=im("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Mt({className:e,variant:t,asChild:r=!1,...n}){const s=r?Iw:"span";return c.jsx(s,{"data-slot":"badge",className:Et(eD({variant:t}),e),...n})}function Xc({className:e,...t}){return c.jsx("textarea",{"data-slot":"textarea",className:Et("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const pt="baabzbunxucblvtojbfj",dn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJhYWJ6YnVueHVjYmx2dG9qYmZqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU5NjkyNDAsImV4cCI6MjA3MTU0NTI0MH0.4Cr44RQtGzBfs4QlyqXHd3ogvrsN2YULMQdAdygnfx4",tD=()=>(console.log(" Using Supabase Edge Functions URL"),`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43`),Yi=tD(),rD="modulepreload",nD=function(e){return"/"+e},V1={},Ol=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let d=function(p){return Promise.all(p.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};var o=d;document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");s=d(r.map(p=>{if(p=nD(p),p in V1)return;V1[p]=!0;const m=p.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${g}`))return;const y=document.createElement("link");if(y.rel=m?"stylesheet":rD,m||(y.as="script"),y.crossOrigin="",y.href=p,f&&y.setAttribute("nonce",f),document.head.appendChild(y),m)return new Promise((w,v)=>{y.addEventListener("load",w),y.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return s.then(u=>{for(const f of u||[])f.status==="rejected"&&a(f.reason);return t().catch(a)})},sD=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ol(async()=>{const{default:n}=await Promise.resolve().then(()=>Ll);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Tm extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class aD extends Tm{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class H1 extends Tm{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class G1 extends Tm{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Ip;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Ip||(Ip={}));var iD=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(p){try{d(n.next(p))}catch(m){o(m)}}function f(p){try{d(n.throw(p))}catch(m){o(m)}}function d(p){p.done?a(p.value):s(p.value).then(u,f)}d((n=n.apply(e,t||[])).next())})};class oD{constructor(t,{headers:r={},customFetch:n,region:s=Ip.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=sD(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return iD(this,void 0,void 0,function*(){try{const{headers:s,method:a,body:o}=r;let u={},{region:f}=r;f||(f=this.region);const d=new URL(`${this.url}/${t}`);f&&f!=="any"&&(u["x-region"]=f,d.searchParams.set("forceFunctionRegion",f));let p;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",p=o):typeof o=="string"?(u["Content-Type"]="text/plain",p=o):typeof FormData<"u"&&o instanceof FormData?p=o:(u["Content-Type"]="application/json",p=JSON.stringify(o)));const m=yield this.fetch(d.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),s),body:p}).catch(v=>{throw new aD(v)}),g=m.headers.get("x-relay-error");if(g&&g==="true")throw new H1(m);if(!m.ok)throw new G1(m);let y=((n=m.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),w;return y==="application/json"?w=yield m.json():y==="application/octet-stream"?w=yield m.blob():y==="text/event-stream"?w=m:y==="multipart/form-data"?w=yield m.formData():w=yield m.text(),{data:w,error:null,response:m}}catch(s){return{data:null,error:s,response:s instanceof G1||s instanceof H1?s.context:void 0}}})}}var en={},Qo={},Zo={},el={},tl={},rl={},lD=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Nl=lD();const cD=Nl.fetch,y_=Nl.fetch.bind(Nl),w_=Nl.Headers,uD=Nl.Request,fD=Nl.Response,Ll=Object.freeze(Object.defineProperty({__proto__:null,Headers:w_,Request:uD,Response:fD,default:y_,fetch:cD},Symbol.toStringTag,{value:"Module"})),dD=NT(Ll);var Uf={},X1;function __(){if(X1)return Uf;X1=1,Object.defineProperty(Uf,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Uf.default=e,Uf}var K1;function S_(){if(K1)return rl;K1=1;var e=rl&&rl.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(rl,"__esModule",{value:!0});const t=e(dD),r=e(__());class n{constructor(a){var o,u;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(o=a.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=a.signal,this.isMaybeSingle=(u=a.isMaybeSingle)!==null&&u!==void 0?u:!1,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,o){return this.headers=new Headers(this.headers),this.headers.set(a,o),this}then(a,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const u=this.fetch;let f=u(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var p,m,g,y;let w=null,v=null,S=null,E=d.status,A=d.statusText;if(d.ok){if(this.method!=="HEAD"){const C=await d.text();C===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?v=C:v=JSON.parse(C))}const D=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),O=(g=d.headers.get("content-range"))===null||g===void 0?void 0:g.split("/");D&&O&&O.length>1&&(S=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(w={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,S=null,E=406,A="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const D=await d.text();try{w=JSON.parse(D),Array.isArray(w)&&d.status===404&&(v=[],w=null,E=200,A="OK")}catch{d.status===404&&D===""?(E=204,A="No Content"):w={message:D}}if(w&&this.isMaybeSingle&&(!((y=w?.details)===null||y===void 0)&&y.includes("0 rows"))&&(w=null,E=200,A="OK"),w&&this.shouldThrowOnError)throw new r.default(w)}return{error:w,data:v,count:S,status:E,statusText:A}});return this.shouldThrowOnError||(f=f.catch(d=>{var p,m,g;return{error:{message:`${(p=d?.name)!==null&&p!==void 0?p:"FetchError"}: ${d?.message}`,details:`${(m=d?.stack)!==null&&m!==void 0?m:""}`,hint:"",code:`${(g=d?.code)!==null&&g!==void 0?g:""}`},data:null,count:null,status:0,statusText:""}})),f.then(a,o)}returns(){return this}overrideTypes(){return this}}return rl.default=n,rl}var q1;function k_(){if(q1)return tl;q1=1;var e=tl&&tl.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(tl,"__esModule",{value:!0});const t=e(S_());class r extends t.default{select(s){let a=!1;const o=(s??"*").split("").map(u=>/\s/.test(u)&&!a?"":(u==='"'&&(a=!a),u)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:a=!0,nullsFirst:o,foreignTable:u,referencedTable:f=u}={}){const d=f?`${f}.order`:"order",p=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${p?`${p},`:""}${s}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:a,referencedTable:o=a}={}){const u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(u,`${s}`),this}range(s,a,{foreignTable:o,referencedTable:u=o}={}){const f=typeof u>"u"?"offset":`${u}.offset`,d=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(f,`${s}`),this.url.searchParams.set(d,`${a-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:a=!1,settings:o=!1,buffers:u=!1,wal:f=!1,format:d="text"}={}){var p;const m=[s?"analyze":null,a?"verbose":null,o?"settings":null,u?"buffers":null,f?"wal":null].filter(Boolean).join("|"),g=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${g}"; options=${m};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return tl.default=r,tl}var Y1;function Cm(){if(Y1)return el;Y1=1;var e=el&&el.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(el,"__esModule",{value:!0});const t=e(k_());class r extends t.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}in(s,a){const o=Array.from(new Set(a)).map(u=>typeof u=="string"&&new RegExp("[,()]").test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:o,type:u}={}){let f="";u==="plain"?f="pl":u==="phrase"?f="ph":u==="websearch"&&(f="w");const d=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${f}fts${d}.${a}`),this}match(s){return Object.entries(s).forEach(([a,o])=>{this.url.searchParams.append(a,`eq.${o}`)}),this}not(s,a,o){return this.url.searchParams.append(s,`not.${a}.${o}`),this}or(s,{foreignTable:a,referencedTable:o=a}={}){const u=o?`${o}.or`:"or";return this.url.searchParams.append(u,`(${s})`),this}filter(s,a,o){return this.url.searchParams.append(s,`${a}.${o}`),this}}return el.default=r,el}var J1;function b_(){if(J1)return Zo;J1=1;var e=Zo&&Zo.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Zo,"__esModule",{value:!0});const t=e(Cm());class r{constructor(s,{headers:a={},schema:o,fetch:u}){this.url=s,this.headers=new Headers(a),this.schema=o,this.fetch=u}select(s,{head:a=!1,count:o}={}){const u=a?"HEAD":"GET";let f=!1;const d=(s??"*").split("").map(p=>/\s/.test(p)&&!f?"":(p==='"'&&(f=!f),p)).join("");return this.url.searchParams.set("select",d),o&&this.headers.append("Prefer",`count=${o}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:a,defaultToNull:o=!0}={}){var u;const f="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const d=s.reduce((p,m)=>p.concat(Object.keys(m)),[]);if(d.length>0){const p=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",p.join(","))}}return new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(s,{onConflict:a,ignoreDuplicates:o=!1,count:u,defaultToNull:f=!0}={}){var d;const p="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),u&&this.headers.append("Prefer",`count=${u}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const m=s.reduce((g,y)=>g.concat(Object.keys(y)),[]);if(m.length>0){const g=[...new Set(m)].map(y=>`"${y}"`);this.url.searchParams.set("columns",g.join(","))}}return new t.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(s,{count:a}={}){var o;const u="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var a;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return Zo.default=r,Zo}var Q1;function hD(){if(Q1)return Qo;Q1=1;var e=Qo&&Qo.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Qo,"__esModule",{value:!0});const t=e(b_()),r=e(Cm());class n{constructor(a,{headers:o={},schema:u,fetch:f}={}){this.url=a,this.headers=new Headers(o),this.schemaName=u,this.fetch=f}from(a){const o=new URL(`${this.url}/${a}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new n(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:u=!1,get:f=!1,count:d}={}){var p;let m;const g=new URL(`${this.url}/rpc/${a}`);let y;u||f?(m=u?"HEAD":"GET",Object.entries(o).filter(([v,S])=>S!==void 0).map(([v,S])=>[v,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([v,S])=>{g.searchParams.append(v,S)})):(m="POST",y=o);const w=new Headers(this.headers);return d&&w.set("Prefer",`count=${d}`),new r.default({method:m,url:g,headers:w,schema:this.schemaName,body:y,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return Qo.default=n,Qo}var Z1;function pD(){if(Z1)return en;Z1=1;var e=en&&en.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(en,"__esModule",{value:!0}),en.PostgrestError=en.PostgrestBuilder=en.PostgrestTransformBuilder=en.PostgrestFilterBuilder=en.PostgrestQueryBuilder=en.PostgrestClient=void 0;const t=e(hD());en.PostgrestClient=t.default;const r=e(b_());en.PostgrestQueryBuilder=r.default;const n=e(Cm());en.PostgrestFilterBuilder=n.default;const s=e(k_());en.PostgrestTransformBuilder=s.default;const a=e(S_());en.PostgrestBuilder=a.default;const o=e(__());return en.PostgrestError=o.default,en.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:a.default,PostgrestError:o.default},en}var mD=pD();const xD=Nd(mD),{PostgrestClient:gD,PostgrestQueryBuilder:az,PostgrestFilterBuilder:iz,PostgrestTransformBuilder:oz,PostgrestBuilder:lz,PostgrestError:cz}=xD;class vD{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const yD="2.15.4",wD=`realtime-js/${yD}`,_D="1.0.0",Op=1e4,SD=1e3,kD=100;var Fc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Fc||(Fc={}));var Hr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Hr||(Hr={}));var Ds;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ds||(Ds={}));var Lp;(function(e){e.websocket="websocket"})(Lp||(Lp={}));var Xi;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Xi||(Xi={}));class bD{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),a=r.getUint8(2);let o=this.HEADER_LENGTH+2;const u=n.decode(t.slice(o,o+s));o=o+s;const f=n.decode(t.slice(o,o+a));o=o+a;const d=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:u,event:f,payload:d}}}class E_{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var nr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(nr||(nr={}));const ey=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((a,o)=>(a[o]=ED(o,e,t,s),a),{})},ED=(e,t,r,n)=>{const s=t.find(u=>u.name===e),a=s?.type,o=r[e];return a&&!n.includes(a)?T_(a,o):Mp(o)},T_=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return AD(t,r)}switch(e){case nr.bool:return TD(t);case nr.float4:case nr.float8:case nr.int2:case nr.int4:case nr.int8:case nr.numeric:case nr.oid:return CD(t);case nr.json:case nr.jsonb:return ND(t);case nr.timestamp:return jD(t);case nr.abstime:case nr.date:case nr.daterange:case nr.int4range:case nr.int8range:case nr.money:case nr.reltime:case nr.text:case nr.time:case nr.timestamptz:case nr.timetz:case nr.tsrange:case nr.tstzrange:return Mp(t);default:return Mp(t)}},Mp=e=>e,TD=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},CD=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},ND=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},AD=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const o=e.slice(1,r);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(u=>T_(t,u))}return e},jD=e=>typeof e=="string"?e.replace(" ","T"):e,C_=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Jh{constructor(t,r,n={},s=Op){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var ty;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(ty||(ty={}));class Rc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:o,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Rc.syncState(this.state,s,a,o),this.pendingDiffs.forEach(f=>{this.state=Rc.syncDiff(this.state,f,a,o)}),this.pendingDiffs=[],u()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Rc.syncDiff(this.state,s,a,o),u())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const a=this.cloneDeep(t),o=this.transformState(r),u={},f={};return this.map(a,(d,p)=>{o[d]||(f[d]=p)}),this.map(o,(d,p)=>{const m=a[d];if(m){const g=p.map(S=>S.presence_ref),y=m.map(S=>S.presence_ref),w=p.filter(S=>y.indexOf(S.presence_ref)<0),v=m.filter(S=>g.indexOf(S.presence_ref)<0);w.length>0&&(u[d]=w),v.length>0&&(f[d]=v)}else u[d]=p}),this.syncDiff(a,{joins:u,leaves:f},n,s)}static syncDiff(t,r,n,s){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(u,f)=>{var d;const p=(d=t[u])!==null&&d!==void 0?d:[];if(t[u]=this.cloneDeep(f),p.length>0){const m=t[u].map(y=>y.presence_ref),g=p.filter(y=>m.indexOf(y.presence_ref)<0);t[u].unshift(...g)}n(u,p,f)}),this.map(o,(u,f)=>{let d=t[u];if(!d)return;const p=f.map(m=>m.presence_ref);d=d.filter(m=>p.indexOf(m.presence_ref)<0),t[u]=d,s(u,d,f),d.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ry;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(ry||(ry={}));var Pc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Pc||(Pc={}));var ka;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ka||(ka={}));class Nm{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Hr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Jh(this,Ds.join,this.params,this.timeout),this.rejoinTimer=new E_(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Hr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Hr.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Hr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Hr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Hr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ds.reply,{},(s,a)=>{this._trigger(this._replyEventName(a),s)}),this.presence=new Rc(this),this.broadcastEndpointURL=C_(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Hr.closed){const{config:{broadcast:o,presence:u,private:f}}=this.params,d=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(y=>y.filter))!==null&&s!==void 0?s:[],p=!!this.bindings[Pc.PRESENCE]&&this.bindings[Pc.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,m={},g={broadcast:o,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:d,private:f};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(y=>t?.(ka.CHANNEL_ERROR,y)),this._onClose(()=>t?.(ka.CLOSED)),this.updateJoinPayload(Object.assign({config:g},m)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:y})=>{var w;if(this.socket.setAuth(),y===void 0){t?.(ka.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,S=(w=v?.length)!==null&&w!==void 0?w:0,E=[];for(let A=0;A<S;A++){const b=v[A],{filter:{event:D,schema:O,table:C,filter:T}}=b,U=y&&y[A];if(U&&U.event===D&&U.schema===O&&U.table===C&&U.filter===T)E.push(Object.assign(Object.assign({},b),{id:U.id}));else{this.unsubscribe(),this.state=Hr.errored,t?.(ka.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,t&&t(ka.SUBSCRIBED);return}}).receive("error",y=>{this.state=Hr.errored,t?.(ka.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{t?.(ka.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Hr.joined&&t===Pc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:o}=t,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,u,f;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((f=(u=(o=this.params)===null||o===void 0?void 0:o.config)===null||u===void 0?void 0:u.broadcast)===null||f===void 0)&&f.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Hr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ds.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Jh(this,Ds.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Hr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Jh(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>kD){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,a;const o=t.toLocaleLowerCase(),{close:u,error:f,leave:d,join:p}=Ds;if(n&&[u,f,d,p].indexOf(o)>=0&&n!==this._joinRef())return;let g=this._onMessage(o,r,n);if(r&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(y=>{var w,v,S;return((w=y.filter)===null||w===void 0?void 0:w.event)==="*"||((S=(v=y.filter)===null||v===void 0?void 0:v.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(y=>y.callback(g,n)):(a=this.bindings[o])===null||a===void 0||a.filter(y=>{var w,v,S,E,A,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const D=y.id,O=(w=y.filter)===null||w===void 0?void 0:w.event;return D&&((v=r.ids)===null||v===void 0?void 0:v.includes(D))&&(O==="*"||O?.toLocaleLowerCase()===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const D=(A=(E=y?.filter)===null||E===void 0?void 0:E.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return D==="*"||D===((b=r?.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof g=="object"&&"ids"in g){const w=g.data,{schema:v,table:S,commit_timestamp:E,type:A,errors:b}=w;g=Object.assign(Object.assign({},{schema:v,table:S,commit_timestamp:E,eventType:A,new:{},old:{},errors:b}),this._getPayloadRecords(w))}y.callback(g,n)})}_isClosed(){return this.state===Hr.closed}_isJoined(){return this.state===Hr.joined}_isJoining(){return this.state===Hr.joining}_isLeaving(){return this.state===Hr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&Nm.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ds.close,{},t)}_onError(t){this._on(Ds.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Hr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=ey(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=ey(t.columns,t.old_record)),r}}const Qh=()=>{},$f={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},DD=[1e3,2e3,5e3,1e4],FD=1e4,RD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class PD{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Op,this.transport=null,this.heartbeatIntervalMs=$f.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Qh,this.ref=0,this.reconnectTimer=null,this.logger=Qh,this.conn=null,this.sendBuffer=[],this.serializer=new bD,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>Ol(async()=>{const{default:u}=await Promise.resolve().then(()=>Ll);return{default:u}},void 0).then(({default:u})=>u(...o)).catch(u=>{throw new Error(`Failed to load @supabase/node-fetch: ${u.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Lp.websocket}`,this.httpEndpoint=C_(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=vD.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:_D}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Fc.connecting:return Xi.Connecting;case Fc.open:return Xi.Open;case Fc.closing:return Xi.Closing;default:return Xi.Closed}}isConnected(){return this.connectionState()===Xi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new Nm(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:s,ref:a}=t,o=()=>{this.encode(t,u=>{var f;(f=this.conn)===null||f===void 0||f.send(u)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(SD,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},$f.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:o}=r,u=o?`(${o})`:"",f=a.status||"";this.log("receive",`${f} ${n} ${s} ${u}`.trim(),a),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(s,a,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ds.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([RD],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:wD};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Ds.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new E_(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},$f.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,a,o,u,f,d,p;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Op,this.heartbeatIntervalMs=(s=t?.heartbeatIntervalMs)!==null&&s!==void 0?s:$f.HEARTBEAT_INTERVAL,this.worker=(a=t?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:Qh,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=t?.reconnectAfterMs)!==null&&f!==void 0?f:(m=>DD[m-1]||FD),this.encode=(d=t?.encode)!==null&&d!==void 0?d:((m,g)=>g(JSON.stringify(m))),this.decode=(p=t?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class Am extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Gr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class ID extends Am{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Bp extends Am{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var OD=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(p){try{d(n.next(p))}catch(m){o(m)}}function f(p){try{d(n.throw(p))}catch(m){o(m)}}function d(p){p.done?a(p.value):s(p.value).then(u,f)}d((n=n.apply(e,t||[])).next())})};const N_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ol(async()=>{const{default:n}=await Promise.resolve().then(()=>Ll);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},LD=()=>OD(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ol(()=>Promise.resolve().then(()=>Ll),void 0)).Response:Response}),Up=e=>{if(Array.isArray(e))return e.map(r=>Up(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=Up(n)}),t},MD=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var yo=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(p){try{d(n.next(p))}catch(m){o(m)}}function f(p){try{d(n.throw(p))}catch(m){o(m)}}function d(p){p.done?a(p.value):s(p.value).then(u,f)}d((n=n.apply(e,t||[])).next())})};const Zh=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),BD=(e,t,r)=>yo(void 0,void 0,void 0,function*(){const n=yield LD();e instanceof n&&!r?.noResolveJson?e.json().then(s=>{const a=e.status||500,o=s?.statusCode||a+"";t(new ID(Zh(s),a,o))}).catch(s=>{t(new Bp(Zh(s),s))}):t(new Bp(Zh(e),e))}),UD=(e,t,r,n)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"||!n?s:(MD(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(n)):s.body=n,t?.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function gu(e,t,r,n,s,a){return yo(this,void 0,void 0,function*(){return new Promise((o,u)=>{e(r,UD(t,n,s,a)).then(f=>{if(!f.ok)throw f;return n?.noResolveJson?f:f.json()}).then(f=>o(f)).catch(f=>BD(f,u,n))})})}function dd(e,t,r,n){return yo(this,void 0,void 0,function*(){return gu(e,"GET",t,r,n)})}function ea(e,t,r,n,s){return yo(this,void 0,void 0,function*(){return gu(e,"POST",t,n,s,r)})}function $p(e,t,r,n,s){return yo(this,void 0,void 0,function*(){return gu(e,"PUT",t,n,s,r)})}function $D(e,t,r,n){return yo(this,void 0,void 0,function*(){return gu(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function A_(e,t,r,n,s){return yo(this,void 0,void 0,function*(){return gu(e,"DELETE",t,n,s,r)})}var Dn=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(p){try{d(n.next(p))}catch(m){o(m)}}function f(p){try{d(n.throw(p))}catch(m){o(m)}}function d(p){p.done?a(p.value):s(p.value).then(u,f)}d((n=n.apply(e,t||[])).next())})};const zD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ny={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class WD{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=N_(s)}uploadOrUpdate(t,r,n,s){return Dn(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},ny),s);let u=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const f=o.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),f&&a.append("metadata",this.encodeMetadata(f)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",o.cacheControl),f&&a.append("metadata",this.encodeMetadata(f))):(a=n,u["cache-control"]=`max-age=${o.cacheControl}`,u["content-type"]=o.contentType,f&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(f)))),s?.headers&&(u=Object.assign(Object.assign({},u),s.headers));const d=this._removeEmptyFolders(r),p=this._getFinalPath(d),m=yield(t=="PUT"?$p:ea)(this.fetch,`${this.url}/object/${p}`,a,Object.assign({headers:u},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:m.Id,fullPath:m.Key},error:null}}catch(a){if(Gr(a))return{data:null,error:a};throw a}})}upload(t,r,n){return Dn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Dn(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),u=new URL(this.url+`/object/upload/sign/${o}`);u.searchParams.set("token",r);try{let f;const d=Object.assign({upsert:ny.upsert},s),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(f=new FormData,f.append("cacheControl",d.cacheControl),f.append("",n)):typeof FormData<"u"&&n instanceof FormData?(f=n,f.append("cacheControl",d.cacheControl)):(f=n,p["cache-control"]=`max-age=${d.cacheControl}`,p["content-type"]=d.contentType);const m=yield $p(this.fetch,u.toString(),f,{headers:p});return{data:{path:a,fullPath:m.Key},error:null}}catch(f){if(Gr(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(t,r){return Dn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r?.upsert&&(s["x-upsert"]="true");const a=yield ea(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+a.url),u=o.searchParams.get("token");if(!u)throw new Am("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:u},error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}update(t,r,n){return Dn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Dn(this,void 0,void 0,function*(){try{return{data:yield ea(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Gr(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Dn(this,void 0,void 0,function*(){try{return{data:{path:(yield ea(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Gr(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Dn(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),a=yield ea(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(Gr(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Dn(this,void 0,void 0,function*(){try{const s=yield ea(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(Gr(s))return{data:null,error:s};throw s}})}download(t,r){return Dn(this,void 0,void 0,function*(){const s=typeof r?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(r?.transform||{}),o=a?`?${a}`:"";try{const u=this._getFinalPath(t);return{data:yield(yield dd(this.fetch,`${this.url}/${s}/${u}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(u){if(Gr(u))return{data:null,error:u};throw u}})}info(t){return Dn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield dd(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Up(n),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}exists(t){return Dn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield $D(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Gr(n)&&n instanceof Bp){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],a=r?.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&s.push(a);const u=typeof r?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(r?.transform||{});f!==""&&s.push(f);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${n}${d}`)}}}remove(t){return Dn(this,void 0,void 0,function*(){try{return{data:yield A_(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}list(t,r,n){return Dn(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},zD),r),{prefix:t||""});return{data:yield ea(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Gr(s))return{data:null,error:s};throw s}})}listV2(t,r){return Dn(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield ea(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const VD="2.11.0",HD={"X-Client-Info":`storage-js/${VD}`};var nl=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(p){try{d(n.next(p))}catch(m){o(m)}}function f(p){try{d(n.throw(p))}catch(m){o(m)}}function d(p){p.done?a(p.value):s(p.value).then(u,f)}d((n=n.apply(e,t||[])).next())})};class GD{constructor(t,r={},n,s){const a=new URL(t);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},HD),r),this.fetch=N_(n)}listBuckets(){return nl(this,void 0,void 0,function*(){try{return{data:yield dd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Gr(t))return{data:null,error:t};throw t}})}getBucket(t){return nl(this,void 0,void 0,function*(){try{return{data:yield dd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return nl(this,void 0,void 0,function*(){try{return{data:yield ea(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return nl(this,void 0,void 0,function*(){try{return{data:yield $p(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}emptyBucket(t){return nl(this,void 0,void 0,function*(){try{return{data:yield ea(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return nl(this,void 0,void 0,function*(){try{return{data:yield A_(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}}class XD extends GD{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new WD(this.url,this.headers,t,this.fetch)}}const KD="2.56.1";let Cc="";typeof Deno<"u"?Cc="deno":typeof document<"u"?Cc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Cc="react-native":Cc="node";const qD={"X-Client-Info":`supabase-js-${Cc}/${KD}`},YD={headers:qD},JD={schema:"public"},QD={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ZD={};var eF=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(p){try{d(n.next(p))}catch(m){o(m)}}function f(p){try{d(n.throw(p))}catch(m){o(m)}}function d(p){p.done?a(p.value):s(p.value).then(u,f)}d((n=n.apply(e,t||[])).next())})};const tF=e=>{let t;return e?t=e:typeof fetch>"u"?t=y_:t=fetch,(...r)=>t(...r)},rF=()=>typeof Headers>"u"?w_:Headers,nF=(e,t,r)=>{const n=tF(r),s=rF();return(a,o)=>eF(void 0,void 0,void 0,function*(){var u;const f=(u=yield t())!==null&&u!==void 0?u:e;let d=new s(o?.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${f}`),n(a,Object.assign(Object.assign({},o),{headers:d}))})};var sF=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(p){try{d(n.next(p))}catch(m){o(m)}}function f(p){try{d(n.throw(p))}catch(m){o(m)}}function d(p){p.done?a(p.value):s(p.value).then(u,f)}d((n=n.apply(e,t||[])).next())})};function aF(e){return e.endsWith("/")?e:e+"/"}function iF(e,t){var r,n;const{db:s,auth:a,realtime:o,global:u}=e,{db:f,auth:d,realtime:p,global:m}=t,g={db:Object.assign(Object.assign({},f),s),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},p),o),storage:{},global:Object.assign(Object.assign(Object.assign({},m),u),{headers:Object.assign(Object.assign({},(r=m?.headers)!==null&&r!==void 0?r:{}),(n=u?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>sF(this,void 0,void 0,function*(){return""})};return e.accessToken?g.accessToken=e.accessToken:delete g.accessToken,g}const j_="2.71.1",fl=30*1e3,zp=3,ep=zp*fl,oF="http://localhost:9999",lF="supabase.auth.token",cF={"X-Client-Info":`gotrue-js/${j_}`},Wp="X-Supabase-Api-Version",D_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},uF=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,fF=600*1e3;class jm extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function gt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class dF extends jm{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function hF(e){return gt(e)&&e.name==="AuthApiError"}class F_ extends jm{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ei extends jm{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class li extends Ei{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function pF(e){return gt(e)&&e.name==="AuthSessionMissingError"}class zf extends Ei{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Wf extends Ei{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Vf extends Ei{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function mF(e){return gt(e)&&e.name==="AuthImplicitGrantRedirectError"}class sy extends Ei{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Vp extends Ei{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function tp(e){return gt(e)&&e.name==="AuthRetryableFetchError"}class ay extends Ei{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Hp extends Ei{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const hd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),iy=` 	
\r=`.split(""),xF=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<iy.length;t+=1)e[iy[t].charCodeAt(0)]=-2;for(let t=0;t<hd.length;t+=1)e[hd[t].charCodeAt(0)]=t;return e})();function oy(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(hd[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(hd[n]),t.queuedBits-=6}}function R_(e,t,r){const n=xF[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function ly(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{yF(o,n,r)};for(let o=0;o<e.length;o+=1)R_(e.charCodeAt(o),s,a);return t.join("")}function gF(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function vF(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}gF(n,t)}}function yF(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function wF(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)R_(e.charCodeAt(s),r,n);return new Uint8Array(t)}function _F(e){const t=[];return vF(e,r=>t.push(r)),new Uint8Array(t)}function SF(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>oy(s,r,n)),oy(null,r,n),t.join("")}function kF(e){return Math.round(Date.now()/1e3)+e}function bF(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const As=()=>typeof window<"u"&&typeof document<"u",Vi={tested:!1,writable:!1},P_=()=>{if(!As())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vi.tested)return Vi.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Vi.tested=!0,Vi.writable=!0}catch{Vi.tested=!0,Vi.writable=!1}return Vi.writable};function EF(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const I_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ol(async()=>{const{default:n}=await Promise.resolve().then(()=>Ll);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},TF=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",dl=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Hi=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ai=async(e,t)=>{await e.removeItem(t)};class Md{constructor(){this.promise=new Md.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Md.promiseConstructor=Promise;function rp(e){const t=e.split(".");if(t.length!==3)throw new Hp("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!uF.test(t[n]))throw new Hp("JWT not in base64url format");return{header:JSON.parse(ly(t[0])),payload:JSON.parse(ly(t[1])),signature:wF(t[2]),raw:{header:t[0],payload:t[1]}}}async function CF(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function NF(e,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await e(a);if(!t(a,null,o)){n(o);return}}catch(o){if(!t(a,o)){s(o);return}}})()})}function AF(e){return("0"+e.toString(16)).substr(-2)}function jF(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,AF).join("")}async function DF(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function FF(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await DF(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function sl(e,t,r=!1){const n=jF();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await dl(e,`${t}-code-verifier`,s);const a=await FF(n);return[a,n===a?"plain":"s256"]}const RF=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function PF(e){const t=e.headers.get(Wp);if(!t||!t.match(RF))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function IF(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function OF(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const LF=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function al(e){if(!LF.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function np(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function cy(e){return JSON.parse(JSON.stringify(e))}var MF=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const Gi=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),BF=[502,503,504];async function uy(e){var t;if(!TF(e))throw new Vp(Gi(e),0);if(BF.includes(e.status))throw new Vp(Gi(e),e.status);let r;try{r=await e.json()}catch(a){throw new F_(Gi(a),a)}let n;const s=PF(e);if(s&&s.getTime()>=D_["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new ay(Gi(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new li}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new ay(Gi(r),e.status,r.weak_password.reasons);throw new dF(Gi(r),e.status||500,n)}const UF=(e,t,r,n)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Ct(e,t,r,n){var s;const a=Object.assign({},n?.headers);a[Wp]||(a[Wp]=D_["2024-01-01"].name),n?.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const u=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",f=await $F(e,t,r+u,{headers:a,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(f):{data:Object.assign({},f),error:null}}async function $F(e,t,r,n,s,a){const o=UF(t,n,s,a);let u;try{u=await e(r,Object.assign({},o))}catch(f){throw console.error(f),new Vp(Gi(f),0)}if(u.ok||await uy(u),n?.noResolveJson)return u;try{return await u.json()}catch(f){await uy(f)}}function Sa(e){var t;let r=null;HF(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=kF(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function fy(e){const t=Sa(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ci(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function zF(e){return{data:e,error:null}}function WF(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e,o=MF(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},f=Object.assign({},o);return{data:{properties:u,user:f},error:null}}function VF(e){return e}function HF(e){return e.access_token&&e.refresh_token&&e.expires_in}const sp=["global","local","others"];var GF=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class XF{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=I_(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=sp[0]){if(sp.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${sp.join(", ")}`);try{return await Ct(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(gt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ct(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ci})}catch(n){if(gt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=GF(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await Ct(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:WF,redirectTo:r?.redirectTo})}catch(r){if(gt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ct(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ci})}catch(r){if(gt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,a,o,u,f;try{const d={nextPage:null,lastPage:0,total:0},p=await Ct(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:VF});if(p.error)throw p.error;const m=await p.json(),g=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(f=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&f!==void 0?f:[];return y.length>0&&(y.forEach(w=>{const v=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(w.split(";")[1].split("=")[1]);d[`${S}Page`]=v}),d.total=parseInt(g)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(gt(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){al(t);try{return await Ct(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ci})}catch(r){if(gt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){al(t);try{return await Ct(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ci})}catch(n){if(gt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){al(t);try{return await Ct(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ci})}catch(n){if(gt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){al(t.userId);try{const{data:r,error:n}=await Ct(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(gt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){al(t.userId),al(t.id);try{return{data:await Ct(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(gt(r))return{data:null,error:r};throw r}}}function dy(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function KF(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const il={debug:!!(globalThis&&P_()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class O_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class qF extends O_{}async function YF(e,t,r){il.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),il.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){il.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{il.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw il.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new qF(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(il.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}KF();const JF={url:oF,storageKey:lF,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:cF,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function hy(e,t,r){return await r()}const ol={};class Kc{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Kc.nextInstanceID,Kc.nextInstanceID+=1,this.instanceID>0&&As()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},JF),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new XF({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=I_(s.fetch),this.lock=s.lock||hy,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:As()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=YF:this.lock=hy,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:P_()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=dy(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=dy(this.memoryStorage)),As()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=ol[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){ol[this.storageKey]=Object.assign(Object.assign({},ol[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=ol[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ol[this.storageKey]=Object.assign(Object.assign({},ol[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${j_}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=EF(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),As()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),mF(a)){const f=(t=a.details)===null||t===void 0?void 0:t.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",u),await this._saveSession(o),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return gt(r)?{error:r}:{error:new F_("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const a=await Ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t?.options)===null||s===void 0?void 0:s.captchaToken}},xform:Sa}),{data:o,error:u}=a;if(u||!o)return{data:{user:null,session:null},error:u};const f=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:d,session:f},error:null}}catch(a){if(gt(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var r,n,s;try{let a;if("email"in t){const{email:p,password:m,options:g}=t;let y=null,w=null;this.flowType==="pkce"&&([y,w]=await sl(this.storage,this.storageKey)),a=await Ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g?.emailRedirectTo,body:{email:p,password:m,data:(r=g?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:g?.captchaToken},code_challenge:y,code_challenge_method:w},xform:Sa})}else if("phone"in t){const{phone:p,password:m,options:g}=t;a=await Ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:m,data:(n=g?.data)!==null&&n!==void 0?n:{},channel:(s=g?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:Sa})}else throw new Wf("You must provide either an email or phone number and a password");const{data:o,error:u}=a;if(u||!o)return{data:{user:null,session:null},error:u};const f=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:d,session:f},error:null}}catch(a){if(gt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:o,options:u}=t;r=await Ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:fy})}else if("phone"in t){const{phone:a,password:o,options:u}=t;r=await Ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:fy})}else throw new Wf("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new zf}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(gt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,s,a,o,u,f,d,p,m,g,y;let w,v;if("message"in t)w=t.message,v=t.signature;else{const{chain:S,wallet:E,statement:A,options:b}=t;let D;if(As())if(typeof E=="object")D=E;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))D=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!b?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");D=E}const O=new URL((r=b?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in D&&D.signIn){const C=await D.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b?.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),A?{statement:A}:null));let T;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")T=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)T=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)w=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),v=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in D)||typeof D.signMessage!="function"||!("publicKey"in D)||typeof D!="object"||!D.publicKey||!("toBase58"in D.publicKey)||typeof D.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${O.host} wants you to sign in with your Solana account:`,D.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(s=(n=b?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=b?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((u=b?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((f=b?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((m=(p=b?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||m===void 0)&&m.length?["Resources",...b.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const C=await D.signMessage(new TextEncoder().encode(w),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=C}}try{const{data:S,error:E}=await Ct(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:SF(v)},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Sa});if(E)throw E;return!S||!S.session||!S.user?{data:{user:null,session:null},error:new zf}:(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),{data:Object.assign({},S),error:E})}catch(S){if(gt(S))return{data:{user:null,session:null},error:S};throw S}}async _exchangeCodeForSession(t){const r=await Hi(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:a,error:o}=await Ct(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Sa});if(await ai(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new zf}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(gt(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:a,nonce:o}=t,u=await Ct(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Sa}),{data:f,error:d}=u;return d?{data:{user:null,session:null},error:d}:!f||!f.session||!f.user?{data:{user:null,session:null},error:new zf}:(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),{data:f,error:d})}catch(r){if(gt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,a,o;try{if("email"in t){const{email:u,options:f}=t;let d=null,p=null;this.flowType==="pkce"&&([d,p]=await sl(this.storage,this.storageKey));const{error:m}=await Ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=f?.data)!==null&&r!==void 0?r:{},create_user:(n=f?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:d,code_challenge_method:p},redirectTo:f?.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in t){const{phone:u,options:f}=t,{data:d,error:p}=await Ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=f?.data)!==null&&s!==void 0?s:{},create_user:(a=f?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(o=f?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:p}}throw new Wf("You must provide either an email or phone number.")}catch(u){if(gt(u))return{data:{user:null,session:null},error:u};throw u}}async verifyOtp(t){var r,n;try{let s,a;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:u}=await Ct(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:Sa});if(u)throw u;if(!o)throw new Error("An error occurred on token verification.");const f=o.session,d=o.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),{data:{user:d,session:f},error:null}}catch(s){if(gt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await sl(this.storage,this.storageKey)),await Ct(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:zF})}catch(a){if(gt(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new li;const{error:s}=await Ct(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(gt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:o}=await Ct(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:o,error:u}=await Ct(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:u}}throw new Wf("You must provide either an email or phone number and a type")}catch(r){if(gt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Hi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<ep:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await Hi(this.userStorage,this.storageKey+"-user");o?.user?t.user=o.user:t.user=np()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(f,d,p)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(f,d,p))})}return{data:{session:t},error:null}}const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ci}):await this._useSession(async r=>{var n,s,a;const{data:o,error:u}=r;if(u)throw u;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new li}:await Ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:ci})})}catch(r){if(gt(r))return pF(r)&&(await this._removeSession(),await ai(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new li;const o=s.session;let u=null,f=null;this.flowType==="pkce"&&t.email!=null&&([u,f]=await sl(this.storage,this.storageKey));const{data:d,error:p}=await Ct(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:f}),jwt:o.access_token,xform:ci});if(p)throw p;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(gt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new li;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:o}=rp(t.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{session:u,error:f}=await this._callRefreshToken(t.refresh_token);if(f)return{data:{user:null,session:null},error:f};if(!u)return{data:{user:null,session:null},error:null};a=u}else{const{data:u,error:f}=await this._getUser(t.access_token);if(f)throw f;a={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(gt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:u}=r;if(u)throw u;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new li;const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(gt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!As())throw new Vf("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Vf(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new sy("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Vf("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new sy("No code detected.");const{data:A,error:b}=await this._exchangeCodeForSession(t.code);if(b)throw b;const D=new URL(window.location.href);return D.searchParams.delete("code"),window.history.replaceState(window.history.state,"",D.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:u,expires_at:f,token_type:d}=t;if(!a||!u||!o||!d)throw new Vf("No session defined in URL");const p=Math.round(Date.now()/1e3),m=parseInt(u);let g=p+m;f&&(g=parseInt(f));const y=g-p;y*1e3<=fl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${m}s`);const w=g-m;p-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,g,p):p-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,g,p);const{data:v,error:S}=await this._getUser(a);if(S)throw S;const E={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:m,expires_at:g,refresh_token:o,token_type:d,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:E,redirectType:t.type},error:null}}catch(n){if(gt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Hi(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{error:a};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:u}=await this.admin.signOut(o,t);if(u&&!(hF(u)&&(u.status===404||u.status===401||u.status===403)))return{error:u}}return t!=="others"&&(await this._removeSession(),await ai(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=bF(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await sl(this.storage,this.storageKey,!0));try{return await Ct(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(gt(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(gt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var o,u,f,d,p;const{data:m,error:g}=a;if(g)throw g;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(f=t.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await Ct(this.fetch,"GET",y,{headers:this.headers,jwt:(p=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&p!==void 0?p:void 0})});if(s)throw s;return As()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(gt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)throw o;return await Ct(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(gt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await NF(async s=>(s>0&&await CF(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Ct(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Sa})),(s,a)=>{const o=200*Math.pow(2,s);return a&&tp(a)&&Date.now()+o-n<fl})}catch(n){if(this._debug(r,"error",n),gt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),As()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Hi(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Hi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await dl(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o?.user)!==null&&t!==void 0?t:np()}else if(s&&!s.user&&!s.user){const o=await Hi(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await ai(this.storage,this.storageKey+"-user"),await dl(this.storage,this.storageKey,s)):s.user=np()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ep;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${ep}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),tp(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:u}=await this._getUser(s.access_token);!u&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new li;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Md;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new li;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const u={session:a.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(a){if(this._debug(s,"error",a),gt(a)){const o={session:null,error:a};return tp(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(f){a.push(f)}});if(await Promise.all(o),a.length>0){for(let u=0;u<a.length;u+=1)console.error(a[u]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await dl(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=cy(s);await dl(this.storage,this.storageKey,a)}else{const s=cy(r);await dl(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await ai(this.storage,this.storageKey),await ai(this.storage,this.storageKey+"-code-verifier"),await ai(this.storage,this.storageKey+"-user"),this.userStorage&&await ai(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&As()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),fl);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/fl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${fl}ms, refresh threshold is ${zp} ticks`),s<=zp&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof O_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!As()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await sl(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(u.toString())}if(n?.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await Ct(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(gt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)return{data:null,error:o};const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:f,error:d}=await Ct(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((s=f?.totp)===null||s===void 0)&&s.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),{data:f,error:null})})}catch(r){if(gt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{data:null,error:a};const{data:o,error:u}=await Ct(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:u})})}catch(r){if(gt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await Ct(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(gt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=t?.factors||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:a}=t;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=rp(s.access_token);let u=null;o.aal&&(u=o.aal);let f=u;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(m=>m.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(f="aal2");const p=o.amr||[];return{data:{currentLevel:u,nextLevel:f,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(u=>u.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(u=>u.kid===t),n&&this.jwks_cached_at+fF>s)return n;const{data:a,error:o}=await Ct(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(u=>u.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:y,error:w}=await this.getSession();if(w||!y.session)return{data:null,error:w};n=y.session.access_token}const{header:s,payload:a,signature:o,raw:{header:u,payload:f}}=rp(n);r?.allowExpired||IF(a.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:y}=await this.getUser(n);if(y)throw y;return{data:{claims:a,header:s,signature:o},error:null}}const p=OF(s.alg),m=await crypto.subtle.importKey("jwk",d,p,!0,["verify"]);if(!await crypto.subtle.verify(p,m,o,_F(`${u}.${f}`)))throw new Hp("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(n){if(gt(n))return{data:null,error:n};throw n}}}Kc.nextInstanceID=0;const QF=Kc;class ZF extends QF{constructor(t){super(t)}}var eR=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function u(p){try{d(n.next(p))}catch(m){o(m)}}function f(p){try{d(n.throw(p))}catch(m){o(m)}}function d(p){p.done?a(p.value):s(p.value).then(u,f)}d((n=n.apply(e,t||[])).next())})};class tR{constructor(t,r,n){var s,a,o;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const u=aF(t),f=new URL(u);this.realtimeUrl=new URL("realtime/v1",f),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",f),this.storageUrl=new URL("storage/v1",f),this.functionsUrl=new URL("functions/v1",f);const d=`sb-${f.hostname.split(".")[0]}-auth-token`,p={db:JD,realtime:ZD,auth:Object.assign(Object.assign({},QD),{storageKey:d}),global:YD},m=iF(n??{},p);this.storageKey=(s=m.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=m.global.headers)!==null&&a!==void 0?a:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(g,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=m.auth)!==null&&o!==void 0?o:{},this.headers,m.global.fetch),this.fetch=nF(r,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.rest=new gD(new URL("rest/v1",f).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new XD(this.storageUrl.href,this.headers,this.fetch,n?.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new oD(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return eR(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:a,flowType:o,lock:u,debug:f},d,p){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ZF({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),d),storageKey:a,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:o,lock:u,debug:f,fetch:p,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new PD(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const rR=(e,t,r)=>new tR(e,t,r);function nR(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}nR()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");class sR{supabase=rR(`https://${pt}.supabase.co`,dn);async signUpWithEmail(t,r,n){try{const{data:s,error:a}=await this.supabase.auth.signUp({email:t,password:r,options:{data:{name:n||""}}});if(a)throw new Error(a.message);return{data:s,error:null}}catch(s){return console.error("Sign up error:",s),{data:null,error:s instanceof Error?s.message:"Sign up failed"}}}async signUpWithServerAutoConfirm(t,r,n){const s={email:t,password:r,name:n||""},a=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/auth/signup`;console.log("Making server signup request:",{url:a,method:"POST",body:{email:t,hasPassword:!!r,name:n}});try{const o=await this.makePublicRequest(a,{method:"POST",body:JSON.stringify(s)});console.log("Server signup response received:",{status:o.status,statusText:o.statusText,ok:o.ok,url:o.url,headers:Object.fromEntries(o.headers.entries())});const u=o.headers.get("content-type");if(!u||!u.includes("application/json")){const m=await o.text();throw console.error("Server returned non-JSON response:",{status:o.status,contentType:u,responseText:m.substring(0,500)}),o.status===404?new Error("Signup endpoint not found. The authentication service may not be deployed properly."):new Error(`Server returned ${u||"unknown"} instead of JSON. This usually means the Supabase Edge Function is not deployed or has an error.`)}let f;try{f=await o.json()}catch(m){throw console.error("Failed to parse server JSON response:",m),new Error("Server returned invalid JSON response.")}if(!o.ok)throw new Error(f.error||`Server error: HTTP ${o.status}`);if(!f.success)throw new Error(f.error||"Signup failed");const{data:d,error:p}=await this.signInWithEmail(t,r);if(p)throw new Error(`Account created but sign in failed: ${p}`);return{data:d,error:null,message:"Account created and signed in successfully"}}catch(o){return console.error("Server signup error:",o),{data:null,error:o instanceof Error?o.message:"Server signup failed"}}}async signInWithEmail(t,r){try{const{data:n,error:s}=await this.supabase.auth.signInWithPassword({email:t,password:r});if(s)throw new Error(s.message);return{data:n,error:null}}catch(n){return console.error("Sign in error:",n),{data:null,error:n instanceof Error?n.message:"Sign in failed"}}}async sendPhoneOTP(t){try{const{data:r,error:n}=await this.supabase.auth.signInWithOtp({phone:t,options:{channel:"sms"}});if(n){let s=n.message;throw n.message.toLowerCase().includes("unsupported phone provider")||n.message.toLowerCase().includes("phone provider not configured")||n.message.toLowerCase().includes("sms provider")?s="SMS authentication is not set up for this application. Please use email authentication instead or contact your administrator to configure an SMS provider (Twilio, MessageBird, etc.) in the Supabase Dashboard.":n.message.toLowerCase().includes("invalid phone number")||n.message.toLowerCase().includes("phone number")?s="Please enter a valid phone number with country code (e.g., +1234567890, +91987654321)":n.message.toLowerCase().includes("rate limit")||n.message.toLowerCase().includes("too many requests")?s="Too many OTP requests. Please wait a few minutes before trying again.":n.message.toLowerCase().includes("timeout")&&(s="SMS delivery timeout. Please try again or use email authentication."),new Error(s)}return{data:r,error:null}}catch(r){console.error("Phone OTP error:",r);const n=r instanceof Error?r.message:"Failed to send OTP";return n.toLowerCase().includes("network")||n.toLowerCase().includes("fetch")?{data:null,error:"Network error occurred while sending SMS. Please check your connection and try again."}:{data:null,error:n}}}async verifyPhoneOTP(t,r){try{const{data:n,error:s}=await this.supabase.auth.verifyOtp({phone:t,token:r,type:"sms"});if(s)throw new Error(s.message);return{data:n,error:null}}catch(n){return console.error("OTP verification error:",n),{data:null,error:n instanceof Error?n.message:"OTP verification failed"}}}async signOut(){try{const{error:t}=await this.supabase.auth.signOut();if(t)throw new Error(t.message);return{error:null}}catch(t){return console.error("Sign out error:",t),{error:t instanceof Error?t.message:"Sign out failed"}}}async getSession(){try{const{data:{session:t},error:r}=await this.supabase.auth.getSession();if(r)throw new Error(r.message);return{session:t,error:null}}catch(t){return console.error("Get session error:",t),{session:null,error:t instanceof Error?t.message:"Failed to get session"}}}async getCurrentUser(){try{const{data:{user:t},error:r}=await this.supabase.auth.getUser();if(r)throw new Error(r.message);return{user:t,error:null}}catch(t){return console.error("Get user error:",t),{user:null,error:t instanceof Error?t.message:"Failed to get user"}}}onAuthStateChange(t){return this.supabase.auth.onAuthStateChange(t)}async getAccessToken(){try{const{data:{session:t},error:r}=await this.supabase.auth.getSession();return r?(console.error("Error getting session for access token:",r),null):t?t.access_token?t.access_token===dn?(console.error("Session access_token is the anon key - this should not happen"),null):(console.log("Access token retrieved successfully, length:",t.access_token.length),t.access_token):(console.warn("Session found but no access token available"),null):(console.warn("No active session found when getting access token"),null)}catch(t){return console.error("Get access token error:",t),null}}async refreshSession(){try{const{data:t,error:r}=await this.supabase.auth.refreshSession();return r?(console.error("Session refresh error:",r),{session:null,error:r.message}):(console.log("Session refreshed successfully"),{session:t.session,error:null})}catch(t){return console.error("Session refresh error:",t),{session:null,error:t instanceof Error?t.message:"Session refresh failed"}}}async resendConfirmationEmail(t){try{const{error:r}=await this.supabase.auth.resend({type:"signup",email:t});if(r)throw new Error(r.message);return{error:null}}catch(r){return console.error("Resend confirmation error:",r),{error:r instanceof Error?r.message:"Failed to resend confirmation email"}}}async makeAuthenticatedRequest(t,r={},n=0){try{let s=await this.getAccessToken();if(!s)throw console.error("No access token available - user not authenticated"),new Error("No access token available - user not authenticated");if(s===dn)throw console.error("Access token is the anon key instead of user token"),new Error("Invalid token - received anon key instead of user access token");const a={Authorization:`Bearer ${s}`,"Content-Type":"application/json",...r.headers};console.log("Making authenticated request to:",t),console.log("Using access token (first 20 chars):",s.substring(0,20)+"..."),console.log("Token length:",s.length);const o=await fetch(t,{...r,headers:a});if(console.log("Response status:",o.status,o.statusText),o.status===401&&n===0){console.log("Got 401, attempting to refresh session...");const{session:u,error:f}=await this.refreshSession();if(!f&&u)return console.log("Session refreshed, retrying request..."),this.makeAuthenticatedRequest(t,r,n+1)}if(!o.ok){let u="";try{const f=o.headers.get("content-type");if(f&&f.includes("application/json")){const d=await o.json();u=JSON.stringify(d)}else u=await o.text()}catch(f){u=`Failed to read error response: ${f}`}throw console.error("Request failed with error:",u),new Error(`HTTP ${o.status}: ${u}`)}return o}catch(s){throw console.error("Authenticated request failed:",s),s}}async makePublicRequest(t,r={}){try{const n={Authorization:`Bearer ${dn}`,"Content-Type":"application/json",...r.headers};return console.log("Making public request to:",t),await fetch(t,{...r,headers:n})}catch(n){throw console.error("Public request failed:",n),n}}}const jt=new sR,L_=j.forwardRef(({onSchemeCreated:e},t)=>{const[r,n]=j.useState({name:"",type:"",distributorData:{zone:"",state:"",distributorType:"",allDistributors:!0,specificDistributors:[]},catalogType:{family:"",class:"",brand:"",article:"",specificArticleIds:""},distIds:{type:"all",specificIds:[]},articles:{type:"all",specificIds:[]},slabType:"",commissionType:"",startDate:"",endDate:""}),[s,a]=j.useState([{min:0,max:null,rate:0}]),[o,u]=j.useState(!1),[f,d]=j.useState(!1),[p,m]=j.useState({}),[g,y]=j.useState(null),[w,v]=j.useState(0),[S,E]=j.useState(""),[A,b]=j.useState(""),[D,O]=j.useState({}),[C,T]=j.useState(""),U=["East","West","North1","North2","South"],z=[{code:"P1",name:"National Distributor"},{code:"P2",name:"Regional Distributor"},{code:"P3",name:"Large Format Retailer"},{code:"P4",name:"Regional Retailer"},{code:"P5",name:"Direct Dealer"},{code:"P6",name:"PBG_Liquidation"},{code:"P7",name:"Advance Dealer-PBG"},{code:"P8",name:"Advance Dist-PBG"},{code:"P9",name:"Advance FOMT-PBG"},{code:"PD",name:"PBG DD Prime Partner"},{code:"PC",name:"PBG CDG Group"}],Z=async()=>{try{console.log("CreateScheme: Fetching zone-state mapping...");const te=Date.now(),I=Math.random().toString(36).substr(2,9),Ie=await(await jt.makePublicRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/zone-state-mapping?t=${te}&r=${I}`,{method:"GET"})).json();Ie.success&&Ie.mapping?(console.log("CreateScheme: Zone-state mapping loaded successfully"),m(Ie.mapping||{})):(console.warn("CreateScheme: Zone-state mapping not available:",Ie),m({}))}catch(te){console.error("CreateScheme: Error fetching zone-state mapping:",te),m({})}},re=async(te=!1)=>{try{const I=Date.now();if(!te&&I-w<1e3){console.log("CreateScheme: Skipping category data fetch - too recent");return}console.log("CreateScheme: Fetching category data...",{force:te,timeSinceLastFetch:I-w,currentTime:new Date(I).toISOString()});const Ce=Date.now(),Ie=Math.random().toString(36).substr(2,9),ue=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/category-data?t=${Ce}&r=${Ie}`;te&&(console.log("CreateScheme: Force refresh - clearing existing category data"),y(null));const ge=await jt.makeAuthenticatedRequest(ue,{method:"GET"});let _e;if(ge.status===404)_e={success:!1,message:"No category data found"},console.log("CreateScheme: No category data found (404) - user needs to upload category data first");else if(ge.ok)_e=await ge.json(),console.log("CreateScheme: Category data API response:",{success:_e.success,families:_e.categoryData?.families?.length||0,uploadId:_e.categoryData?.uploadId,uploadedAt:_e.categoryData?.uploadedAt,responseTimestamp:new Date().toISOString()});else{const je=await ge.text();throw new Error(`HTTP ${ge.status}: ${je}`)}if(v(I),_e.success&&_e.categoryData&&_e.categoryData.families&&_e.categoryData.families.length>0){const je=_e.categoryData;console.log("CreateScheme: Category data loaded successfully:",{families:je.families?.length||0,familiesList:je.families,classes:je.classes?.length||0,brands:je.brands?.length||0,articles:Object.keys(je.articleMappings||{}).length,uploadId:je.uploadId,uploadedAt:je.uploadedAt}),!g||JSON.stringify(g.families)!==JSON.stringify(je.families)||g.uploadId!==je.uploadId?(console.log("CreateScheme: New category data detected, updating state"),r.type==="per_unit"&&g&&(console.log("CreateScheme: Category data changed for Booster scheme, clearing form selections"),n(ot=>({...ot,catalogType:{family:"",class:"",brand:"",article:"",specificArticleIds:""}})))):console.log("CreateScheme: Category data unchanged"),y(je),te&&be.success(`Category data refreshed - ${je.families?.length||0} families available (Upload ID: ${je.uploadId?.slice(-8)||"Unknown"})`,{duration:3e3})}else console.warn("CreateScheme: No category data available or empty data:",_e),y(null),te&&be.info("No category data found. Please upload category data first to enable family, class, and brand selections for Booster schemes.")}catch(I){if(console.error("CreateScheme: Error fetching category data:",I),y(null),te){const Ce=I instanceof Error?I.message:"Unknown error";Ce.includes("No access token")||Ce.includes("user not authenticated")?be.error("Authentication failed. Please logout and login again."):Ce.includes("Invalid token")||Ce.includes("anon key")?be.error("Authentication token is invalid. Please logout and login again."):Ce.includes("404")?be.info("No category data found. Please upload category data first in the Category Data tab."):Ce.includes("Network")||Ce.includes("Failed to fetch")?be.error("Network error. Please check your connection and try again."):be.error(`Failed to load category data: ${Ce}`)}}},P=async(te=!1)=>{console.log("CreateScheme: Refreshing data...",te?"(forced)":"","at",new Date().toISOString()),d(!0);try{await Promise.all([Z(),re(te)]),console.log("CreateScheme: Data refresh completed at",new Date().toISOString())}finally{d(!1)}},se=()=>{console.log("CreateScheme: Clearing category data state"),y(null),v(0),r.type==="per_unit"&&n(te=>({...te,catalogType:{family:"",class:"",brand:"",article:"",specificArticleIds:""}}))};j.useImperativeHandle(t,()=>({refresh:()=>{console.log("CreateScheme: External refresh called at",new Date().toISOString()),P(!0)},clearCategoryData:()=>{console.log("CreateScheme: External clearCategoryData called at",new Date().toISOString()),se()}})),j.useEffect(()=>{console.log("CreateScheme: Initial data load"),P(!0)},[]);const me=()=>!p||typeof p!="object"?[]:!r.distributorData.zone||r.distributorData.zone==="all-zones"?Object.values(p).flat():p[r.distributorData.zone]||[],ce=()=>!g||!g.classes?[]:!r.catalogType.family||r.catalogType.family==="all-families"?g.classes||[]:g.familyClassMapping?g.familyClassMapping[r.catalogType.family]||[]:[],fe=()=>!g||!g.brands?[]:r.catalogType.class&&r.catalogType.class!=="all-classes"?g.classBrandMapping?g.classBrandMapping[r.catalogType.class]||[]:[]:r.catalogType.family&&r.catalogType.family!=="all-families"?g.familyBrandMapping?g.familyBrandMapping[r.catalogType.family]||[]:[]:g.brands||[],de=(te,I)=>{if(te.includes(".")){const[Ce,Ie]=te.split(".");n(ue=>{const ge={...ue,[Ce]:{...ue[Ce],[Ie]:I}};return te==="distributorData.zone"&&(ge.distributorData.state=""),te==="catalogType.family"&&(ge.catalogType.class="",ge.catalogType.brand="",ge.catalogType.article=""),te==="catalogType.class"&&(ge.catalogType.brand="",ge.catalogType.article=""),te==="catalogType.brand"&&(ge.catalogType.article="",ge.catalogType.specificArticleIds=""),te==="catalogType.article"&&(ge.catalogType.specificArticleIds="",I==="others-articles"&&(ge.catalogType.family="",ge.catalogType.class="",ge.catalogType.brand="")),(te==="catalogType.family"||te==="catalogType.class"||te==="catalogType.brand")&&ge.catalogType.article==="others-articles"&&(ge.catalogType.article=""),ge})}else n(Ce=>({...Ce,[te]:I}))},he=te=>{n(I=>({...I,distIds:{type:te,specificIds:[]}})),E(""),te==="other"&&n(I=>({...I,distributorData:{zone:"",state:"",distributorType:"",allDistributors:!0,specificDistributors:[]}}))},Q=te=>{E(te);const I=te.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce);n(Ce=>({...Ce,distIds:{...Ce.distIds,specificIds:I}}))},ee=te=>{b(te);const I=te.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce);n(Ce=>({...Ce,articles:{...Ce.articles,specificIds:I}}))},V=()=>{const te=`Article ID,Commission
ART001,10.5
ART002,25
ART003,15.75
ART004,50
ART005,8.25`,I=new Blob([te],{type:"text/csv"}),Ce=window.URL.createObjectURL(I),Ie=document.createElement("a");Ie.href=Ce,Ie.download="article-scheme-template.csv",document.body.appendChild(Ie),Ie.click(),document.body.removeChild(Ie),window.URL.revokeObjectURL(Ce),be.success("Article scheme template downloaded! Use this to define your articles and commissions.")},F=async te=>{const I=te.target.files?.[0];if(I){if(!I.name.toLowerCase().endsWith(".csv")&&!I.name.toLowerCase().endsWith(".xlsx")&&!I.name.toLowerCase().endsWith(".xls")){be.error("Please upload a CSV or Excel file");return}try{const Ie=(await I.text()).split(`
`).filter(et=>et.trim());if(Ie.length<2){be.error("File must contain header and at least one data row");return}const ue=Ie[0].split(",").map(et=>et.trim().toLowerCase()),ge=ue.findIndex(et=>et.includes("article")&&(et.includes("id")||et.includes("code"))),_e=ue.findIndex(et=>et.includes("commission"));if(ge===-1){be.error('Could not find Article ID column. Please ensure your file has an "Article ID" column.');return}if(_e===-1){be.error('Could not find Commission column. Please ensure your file has a "Commission" column.');return}const je={},Ke=[];let ot=0;const ft=[];for(let et=1;et<Ie.length;et++){const tt=Ie[et].split(",").map(dr=>dr.trim());if(tt.length<=Math.max(ge,_e)){ft.push(`Row ${et+1}: Insufficient columns`);continue}const lt=tt[ge],Ye=tt[_e];if(!lt){ft.push(`Row ${et+1}: Missing Article ID`);continue}const Tt=parseFloat(Ye);if(isNaN(Tt)){ft.push(`Row ${et+1}: Invalid commission value "${Ye}"`);continue}je[lt]=Tt,Ke.push(lt),ot++}if(ft.length>0&&ot===0){be.error(c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Upload failed"}),c.jsx("p",{className:"text-sm",children:ft.slice(0,3).join(", ")}),ft.length>3&&c.jsxs("p",{className:"text-sm",children:["...and ",ft.length-3," more errors"]})]}));return}O(je),T(I.name),n(et=>({...et,articles:{type:"other",specificIds:Ke}})),b(Ke.join(", ")),be.success(c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Excel Upload Successful!"}),c.jsxs("p",{className:"text-sm",children:[ot," articles loaded with commission data"]}),ft.length>0&&c.jsxs("p",{className:"text-sm text-orange-600",children:[ft.length," rows had errors"]})]}))}catch(Ce){console.error("Error processing Excel file:",Ce),be.error("Failed to process Excel file. Please check the format.")}te.target.value=""}},N=()=>{O({}),T(""),n(te=>({...te,articles:{type:"all",specificIds:[]}})),b(""),be.success("Article scheme data cleared successfully.")},L=()=>{a(te=>[...te,{min:0,max:null,rate:0}])},B=te=>{a(I=>I.filter((Ce,Ie)=>Ie!==te))},q=te=>{const I=parseFloat(te);return isNaN(I)?0:I},ne=(te,I,Ce)=>{a(Ie=>Ie.map((ue,ge)=>{if(ge!==te)return ue;if(I==="max"&&Ce===null)return{...ue,max:null};if(I==="max"&&Ce==="")return{...ue,max:null};if(typeof Ce=="string"){const _e=q(Ce);return{...ue,[I]:_e}}return{...ue,[I]:Ce}}))},Y=te=>{const I={...te};return I.distributorData.zone==="all-zones"&&(I.distributorData.zone=""),I.distributorData.state==="all-states"&&(I.distributorData.state=""),I.distributorData.distributorType==="all-types"&&(I.distributorData.distributorType=""),I.catalogType.family==="all-families"&&(I.catalogType.family=""),I.catalogType.brand==="all-brands"&&(I.catalogType.brand=""),I.catalogType.class==="all-classes"&&(I.catalogType.class=""),I.catalogType.article==="all-articles"&&(I.catalogType.article=""),I.catalogType.article==="others-articles"&&(I.catalogType.article="others"),I},oe=async te=>{if(te.preventDefault(),r.type==="article"&&Object.keys(D).length===0){be.error("Please upload an Excel file with Article ID and Commission data for Article schemes.");return}u(!0);try{const I=Y(r);let Ce=I.type;I.type==="per_unit"?Ce="booster-scheme":I.type==="article"&&(Ce="article-scheme");const Ie={...I,schemeType:Ce,basicInfo:{schemeName:I.name,schemeType:Ce,type:I.type,slabType:I.slabType||"quantity",commissionType:I.commissionType||"percentage",slabs:r.type==="article"?[]:s,startDate:I.startDate,endDate:I.endDate},slabs:r.type==="article"?[]:s,articleCommissions:Object.keys(D).length>0?D:void 0};console.log("Creating scheme with data:",{name:Ie.basicInfo?.schemeName,type:Ie.type,schemeType:Ie.schemeType,slabType:Ie.basicInfo?.slabType,commissionType:Ie.basicInfo?.commissionType,slabCount:Ie.slabs?.length||0,hasArticleCommissions:!!Ie.articleCommissions});const ge=await(await jt.makeAuthenticatedRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/schemes`,{method:"POST",body:JSON.stringify(Ie)})).json();ge.success?(be.success(c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{className:"h-5 w-5 text-green-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Scheme Created Successfully!"}),c.jsxs("p",{className:"text-sm text-gray-600",children:['"',r.name,'" is now ready for calculations']})]})]}),{duration:4e3}),n({name:"",type:"",distributorData:{zone:"",state:"",distributorType:"",allDistributors:!0,specificDistributors:[]},catalogType:{family:"",class:"",brand:"",article:"",specificArticleIds:""},distIds:{type:"all",specificIds:[]},articles:{type:"all",specificIds:[]},slabType:"",commissionType:"",startDate:"",endDate:""}),a([{min:0,max:null,rate:0}]),E(""),b(""),O({}),T(""),e&&e()):be.error(`Failed to create scheme: ${ge.error}`)}catch(I){console.error("Error creating scheme:",I),be.error("Failed to create scheme. Please try again.")}finally{u(!1)}},le=r.distIds.type==="other";return c.jsxs("form",{onSubmit:oe,className:"space-y-6",children:[g?c.jsxs(Je,{className:"bg-blue-50 border-blue-200",children:[c.jsx(At,{className:"pb-3",children:c.jsxs(Ft,{className:"text-sm flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ja,{className:"h-4 w-4"}),c.jsx("span",{children:"Category Data Status"})]}),c.jsxs($e,{type:"button",variant:"outline",size:"sm",onClick:()=>P(!0),disabled:f,className:"h-8",children:[c.jsx(zr,{className:`h-3 w-3 mr-1 ${f?"animate-spin":""}`}),"Refresh"]})]})}),c.jsx(Qe,{className:"pt-0",children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Families:"}),c.jsx("div",{className:"text-blue-700",children:g.families?.length||0})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Classes:"}),c.jsx("div",{className:"text-blue-700",children:g.classes?.length||0})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Brands:"}),c.jsx("div",{className:"text-blue-700",children:g.brands?.length||0})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Upload ID:"}),c.jsx("div",{className:"text-blue-700 font-mono text-xs",children:g.uploadId?.slice(-12)||"None"})]})]})})]}):c.jsxs(Je,{className:"bg-yellow-50 border-yellow-200",children:[c.jsx(At,{className:"pb-3",children:c.jsxs(Ft,{className:"text-sm flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ja,{className:"h-4 w-4 text-yellow-600"}),c.jsx("span",{children:"Category Data Required"})]}),c.jsxs($e,{type:"button",variant:"outline",size:"sm",onClick:()=>P(!0),disabled:f,className:"h-8",children:[c.jsx(zr,{className:`h-3 w-3 mr-1 ${f?"animate-spin":""}`}),"Load Data"]})]})}),c.jsx(Qe,{className:"pt-0",children:c.jsx("p",{className:"text-sm text-yellow-700",children:"No category data loaded. Please load category data to enable family, class, and brand selections for Booster schemes."})})]}),c.jsxs(Je,{children:[c.jsx(At,{children:c.jsx(Ft,{children:"Basic Information"})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"name",children:"Scheme Name"}),c.jsx(Qt,{id:"name",value:r.name,onChange:te=>de("name",te.target.value),placeholder:"Enter scheme name",required:!0})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"type",children:"Scheme Type"}),c.jsxs(_r,{value:r.type,onValueChange:te=>de("type",te),children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select scheme type"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"article",children:"Article Scheme"}),c.jsx(wt,{value:"per_unit",children:"Booster"})]})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"startDate",children:"Start Date"}),c.jsx(Qt,{id:"startDate",type:"date",value:r.startDate,onChange:te=>de("startDate",te.target.value),required:!0})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"endDate",children:"End Date"}),c.jsx(Qt,{id:"endDate",type:"date",value:r.endDate,onChange:te=>de("endDate",te.target.value),required:!0})]})]})]})]}),c.jsxs(Je,{children:[c.jsx(At,{children:c.jsx(Ft,{children:"Distributor Criteria"})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"distIds",children:"DIST ID's"}),c.jsxs(_r,{value:r.distIds.type,onValueChange:he,children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select distributor ID option"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"all",children:"All"}),c.jsx(wt,{value:"other",children:"Other"})]})]})]}),r.distIds.type==="other"&&c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"specificDistIds",children:"Specific Distributor IDs"}),c.jsx(Xc,{id:"specificDistIds",value:S,onChange:te=>Q(te.target.value),placeholder:"Enter distributor IDs separated by commas (e.g., DIST001, DIST002, DIST003)",rows:3}),r.distIds.specificIds.length>0&&c.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:r.distIds.specificIds.map(te=>c.jsx(Mt,{variant:"outline",children:te},te))})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"zone",children:"Zone"}),c.jsxs(_r,{value:r.distributorData.zone,onValueChange:te=>de("distributorData.zone",te),disabled:le,children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select zone"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"all-zones",children:"ALL Zones"}),U.map(te=>c.jsx(wt,{value:te,children:te},te))]})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"state",children:"State"}),c.jsxs(_r,{value:r.distributorData.state,onValueChange:te=>de("distributorData.state",te),disabled:le,children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select state"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"all-states",children:"ALL States"}),me().map(te=>c.jsx(wt,{value:te,children:te},te))]})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"distributorType",children:"Distributor Type"}),c.jsxs(_r,{value:r.distributorData.distributorType,onValueChange:te=>de("distributorData.distributorType",te),disabled:le,children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select type"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"all-types",children:"ALL Types"}),z.map(te=>c.jsxs(wt,{value:te.code,children:[te.code," - ",te.name]},te.code))]})]})]})]})]})]}),r.type==="per_unit"&&c.jsxs(Je,{children:[c.jsx(At,{children:c.jsx(Ft,{children:"Catalog Criteria"})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"family",children:"Family"}),c.jsxs(_r,{value:r.catalogType.family,onValueChange:te=>de("catalogType.family",te),children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select family"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"all-families",children:"ALL Families"}),g?.families?.map(te=>c.jsx(wt,{value:te,children:te},te))]})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"class",children:"Class"}),c.jsxs(_r,{value:r.catalogType.class,onValueChange:te=>de("catalogType.class",te),disabled:r.catalogType.article==="others-articles",children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select class"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"all-classes",children:"ALL Classes"}),ce().map(te=>c.jsx(wt,{value:te,children:te},te))]})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"brand",children:"Brand"}),c.jsxs(_r,{value:r.catalogType.brand,onValueChange:te=>de("catalogType.brand",te),disabled:r.catalogType.article==="others-articles",children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select brand"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"all-brands",children:"ALL Brands"}),fe().map(te=>c.jsx(wt,{value:te,children:te},te))]})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"article",children:"Articles"}),c.jsxs(_r,{value:r.catalogType.article,onValueChange:te=>de("catalogType.article",te),children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select articles"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"all-articles",children:"ALL Articles"}),c.jsx(wt,{value:"others-articles",children:"Others"})]})]})]})]}),r.catalogType.article==="others-articles"&&c.jsxs("div",{className:"mt-4",children:[c.jsx(ct,{htmlFor:"specificArticleIds",children:"Specific Article IDs"}),c.jsx(Xc,{id:"specificArticleIds",value:A,onChange:te=>ee(te.target.value),placeholder:"Enter article IDs separated by commas (e.g., ART001, ART002, ART003)",rows:3}),r.articles.specificIds.length>0&&c.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:r.articles.specificIds.map(te=>c.jsx(Mt,{variant:"outline",children:te},te))})]})]})]}),r.type==="article"&&c.jsxs(Je,{children:[c.jsx(At,{children:c.jsx(Ft,{children:"Article Scheme Definition"})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"commissionType",children:"Commission Type"}),c.jsxs(_r,{value:r.commissionType,onValueChange:te=>de("commissionType",te),children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select commission type"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"fixed",children:"Fixed"}),c.jsx(wt,{value:"absolute",children:"Absolute (per unit)"}),c.jsx(wt,{value:"percentage",children:"Percentage"})]})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(ct,{children:"Upload Article Commissions"}),c.jsxs($e,{type:"button",variant:"outline",size:"sm",onClick:V,children:[c.jsx(pi,{className:"h-4 w-4 mr-2"}),"Download Template"]})]}),c.jsxs("div",{children:[c.jsx(Qt,{type:"file",accept:".csv,.xlsx,.xls",onChange:F,className:"cursor-pointer"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload a CSV or Excel file with Article ID and Commission columns"})]}),C&&c.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-md",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(c3,{className:"h-4 w-4 text-green-600"}),c.jsx("span",{className:"text-sm text-green-800",children:C}),c.jsxs(Mt,{variant:"outline",className:"text-green-700",children:[Object.keys(D).length," articles"]})]}),c.jsx($e,{type:"button",variant:"outline",size:"sm",onClick:N,children:"Clear"})]})]})]})]}),r.type==="per_unit"&&c.jsxs(Je,{children:[c.jsx(At,{children:c.jsx(Ft,{children:"Slab Configuration"})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"slabType",children:"Slab Type"}),c.jsxs(_r,{value:r.slabType,onValueChange:te=>de("slabType",te),children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select slab type"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"quantity",children:"Quantity"}),c.jsx(wt,{value:"value",children:"Value"})]})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"commissionType",children:"Commission Type"}),c.jsxs(_r,{value:r.commissionType,onValueChange:te=>de("commissionType",te),children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select commission type"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"fixed",children:"Fixed"}),c.jsx(wt,{value:"percentage",children:"Percentage"}),c.jsx(wt,{value:"absolute_per_unit",children:"Absolute Per Unit"})]})]})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(ct,{children:"Slabs"}),c.jsxs($e,{type:"button",variant:"outline",size:"sm",onClick:L,children:[c.jsx(Gc,{className:"h-4 w-4 mr-2"}),"Add Slab"]})]}),s.map((te,I)=>c.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-md",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx(ct,{className:"text-sm",children:"Min"}),c.jsx(Qt,{type:"number",value:te.min,onChange:Ce=>ne(I,"min",Ce.target.value),min:"0",step:"0.01"})]}),c.jsxs("div",{className:"flex-1",children:[c.jsx(ct,{className:"text-sm",children:"Max (Optional)"}),c.jsx(Qt,{type:"number",value:te.max===null?"":te.max,onChange:Ce=>ne(I,"max",Ce.target.value||null),min:"0",step:"0.01",placeholder:"No limit"})]}),c.jsxs("div",{className:"flex-1",children:[c.jsx(ct,{className:"text-sm",children:"Rate"}),c.jsx(Qt,{type:"number",value:te.rate,onChange:Ce=>ne(I,"rate",Ce.target.value),min:"0",step:"0.01"})]}),s.length>1&&c.jsx($e,{type:"button",variant:"outline",size:"sm",onClick:()=>B(I),children:c.jsx(xu,{className:"h-4 w-4"})})]},I))]})]})]}),c.jsxs("div",{className:"flex justify-end space-x-4",children:[c.jsxs($e,{type:"button",variant:"outline",onClick:()=>P(!0),disabled:f,children:[c.jsx(zr,{className:`h-4 w-4 mr-2 ${f?"animate-spin":""}`}),"Refresh Data"]}),c.jsx($e,{type:"submit",disabled:o,children:o?c.jsxs(c.Fragment,{children:[c.jsx(zr,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating Scheme..."]}):c.jsxs(c.Fragment,{children:[c.jsx(gs,{className:"h-4 w-4 mr-2"}),"Create Scheme"]})})]})]})});L_.displayName="CreateScheme";function aR({onDataUploaded:e}){const[t,r]=j.useState(null),[n,s]=j.useState(""),[a,o]=j.useState(""),[u,f]=j.useState(!1),[d,p]=j.useState("idle"),[m,g]=j.useState([]),y=j.useRef(null),w=["January","February","March","April","May","June","July","August","September","October","November","December"],v=new Date().getFullYear(),S=Array.from({length:5},(O,C)=>v-2+C),E=O=>{const C=O.target.files?.[0];C&&(r(C),p("idle"),C.type==="text/csv"||C.name.endsWith(".csv")?A(C):be.error("Please upload a CSV file"))},A=O=>{const C=new FileReader;C.onload=T=>{const z=(T.target?.result).split(`
`);z[0].split(",").map(re=>re.trim());const Z=[];for(let re=1;re<z.length;re++){if(z[re].trim()==="")continue;const P=z[re].split(",").map(me=>me.trim()),se={monthOfBillingDate:P[0]||"",dayOfBillingDate:P[1]||"",distributorId:P[2]||"",articleId:P[3]||"",billingQuantity:parseFloat(P[4])||0,netSales:parseFloat(P[5])||0,billingDocument:P[6]||""};Z.push(se)}if(Z.length>1e5){be.error(`File contains ${Z.length} records. Maximum 100,000 records allowed for optimal performance. Please split your data into smaller files.`),g([]);return}g(Z),be.success(`Parsed ${Z.length} records from CSV`)},C.onerror=()=>{be.error("Error reading file")},C.readAsText(O)},b=async()=>{if(!t||!n||!a||m.length===0){be.error("Please select a file, month, year and ensure data is parsed");return}f(!0);try{const O={fileName:t.name,data:m,month:n,year:parseInt(a)};console.log("Uploading to:",`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/upload-sales-data`),console.log("Upload data summary:",{fileName:O.fileName,recordCount:O.data.length,month:O.month,year:O.year});const C=await jt.makeAuthenticatedRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/upload-sales-data`,{method:"POST",body:JSON.stringify(O)});console.log("Response status:",C.status,C.statusText),console.log("Response headers:",Object.fromEntries(C.headers.entries()));let T;const U=await C.text();console.log("Raw response:",U);try{T=JSON.parse(U)}catch(z){console.error("JSON parse error:",z),console.error("Response text that failed to parse:",U),be.error(c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ia,{className:"h-4 w-4 text-red-500"}),c.jsx("span",{className:"font-medium",children:"Server Response Error"})]}),c.jsxs("div",{className:"text-sm",children:[c.jsx("p",{children:"The server returned an invalid response:"}),c.jsxs("code",{className:"bg-red-100 px-2 py-1 rounded text-xs block mt-1 max-w-md overflow-hidden",children:[U.substring(0,200),U.length>200?"...":""]}),c.jsxs("p",{className:"mt-2",children:["Status: ",C.status," ",C.statusText]}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Check the Debug tab for more information about the backend connection."})]})]}),{duration:1e4}),p("error");return}if(C.ok&&T.success)p("success"),be.success(c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{className:"h-5 w-5 text-green-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Sales Data Uploaded Successfully!"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[m.length," records uploaded for ",n," ",a]})]})]}),{duration:5e3}),setTimeout(()=>{be.info(c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(p_,{className:"h-5 w-5 text-blue-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Ready for Calculations!"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Go to 'Manage Schemes' or 'View Calculations' tab to run calculations with this data"})]})]}),{duration:6e3})},1e3),r(null),s(""),o(""),g([]),y.current&&(y.current.value=""),e&&e();else{p("error");const z=T?.error||`HTTP ${C.status}: ${C.statusText}`;be.error(c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ia,{className:"h-4 w-4 text-red-500"}),c.jsx("span",{className:"font-medium",children:"Upload Failed"})]}),c.jsxs("div",{className:"text-sm",children:[c.jsx("p",{children:z}),C.status===404&&c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"The upload endpoint may not be deployed. Check the Debug tab for backend status."})]})]}),{duration:8e3})}}catch(O){console.error("Upload error:",O),p("error");let C="Failed to upload sales data";O instanceof Error&&(O.message.includes("Failed to fetch")?C="Unable to connect to the backend server. Please check if the Supabase Edge Function is deployed.":O.message.includes("NetworkError")?C="Network error occurred. Please check your internet connection.":C=`Upload error: ${O.message}`),be.error(c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ia,{className:"h-4 w-4 text-red-500"}),c.jsx("span",{className:"font-medium",children:"Upload Error"})]}),c.jsxs("div",{className:"text-sm",children:[c.jsx("p",{children:C}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Check the Debug tab for more information about the backend connection."})]})]}),{duration:8e3})}finally{f(!1)}},D=()=>{const O=["Month of Billing Date,Day of Billing Date,Distributor ID,Article ID,Billing Quantity,Net Sales,Billing Document","01,15,DIST001,ART123456,10,500000,INV001234","01,20,DIST002,ART123457,15,450000,INV001235","01,25,DIST003,ART123458,5,150000,INV001236","02,05,DIST004,ART123459,8,240000,INV001237","02,12,DIST005,ART123460,12,120000,INV001238","02,18,DIST006,ART123461,6,180000,INV001239","03,08,DIST007,ART123462,4,80000,INV001240","03,14,DIST008,ART123459,5,150000,INV001241","03,22,DIST009,ART123456,7,350000,INV001242"].join(`
`),C=new Blob([O],{type:"text/csv"}),T=window.URL.createObjectURL(C),U=document.createElement("a");U.href=T,U.download="sample_sales_data.csv",U.click(),window.URL.revokeObjectURL(T)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs(sr,{children:[c.jsx(Hc,{className:"h-4 w-4"}),c.jsxs(ar,{children:[c.jsx("strong",{children:"Updated Format & Performance Limits:"})," Sales data follows the new billing format with Month, Day, Distributor ID, Article ID, Billing Quantity, Net Sales, and Billing Document.",c.jsx("strong",{children:"Maximum 100,000 records per upload"})," for optimal performance. Make sure your Article IDs match those from your category upload for proper calculations."]})]}),c.jsxs(Je,{children:[c.jsx(At,{children:c.jsx(Ft,{children:"Upload Configuration"})}),c.jsx(Qe,{className:"space-y-4",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"month",children:"Month"}),c.jsxs(_r,{value:n,onValueChange:s,children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select month"})}),c.jsx(br,{children:w.map((O,C)=>c.jsx(wt,{value:O,children:O},O))})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"year",children:"Year"}),c.jsxs(_r,{value:a,onValueChange:o,children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select year"})}),c.jsx(br,{children:S.map(O=>c.jsx(wt,{value:O.toString(),children:O},O))})]})]})]})})]}),c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center justify-between",children:[c.jsx("span",{children:"Upload Sales Data"}),c.jsxs($e,{onClick:D,variant:"outline",size:"sm",children:[c.jsx(Cl,{className:"h-4 w-4 mr-2"}),"Download Sample CSV"]})]})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[c.jsx(oa,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-lg",children:"Drop your CSV file here or click to browse"}),c.jsx("p",{className:"text-sm text-gray-500",children:"CSV format: Month of Billing Date, Day of Billing Date, Distributor ID, Article ID, Billing Quantity, Net Sales, Billing Document"})]}),c.jsx("input",{ref:y,type:"file",accept:".csv",onChange:E,className:"hidden",id:"file-upload"}),c.jsx($e,{onClick:()=>y.current?.click(),variant:"outline",className:"mt-4",children:"Select File"})]}),t&&c.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Cl,{className:"h-5 w-5 text-blue-500"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:t.name}),c.jsxs("p",{className:"text-sm text-gray-500",children:[(t.size/1024).toFixed(1)," KB"]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[d==="success"&&c.jsxs(Mt,{variant:"secondary",className:"bg-green-100 text-green-800",children:[c.jsx(bm,{className:"h-3 w-3 mr-1"}),"Uploaded"]}),d==="error"&&c.jsxs(Mt,{variant:"secondary",className:"bg-red-100 text-red-800",children:[c.jsx(fd,{className:"h-3 w-3 mr-1"}),"Error"]}),c.jsx($e,{onClick:()=>{r(null),g([]),p("idle"),y.current&&(y.current.value="")},variant:"ghost",size:"sm",children:c.jsx(fd,{className:"h-4 w-4"})})]})]}),m.length>0&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h4",{className:"font-medium",children:"Data Preview"}),c.jsxs(Mt,{variant:"outline",children:[m.length," records"]})]}),c.jsxs("div",{className:"max-h-64 overflow-auto border rounded-lg",children:[c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"p-2 text-left",children:"Month"}),c.jsx("th",{className:"p-2 text-left",children:"Day"}),c.jsx("th",{className:"p-2 text-left",children:"Distributor ID"}),c.jsx("th",{className:"p-2 text-left",children:"Article ID"}),c.jsx("th",{className:"p-2 text-right",children:"Quantity"}),c.jsx("th",{className:"p-2 text-right",children:"Net Sales"}),c.jsx("th",{className:"p-2 text-left",children:"Document"})]})}),c.jsx("tbody",{children:m.slice(0,10).map((O,C)=>c.jsxs("tr",{className:"border-t",children:[c.jsx("td",{className:"p-2",children:O.monthOfBillingDate}),c.jsx("td",{className:"p-2",children:O.dayOfBillingDate}),c.jsx("td",{className:"p-2",children:O.distributorId}),c.jsx("td",{className:"p-2 font-mono text-xs",children:O.articleId}),c.jsx("td",{className:"p-2 text-right",children:O.billingQuantity}),c.jsxs("td",{className:"p-2 text-right",children:["",O.netSales.toLocaleString()]}),c.jsx("td",{className:"p-2 text-xs",children:O.billingDocument})]},C))})]}),m.length>10&&c.jsxs("div",{className:"p-2 text-center text-sm text-gray-500 bg-gray-50",children:["... and ",m.length-10," more records"]})]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsx($e,{onClick:b,disabled:!t||!n||!a||u||m.length===0,size:"lg",children:u?"Uploading...":"Upload Sales Data"})})]})]}),d==="success"&&c.jsx(Je,{className:"border-green-200 bg-green-50",children:c.jsx(Qe,{className:"p-6",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(gs,{className:"h-6 w-6 text-green-600"}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-green-900",children:"Sales Data Uploaded Successfully!"}),c.jsx("p",{className:"text-sm text-green-700",children:"Your billing data is now ready for scheme calculations. The system will use the Article IDs to map to the corresponding family, class, and brand information from your category data, along with distributor information for comprehensive scheme calculations. Head to 'Manage Schemes' or 'View Calculations' to run calculations with this uploaded data."})]})]})})})]})}const Dm=()=>{const e=Date.now(),t=Math.random().toString(36).substr(2,9);return`v=${e}&r=${t}`},iR=async()=>{try{const e=Dm(),t=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/schemes?${e}`;console.log("=== FETCHING SCHEMES ==="),console.log("URL:",t);const r=await jt.makeAuthenticatedRequest(t,{method:"GET"});if(console.log("Schemes response:",{status:r.status,statusText:r.statusText,ok:r.ok}),!r.ok){const s=await r.text();if(console.error("Schemes fetch failed:",r.status,s),r.status===404||r.status===500)return console.warn(`Schemes endpoint returned ${r.status} - returning empty array`),[];throw new Error(`HTTP ${r.status}: ${s}`)}const n=await r.json();if(console.log("Schemes result:",{success:n.success,schemesLength:n.schemes?.length||0}),n.success&&Array.isArray(n.schemes)){const s=n.schemes.map(a=>{const o=a.value||a;return{id:o.id,name:o.name,type:o.type,startDate:o.startDate,endDate:o.endDate,status:o.status||"active",slabType:o.slabType,commissionType:o.commissionType,distributorData:o.distributorData,catalogType:o.catalogType}}).filter(a=>a&&a.id&&a.name);return console.log("Successfully processed schemes:",s.length),s}return console.log("No schemes found or invalid response structure"),[]}catch(e){console.error("Error fetching schemes:",e);const t=e instanceof Error?e.message:"Unknown error";return e instanceof Error&&(e.message.includes("404")||e.message.includes("500"))?(console.log("Backend error when fetching schemes - may be expected if backend is not deployed"),[]):(be.error(`Failed to fetch schemes: ${t}`),[])}},oR=async()=>{try{const e=Dm(),t=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/sales-data?${e}`;console.log("=== FETCHING SALES DATA (UPLOADS) ==="),console.log("URL:",t);const r=await jt.makeAuthenticatedRequest(t,{method:"GET"});if(console.log("Sales data response:",{status:r.status,statusText:r.statusText,ok:r.ok}),!r.ok){const s=await r.text();if(console.error("Sales data fetch failed:",r.status,s),r.status===404)return console.log("Sales data endpoint returned 404 - this is expected when no sales data has been uploaded"),[];if(r.status===500)return console.warn("Server error when fetching sales data - backend may be experiencing issues"),[];throw new Error(`HTTP ${r.status}: ${s}`)}const n=await r.json();if(console.log("Sales data result:",{success:n.success,salesDataExists:!!n.salesData,salesDataLength:n.salesData?.length||0}),n.success){if(!n.salesData||!Array.isArray(n.salesData)||n.salesData.length===0)return console.log("No sales data found - returning empty uploads array"),[];const s=[],a=new Map;n.salesData.forEach(u=>{const f=u.uploadMonth||"Unknown",d=u.uploadYear||new Date().getFullYear(),p=u.fileName||"sales_data.csv",m=u.uploadedAt?u.uploadedAt.split("T")[0]:new Date().toISOString().split("T")[0],g=`${f}_${d}_${p}_${m}`;a.has(g)||a.set(g,[]),a.get(g).push(u)});let o=0;return a.forEach((u,f)=>{const d=u[0],p={id:`upload_${o}_${d.uploadMonth||"unknown"}_${d.uploadYear||"unknown"}`,fileName:d.fileName||"sales_data.csv",month:d.uploadMonth||"Unknown",year:Number(d.uploadYear)||new Date().getFullYear(),uploadedAt:d.uploadedAt||new Date().toISOString(),data:u};s.push(p),o++}),console.log("Successfully transformed sales data to uploads:",{uploadsCount:s.length,totalSalesRecords:n.salesData.length,uploadDetails:s.map(u=>`${u.month} ${u.year} (${u.data?.length||0} records)`)}),s}return console.log("Sales data response did not contain expected structure or was not successful"),[]}catch(e){console.error("Error fetching sales data for uploads:",e);const t=e instanceof Error?e.message:"Unknown error";if(e instanceof Error){if(e.message.includes("404"))return console.log("No sales data available - this is expected when no data has been uploaded"),[];if(e.message.includes("500"))return console.warn("Server error when fetching sales data"),[];if(e.message.includes("Failed to fetch")||e.message.includes("NetworkError"))return console.error("Network error - backend may not be accessible"),[]}return console.warn("Showing error toast for unexpected error:",t),be.error(`Failed to fetch sales data: ${t}`),[]}},lR=async(e=50,t=0)=>{try{const r=Dm(),n=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/calculations/latest?${r}`;console.log("=== FETCHING LATEST CALCULATION ==="),console.log("URL:",n);const s=await jt.makeAuthenticatedRequest(n,{method:"GET"});if(console.log("Calculations response:",{status:s.status,statusText:s.statusText,ok:s.ok}),!s.ok){const o=await s.text();if(console.error("Calculations fetch failed:",s.status,o),s.status===408)throw new Error("Server timeout - too much calculation data. Please try again or contact support.");if(s.status===404)return console.log("No calculations found - this is expected when no calculations have been run"),[];throw new Error(`HTTP ${s.status}: ${o}`)}const a=await s.json();if(console.log("Calculations result:",{success:a.success,calculationsLength:a.calculations?.length||0,calculationId:a.calculationId,totalRecords:a.totalRecords}),a.success&&Array.isArray(a.calculations)){const o={id:a.calculationId||`calc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,schemeId:"",uploadId:"all-sales-data",calculations:a.calculations,distributorArticleSummary:[],totalCommission:a.calculations.reduce((u,f)=>u+(f.commission||0),0),totalDistributorArticleCombinations:new Set(a.calculations.map(u=>`${u.distributorId}:${u.articleId}`)).size,calculatedAt:a.createdAt||new Date().toISOString(),calculationType:"optimized-chunked"};return console.log("Successfully processed latest calculation:",{id:o.id,totalCommission:o.totalCommission,totalRecords:o.calculations.length}),[o]}return console.log("Calculations response did not contain expected structure"),[]}catch(r){console.error("Error fetching calculations:",r);const n=r instanceof Error?r.message:"Unknown error";if(n.includes("timeout"))throw r;if(r instanceof Error&&(r.message.includes("404")||r.message.includes("500")))return console.log("Backend error when fetching calculations - may be expected"),[];throw be.error(`Failed to fetch calculations: ${n}`),r}},cR=async(e,t)=>{try{console.log("=== CALCULATING SCHEME ==="),console.log("Scheme ID:",e);const r=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/calculate`;console.log("Calculate URL:",r);const n=await jt.makeAuthenticatedRequest(r,{method:"POST",body:JSON.stringify({schemeId:e})});if(console.log("Calculate response:",{status:n.status,statusText:n.statusText,ok:n.ok}),!n.ok){const a=await n.text();throw console.error("Calculate request failed:",n.status,a),n.status===408?new Error("Calculation timeout - Dataset too large. Please reduce your data size or contact support."):new Error(`HTTP ${n.status}: ${a}`)}const s=await n.json();return console.log("Calculate result:",{success:s.success,calculationId:s.calculationId,totalCommission:s.summary?.totalCommission,recordsProcessed:s.calculations?.length}),s}catch(r){throw console.error("Error in calculateScheme:",r),r}},M_=(e,t,r)=>{const n=t.find(d=>d.id===e.schemeId),s=r.find(d=>d.id===e.uploadId),a=["Scheme Name,Calculation Date,Sales Period,Month,Day,Distributor ID,Distributor Name,Article ID,Billing Quantity,Net Sales,Billing Document,Commission,Scheme Type,Total Group Quantity,Total Group Value,Slab Rate,Total Group Commission",...e.calculations.map(d=>`${n?.name||"Unknown"},${new Date(e.calculatedAt).toLocaleDateString()},${s?`${s.month} ${s.year}`:"Unknown"},${d.monthOfBillingDate},${d.dayOfBillingDate},${d.distributorId},${d.distributorName||""},${d.articleId||""},${d.billingQuantity},${d.netSales},${d.billingDocument||""},${d.commission},${d.schemeType},${d.totalGroupQuantity||""},${d.totalGroupValue||""},${d.slabRate||""},${d.totalGroupCommission||""}`)].join(`
`),o=new Blob([a],{type:"text/csv"}),u=window.URL.createObjectURL(o),f=document.createElement("a");f.href=u,f.download=`scheme_calculation_detailed_${n?.name?.replace(/\s+/g,"_")||e.id}_${new Date(e.calculatedAt).toISOString().split("T")[0]}.csv`,f.click(),window.URL.revokeObjectURL(u),be.success("Detailed calculation exported successfully!")},B_=(e,t,r)=>{if(!e.distributorArticleSummary||e.distributorArticleSummary.length===0){be.error("No distributor-article summary data available for this calculation");return}const n=t.find(d=>d.id===e.schemeId),s=r.find(d=>d.id===e.uploadId),a=["Scheme Name,Calculation Date,Sales Period,Distributor ID,Distributor Name,Article ID,Total Quantity,Total Value,Slab Rate,Commission,Sales Count,Comparison Value,Slab Type,Commission Type",...e.distributorArticleSummary.map(d=>`${n?.name||"Unknown"},${new Date(e.calculatedAt).toLocaleDateString()},${s?`${s.month} ${s.year}`:"Unknown"},${d.distributorId},${d.distributorName},${d.articleId},${d.totalQuantity},${d.totalValue},${d.slabRate},${d.commission},${d.salesCount},${d.comparisonValue},${d.slabType},${d.commissionType}`)].join(`
`),o=new Blob([a],{type:"text/csv"}),u=window.URL.createObjectURL(o),f=document.createElement("a");f.href=u,f.download=`scheme_distributor_article_summary_${n?.name?.replace(/\s+/g,"_")||e.id}_${new Date(e.calculatedAt).toISOString().split("T")[0]}.csv`,f.click(),window.URL.revokeObjectURL(u),be.success("Distributor-Article summary exported successfully!")},U_=(e,t,r)=>{const n=e.flatMap(f=>{const d=t.find(g=>g.id===f.schemeId),p=r.find(g=>g.id===f.uploadId),m=new Map;return f.calculations.forEach(g=>{const y=`${g.distributorId}_${g.articleId}`,w=m.get(y);w?(w.totalQuantity+=g.billingQuantity,w.totalValue+=g.netSales,w.totalCommission+=g.commission,w.recordCount+=1):m.set(y,{schemeName:d?.name||"Unknown",calculationDate:new Date(f.calculatedAt).toLocaleDateString(),salesPeriod:p?`${p.month} ${p.year}`:"Unknown",distributorId:g.distributorId,distributorName:g.distributorName||"",articleId:g.articleId||"",totalQuantity:g.billingQuantity,totalValue:g.netSales,totalCommission:g.commission,recordCount:1})}),Array.from(m.values())});if(n.length===0){be.error("No distributor-article level data available");return}const s=["Scheme Name,Calculation Date,Sales Period,Distributor ID,Distributor Name,Article ID,Total Quantity,Total Value,Total Commission,Record Count",...n.map(f=>`${f.schemeName},${f.calculationDate},${f.salesPeriod},${f.distributorId},${f.distributorName},${f.articleId},${f.totalQuantity},${f.totalValue},${f.totalCommission},${f.recordCount}`)].join(`
`),a=new Blob([s],{type:"text/csv"}),o=window.URL.createObjectURL(a),u=document.createElement("a");u.href=o,u.download=`distributor_article_level_export_${new Date().toISOString().split("T")[0]}.csv`,u.click(),window.URL.revokeObjectURL(o),be.success("Distributor + Article level export completed successfully!")},$_=(e,t,r)=>{const n=e.flatMap(f=>{const d=t.find(g=>g.id===f.schemeId),p=r.find(g=>g.id===f.uploadId),m=new Map;return f.calculations.forEach(g=>{const y=`${f.schemeId}_${g.distributorId}`,w=m.get(y);w?(w.uniqueArticles.add(g.articleId||""),w.totalQuantity+=g.billingQuantity,w.totalValue+=g.netSales,w.totalCommission+=g.commission,w.recordCount+=1):m.set(y,{schemeName:d?.name||"Unknown",schemeType:d?.type||"Unknown",calculationDate:new Date(f.calculatedAt).toLocaleDateString(),salesPeriod:p?`${p.month} ${p.year}`:"Unknown",distributorId:g.distributorId,distributorName:g.distributorName||"",uniqueArticles:new Set([g.articleId||""]),totalQuantity:g.billingQuantity,totalValue:g.netSales,totalCommission:g.commission,recordCount:1})}),Array.from(m.values()).map(g=>({...g,articleCount:g.uniqueArticles.size,articleList:Array.from(g.uniqueArticles).join(", ")}))});if(n.length===0){be.error("No scheme-distributor level data available");return}const s=["Scheme Name,Scheme Type,Calculation Date,Sales Period,Distributor ID,Distributor Name,Article Count,Articles,Total Quantity,Total Value,Total Commission,Record Count",...n.map(f=>`${f.schemeName},${f.schemeType},${f.calculationDate},${f.salesPeriod},${f.distributorId},${f.distributorName},${f.articleCount},"${f.articleList}",${f.totalQuantity},${f.totalValue},${f.totalCommission},${f.recordCount}`)].join(`
`),a=new Blob([s],{type:"text/csv"}),o=window.URL.createObjectURL(a),u=document.createElement("a");u.href=o,u.download=`scheme_distributor_level_export_${new Date().toISOString().split("T")[0]}.csv`,u.click(),window.URL.revokeObjectURL(o),be.success("Scheme + Distributor level export completed successfully!")};function qc({className:e,...t}){return c.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:c.jsx("table",{"data-slot":"table",className:Et("w-full caption-bottom text-sm",e),...t})})}function Yc({className:e,...t}){return c.jsx("thead",{"data-slot":"table-header",className:Et("[&_tr]:border-b",e),...t})}function Jc({className:e,...t}){return c.jsx("tbody",{"data-slot":"table-body",className:Et("[&_tr:last-child]:border-0",e),...t})}function Fs({className:e,...t}){return c.jsx("tr",{"data-slot":"table-row",className:Et("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function It({className:e,...t}){return c.jsx("th",{"data-slot":"table-head",className:Et("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function Pt({className:e,...t}){return c.jsx("td",{"data-slot":"table-cell",className:Et("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function uR({currentCalculation:e,schemes:t,uploads:r}){return e?c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center justify-between",children:[c.jsx("span",{children:"Latest Calculation Details"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs($e,{onClick:()=>M_(e,t,r),variant:"outline",size:"sm",children:[c.jsx(pi,{className:"h-4 w-4 mr-2"}),"Export Detailed"]}),e.distributorArticleSummary&&e.distributorArticleSummary.length>0&&c.jsxs($e,{onClick:()=>B_(e,t,r),variant:"outline",size:"sm",children:[c.jsx(pl,{className:"h-4 w-4 mr-2"}),"Export Summary"]}),c.jsxs($e,{onClick:()=>U_([e],t,r),variant:"outline",size:"sm",children:[c.jsx(pi,{className:"h-4 w-4 mr-2"}),"Export Distributor+Article"]}),c.jsxs($e,{onClick:()=>$_([e],t,r),variant:"outline",size:"sm",children:[c.jsx(pi,{className:"h-4 w-4 mr-2"}),"Export Scheme+Distributor"]})]})]})}),c.jsxs(Qe,{children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["",e.totalCommission.toLocaleString()]}),c.jsx("div",{className:"text-sm text-gray-500",children:"Total Commission"})]})})}),c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.calculations.length}),c.jsx("div",{className:"text-sm text-gray-500",children:"Detailed Records"})]})})}),c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e.totalDistributorArticleCombinations||0}),c.jsx("div",{className:"text-sm text-gray-500",children:"Distributor-Article Combinations"})]})})})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(qc,{children:[c.jsx(Yc,{children:c.jsxs(Fs,{children:[c.jsx(It,{children:"Distributor ID"}),c.jsx(It,{children:"Article ID"}),c.jsx(It,{children:"Quantity"}),c.jsx(It,{children:"Net Sales"}),c.jsx(It,{children:"Commission"}),c.jsx(It,{children:"Slab Rate"}),c.jsx(It,{children:"Group Total Qty"}),c.jsx(It,{children:"Group Commission"})]})}),c.jsx(Jc,{children:e.calculations.slice(0,50).map((n,s)=>c.jsxs(Fs,{children:[c.jsx(Pt,{className:"font-mono text-sm",children:n.distributorId}),c.jsx(Pt,{className:"font-mono text-sm",children:n.articleId}),c.jsx(Pt,{className:"text-right",children:n.billingQuantity}),c.jsxs(Pt,{className:"text-right",children:["",n.netSales.toLocaleString()]}),c.jsxs(Pt,{className:"text-right font-medium",children:["",n.commission.toFixed(2)]}),c.jsx(Pt,{className:"text-right",children:n.slabRate||"-"}),c.jsx(Pt,{className:"text-right",children:n.totalGroupQuantity||"-"}),c.jsx(Pt,{className:"text-right font-medium",children:n.totalGroupCommission?`${n.totalGroupCommission.toFixed(2)}`:"-"})]},s))})]})}),e.calculations.length>50&&c.jsxs("div",{className:"text-center text-gray-500 text-sm mt-4",children:["Showing first 50 records of ",e.calculations.length,". Export to see all data."]})]})]}):c.jsx(Je,{children:c.jsxs(Qe,{className:"p-8 text-center",children:[c.jsx(na,{className:"h-16 w-16 mx-auto text-gray-400 mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Current Calculation"}),c.jsx("p",{className:"text-gray-500",children:"Run a calculation above to see detailed results here."})]})})}function fR(){const[e,t]=j.useState([]),[r,n]=j.useState([]),[s,a]=j.useState([]),[o,u]=j.useState(""),[f,d]=j.useState("all-sales-data"),[p,m]=j.useState(null),[g,y]=j.useState(!1),[w,v]=j.useState(""),[S,E]=j.useState("all"),[A,b]=j.useState(null);j.useEffect(()=>{D()},[]),j.useEffect(()=>{r.length>0&&!f&&d("all-sales-data")},[r]);const D=async()=>{y(!0),b(null);try{const[P,se]=await Promise.all([iR(),oR()]);t(P),n(se);try{const me=await lR(50,0);a(me)}catch(me){console.error("Error fetching calculations:",me);const ce=me instanceof Error?me.message:"Unknown error";ce.includes("timeout")?(b("Calculations data is taking too long to load. The system may have too much historical data. Recent calculations functionality is temporarily unavailable."),a([])):(b(`Failed to load calculations: ${ce}`),a([]))}}catch(P){console.error("Error fetching main data:",P),be.error("Failed to fetch schemes and uploads data")}finally{y(!1)}},O=async()=>{if(!o){be.error("Please select a scheme to calculate");return}if(r.length===0){be.error("No sales data available. Please upload sales data first.");return}y(!0);const P=Date.now();try{const se=await cR(o,f==="all-sales-data"?"":f);if(se.success){const me=Date.now()-P;be.success(c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{className:"h-5 w-5 text-green-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Calculation Completed Successfully!"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[se.totalRecords?.toLocaleString()||0," detailed records generated  Stored in ",se.totalChunks||1," chunks ",(me/1e3).toFixed(1),"s"]})]})]}),{duration:6e3}),await D(),u(""),d("all-sales-data")}else be.error(`Calculation failed: ${se.error}`)}catch(se){console.error("Error calculating scheme:",se);let me="Failed to calculate scheme";se instanceof Error?(me=se.message,me.includes("timeout")?me="Calculation timed out. This may be due to a large dataset. Please try with smaller data sets or contact support.":me.includes("statement timeout")&&(me="Database operation timed out. The system may be processing too much data. Please try again or contact support.")):typeof se=="string"&&(me=se),be.error(c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Calculation Error"}),c.jsx("p",{className:"text-sm text-gray-600",children:me})]}),{duration:8e3})}finally{y(!1)}},C=s.filter(P=>S==="all"||P.schemeId===S),T=s.reduce((P,se)=>P+se.totalCommission,0);s.reduce((P,se)=>P+se.calculations.length,0);const U=s.reduce((P,se)=>P+(se.totalDistributorArticleCombinations||0),0),z=new Set(s.flatMap(P=>P.calculations.map(se=>se.distributorId))).size,Z=e.find(P=>P&&P.id===o)||null,re=f&&f!=="all-sales-data"&&r.find(P=>P&&P.id===f)||null;return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(na,{className:"h-5 w-5 text-blue-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Total Calculations"}),c.jsx("p",{className:"text-2xl font-bold",children:s.length})]})]})})}),c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(v_,{className:"h-5 w-5 text-green-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Total Commission"}),c.jsxs("p",{className:"text-2xl font-bold",children:["",T.toLocaleString()]})]})]})})}),c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(pl,{className:"h-5 w-5 text-purple-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Distributor-Article Combinations"}),c.jsx("p",{className:"text-2xl font-bold",children:U})]})]})})}),c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(mi,{className:"h-5 w-5 text-orange-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Unique Distributors"}),c.jsx("p",{className:"text-2xl font-bold",children:z})]})]})})})]}),A&&c.jsxs(sr,{className:"border-orange-200 bg-orange-50",children:[c.jsx(pl,{className:"h-4 w-4 text-orange-600"}),c.jsxs(ar,{className:"text-orange-800",children:[c.jsx("strong",{children:"Calculations Loading Issue:"})," ",A,c.jsx("div",{className:"mt-2",children:c.jsxs($e,{onClick:D,variant:"outline",size:"sm",disabled:g,className:"ml-0",children:[c.jsx(zr,{className:`h-4 w-4 mr-2 ${g?"animate-spin":""}`}),"Try Again"]})})]})]}),r.length===0&&c.jsxs(sr,{className:"border-blue-200 bg-blue-50",children:[c.jsx(oa,{className:"h-4 w-4 text-blue-600"}),c.jsxs(ar,{className:"text-blue-800",children:[c.jsx("strong",{children:"No Sales Data Available:"}),' You need to upload sales data before you can run calculations. Please go to the "Upload Data" tab to upload your sales data first.']})]}),r.length>0&&c.jsxs(sr,{className:"border-green-200 bg-green-50",children:[c.jsx(io,{className:"h-4 w-4 text-green-600"}),c.jsxs(ar,{className:"text-green-800",children:[c.jsx("strong",{children:"Sales Data Available:"})," ",r.length," sales data upload(s) ready for calculation.",c.jsxs("div",{className:"mt-2 text-sm",children:["Available periods: ",r.map(P=>`${P.month} ${P.year}`).join(", ")]})]})]}),c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(na,{className:"h-5 w-5"}),c.jsx("span",{children:"Calculate New Commission"})]})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs(sr,{children:[c.jsx(pl,{className:"h-4 w-4"}),c.jsxs(ar,{children:[c.jsx("strong",{children:"Booster Schemes (per_unit):"})," Use cumulative quantity-based calculation where commission is recalculated as sales accumulate chronologically. Each sale contributes to the cumulative total, and commission = slab_rate  cumulative_total_quantity.",c.jsx("br",{}),c.jsx("strong",{children:"Article Schemes:"})," Use multi-slab logic where sales are grouped by distributor-article combination, and commission = slab_rate  total_quantity.",c.jsx("br",{}),c.jsx("strong",{children:"Negative Quantity Rule:"})," If the total/cumulative quantity is negative, commission is automatically set to zero."]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Scheme"}),c.jsxs(_r,{value:o,onValueChange:u,children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Choose a scheme"})}),c.jsx(br,{children:e.filter(P=>P&&P.id).map(P=>c.jsxs(wt,{value:P.id,children:[P.name," (",P.type==="per_unit"?"Booster":P.type==="article"?"Article Scheme":P.type,")"]},P.id))})]}),Z&&c.jsx("div",{className:"mt-2 p-3 bg-gray-50 rounded-md",children:c.jsxs("div",{className:"text-sm space-y-1",children:[c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:"Type:"})," ",Z.type==="per_unit"?"Booster":Z.type==="article"?"Article Scheme":Z.type]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:"Period:"})," ",Z.startDate," to ",Z.endDate]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:"Slab Type:"})," ",Z.slabType]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:"Commission Type:"})," ",Z.commissionType==="fixed"?"Fixed":Z.commissionType==="absolute_per_unit"?"Absolute(per unit)":Z.commissionType==="percentage"?"Percentage":Z.commissionType]})]})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Sales Data"}),r.length>0?c.jsxs(_r,{value:f||"all-sales-data",onValueChange:d,children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Choose sales data"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"all-sales-data",children:"All Sales Data (Recommended)"}),r.map(P=>c.jsxs(wt,{value:P.id,children:[P.month," ",P.year," (",P.data?.length||0," records)"]},P.id))]})]}):c.jsx("div",{className:"p-3 border border-gray-200 rounded-md bg-gray-50 text-gray-500 text-sm",children:"No sales data available. Please upload sales data first."}),re&&c.jsx("div",{className:"mt-2 p-3 bg-blue-50 rounded-md",children:c.jsxs("div",{className:"text-sm space-y-1 text-blue-700",children:[c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:"File:"})," ",re.fileName]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:"Period:"})," ",re.month," ",re.year]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:"Records:"})," ",re.data?.length||0]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:"Uploaded:"})," ",new Date(re.uploadedAt).toLocaleDateString()]})]})}),(!f||f==="all-sales-data")&&r.length>0&&c.jsx("div",{className:"mt-2 p-3 bg-green-50 rounded-md border border-green-200",children:c.jsxs("div",{className:"text-sm space-y-1 text-green-700",children:[c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:" All Sales Data Selected:"})," The system will use all available sales data"]}),c.jsxs("p",{className:"text-xs",children:["Available periods: ",r.map(P=>`${P.month} ${P.year}`).join(", ")," (",r.reduce((P,se)=>P+(se.data?.length||0),0)," total records)"]})]})}),f&&f!=="all-sales-data"&&re&&c.jsx("div",{className:"mt-2 p-3 bg-blue-50 rounded-md border border-blue-200",children:c.jsxs("div",{className:"text-sm space-y-1 text-blue-700",children:[c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:" Specific Period Selected:"})," ",re.month," ",re.year]}),c.jsxs("p",{className:"text-xs",children:["Records: ",re.data?.length||0,"  Uploaded: ",new Date(re.uploadedAt).toLocaleDateString()]})]})})]})]}),e.length===0&&c.jsxs(sr,{children:[c.jsx(Tl,{className:"h-4 w-4"}),c.jsx(ar,{children:"No schemes found. Please create a scheme first before calculating commissions."})]}),r.length===0&&c.jsxs(sr,{children:[c.jsx(na,{className:"h-4 w-4"}),c.jsx(ar,{children:"No sales data found. Please upload sales data first before calculating commissions."})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs($e,{onClick:D,variant:"outline",size:"sm",disabled:g,children:[c.jsx(zr,{className:`h-4 w-4 mr-2 ${g?"animate-spin":""}`}),"Refresh Data"]}),c.jsx($e,{onClick:async()=>{try{console.log("Testing debug endpoint...");const P=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/debug/route-test`,se=await fetch(P,{headers:{Authorization:`Bearer ${dn}`}});console.log("Debug test result:",{status:se.status,ok:se.ok,result:se.ok?await se.json():await se.text()}),be.success("Debug endpoint test completed - check console")}catch(P){console.error("Debug test failed:",P),be.error("Debug endpoint test failed")}},variant:"outline",size:"sm",children:"Test Debug"})]}),c.jsxs($e,{onClick:O,disabled:!o||r.length===0||g,size:"lg",className:"bg-blue-600 hover:bg-blue-700 text-white",children:[c.jsx(m_,{className:"h-4 w-4 mr-2"}),g?"Calculating...":"Calculate Commission"]})]})]})]}),c.jsxs(go,{defaultValue:"results",className:"w-full",children:[c.jsxs(vo,{className:"grid w-full grid-cols-2",children:[c.jsx(Yt,{value:"results",children:"All Calculation Results"}),c.jsx(Yt,{value:"current",children:"Latest Calculation"})]}),c.jsxs(Jt,{value:"results",className:"space-y-4",children:[c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:c.jsx("div",{className:"w-full md:w-64",children:c.jsxs(_r,{value:S,onValueChange:E,children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Filter by scheme"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"all",children:"All Schemes"}),e.map(P=>c.jsx(wt,{value:P.id,children:P.name},P.id))]})]})})})})}),c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center justify-between",children:[c.jsxs("span",{children:["Calculation History (",C.length,")"]}),c.jsxs($e,{onClick:D,variant:"outline",size:"sm",disabled:g,children:[c.jsx(zr,{className:`h-4 w-4 mr-2 ${g?"animate-spin":""}`}),"Refresh"]})]})}),c.jsx(Qe,{children:C.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(na,{className:"h-16 w-16 mx-auto text-gray-400 mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s.length===0?"No Calculations Yet":"No Results Found"}),c.jsx("p",{className:"text-gray-500 mb-6",children:s.length===0?"Create schemes and upload sales data to start calculating commissions.":"Try adjusting your filter criteria."})]}):c.jsx("div",{className:"space-y-4",children:C.sort((P,se)=>new Date(se.calculatedAt).getTime()-new Date(P.calculatedAt).getTime()).map(P=>{const se=e.find(ce=>ce.id===P.schemeId),me=r.find(ce=>ce.id===P.uploadId);return c.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-lg",children:se?.name||"Unknown Scheme"}),c.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 mt-1",children:[c.jsxs("span",{children:["Calculated: ",new Date(P.calculatedAt).toLocaleDateString()]}),me&&c.jsxs("span",{children:["Sales Period: ",me.month," ",me.year]}),!me&&c.jsx("span",{children:"Used: All Sales Data"}),c.jsxs("span",{children:["Detailed Records: ",P.calculations.length]}),P.totalDistributorArticleCombinations&&c.jsxs("span",{children:["Distributor-Article Combinations: ",P.totalDistributorArticleCombinations]}),P.calculationType&&c.jsx(Mt,{variant:"outline",children:P.calculationType})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["",P.totalCommission.toLocaleString()]}),c.jsx("div",{className:"text-sm text-gray-500",children:"Total Commission"})]}),c.jsxs("div",{className:"flex flex-col space-y-2",children:[c.jsx($e,{onClick:()=>m(P),variant:"outline",size:"sm",children:"View Detail"}),c.jsxs("div",{className:"flex flex-wrap gap-1",children:[c.jsx($e,{onClick:()=>M_(P,e,r),variant:"outline",size:"sm",title:"Export Detailed Records",children:c.jsx(pi,{className:"h-4 w-4"})}),P.distributorArticleSummary&&P.distributorArticleSummary.length>0&&c.jsx($e,{onClick:()=>B_(P,e,r),variant:"outline",size:"sm",title:"Export Distributor-Article Summary",children:c.jsx(pl,{className:"h-4 w-4"})}),c.jsx($e,{onClick:()=>U_([P],e,r),variant:"outline",size:"sm",title:"Export Distributor+Article Level",children:c.jsx(mi,{className:"h-4 w-4"})}),c.jsx($e,{onClick:()=>$_([P],e,r),variant:"outline",size:"sm",title:"Export Scheme+Distributor Level",children:c.jsx(Tl,{className:"h-4 w-4"})})]})]})]})]})},P.id)})})})]})]}),c.jsx(Jt,{value:"current",className:"space-y-4",children:c.jsx(uR,{currentCalculation:p,schemes:e,uploads:r})})]})]})}var Bd="Dialog",[z_,W_]=Da(Bd),[dR,Ms]=z_(Bd),V_=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:a,modal:o=!0}=e,u=j.useRef(null),f=j.useRef(null),[d,p]=ro({prop:n,defaultProp:s??!1,onChange:a,caller:Bd});return c.jsx(dR,{scope:t,triggerRef:u,contentRef:f,contentId:Ea(),titleId:Ea(),descriptionId:Ea(),open:d,onOpenChange:p,onOpenToggle:j.useCallback(()=>p(m=>!m),[p]),modal:o,children:r})};V_.displayName=Bd;var H_="DialogTrigger",G_=j.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Ms(H_,r),a=er(t,s.triggerRef);return c.jsx(St.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Pm(s.open),...n,ref:a,onClick:Nt(e.onClick,s.onOpenToggle)})});G_.displayName=H_;var Fm="DialogPortal",[hR,X_]=z_(Fm,{forceMount:void 0}),K_=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,a=Ms(Fm,t);return c.jsx(hR,{scope:t,forceMount:r,children:j.Children.map(n,o=>c.jsx(Fl,{present:r||a.open,children:c.jsx(wm,{asChild:!0,container:s,children:o})}))})};K_.displayName=Fm;var pd="DialogOverlay",q_=j.forwardRef((e,t)=>{const r=X_(pd,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=Ms(pd,e.__scopeDialog);return a.modal?c.jsx(Fl,{present:n||a.open,children:c.jsx(mR,{...s,ref:t})}):null});q_.displayName=pd;var pR=bl("DialogOverlay.RemoveScroll"),mR=j.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Ms(pd,r);return c.jsx(_m,{as:pR,allowPinchZoom:!0,shards:[s.contentRef],children:c.jsx(St.div,{"data-state":Pm(s.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),oo="DialogContent",Y_=j.forwardRef((e,t)=>{const r=X_(oo,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=Ms(oo,e.__scopeDialog);return c.jsx(Fl,{present:n||a.open,children:a.modal?c.jsx(xR,{...s,ref:t}):c.jsx(gR,{...s,ref:t})})});Y_.displayName=oo;var xR=j.forwardRef((e,t)=>{const r=Ms(oo,e.__scopeDialog),n=j.useRef(null),s=er(t,r.contentRef,n);return j.useEffect(()=>{const a=n.current;if(a)return F2(a)},[]),c.jsx(J_,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Nt(e.onCloseAutoFocus,a=>{a.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Nt(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,u=o.button===0&&o.ctrlKey===!0;(o.button===2||u)&&a.preventDefault()}),onFocusOutside:Nt(e.onFocusOutside,a=>a.preventDefault())})}),gR=j.forwardRef((e,t)=>{const r=Ms(oo,e.__scopeDialog),n=j.useRef(!1),s=j.useRef(!1);return c.jsx(J_,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{e.onCloseAutoFocus?.(a),a.defaultPrevented||(n.current||r.triggerRef.current?.focus(),a.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:a=>{e.onInteractOutside?.(a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=a.target;r.triggerRef.current?.contains(o)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}})}),J_=j.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:a,...o}=e,u=Ms(oo,r),f=j.useRef(null),d=er(t,f);return s2(),c.jsxs(c.Fragment,{children:[c.jsx(fm,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:a,children:c.jsx(um,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":Pm(u.open),...o,ref:d,onDismiss:()=>u.onOpenChange(!1)})}),c.jsxs(c.Fragment,{children:[c.jsx(yR,{titleId:u.titleId}),c.jsx(_R,{contentRef:f,descriptionId:u.descriptionId})]})]})}),Rm="DialogTitle",Q_=j.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Ms(Rm,r);return c.jsx(St.h2,{id:s.titleId,...n,ref:t})});Q_.displayName=Rm;var Z_="DialogDescription",eS=j.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Ms(Z_,r);return c.jsx(St.p,{id:s.descriptionId,...n,ref:t})});eS.displayName=Z_;var tS="DialogClose",rS=j.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Ms(tS,r);return c.jsx(St.button,{type:"button",...n,ref:t,onClick:Nt(e.onClick,()=>s.onOpenChange(!1))})});rS.displayName=tS;function Pm(e){return e?"open":"closed"}var nS="DialogTitleWarning",[vR,sS]=g4(nS,{contentName:oo,titleName:Rm,docsSlug:"dialog"}),yR=({titleId:e})=>{const t=sS(nS),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return j.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},wR="DialogDescriptionWarning",_R=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${sS(wR).contentName}}.`;return j.useEffect(()=>{const s=e.current?.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},SR=V_,kR=G_,bR=K_,ER=q_,TR=Y_,CR=Q_,NR=eS,aS=rS,iS="AlertDialog",[AR,uz]=Da(iS,[W_]),Fa=W_(),oS=e=>{const{__scopeAlertDialog:t,...r}=e,n=Fa(t);return c.jsx(SR,{...n,...r,modal:!0})};oS.displayName=iS;var jR="AlertDialogTrigger",lS=j.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=Fa(r);return c.jsx(kR,{...s,...n,ref:t})});lS.displayName=jR;var DR="AlertDialogPortal",cS=e=>{const{__scopeAlertDialog:t,...r}=e,n=Fa(t);return c.jsx(bR,{...n,...r})};cS.displayName=DR;var FR="AlertDialogOverlay",uS=j.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=Fa(r);return c.jsx(ER,{...s,...n,ref:t})});uS.displayName=FR;var yl="AlertDialogContent",[RR,PR]=AR(yl),IR=h4("AlertDialogContent"),fS=j.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...s}=e,a=Fa(r),o=j.useRef(null),u=er(t,o),f=j.useRef(null);return c.jsx(vR,{contentName:yl,titleName:dS,docsSlug:"alert-dialog",children:c.jsx(RR,{scope:r,cancelRef:f,children:c.jsxs(TR,{role:"alertdialog",...a,...s,ref:u,onOpenAutoFocus:Nt(s.onOpenAutoFocus,d=>{d.preventDefault(),f.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[c.jsx(IR,{children:n}),c.jsx(LR,{contentRef:o})]})})})});fS.displayName=yl;var dS="AlertDialogTitle",hS=j.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=Fa(r);return c.jsx(CR,{...s,...n,ref:t})});hS.displayName=dS;var pS="AlertDialogDescription",mS=j.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=Fa(r);return c.jsx(NR,{...s,...n,ref:t})});mS.displayName=pS;var OR="AlertDialogAction",xS=j.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=Fa(r);return c.jsx(aS,{...s,...n,ref:t})});xS.displayName=OR;var gS="AlertDialogCancel",vS=j.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:s}=PR(gS,r),a=Fa(r),o=er(t,s);return c.jsx(aS,{...a,...n,ref:o})});vS.displayName=gS;var LR=({contentRef:e})=>{const t=`\`${yl}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${yl}\` by passing a \`${pS}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${yl}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return j.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},MR=oS,BR=lS,UR=cS,$R=uS,zR=fS,WR=xS,VR=vS,HR=hS,GR=mS;function XR({...e}){return c.jsx(MR,{"data-slot":"alert-dialog",...e})}function KR({...e}){return c.jsx(BR,{"data-slot":"alert-dialog-trigger",...e})}function qR({...e}){return c.jsx(UR,{"data-slot":"alert-dialog-portal",...e})}function YR({className:e,...t}){return c.jsx($R,{"data-slot":"alert-dialog-overlay",className:Et("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function JR({className:e,...t}){return c.jsxs(qR,{children:[c.jsx(YR,{}),c.jsx(zR,{"data-slot":"alert-dialog-content",className:Et("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...t})]})}function QR({className:e,...t}){return c.jsx("div",{"data-slot":"alert-dialog-header",className:Et("flex flex-col gap-2 text-center sm:text-left",e),...t})}function ZR({className:e,...t}){return c.jsx("div",{"data-slot":"alert-dialog-footer",className:Et("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function eP({className:e,...t}){return c.jsx(HR,{"data-slot":"alert-dialog-title",className:Et("text-lg font-semibold",e),...t})}function tP({className:e,...t}){return c.jsx(GR,{"data-slot":"alert-dialog-description",className:Et("text-muted-foreground text-sm",e),...t})}function rP({className:e,...t}){return c.jsx(WR,{className:Et(om(),e),...t})}function nP({className:e,...t}){return c.jsx(VR,{className:Et(om({variant:"outline"}),e),...t})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Qc={};Qc.version="0.18.5";var es=1200,lo=1252,sP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Im={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ud=function(e){sP.indexOf(e)!=-1&&(lo=Im[0]=e)};function aP(){Ud(1252)}var xs=function(e){es=e,Ud(e)};function $d(){xs(1200),aP()}function md(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function iP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function yS(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ml=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?iP(e.slice(2)):t==254&&r==255?yS(e.slice(2)):t==65279?e.slice(1):e},Nc=function(t){return String.fromCharCode(t)},Gp=function(t){return String.fromCharCode(t)},Ot;function oP(e){Ot=e,xs=function(t){es=t,Ud(t)},ml=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?Ot.utils.decode(1200,md(t.slice(2))):t},Nc=function(r){return es===1200?String.fromCharCode(r):Ot.utils.decode(es,[r&255,r>>8])[0]},Gp=function(r){return Ot.utils.decode(lo,[r])[0]},KS()}var ui="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Zc(e){for(var t="",r=0,n=0,s=0,a=0,o=0,u=0,f=0,d=0;d<e.length;)r=e.charCodeAt(d++),a=r>>2,n=e.charCodeAt(d++),o=(r&3)<<4|n>>4,s=e.charCodeAt(d++),u=(n&15)<<2|s>>6,f=s&63,isNaN(n)?u=f=64:isNaN(s)&&(f=64),t+=ui.charAt(a)+ui.charAt(o)+ui.charAt(u)+ui.charAt(f);return t}function ts(e){var t="",r=0,n=0,s=0,a=0,o=0,u=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)a=ui.indexOf(e.charAt(d++)),o=ui.indexOf(e.charAt(d++)),r=a<<2|o>>4,t+=String.fromCharCode(r),u=ui.indexOf(e.charAt(d++)),n=(o&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(n)),f=ui.indexOf(e.charAt(d++)),s=(u&3)<<6|f,f!==64&&(t+=String.fromCharCode(s));return t}var _t=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ra=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function yi(e){return _t?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function py(e){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Jn=function(t){return _t?Ra(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function vu(e){if(typeof ArrayBuffer>"u")return Jn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ti(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function lP(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Om(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Om(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var nn=_t?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ra(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function cP(e){for(var t=[],r=0,n=e.length+250,s=yi(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=e.charCodeAt(++a)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|u>>6&15|(o&3)<<4,s[r++]=128|u&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=yi(65535),n=65530)}return t.push(s.slice(0,r)),nn(t)}var kn=/\u0000/g,Ac=/[\u0001-\u0006]/g;function wl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Rs(e,t){var r=""+e;return r.length>=t?r:Er("0",t-r.length)+r}function Lm(e,t){var r=""+e;return r.length>=t?r:Er(" ",t-r.length)+r}function xd(e,t){var r=""+e;return r.length>=t?r:r+Er(" ",t-r.length)}function uP(e,t){var r=""+Math.round(e);return r.length>=t?r:Er("0",t-r.length)+r}function fP(e,t){var r=""+e;return r.length>=t?r:Er("0",t-r.length)+r}var my=Math.pow(2,32);function ll(e,t){if(e>my||e<-my)return uP(e,t);var r=Math.round(e);return fP(r,t)}function gd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var xy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ap=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dP(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},gy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vd(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,o=1,u=0,f=1,d=0,p=0,m=Math.floor(s);d<t&&(m=Math.floor(s),u=m*o+a,p=m*d+f,!(s-m<5e-8));)s=1/(s-m),a=o,o=u,f=d,d=p;if(p>t&&(d>t?(p=f,u=a):(p=d,u=o)),!r)return[0,n*u,p];var g=Math.floor(n*u/p);return[g,n*u-g*p,p]}function fi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,o=[],u={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],a=f.getDay(),n<60&&(a=(a+6)%7),r&&(a=yP(f,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=a,u}var wS=new Date(1899,11,31,0,0,0),pP=wS.getTime(),mP=new Date(1900,2,1,0,0,0);function _S(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=mP&&(r+=1440*60*1e3),(r-(pP+(e.getTimezoneOffset()-wS.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Mm(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function xP(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function gP(e){var t=e<0?12:11,r=Mm(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function vP(e){var t=Mm(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function eu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=gP(e):t===10?r=e.toFixed(10).substr(0,12):r=vP(e),Mm(xP(r.toUpperCase()))}function co(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):eu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return rs(14,_S(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function yP(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function wP(e,t,r,n){var s="",a=0,o=0,u=r.y,f,d=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:f=u%100,d=2;break;default:f=u%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:f=r.m,d=t.length;break;case 3:return ap[r.m-1][1];case 5:return ap[r.m-1][0];default:return ap[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,d=t.length;break;case 3:return xy[r.q][0];default:return xy[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Rs(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(s=Rs(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:f=u,d=1;break}var p=d>0?Rs(f,d):"";return p}function di(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var SS=/%/g;function _P(e,t,r){var n=t.replace(SS,""),s=t.length-n.length;return Ta(e,n,r*Math.pow(10,2*s))+Er("%",s)}function SP(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ta(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function kS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+kS(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,p){return f+d+p.substr(0,(s+a)%s)+"."+p.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var bS=/# (\?+)( ?)\/( ?)(\d+)/;function kP(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),o=s-a*n,u=n;return r+(a===0?"":""+a)+" "+(o===0?Er(" ",e[1].length+1+e[4].length):Lm(o,e[1].length)+e[2]+"/"+e[3]+Rs(u,e[4].length))}function bP(e,t,r){return r+(t===0?"":""+t)+Er(" ",e[1].length+2+e[4].length)}var ES=/^#*0*\.([0#]+)/,TS=/\).*[0#]/,CS=/\(###\) ###\\?-####/;function Fn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function vy(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function yy(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function EP(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function TP(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function fs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(TS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fs("n",n,r):"("+fs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return SP(e,t,r);if(t.indexOf("%")!==-1)return _P(e,t,r);if(t.indexOf("E")!==-1)return kS(t,r);if(t.charCodeAt(0)===36)return"$"+fs(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,u,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ll(f,t.length);if(t.match(/^[#?]+$/))return s=ll(r,0),s==="0"&&(s=""),s.length>t.length?s:Fn(t.substr(0,t.length-s.length))+s;if(a=t.match(bS))return kP(a,f,d);if(t.match(/^#+0+$/))return d+ll(f,t.length-t.indexOf("0"));if(a=t.match(ES))return s=vy(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Fn(a[1])).replace(/\.$/,"."+Fn(a[1])).replace(/\.(\d*)$/,function(w,v){return"."+v+Er("0",Fn(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+vy(f,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+di(ll(f,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fs(e,t,-r):di(""+(Math.floor(r)+EP(r,a[1].length)))+"."+Rs(yy(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return fs(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=wl(fs(e,t.replace(/[\\-]/g,""),r)),o=0,wl(wl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<s.length?s.charAt(o++):w==="0"?"0":""}));if(t.match(CS))return s=fs(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),u=vd(f,Math.pow(10,o)-1,!1),s=""+d,p=Ta("n",a[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+a[2]+"/"+a[3],p=xd(u[2],o),p.length<a[4].length&&(p=Fn(a[4].substr(a[4].length-p.length))+p),s+=p,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),u=vd(f,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Lm(u[1],o)+a[2]+"/"+a[3]+xd(u[2],o):Er(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=ll(r,0),t.length<=s.length?s:Fn(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var m=t.indexOf(".")-o,g=t.length-s.length-m;return Fn(t.substr(0,m)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=yy(r,a[1].length),r<0?"-"+fs(e,t,-r):di(TP(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Rs(0,3-w.length):"")+w})+"."+Rs(o,a[1].length);switch(t){case"###,##0.00":return fs(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=di(ll(f,0));return y!=="0"?d+y:"";case"###,###.00":return fs(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return fs(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function CP(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ta(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function NP(e,t,r){var n=t.replace(SS,""),s=t.length-n.length;return Ta(e,n,r*Math.pow(10,2*s))+Er("%",s)}function NS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+NS(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,p){return f+d+p.substr(0,(s+a)%s)+"."+p.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Qs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(TS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Qs("n",n,r):"("+Qs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return CP(e,t,r);if(t.indexOf("%")!==-1)return NP(e,t,r);if(t.indexOf("E")!==-1)return NS(t,r);if(t.charCodeAt(0)===36)return"$"+Qs(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,o,u,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Rs(f,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Fn(t.substr(0,t.length-s.length))+s;if(a=t.match(bS))return bP(a,f,d);if(t.match(/^#+0+$/))return d+Rs(f,t.length-t.indexOf("0"));if(a=t.match(ES))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Fn(a[1])).replace(/\.$/,"."+Fn(a[1])),s=s.replace(/\.(\d*)$/,function(w,v){return"."+v+Er("0",Fn(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+di(""+f);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Qs(e,t,-r):di(""+r)+"."+Er("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Qs(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=wl(Qs(e,t.replace(/[\\-]/g,""),r)),o=0,wl(wl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<s.length?s.charAt(o++):w==="0"?"0":""}));if(t.match(CS))return s=Qs(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),u=vd(f,Math.pow(10,o)-1,!1),s=""+d,p=Ta("n",a[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+a[2]+"/"+a[3],p=xd(u[2],o),p.length<a[4].length&&(p=Fn(a[4].substr(a[4].length-p.length))+p),s+=p,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),u=vd(f,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Lm(u[1],o)+a[2]+"/"+a[3]+xd(u[2],o):Er(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Fn(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var m=t.indexOf(".")-o,g=t.length-s.length-m;return Fn(t.substr(0,m)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Qs(e,t,-r):di(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Rs(0,3-w.length):"")+w})+"."+Rs(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=di(""+f);return y!=="0"?d+y:"";default:if(t.match(/\.[0#?]*$/))return Qs(e,t.slice(0,t.lastIndexOf(".")),r)+Fn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ta(e,t,r){return(r|0)===r?Qs(e,t,r):fs(e,t,r)}function AP(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var AS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function wo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":gd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(AS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function jP(e,t,r,n){for(var s=[],a="",o=0,u="",f="t",d,p,m,g="H";o<e.length;)switch(u=e.charAt(o)){case"G":if(!gd(e,o))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(m=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(m);s[s.length]={t:"t",v:a},++o;break;case"\\":var y=e.charAt(++o),w=y==="("||y===")"?y:"t";s[s.length]={t:w,v:y},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=fi(t,r,e.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},f=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=fi(t,r),d==null))return"";for(a=u;++o<e.length&&e.charAt(o).toLowerCase()===u;)a+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=g),s[s.length]={t:u,v:a},f=u;break;case"A":case"a":case"":var v={t:u,v:u};if(d==null&&(d=fi(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(v.v=d.H>=12?"P":"A"),v.t="T",g="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(v.v=d.H>=12?"PM":"AM"),v.t="T",o+=5,g="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(v.v=d.H>=12?"":""),v.t="T",o+=5,g="h"):(v.t="t",++o),d==null&&v.t==="T")return"";s[s.length]=v,f=u;break;case"[":for(a=u;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(AS)){if(d==null&&(d=fi(t,r),d==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},f=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",wo(e)||(s[s.length]={t:"t",v:a}));break;case".":if(d!=null){for(a=u;++o<e.length&&(u=e.charAt(o))==="0";)a+=u;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=u;++o<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(o))>-1;)a+=u;s[s.length]={t:"n",v:a};break;case"?":for(a=u;e.charAt(++o)===u;)a+=u;s[s.length]={t:u,v:a},f=u;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=u;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:u,v:u},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++o;break}var S=0,E=0,A;for(o=s.length-1,f="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=g,f="h",S<1&&(S=1);break;case"s":(A=s[o].v.match(/\.0+$/))&&(E=Math.max(E,A[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":f=s[o].t;break;case"m":f==="s"&&(s[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&s[o].v.match(/[Hh]/)&&(S=1),S<2&&s[o].v.match(/[Mm]/)&&(S=2),S<3&&s[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var b="",D;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=wP(s[o].t.charCodeAt(0),s[o].v,d,E),s[o].t="t";break;case"n":case"?":for(D=o+1;s[D]!=null&&((u=s[D].t)==="?"||u==="D"||(u===" "||u==="t")&&s[D+1]!=null&&(s[D+1].t==="?"||s[D+1].t==="t"&&s[D+1].v==="/")||s[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[D].v==="/"||s[D].v===" "&&s[D+1]!=null&&s[D+1].t=="?"));)s[o].v+=s[D].v,s[D]={v:"",t:";"},++D;b+=s[o].v,o=D-1;break;case"G":s[o].t="t",s[o].v=co(t,r);break}var O="",C,T;if(b.length>0){b.charCodeAt(0)==40?(C=t<0&&b.charCodeAt(0)===45?-t:t,T=Ta("n",b,C)):(C=t<0&&n>1?-t:t,T=Ta("n",b,C),C<0&&s[0]&&s[0].t=="t"&&(T=T.substr(1),s[0].v="-"+s[0].v)),D=T.length-1;var U=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){U=o;break}var z=s.length;if(U===s.length&&T.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(D>=s[o].v.length-1?(D-=s[o].v.length,s[o].v=T.substr(D+1,s[o].v.length)):D<0?s[o].v="":(s[o].v=T.substr(0,D+1),D=-1),s[o].t="t",z=o);D>=0&&z<s.length&&(s[z].v=T.substr(0,D+1)+s[z].v)}else if(U!==s.length&&T.indexOf("E")===-1){for(D=T.indexOf(".")-1,o=U;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(p=s[o].v.indexOf(".")>-1&&o===U?s[o].v.indexOf(".")-1:s[o].v.length-1,O=s[o].v.substr(p+1);p>=0;--p)D>=0&&(s[o].v.charAt(p)==="0"||s[o].v.charAt(p)==="#")&&(O=T.charAt(D--)+O);s[o].v=O,s[o].t="t",z=o}for(D>=0&&z<s.length&&(s[z].v=T.substr(0,D+1)+s[z].v),D=T.indexOf(".")+1,o=U;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==U)){for(p=s[o].v.indexOf(".")>-1&&o===U?s[o].v.indexOf(".")+1:0,O=s[o].v.substr(0,p);p<s[o].v.length;++p)D<T.length&&(O+=T.charAt(D++));s[o].v=O,s[o].t="t",z=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(C=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=Ta(s[o].t,s[o].v,C),s[o].t="t");var Z="";for(o=0;o!==s.length;++o)s[o]!=null&&(Z+=s[o].v);return Z}var wy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function _y(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function DP(e,t){var r=AP(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(wy),u=r[1].match(wy);return _y(t,o)?[n,r[0]]:_y(t,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,a]}function rs(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:st)[e],n==null&&(n=r.table&&r.table[gy[e]]||st[gy[e]]),n==null&&(n=hP[e]||"General");break}if(gd(n,0))return co(t,r);t instanceof Date&&(t=_S(t,r.date1904));var s=DP(n,t);if(gd(s[1]))return co(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return jP(s[1],t,r,s[0])}function la(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(st[r]==null){t<0&&(t=r);continue}if(st[r]==e){t=r;break}}t<0&&(t=391)}return st[t]=e,t}function yu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&la(e[t],t)}function Ml(){st=dP()}var jS={format:rs,load:la,_table:st,load_table:yu,parse_date_code:fi,is_date:wo,get_table:function(){return jS._table=st}},FP={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},DS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function RP(e){var t=typeof e=="number"?st[e]:e;return t=t.replace(DS,"(\\d+)"),new RegExp("^"+t+"$")}function PP(e,t,r){var n=-1,s=-1,a=-1,o=-1,u=-1,f=-1;(t.match(DS)||[]).forEach(function(m,g){var y=parseInt(r[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=y;break;case"d":a=y;break;case"h":o=y;break;case"s":f=y;break;case"m":o>=0?u=y:s=y;break}}),f>=0&&u==-1&&s>=0&&(u=s,s=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&u==-1&&f==-1?d:n==-1&&s==-1&&a==-1?p:d+"T"+p}var IP=(function(){var e={};e.version="1.2.0";function t(){for(var T=0,U=new Array(256),z=0;z!=256;++z)T=z,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,U[z]=T;return typeof Int32Array<"u"?new Int32Array(U):U}var r=t();function n(T){var U=0,z=0,Z=0,re=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Z=0;Z!=256;++Z)re[Z]=T[Z];for(Z=0;Z!=256;++Z)for(z=T[Z],U=256+Z;U<4096;U+=256)z=re[U]=z>>>8^T[z&255];var P=[];for(Z=1;Z!=16;++Z)P[Z-1]=typeof Int32Array<"u"?re.subarray(Z*256,Z*256+256):re.slice(Z*256,Z*256+256);return P}var s=n(r),a=s[0],o=s[1],u=s[2],f=s[3],d=s[4],p=s[5],m=s[6],g=s[7],y=s[8],w=s[9],v=s[10],S=s[11],E=s[12],A=s[13],b=s[14];function D(T,U){for(var z=U^-1,Z=0,re=T.length;Z<re;)z=z>>>8^r[(z^T.charCodeAt(Z++))&255];return~z}function O(T,U){for(var z=U^-1,Z=T.length-15,re=0;re<Z;)z=b[T[re++]^z&255]^A[T[re++]^z>>8&255]^E[T[re++]^z>>16&255]^S[T[re++]^z>>>24]^v[T[re++]]^w[T[re++]]^y[T[re++]]^g[T[re++]]^m[T[re++]]^p[T[re++]]^d[T[re++]]^f[T[re++]]^u[T[re++]]^o[T[re++]]^a[T[re++]]^r[T[re++]];for(Z+=15;re<Z;)z=z>>>8^r[(z^T[re++])&255];return~z}function C(T,U){for(var z=U^-1,Z=0,re=T.length,P=0,se=0;Z<re;)P=T.charCodeAt(Z++),P<128?z=z>>>8^r[(z^P)&255]:P<2048?(z=z>>>8^r[(z^(192|P>>6&31))&255],z=z>>>8^r[(z^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,se=T.charCodeAt(Z++)&1023,z=z>>>8^r[(z^(240|P>>8&7))&255],z=z>>>8^r[(z^(128|P>>2&63))&255],z=z>>>8^r[(z^(128|se>>6&15|(P&3)<<4))&255],z=z>>>8^r[(z^(128|se&63))&255]):(z=z>>>8^r[(z^(224|P>>12&15))&255],z=z>>>8^r[(z^(128|P>>6&63))&255],z=z>>>8^r[(z^(128|P&63))&255]);return~z}return e.table=r,e.bstr=D,e.buf=O,e.str=C,e})(),Ze=(function(){var t={};t.version="1.2.1";function r(M,G){for(var W=M.split("/"),H=G.split("/"),X=0,K=0,ye=Math.min(W.length,H.length);X<ye;++X){if(K=W[X].length-H[X].length)return K;if(W[X]!=H[X])return W[X]<H[X]?-1:1}return W.length-H.length}function n(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:n(M.slice(0,-1));var G=M.lastIndexOf("/");return G===-1?M:M.slice(0,G+1)}function s(M){if(M.charAt(M.length-1)=="/")return s(M.slice(0,-1));var G=M.lastIndexOf("/");return G===-1?M:M.slice(G+1)}function a(M,G){typeof G=="string"&&(G=new Date(G));var W=G.getHours();W=W<<6|G.getMinutes(),W=W<<5|G.getSeconds()>>>1,M.write_shift(2,W);var H=G.getFullYear()-1980;H=H<<4|G.getMonth()+1,H=H<<5|G.getDate(),M.write_shift(2,H)}function o(M){var G=M.read_shift(2)&65535,W=M.read_shift(2)&65535,H=new Date,X=W&31;W>>>=5;var K=W&15;W>>>=4,H.setMilliseconds(0),H.setFullYear(W+1980),H.setMonth(K-1),H.setDate(X);var ye=G&31;G>>>=5;var Te=G&63;return G>>>=6,H.setHours(G),H.setMinutes(Te),H.setSeconds(ye<<1),H}function u(M){un(M,0);for(var G={},W=0;M.l<=M.length-4;){var H=M.read_shift(2),X=M.read_shift(2),K=M.l+X,ye={};switch(H){case 21589:W=M.read_shift(1),W&1&&(ye.mtime=M.read_shift(4)),X>5&&(W&2&&(ye.atime=M.read_shift(4)),W&4&&(ye.ctime=M.read_shift(4))),ye.mtime&&(ye.mt=new Date(ye.mtime*1e3));break}M.l=K,G[H]=ye}return G}var f;function d(){return f||(f={})}function p(M,G){if(M[0]==80&&M[1]==75)return La(M,G);if((M[0]|32)==109&&(M[1]|32)==105)return yr(M,G);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var W=3,H=512,X=0,K=0,ye=0,Te=0,ve=0,we=[],Se=M.slice(0,512);un(Se,0);var Fe=m(Se);switch(W=Fe[0],W){case 3:H=512;break;case 4:H=4096;break;case 0:if(Fe[1]==0)return La(M,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+W)}H!==512&&(Se=M.slice(0,H),un(Se,28));var ze=M.slice(0,H);g(Se,W);var Ve=Se.read_shift(4,"i");if(W===3&&Ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ve);Se.l+=4,ye=Se.read_shift(4,"i"),Se.l+=4,Se.chk("00100000","Mini Stream Cutoff Size: "),Te=Se.read_shift(4,"i"),X=Se.read_shift(4,"i"),ve=Se.read_shift(4,"i"),K=Se.read_shift(4,"i");for(var Le=-1,Pe=0;Pe<109&&(Le=Se.read_shift(4,"i"),!(Le<0));++Pe)we[Pe]=Le;var xt=y(M,H);S(ve,K,xt,H,we);var qt=A(xt,ye,we,H);qt[ye].name="!Directory",X>0&&Te!==se&&(qt[Te].name="!MiniFAT"),qt[we[0]].name="!FAT",qt.fat_addrs=we,qt.ssz=H;var tr={},Fr=[],Di=[],Ma=[];b(ye,qt,xt,Fr,X,tr,Di,Te),w(Di,Ma,Fr),Fr.shift();var Hs={FileIndex:Di,FullPaths:Ma};return G&&G.raw&&(Hs.raw={header:ze,sectors:xt}),Hs}function m(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(me,"Header Signature: "),M.l+=16;var G=M.read_shift(2,"u");return[M.read_shift(2,"u"),G]}function g(M,G){var W=9;switch(M.l+=2,W=M.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+W);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+W);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+W)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function y(M,G){for(var W=Math.ceil(M.length/G)-1,H=[],X=1;X<W;++X)H[X-1]=M.slice(X*G,(X+1)*G);return H[W-1]=M.slice(W*G),H}function w(M,G,W){for(var H=0,X=0,K=0,ye=0,Te=0,ve=W.length,we=[],Se=[];H<ve;++H)we[H]=Se[H]=H,G[H]=W[H];for(;Te<Se.length;++Te)H=Se[Te],X=M[H].L,K=M[H].R,ye=M[H].C,we[H]===H&&(X!==-1&&we[X]!==X&&(we[H]=we[X]),K!==-1&&we[K]!==K&&(we[H]=we[K])),ye!==-1&&(we[ye]=H),X!==-1&&H!=we[H]&&(we[X]=we[H],Se.lastIndexOf(X)<Te&&Se.push(X)),K!==-1&&H!=we[H]&&(we[K]=we[H],Se.lastIndexOf(K)<Te&&Se.push(K));for(H=1;H<ve;++H)we[H]===H&&(K!==-1&&we[K]!==K?we[H]=we[K]:X!==-1&&we[X]!==X&&(we[H]=we[X]));for(H=1;H<ve;++H)if(M[H].type!==0){if(Te=H,Te!=we[Te])do Te=we[Te],G[H]=G[Te]+"/"+G[H];while(Te!==0&&we[Te]!==-1&&Te!=we[Te]);we[H]=-1}for(G[0]+="/",H=1;H<ve;++H)M[H].type!==2&&(G[H]+="/")}function v(M,G,W){for(var H=M.start,X=M.size,K=[],ye=H;W&&X>0&&ye>=0;)K.push(G.slice(ye*P,ye*P+P)),X-=P,ye=Ki(W,ye*4);return K.length===0?Ee(0):nn(K).slice(0,M.size)}function S(M,G,W,H,X){var K=se;if(M===se){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var ye=W[M],Te=(H>>>2)-1;if(!ye)return;for(var ve=0;ve<Te&&(K=Ki(ye,ve*4))!==se;++ve)X.push(K);S(Ki(ye,H-4),G-1,W,H,X)}}function E(M,G,W,H,X){var K=[],ye=[];X||(X=[]);var Te=H-1,ve=0,we=0;for(ve=G;ve>=0;){X[ve]=!0,K[K.length]=ve,ye.push(M[ve]);var Se=W[Math.floor(ve*4/H)];if(we=ve*4&Te,H<4+we)throw new Error("FAT boundary crossed: "+ve+" 4 "+H);if(!M[Se])break;ve=Ki(M[Se],we)}return{nodes:K,data:Ry([ye])}}function A(M,G,W,H){var X=M.length,K=[],ye=[],Te=[],ve=[],we=H-1,Se=0,Fe=0,ze=0,Ve=0;for(Se=0;Se<X;++Se)if(Te=[],ze=Se+G,ze>=X&&(ze-=X),!ye[ze]){ve=[];var Le=[];for(Fe=ze;Fe>=0;){Le[Fe]=!0,ye[Fe]=!0,Te[Te.length]=Fe,ve.push(M[Fe]);var Pe=W[Math.floor(Fe*4/H)];if(Ve=Fe*4&we,H<4+Ve)throw new Error("FAT boundary crossed: "+Fe+" 4 "+H);if(!M[Pe]||(Fe=Ki(M[Pe],Ve),Le[Fe]))break}K[ze]={nodes:Te,data:Ry([ve])}}return K}function b(M,G,W,H,X,K,ye,Te){for(var ve=0,we=H.length?2:0,Se=G[M].data,Fe=0,ze=0,Ve;Fe<Se.length;Fe+=128){var Le=Se.slice(Fe,Fe+128);un(Le,64),ze=Le.read_shift(2),Ve=Hd(Le,0,ze-we),H.push(Ve);var Pe={name:Ve,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},xt=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);xt!==0&&(Pe.ct=D(Le,Le.l-8));var qt=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);qt!==0&&(Pe.mt=D(Le,Le.l-8)),Pe.start=Le.read_shift(4,"i"),Pe.size=Le.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=se,Pe.name=""),Pe.type===5?(ve=Pe.start,X>0&&ve!==se&&(G[ve].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",G[Pe.start]===void 0&&(G[Pe.start]=E(W,Pe.start,G.fat_addrs,G.ssz)),G[Pe.start].name=Pe.name,Pe.content=G[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:ve!==se&&Pe.start!==se&&G[ve]&&(Pe.content=v(Pe,G[ve].data,(G[Te]||{}).data))),Pe.content&&un(Pe.content,0),K[Ve]=Pe,ye.push(Pe)}}function D(M,G){return new Date((rn(M,G+4)/1e7*Math.pow(2,32)+rn(M,G)/1e7-11644473600)*1e3)}function O(M,G){return d(),p(f.readFileSync(M),G)}function C(M,G){var W=G&&G.type;switch(W||_t&&Buffer.isBuffer(M)&&(W="buffer"),W||"base64"){case"file":return O(M,G);case"base64":return p(Jn(ts(M)),G);case"binary":return p(Jn(M),G)}return p(M,G)}function T(M,G){var W=G||{},H=W.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=H+"/",M.FileIndex[0]={name:H,type:5}),W.CLSID&&(M.FileIndex[0].clsid=W.CLSID),U(M)}function U(M){var G="Sh33tJ5";if(!Ze.find(M,"/"+G)){var W=Ee(4);W[0]=55,W[1]=W[3]=50,W[2]=54,M.FileIndex.push({name:G,type:2,content:W,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+G),z(M)}}function z(M,G){T(M);for(var W=!1,H=!1,X=M.FullPaths.length-1;X>=0;--X){var K=M.FileIndex[X];switch(K.type){case 0:H?W=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(K.R*K.L*K.C)&&(W=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(W=!0);break;default:W=!0;break}}if(!(!W&&!G)){var ye=new Date(1987,1,19),Te=0,ve=Object.create?Object.create(null):{},we=[];for(X=0;X<M.FullPaths.length;++X)ve[M.FullPaths[X]]=!0,M.FileIndex[X].type!==0&&we.push([M.FullPaths[X],M.FileIndex[X]]);for(X=0;X<we.length;++X){var Se=n(we[X][0]);H=ve[Se],H||(we.push([Se,{name:s(Se).replace("/",""),type:1,clsid:fe,ct:ye,mt:ye,content:null}]),ve[Se]=!0)}for(we.sort(function(Ve,Le){return r(Ve[0],Le[0])}),M.FullPaths=[],M.FileIndex=[],X=0;X<we.length;++X)M.FullPaths[X]=we[X][0],M.FileIndex[X]=we[X][1];for(X=0;X<we.length;++X){var Fe=M.FileIndex[X],ze=M.FullPaths[X];if(Fe.name=s(ze).replace("/",""),Fe.L=Fe.R=Fe.C=-(Fe.color=1),Fe.size=Fe.content?Fe.content.length:0,Fe.start=0,Fe.clsid=Fe.clsid||fe,X===0)Fe.C=we.length>1?1:-1,Fe.size=0,Fe.type=5;else if(ze.slice(-1)=="/"){for(Te=X+1;Te<we.length&&n(M.FullPaths[Te])!=ze;++Te);for(Fe.C=Te>=we.length?-1:Te,Te=X+1;Te<we.length&&n(M.FullPaths[Te])!=n(ze);++Te);Fe.R=Te>=we.length?-1:Te,Fe.type=1}else n(M.FullPaths[X+1]||"")==n(ze)&&(Fe.R=X+1),Fe.type=2}}}function Z(M,G){var W=G||{};if(W.fileType=="mad")return Lr(M,W);switch(z(M),W.fileType){case"zip":return ws(M,W)}var H=(function(Ve){for(var Le=0,Pe=0,xt=0;xt<Ve.FileIndex.length;++xt){var qt=Ve.FileIndex[xt];if(qt.content){var tr=qt.content.length;tr>0&&(tr<4096?Le+=tr+63>>6:Pe+=tr+511>>9)}}for(var Fr=Ve.FullPaths.length+3>>2,Di=Le+7>>3,Ma=Le+127>>7,Hs=Di+Pe+Fr+Ma,Yr=Hs+127>>7,zl=Yr<=109?0:Math.ceil((Yr-109)/127);Hs+Yr+zl+127>>7>Yr;)zl=++Yr<=109?0:Math.ceil((Yr-109)/127);var Rr=[1,zl,Yr,Ma,Fr,Pe,Le,0];return Ve.FileIndex[0].size=Le<<6,Rr[7]=(Ve.FileIndex[0].start=Rr[0]+Rr[1]+Rr[2]+Rr[3]+Rr[4]+Rr[5])+(Rr[6]+7>>3),Rr})(M),X=Ee(H[7]<<9),K=0,ye=0;{for(K=0;K<8;++K)X.write_shift(1,ce[K]);for(K=0;K<8;++K)X.write_shift(2,0);for(X.write_shift(2,62),X.write_shift(2,3),X.write_shift(2,65534),X.write_shift(2,9),X.write_shift(2,6),K=0;K<3;++K)X.write_shift(2,0);for(X.write_shift(4,0),X.write_shift(4,H[2]),X.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),X.write_shift(4,0),X.write_shift(4,4096),X.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:se),X.write_shift(4,H[3]),X.write_shift(-4,H[1]?H[0]-1:se),X.write_shift(4,H[1]),K=0;K<109;++K)X.write_shift(-4,K<H[2]?H[1]+K:-1)}if(H[1])for(ye=0;ye<H[1];++ye){for(;K<236+ye*127;++K)X.write_shift(-4,K<H[2]?H[1]+K:-1);X.write_shift(-4,ye===H[1]-1?se:ye+1)}var Te=function(Ve){for(ye+=Ve;K<ye-1;++K)X.write_shift(-4,K+1);Ve&&(++K,X.write_shift(-4,se))};for(ye=K=0,ye+=H[1];K<ye;++K)X.write_shift(-4,de.DIFSECT);for(ye+=H[2];K<ye;++K)X.write_shift(-4,de.FATSECT);Te(H[3]),Te(H[4]);for(var ve=0,we=0,Se=M.FileIndex[0];ve<M.FileIndex.length;++ve)Se=M.FileIndex[ve],Se.content&&(we=Se.content.length,!(we<4096)&&(Se.start=ye,Te(we+511>>9)));for(Te(H[6]+7>>3);X.l&511;)X.write_shift(-4,de.ENDOFCHAIN);for(ye=K=0,ve=0;ve<M.FileIndex.length;++ve)Se=M.FileIndex[ve],Se.content&&(we=Se.content.length,!(!we||we>=4096)&&(Se.start=ye,Te(we+63>>6)));for(;X.l&511;)X.write_shift(-4,de.ENDOFCHAIN);for(K=0;K<H[4]<<2;++K){var Fe=M.FullPaths[K];if(!Fe||Fe.length===0){for(ve=0;ve<17;++ve)X.write_shift(4,0);for(ve=0;ve<3;++ve)X.write_shift(4,-1);for(ve=0;ve<12;++ve)X.write_shift(4,0);continue}Se=M.FileIndex[K],K===0&&(Se.start=Se.size?Se.start-1:se);var ze=K===0&&W.root||Se.name;if(we=2*(ze.length+1),X.write_shift(64,ze,"utf16le"),X.write_shift(2,we),X.write_shift(1,Se.type),X.write_shift(1,Se.color),X.write_shift(-4,Se.L),X.write_shift(-4,Se.R),X.write_shift(-4,Se.C),Se.clsid)X.write_shift(16,Se.clsid,"hex");else for(ve=0;ve<4;++ve)X.write_shift(4,0);X.write_shift(4,Se.state||0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,Se.start),X.write_shift(4,Se.size),X.write_shift(4,0)}for(K=1;K<M.FileIndex.length;++K)if(Se=M.FileIndex[K],Se.size>=4096)if(X.l=Se.start+1<<9,_t&&Buffer.isBuffer(Se.content))Se.content.copy(X,X.l,0,Se.size),X.l+=Se.size+511&-512;else{for(ve=0;ve<Se.size;++ve)X.write_shift(1,Se.content[ve]);for(;ve&511;++ve)X.write_shift(1,0)}for(K=1;K<M.FileIndex.length;++K)if(Se=M.FileIndex[K],Se.size>0&&Se.size<4096)if(_t&&Buffer.isBuffer(Se.content))Se.content.copy(X,X.l,0,Se.size),X.l+=Se.size+63&-64;else{for(ve=0;ve<Se.size;++ve)X.write_shift(1,Se.content[ve]);for(;ve&63;++ve)X.write_shift(1,0)}if(_t)X.l=X.length;else for(;X.l<X.length;)X.write_shift(1,0);return X}function re(M,G){var W=M.FullPaths.map(function(ve){return ve.toUpperCase()}),H=W.map(function(ve){var we=ve.split("/");return we[we.length-(ve.slice(-1)=="/"?2:1)]}),X=!1;G.charCodeAt(0)===47?(X=!0,G=W[0].slice(0,-1)+G):X=G.indexOf("/")!==-1;var K=G.toUpperCase(),ye=X===!0?W.indexOf(K):H.indexOf(K);if(ye!==-1)return M.FileIndex[ye];var Te=!K.match(Ac);for(K=K.replace(kn,""),Te&&(K=K.replace(Ac,"!")),ye=0;ye<W.length;++ye)if((Te?W[ye].replace(Ac,"!"):W[ye]).replace(kn,"")==K||(Te?H[ye].replace(Ac,"!"):H[ye]).replace(kn,"")==K)return M.FileIndex[ye];return null}var P=64,se=-2,me="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:se,FREESECT:-1,HEADER_SIGNATURE:me,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function he(M,G,W){d();var H=Z(M,W);f.writeFileSync(G,H)}function Q(M){for(var G=new Array(M.length),W=0;W<M.length;++W)G[W]=String.fromCharCode(M[W]);return G.join("")}function ee(M,G){var W=Z(M,G);switch(G&&G.type||"buffer"){case"file":return d(),f.writeFileSync(G.filename,W),W;case"binary":return typeof W=="string"?W:Q(W);case"base64":return Zc(typeof W=="string"?W:Q(W));case"buffer":if(_t)return Buffer.isBuffer(W)?W:Ra(W);case"array":return typeof W=="string"?Jn(W):W}return W}var V;function F(M){try{var G=M.InflateRaw,W=new G;if(W._processChunk(new Uint8Array([3,0]),W._finishFlushFlag),W.bytesRead)V=M;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function N(M,G){if(!V)return Bs(M,G);var W=V.InflateRaw,H=new W,X=H._processChunk(M.slice(M.l),H._finishFlushFlag);return M.l+=H.bytesRead,X}function L(M){return V?V.deflateRawSync(M):at(M)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Y(M){var G=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(G>>16|G>>8|G)&255}for(var oe=typeof Uint8Array<"u",le=oe?new Uint8Array(256):[],te=0;te<256;++te)le[te]=Y(te);function I(M,G){var W=le[M&255];return G<=8?W>>>8-G:(W=W<<8|le[M>>8&255],G<=16?W>>>16-G:(W=W<<8|le[M>>16&255],W>>>24-G))}function Ce(M,G){var W=G&7,H=G>>>3;return(M[H]|(W<=6?0:M[H+1]<<8))>>>W&3}function Ie(M,G){var W=G&7,H=G>>>3;return(M[H]|(W<=5?0:M[H+1]<<8))>>>W&7}function ue(M,G){var W=G&7,H=G>>>3;return(M[H]|(W<=4?0:M[H+1]<<8))>>>W&15}function ge(M,G){var W=G&7,H=G>>>3;return(M[H]|(W<=3?0:M[H+1]<<8))>>>W&31}function _e(M,G){var W=G&7,H=G>>>3;return(M[H]|(W<=1?0:M[H+1]<<8))>>>W&127}function je(M,G,W){var H=G&7,X=G>>>3,K=(1<<W)-1,ye=M[X]>>>H;return W<8-H||(ye|=M[X+1]<<8-H,W<16-H)||(ye|=M[X+2]<<16-H,W<24-H)||(ye|=M[X+3]<<24-H),ye&K}function Ke(M,G,W){var H=G&7,X=G>>>3;return H<=5?M[X]|=(W&7)<<H:(M[X]|=W<<H&255,M[X+1]=(W&7)>>8-H),G+3}function ot(M,G,W){var H=G&7,X=G>>>3;return W=(W&1)<<H,M[X]|=W,G+1}function ft(M,G,W){var H=G&7,X=G>>>3;return W<<=H,M[X]|=W&255,W>>>=8,M[X+1]=W,G+8}function et(M,G,W){var H=G&7,X=G>>>3;return W<<=H,M[X]|=W&255,W>>>=8,M[X+1]=W&255,M[X+2]=W>>>8,G+16}function tt(M,G){var W=M.length,H=2*W>G?2*W:G+5,X=0;if(W>=G)return M;if(_t){var K=py(H);if(M.copy)M.copy(K);else for(;X<M.length;++X)K[X]=M[X];return K}else if(oe){var ye=new Uint8Array(H);if(ye.set)ye.set(M);else for(;X<W;++X)ye[X]=M[X];return ye}return M.length=H,M}function lt(M){for(var G=new Array(M),W=0;W<M;++W)G[W]=0;return G}function Ye(M,G,W){var H=1,X=0,K=0,ye=0,Te=0,ve=M.length,we=oe?new Uint16Array(32):lt(32);for(K=0;K<32;++K)we[K]=0;for(K=ve;K<W;++K)M[K]=0;ve=M.length;var Se=oe?new Uint16Array(ve):lt(ve);for(K=0;K<ve;++K)we[X=M[K]]++,H<X&&(H=X),Se[K]=0;for(we[0]=0,K=1;K<=H;++K)we[K+16]=Te=Te+we[K-1]<<1;for(K=0;K<ve;++K)Te=M[K],Te!=0&&(Se[K]=we[Te+16]++);var Fe=0;for(K=0;K<ve;++K)if(Fe=M[K],Fe!=0)for(Te=I(Se[K],H)>>H-Fe,ye=(1<<H+4-Fe)-1;ye>=0;--ye)G[Te|ye<<Fe]=Fe&15|K<<4;return H}var Tt=oe?new Uint16Array(512):lt(512),dr=oe?new Uint16Array(32):lt(32);if(!oe){for(var Kt=0;Kt<512;++Kt)Tt[Kt]=0;for(Kt=0;Kt<32;++Kt)dr[Kt]=0}(function(){for(var M=[],G=0;G<32;G++)M.push(5);Ye(M,dr,32);var W=[];for(G=0;G<=143;G++)W.push(8);for(;G<=255;G++)W.push(9);for(;G<=279;G++)W.push(7);for(;G<=287;G++)W.push(8);Ye(W,Tt,288)})();var an=(function(){for(var G=oe?new Uint8Array(32768):[],W=0,H=0;W<ne.length-1;++W)for(;H<ne[W+1];++H)G[H]=W;for(;H<32768;++H)G[H]=29;var X=oe?new Uint8Array(259):[];for(W=0,H=0;W<q.length-1;++W)for(;H<q[W+1];++H)X[H]=W;function K(Te,ve){for(var we=0;we<Te.length;){var Se=Math.min(65535,Te.length-we),Fe=we+Se==Te.length;for(ve.write_shift(1,+Fe),ve.write_shift(2,Se),ve.write_shift(2,~Se&65535);Se-- >0;)ve[ve.l++]=Te[we++]}return ve.l}function ye(Te,ve){for(var we=0,Se=0,Fe=oe?new Uint16Array(32768):[];Se<Te.length;){var ze=Math.min(65535,Te.length-Se);if(ze<10){for(we=Ke(ve,we,+(Se+ze==Te.length)),we&7&&(we+=8-(we&7)),ve.l=we/8|0,ve.write_shift(2,ze),ve.write_shift(2,~ze&65535);ze-- >0;)ve[ve.l++]=Te[Se++];we=ve.l*8;continue}we=Ke(ve,we,+(Se+ze==Te.length)+2);for(var Ve=0;ze-- >0;){var Le=Te[Se];Ve=(Ve<<5^Le)&32767;var Pe=-1,xt=0;if((Pe=Fe[Ve])&&(Pe|=Se&-32768,Pe>Se&&(Pe-=32768),Pe<Se))for(;Te[Pe+xt]==Te[Se+xt]&&xt<250;)++xt;if(xt>2){Le=X[xt],Le<=22?we=ft(ve,we,le[Le+1]>>1)-1:(ft(ve,we,3),we+=5,ft(ve,we,le[Le-23]>>5),we+=3);var qt=Le<8?0:Le-4>>2;qt>0&&(et(ve,we,xt-q[Le]),we+=qt),Le=G[Se-Pe],we=ft(ve,we,le[Le]>>3),we-=3;var tr=Le<4?0:Le-2>>1;tr>0&&(et(ve,we,Se-Pe-ne[Le]),we+=tr);for(var Fr=0;Fr<xt;++Fr)Fe[Ve]=Se&32767,Ve=(Ve<<5^Te[Se])&32767,++Se;ze-=xt-1}else Le<=143?Le=Le+48:we=ot(ve,we,1),we=ft(ve,we,le[Le]),Fe[Ve]=Se&32767,++Se}we=ft(ve,we,0)-1}return ve.l=(we+7)/8|0,ve.l}return function(ve,we){return ve.length<8?K(ve,we):ye(ve,we)}})();function at(M){var G=Ee(50+Math.floor(M.length*1.1)),W=an(M,G);return G.slice(0,W)}var zt=oe?new Uint16Array(32768):lt(32768),Ar=oe?new Uint16Array(32768):lt(32768),hr=oe?new Uint16Array(128):lt(128),ns=1,Ai=1;function Oa(M,G){var W=ge(M,G)+257;G+=5;var H=ge(M,G)+1;G+=5;var X=ue(M,G)+4;G+=4;for(var K=0,ye=oe?new Uint8Array(19):lt(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ve=1,we=oe?new Uint8Array(8):lt(8),Se=oe?new Uint8Array(8):lt(8),Fe=ye.length,ze=0;ze<X;++ze)ye[B[ze]]=K=Ie(M,G),ve<K&&(ve=K),we[K]++,G+=3;var Ve=0;for(we[0]=0,ze=1;ze<=ve;++ze)Se[ze]=Ve=Ve+we[ze-1]<<1;for(ze=0;ze<Fe;++ze)(Ve=ye[ze])!=0&&(Te[ze]=Se[Ve]++);var Le=0;for(ze=0;ze<Fe;++ze)if(Le=ye[ze],Le!=0){Ve=le[Te[ze]]>>8-Le;for(var Pe=(1<<7-Le)-1;Pe>=0;--Pe)hr[Ve|Pe<<Le]=Le&7|ze<<3}var xt=[];for(ve=1;xt.length<W+H;)switch(Ve=hr[_e(M,G)],G+=Ve&7,Ve>>>=3){case 16:for(K=3+Ce(M,G),G+=2,Ve=xt[xt.length-1];K-- >0;)xt.push(Ve);break;case 17:for(K=3+Ie(M,G),G+=3;K-- >0;)xt.push(0);break;case 18:for(K=11+_e(M,G),G+=7;K-- >0;)xt.push(0);break;default:xt.push(Ve),ve<Ve&&(ve=Ve);break}var qt=xt.slice(0,W),tr=xt.slice(W);for(ze=W;ze<286;++ze)qt[ze]=0;for(ze=H;ze<30;++ze)tr[ze]=0;return ns=Ye(qt,zt,286),Ai=Ye(tr,Ar,30),G}function ji(M,G){if(M[0]==3&&!(M[1]&3))return[yi(G),2];for(var W=0,H=0,X=py(G||1<<18),K=0,ye=X.length>>>0,Te=0,ve=0;(H&1)==0;){if(H=Ie(M,W),W+=3,H>>>1)H>>1==1?(Te=9,ve=5):(W=Oa(M,W),Te=ns,ve=Ai);else{W&7&&(W+=8-(W&7));var we=M[W>>>3]|M[(W>>>3)+1]<<8;if(W+=32,we>0)for(!G&&ye<K+we&&(X=tt(X,K+we),ye=X.length);we-- >0;)X[K++]=M[W>>>3],W+=8;continue}for(;;){!G&&ye<K+32767&&(X=tt(X,K+32767),ye=X.length);var Se=je(M,W,Te),Fe=H>>>1==1?Tt[Se]:zt[Se];if(W+=Fe&15,Fe>>>=4,(Fe>>>8&255)===0)X[K++]=Fe;else{if(Fe==256)break;Fe-=257;var ze=Fe<8?0:Fe-4>>2;ze>5&&(ze=0);var Ve=K+q[Fe];ze>0&&(Ve+=je(M,W,ze),W+=ze),Se=je(M,W,ve),Fe=H>>>1==1?dr[Se]:Ar[Se],W+=Fe&15,Fe>>>=4;var Le=Fe<4?0:Fe-2>>1,Pe=ne[Fe];for(Le>0&&(Pe+=je(M,W,Le),W+=Le),!G&&ye<Ve&&(X=tt(X,Ve+100),ye=X.length);K<Ve;)X[K]=X[K-Pe],++K}}}return G?[X,W+7>>>3]:[X.slice(0,K),W+7>>>3]}function Bs(M,G){var W=M.slice(M.l||0),H=ji(W,G);return M.l+=H[1],H[0]}function Cn(M,G){if(M)typeof console<"u"&&console.error(G);else throw new Error(G)}function La(M,G){var W=M;un(W,0);var H=[],X=[],K={FileIndex:H,FullPaths:X};T(K,{root:G.root});for(var ye=W.length-4;(W[ye]!=80||W[ye+1]!=75||W[ye+2]!=5||W[ye+3]!=6)&&ye>=0;)--ye;W.l=ye+4,W.l+=4;var Te=W.read_shift(2);W.l+=6;var ve=W.read_shift(4);for(W.l=ve,ye=0;ye<Te;++ye){W.l+=20;var we=W.read_shift(4),Se=W.read_shift(4),Fe=W.read_shift(2),ze=W.read_shift(2),Ve=W.read_shift(2);W.l+=8;var Le=W.read_shift(4),Pe=u(W.slice(W.l+Fe,W.l+Fe+ze));W.l+=Fe+ze+Ve;var xt=W.l;W.l=Le+4,Us(W,we,Se,K,Pe),W.l=xt}return K}function Us(M,G,W,H,X){M.l+=2;var K=M.read_shift(2),ye=M.read_shift(2),Te=o(M);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var ve=M.read_shift(4),we=M.read_shift(4),Se=M.read_shift(4),Fe=M.read_shift(2),ze=M.read_shift(2),Ve="",Le=0;Le<Fe;++Le)Ve+=String.fromCharCode(M[M.l++]);if(ze){var Pe=u(M.slice(M.l,M.l+ze));(Pe[21589]||{}).mt&&(Te=Pe[21589].mt),((X||{})[21589]||{}).mt&&(Te=X[21589].mt)}M.l+=ze;var xt=M.slice(M.l,M.l+we);switch(ye){case 8:xt=N(M,Se);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ye)}var qt=!1;K&8&&(ve=M.read_shift(4),ve==134695760&&(ve=M.read_shift(4),qt=!0),we=M.read_shift(4),Se=M.read_shift(4)),we!=G&&Cn(qt,"Bad compressed size: "+G+" != "+we),Se!=W&&Cn(qt,"Bad uncompressed size: "+W+" != "+Se),Dr(H,Ve,xt,{unsafe:!0,mt:Te})}function ws(M,G){var W=G||{},H=[],X=[],K=Ee(1),ye=W.compression?8:0,Te=0,ve=0,we=0,Se=0,Fe=0,ze=M.FullPaths[0],Ve=ze,Le=M.FileIndex[0],Pe=[],xt=0;for(ve=1;ve<M.FullPaths.length;++ve)if(Ve=M.FullPaths[ve].slice(ze.length),Le=M.FileIndex[ve],!(!Le.size||!Le.content||Ve=="Sh33tJ5")){var qt=Se,tr=Ee(Ve.length);for(we=0;we<Ve.length;++we)tr.write_shift(1,Ve.charCodeAt(we)&127);tr=tr.slice(0,tr.l),Pe[Fe]=IP.buf(Le.content,0);var Fr=Le.content;ye==8&&(Fr=L(Fr)),K=Ee(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,Te),K.write_shift(2,ye),Le.mt?a(K,Le.mt):K.write_shift(4,0),K.write_shift(-4,Pe[Fe]),K.write_shift(4,Fr.length),K.write_shift(4,Le.content.length),K.write_shift(2,tr.length),K.write_shift(2,0),Se+=K.length,H.push(K),Se+=tr.length,H.push(tr),Se+=Fr.length,H.push(Fr),K=Ee(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,Te),K.write_shift(2,ye),K.write_shift(4,0),K.write_shift(-4,Pe[Fe]),K.write_shift(4,Fr.length),K.write_shift(4,Le.content.length),K.write_shift(2,tr.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,qt),xt+=K.l,X.push(K),xt+=tr.length,X.push(tr),++Fe}return K=Ee(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,Fe),K.write_shift(2,Fe),K.write_shift(4,xt),K.write_shift(4,Se),K.write_shift(2,0),nn([nn(H),nn(X),K])}var $s={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function mt(M,G){if(M.ctype)return M.ctype;var W=M.name||"",H=W.match(/\.([^\.]+)$/);return H&&$s[H[1]]||G&&(H=(W=G).match(/[\.\\]([^\.\\])+$/),H&&$s[H[1]])?$s[H[1]]:"application/octet-stream"}function mr(M){for(var G=Zc(M),W=[],H=0;H<G.length;H+=76)W.push(G.slice(H,H+76));return W.join(`\r
`)+`\r
`}function jr(M){var G=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(we){var Se=we.charCodeAt(0).toString(16).toUpperCase();return"="+(Se.length==1?"0"+Se:Se)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var W=[],H=G.split(`\r
`),X=0;X<H.length;++X){var K=H[X];if(K.length==0){W.push("");continue}for(var ye=0;ye<K.length;){var Te=76,ve=K.slice(ye,ye+Te);ve.charAt(Te-1)=="="?Te--:ve.charAt(Te-2)=="="?Te-=2:ve.charAt(Te-3)=="="&&(Te-=3),ve=K.slice(ye,ye+Te),ye+=Te,ye<K.length&&(ve+="="),W.push(ve)}}return W.join(`\r
`)}function qr(M){for(var G=[],W=0;W<M.length;++W){for(var H=M[W];W<=M.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+M[++W];G.push(H)}for(var X=0;X<G.length;++X)G[X]=G[X].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return Jn(G.join(`\r
`))}function zs(M,G,W){for(var H="",X="",K="",ye,Te=0;Te<10;++Te){var ve=G[Te];if(!ve||ve.match(/^\s*$/))break;var we=ve.match(/^(.*?):\s*([^\s].*)$/);if(we)switch(we[1].toLowerCase()){case"content-location":H=we[2].trim();break;case"content-type":K=we[2].trim();break;case"content-transfer-encoding":X=we[2].trim();break}}switch(++Te,X.toLowerCase()){case"base64":ye=Jn(ts(G.slice(Te).join("")));break;case"quoted-printable":ye=qr(G.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+X)}var Se=Dr(M,H.slice(W.length),ye,{unsafe:!0});K&&(Se.ctype=K)}function yr(M,G){if(Q(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var W=G&&G.root||"",H=(_t&&Buffer.isBuffer(M)?M.toString("binary"):Q(M)).split(`\r
`),X=0,K="";for(X=0;X<H.length;++X)if(K=H[X],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),W||(W=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,W.length)!=W))for(;W.length>0&&(W=W.slice(0,W.length-1),W=W.slice(0,W.lastIndexOf("/")+1),K.slice(0,W.length)!=W););var ye=(H[1]||"").match(/boundary="(.*?)"/);if(!ye)throw new Error("MAD cannot find boundary");var Te="--"+(ye[1]||""),ve=[],we=[],Se={FileIndex:ve,FullPaths:we};T(Se);var Fe,ze=0;for(X=0;X<H.length;++X){var Ve=H[X];Ve!==Te&&Ve!==Te+"--"||(ze++&&zs(Se,H.slice(Fe,X),W),Fe=X)}return Se}function Lr(M,G){var W=G||{},H=W.boundary||"SheetJS";H="------="+H;for(var X=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],K=M.FullPaths[0],ye=K,Te=M.FileIndex[0],ve=1;ve<M.FullPaths.length;++ve)if(ye=M.FullPaths[ve].slice(K.length),Te=M.FileIndex[ve],!(!Te.size||!Te.content||ye=="Sh33tJ5")){ye=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(xt){return"_x"+xt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(xt){return"_u"+xt.charCodeAt(0).toString(16)+"_"});for(var we=Te.content,Se=_t&&Buffer.isBuffer(we)?we.toString("binary"):Q(we),Fe=0,ze=Math.min(1024,Se.length),Ve=0,Le=0;Le<=ze;++Le)(Ve=Se.charCodeAt(Le))>=32&&Ve<128&&++Fe;var Pe=Fe>=ze*4/5;X.push(H),X.push("Content-Location: "+(W.root||"file:///C:/SheetJS/")+ye),X.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),X.push("Content-Type: "+mt(Te,ye)),X.push(""),X.push(Pe?jr(Se):mr(Se))}return X.push(H+`--\r
`),X.join(`\r
`)}function Ws(M){var G={};return T(G,M),G}function Dr(M,G,W,H){var X=H&&H.unsafe;X||T(M);var K=!X&&Ze.find(M,G);if(!K){var ye=M.FullPaths[0];G.slice(0,ye.length)==ye?ye=G:(ye.slice(-1)!="/"&&(ye+="/"),ye=(ye+G).replace("//","/")),K={name:s(G),type:2},M.FileIndex.push(K),M.FullPaths.push(ye),X||Ze.utils.cfb_gc(M)}return K.content=W,K.size=W?W.length:0,H&&(H.CLSID&&(K.clsid=H.CLSID),H.mt&&(K.mt=H.mt),H.ct&&(K.ct=H.ct)),K}function Nn(M,G){T(M);var W=Ze.find(M,G);if(W){for(var H=0;H<M.FileIndex.length;++H)if(M.FileIndex[H]==W)return M.FileIndex.splice(H,1),M.FullPaths.splice(H,1),!0}return!1}function Vs(M,G,W){T(M);var H=Ze.find(M,G);if(H){for(var X=0;X<M.FileIndex.length;++X)if(M.FileIndex[X]==H)return M.FileIndex[X].name=s(W),M.FullPaths[X]=W,!0}return!1}function In(M){z(M,!0)}return t.find=re,t.read=C,t.parse=p,t.write=ee,t.writeFile=he,t.utils={cfb_new:Ws,cfb_add:Dr,cfb_del:Nn,cfb_mov:Vs,cfb_gc:In,ReadShift:Ic,CheckField:qS,prep_blob:un,bconcat:nn,use_zlib:F,_deflateRaw:at,_inflateRaw:Bs,consts:de},t})();let hi;function OP(e){hi=e}function LP(e){return typeof e=="string"?vu(e):Array.isArray(e)?lP(e):e}function wu(e,t,r){if(typeof hi<"u"&&hi.writeFileSync)return r?hi.writeFileSync(e,t,r):hi.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=vu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?sa(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([LP(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=Ti(t)),u.write(t),u.close(),t}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+e)}function MP(e){if(typeof hi<"u")return hi.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Nr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Sy(e,t){for(var r=[],n=Nr(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function zd(e){for(var t=[],r=Nr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Wd(e){for(var t=[],r=Nr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function BP(e){for(var t=[],r=Nr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var yd=new Date(1899,11,30,0,0,0);function Kr(e,t){var r=e.getTime(),n=yd.getTime()+(e.getTimezoneOffset()-yd.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var FS=new Date,UP=yd.getTime()+(FS.getTimezoneOffset()-yd.getTimezoneOffset())*6e4,ky=FS.getTimezoneOffset();function Vd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+UP),t.getTimezoneOffset()!==ky&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ky)*6e4),t}function $P(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var by=new Date("2017-02-19T19:06:09.000Z"),RS=isNaN(by.getFullYear())?new Date("2/19/17"):by,zP=RS.getFullYear()==2017;function fr(e,t){var r=new Date(e);if(zP)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(RS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function uo(e,t){if(_t&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return sa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return sa(yS(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return sa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return sa(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Zt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Zt(e[r]));return t}function Er(e,t){for(var r="";r.length<t;)r+=e;return r}function Ps(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var WP=["january","february","march","april","may","june","july","august","september","october","november","december"];function Al(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&WP.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var VP=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],u=1;u<a.length;++u)o.push(s),o.push(a[u]);return o}})();function PS(e){return e?e.content&&e.type?uo(e.content,!0):e.data?ml(e.data):e.asNodeBuffer&&_t?ml(e.asNodeBuffer().toString("binary")):e.asBinary?ml(e.asBinary()):e._data&&e._data.getContent?ml(uo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function IS(e){if(!e)return null;if(e.data)return md(e.data);if(e.asNodeBuffer&&_t)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?md(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function HP(e){return e&&e.name.slice(-4)===".bin"?IS(e):PS(e)}function ps(e,t){for(var r=e.FullPaths||Nr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Bm(e,t){var r=ps(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ur(e,t,r){if(!r)return HP(Bm(e,t));if(!t)return null;try{return Ur(e,t)}catch{return null}}function Qn(e,t,r){if(!r)return PS(Bm(e,t));if(!t)return null;try{return Qn(e,t)}catch{return null}}function GP(e,t,r){return IS(Bm(e,t))}function Ey(e){for(var t=e.FullPaths||Nr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function yt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return _t?n=Ra(r):n=cP(r),Ze.utils.cfb_add(e,t,n)}Ze.utils.cfb_add(e,t,r)}else e.file(t,r)}function Um(){return Ze.utils.cfb_new()}function OS(e,t){switch(t.type){case"base64":return Ze.read(e,{type:"base64"});case"binary":return Ze.read(e,{type:"binary"});case"buffer":case"array":return Ze.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function jc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Or=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,XP=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ty=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,KP=/<[^>]*>/g,Tn=Or.match(Ty)?Ty:KP,qP=/<\w*:/,YP=/<(\/?)\w+:/;function dt(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var o=e.match(XP),u=0,f="",d=0,p="",m="",g=1;if(o)for(d=0;d!=o.length;++d){for(m=o[d],a=0;a!=m.length&&m.charCodeAt(a)!==61;++a);for(p=m.slice(0,a).trim();m.charCodeAt(a+1)==32;)++a;for(g=(s=m.charCodeAt(a+1))==34||s==39?1:0,f=m.slice(a+1+g,m.length-g),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=f,n[p.toLowerCase()]=f;else{var y=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[y]&&p.slice(u-3,u)=="ext")continue;n[y]=f,n[y.toLowerCase()]=f}}return n}function da(e){return e.replace(YP,"<$1")}var LS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$m=zd(LS),Bt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(u,f){return LS[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,f){return String.fromCharCode(parseInt(f,16))});var o=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,o)+r(s.slice(o+3))}})(),zm=/[&<>'"]/g,JP=/[\u0000-\u0008\u000b-\u001f]/g;function Gt(e){var t=e+"";return t.replace(zm,function(r){return $m[r]}).replace(JP,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Cy(e){return Gt(e).replace(/ /g,"_x0020_")}var MS=/[\u0000-\u001f]/g;function Wm(e){var t=e+"";return t.replace(zm,function(r){return $m[r]}).replace(/\n/g,"<br/>").replace(MS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function QP(e){var t=e+"";return t.replace(zm,function(r){return $m[r]}).replace(MS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Ny=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function ZP(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function cr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ip(e){for(var t="",r=0,n=0,s=0,a=0,o=0,u=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}o=e.charCodeAt(r++),u=((n&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Ay(e){var t=yi(2*e.length),r,n,s=1,a=0,o=0,u;for(n=0;n<e.length;n+=s)s=1,(u=e.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(n+1)&63),s=2):u<240?(r=(u&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(u&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function jy(e){return Ra(e,"binary").toString("utf8")}var Hf="foo bar baz",Xt=_t&&(jy(Hf)==ip(Hf)&&jy||Ay(Hf)==ip(Hf)&&Ay)||ip,sa=_t?function(e){return Ra(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},tu=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),BS=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),eI=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),tI=/<\/?(?:vt:)?variant>/g,rI=/<(?:vt:)([^>]*)>([\s\S]*)</;function Dy(e,t){var r=dt(e),n=e.match(eI(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var o=a.replace(tI,"").match(rI);o&&s.push({v:Xt(o[2]),t:o[1]})}),s}var US=/(^\s|\s$|\n)/;function fn(e,t){return"<"+e+(t.match(US)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ru(e){return Nr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Be(e,t,r){return"<"+e+(r!=null?ru(r):"")+(t!=null?(t.match(US)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Xp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function nI(e,t){switch(typeof e){case"string":var r=Be("vt:lpwstr",Gt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((e|0)==e?"vt:i4":"vt:r8",Gt(String(e)));case"boolean":return Be("vt:bool",e?"true":"false")}if(e instanceof Date)return Be("vt:filetime",Xp(e));throw new Error("Unable to serialize "+e)}function Vm(e){if(_t&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Xt(Ti(Om(e)));throw new Error("Bad input format: expected Buffer or string")}var nu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Xr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_o=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Yn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function sI(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function aI(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,o=n?-t:t;isFinite(o)?o==0?s=a=0:(s=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var u=0;u<=5;++u,a/=256)e[r+u]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var Fy=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},Ry=_t?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ra(t)})):Fy(e)}:Fy,Py=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(ba(e,s)));return n.join("").replace(kn,"")},Hd=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(kn,""):Py(e,t,r)}:Py,Iy=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},$S=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Iy(e,t,r)}:Iy,Oy=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(hl(e,s)));return n.join("")},Bl=_t?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Oy(t,r,n)}:Oy,zS=function(e,t){var r=rn(e,t);return r>0?Bl(e,t+4,t+4+r-1):""},Hm=zS,WS=function(e,t){var r=rn(e,t);return r>0?Bl(e,t+4,t+4+r-1):""},Gm=WS,VS=function(e,t){var r=2*rn(e,t);return r>0?Bl(e,t+4,t+4+r-1):""},Xm=VS,HS=function(t,r){var n=rn(t,r);return n>0?Hd(t,r+4,r+4+n):""},Km=HS,GS=function(e,t){var r=rn(e,t);return r>0?Bl(e,t+4,t+4+r):""},qm=GS,XS=function(e,t){return sI(e,t)},wd=XS,Ym=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};_t&&(Hm=function(t,r){if(!Buffer.isBuffer(t))return zS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Gm=function(t,r){if(!Buffer.isBuffer(t))return WS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Xm=function(t,r){if(!Buffer.isBuffer(t))return VS(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Km=function(t,r){if(!Buffer.isBuffer(t))return HS(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},qm=function(t,r){if(!Buffer.isBuffer(t))return GS(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},wd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):XS(t,r)},Ym=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function KS(){Hd=function(e,t,r){return Ot.utils.decode(1200,e.slice(t,r)).replace(kn,"")},Bl=function(e,t,r){return Ot.utils.decode(65001,e.slice(t,r))},Hm=function(e,t){var r=rn(e,t);return r>0?Ot.utils.decode(lo,e.slice(t+4,t+4+r-1)):""},Gm=function(e,t){var r=rn(e,t);return r>0?Ot.utils.decode(es,e.slice(t+4,t+4+r-1)):""},Xm=function(e,t){var r=2*rn(e,t);return r>0?Ot.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Km=function(e,t){var r=rn(e,t);return r>0?Ot.utils.decode(1200,e.slice(t+4,t+4+r)):""},qm=function(e,t){var r=rn(e,t);return r>0?Ot.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof Ot<"u"&&KS();var hl=function(e,t){return e[t]},ba=function(e,t){return e[t+1]*256+e[t]},iI=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},rn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ki=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},oI=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ic(e,t){var r="",n,s,a=[],o,u,f,d;switch(t){case"dbcs":if(d=this.l,_t&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)r+=String.fromCharCode(ba(this,d)),d+=2;e*=2;break;case"utf8":r=Bl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Hd(this,this.l,this.l+e);break;case"wstr":if(typeof Ot<"u")r=Ot.utils.decode(es,this.slice(this.l,this.l+2*e));else return Ic.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Hm(this,this.l),e=4+rn(this,this.l);break;case"lpstr-cp":r=Gm(this,this.l),e=4+rn(this,this.l);break;case"lpwstr":r=Xm(this,this.l),e=4+2*rn(this,this.l);break;case"lpp4":e=4+rn(this,this.l),r=Km(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+rn(this,this.l),r=qm(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=hl(this,this.l+e++))!==0;)a.push(Nc(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=ba(this,this.l+e))!==0;)a.push(Nc(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=hl(this,d),this.l=d+1,u=Ic.call(this,e-f,o?"dbcs-cont":"sbcs-cont"),a.join("")+u;a.push(Nc(ba(this,d))),d+=2}r=a.join(""),e*=2;break;case"cpstr":if(typeof Ot<"u"){r=Ot.utils.decode(es,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",d=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=hl(this,d),this.l=d+1,u=Ic.call(this,e-f,o?"dbcs-cont":"sbcs-cont"),a.join("")+u;a.push(Nc(hl(this,d))),d+=1}r=a.join("");break;default:switch(e){case 1:return n=hl(this,this.l),this.l++,n;case 2:return n=(t==="i"?iI:ba)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Ki:oI)(this,this.l),this.l+=4,n):(s=rn(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=wd(this,this.l):s=wd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=$S(this,this.l,e);break}}return this.l+=e,r}var lI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},cI=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},uI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function fI(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)uI(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){if(typeof Ot<"u"&&lo==874)for(s=0;s!=t.length;++s){var a=Ot.utils.encode(lo,t.charAt(s));this[this.l+s]=a[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var u=t.charCodeAt(s);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,lI(this,t,this.l);break;case 8:if(n=8,r==="f"){aI(this,t,this.l);break}case 16:break;case-4:n=4,cI(this,t,this.l);break}return this.l+=n,this}function qS(e,t){var r=$S(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function un(e,t){e.l=t,e.read_shift=Ic,e.chk=qS,e.write_shift=fI}function En(e,t){e.l+=t}function Ee(e){var t=yi(e);return un(t,0),t}function Pa(e,t,r){if(e){var n,s,a;un(e,e.l||0);for(var o=e.length,u=0,f=0;e.l<o;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var d=cu[u]||cu[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;f=e.l+a;var p=d.f&&d.f(e,a,r);if(e.l=f,t(p,d,u))return}}}function Vn(){var e=[],t=_t?256:2048,r=function(d){var p=Ee(d);return un(p,0),p},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(d){return n&&d<n.length-n.l?n:(s(),n=r(Math.max(d+1,t)))},o=function(){return s(),nn(e)},u=function(d){s(),n=d,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:u,end:o,_bufs:e}}function Ne(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=cu[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=e.next(a);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var u=0;u!=4;++u)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Ym(r)&&e.push(r)}}function Oc(e,t,r){var n=Zt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ly(e,t,r){var n=Zt(e);return n.s=Oc(n.s,t.s,r),n.e=Oc(n.e,t.s,r),n}function Lc(e,t){if(e.cRel&&e.c<0)for(e=Zt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Zt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ut(e);return!e.cRel&&e.cRel!=null&&(r=pI(r)),!e.rRel&&e.rRel!=null&&(r=dI(r)),r}function op(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ur(e.s.c)+":"+(e.e.cRel?"":"$")+ur(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Tr(e.s.r)+":"+(e.e.rRel?"":"$")+Tr(e.e.r):Lc(e.s,t.biff)+":"+Lc(e.e,t.biff)}function Jm(e){return parseInt(hI(e),10)-1}function Tr(e){return""+(e+1)}function dI(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function hI(e){return e.replace(/\$(\d+)$/,"$1")}function Qm(e){for(var t=mI(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ur(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function pI(e){return e.replace(/^([A-Z])/,"$$$1")}function mI(e){return e.replace(/^\$([A-Z])/,"$1")}function xI(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vr(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function ut(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Pn(e){var t=e.indexOf(":");return t==-1?{s:vr(e),e:vr(e)}:{s:vr(e.slice(0,t)),e:vr(e.slice(t+1))}}function vt(e,t){return typeof t>"u"||typeof t=="number"?vt(e.s,e.e):(typeof e!="string"&&(e=ut(e)),typeof t!="string"&&(t=ut(t)),e==t?e:e+":"+t)}function Rt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function My(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=rs(e.z,r?Kr(t):t)}catch{}try{return e.w=rs((e.XF||{}).numFmtId||(r?14:0),r?Kr(t):t)}catch{return""+t}}function ua(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ia[e.v]||e.v:t==null?My(e,e.v):My(e,t))}function Ci(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function YS(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),o=0,u=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?vr(n.origin):n.origin;o=f.r,u=f.c}a["!ref"]||(a["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var p=Rt(a["!ref"]);d.s.c=p.s.c,d.s.r=p.s.r,d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),o==-1&&(d.e.r=o=p.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[m].length;++g)if(!(typeof t[m][g]>"u")){var y={v:t[m][g]},w=o+m,v=u+g;if(d.s.r>w&&(d.s.r=w),d.s.c>v&&(d.s.c=v),d.e.r<w&&(d.e.r=w),d.e.c<v&&(d.e.c=v),t[m][g]&&typeof t[m][g]=="object"&&!Array.isArray(t[m][g])&&!(t[m][g]instanceof Date))y=t[m][g];else if(Array.isArray(y.v)&&(y.f=t[m][g][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||st[14],n.cellDates?(y.t="d",y.w=rs(y.z,Kr(y.v))):(y.t="n",y.v=Kr(y.v),y.w=rs(y.z,y.v))):y.t="s";if(s)a[w]||(a[w]=[]),a[w][v]&&a[w][v].z&&(y.z=a[w][v].z),a[w][v]=y;else{var S=ut({c:v,r:w});a[S]&&a[S].z&&(y.z=a[S].z),a[S]=y}}}return d.s.c<1e7&&(a["!ref"]=vt(d)),a}function Ul(e,t){return YS(null,e,t)}function gI(e){return e.read_shift(4,"i")}function Is(e,t){return t||(t=Ee(4)),t.write_shift(4,e),t}function bn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function sn(e,t){var r=!1;return t==null&&(r=!0,t=Ee(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function vI(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function yI(e,t){return t||(t=Ee(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Zm(e,t){var r=e.l,n=e.read_shift(1),s=bn(e),a=[],o={t:s,h:s};if((n&1)!==0){for(var u=e.read_shift(4),f=0;f!=u;++f)a.push(vI(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function wI(e,t){var r=!1;return t==null&&(r=!0,t=Ee(15+4*e.t.length)),t.write_shift(1,0),sn(e.t,t),r?t.slice(0,t.l):t}var _I=Zm;function SI(e,t){var r=!1;return t==null&&(r=!0,t=Ee(23+4*e.t.length)),t.write_shift(1,1),sn(e.t,t),t.write_shift(4,1),yI({},t),r?t.slice(0,t.l):t}function ys(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function So(e,t){return t==null&&(t=Ee(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ko(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function bo(e,t){return t==null&&(t=Ee(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var kI=bn,JS=sn;function ex(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function _d(e,t){var r=!1;return t==null&&(r=!0,t=Ee(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var bI=bn,Kp=ex,tx=_d;function rx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?wd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ki(t,0)>>2;return r?s/100:s}function QS(e,t){t==null&&(t=Ee(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function ZS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function EI(e,t){return t||(t=Ee(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Eo=ZS,$l=EI;function Sn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function fo(e,t){return(t||Ee(8)).write_shift(8,e,"f")}function TI(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),u=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var d=Ji[s];d&&(t.rgb=au(d));break;case 2:t.rgb=au([o,u,f]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Sd(e,t){if(t||(t=Ee(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function CI(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function NI(e,t){t||(t=Ee(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function ek(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function AI(e){return ek(e,1)}function jI(e){return ek(e,2)}var nx=2,Wn=3,Gf=11,By=12,kd=19,Xf=64,DI=65,FI=71,RI=4108,PI=4126,tn=80,tk=81,II=[tn,tk],qp={1:{n:"CodePage",t:nx},2:{n:"Category",t:tn},3:{n:"PresentationFormat",t:tn},4:{n:"ByteCount",t:Wn},5:{n:"LineCount",t:Wn},6:{n:"ParagraphCount",t:Wn},7:{n:"SlideCount",t:Wn},8:{n:"NoteCount",t:Wn},9:{n:"HiddenCount",t:Wn},10:{n:"MultimediaClipCount",t:Wn},11:{n:"ScaleCrop",t:Gf},12:{n:"HeadingPairs",t:RI},13:{n:"TitlesOfParts",t:PI},14:{n:"Manager",t:tn},15:{n:"Company",t:tn},16:{n:"LinksUpToDate",t:Gf},17:{n:"CharacterCount",t:Wn},19:{n:"SharedDoc",t:Gf},22:{n:"HyperlinksChanged",t:Gf},23:{n:"AppVersion",t:Wn,p:"version"},24:{n:"DigSig",t:DI},26:{n:"ContentType",t:tn},27:{n:"ContentStatus",t:tn},28:{n:"Language",t:tn},29:{n:"Version",t:tn},255:{},2147483648:{n:"Locale",t:kd},2147483651:{n:"Behavior",t:kd},1919054434:{}},Yp={1:{n:"CodePage",t:nx},2:{n:"Title",t:tn},3:{n:"Subject",t:tn},4:{n:"Author",t:tn},5:{n:"Keywords",t:tn},6:{n:"Comments",t:tn},7:{n:"Template",t:tn},8:{n:"LastAuthor",t:tn},9:{n:"RevNumber",t:tn},10:{n:"EditTime",t:Xf},11:{n:"LastPrinted",t:Xf},12:{n:"CreatedDate",t:Xf},13:{n:"ModifiedDate",t:Xf},14:{n:"PageCount",t:Wn},15:{n:"WordCount",t:Wn},16:{n:"CharCount",t:Wn},17:{n:"Thumbnail",t:FI},18:{n:"Application",t:tn},19:{n:"DocSecurity",t:Wn},255:{},2147483648:{n:"Locale",t:kd},2147483651:{n:"Behavior",t:kd},1919054434:{}},Uy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},OI=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function LI(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var MI=LI([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ji=Zt(MI),Ia={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},rk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Jp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Kf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function sx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function BI(e){var t=sx();if(!e||!e.match)return t;var r={};if((e.match(Tn)||[]).forEach(function(n){var s=dt(n);switch(s[0].replace(qP,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Jp[s.ContentType]]!==void 0&&t[Jp[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Xr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function nk(e,t){var r=BP(Jp),n=[],s;n[n.length]=Or,n[n.length]=Be("Types",null,{xmlns:Xr.CT,"xmlns:xsd":Xr.xsd,"xmlns:xsi":Xr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Be("Default",null,{Extension:f[0],ContentType:f[1]})}));var a=function(f){e[f]&&e[f].length>0&&(s=e[f][0],n[n.length]=Be("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Kf[f][t.bookType]||Kf[f].xlsx}))},o=function(f){(e[f]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Kf[f][t.bookType]||Kf[f].xlsx})})},u=function(f){(e[f]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return a("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function su(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Mc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Tn)||[]).forEach(function(s){var a=dt(s);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var u=a.TargetMode==="External"?a.Target:jc(a.Target,t);r[u]=o,n[a.Id]=o}}),r["!id"]=n,r}function _l(e){var t=[Or,Be("Relationships",null,{xmlns:Xr.RELS})];return Nr(e["!id"]).forEach(function(r){t[t.length]=Be("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ht(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var UI="application/vnd.oasis.opendocument.spreadsheet";function $I(e,t){for(var r=Vm(e),n,s;n=nu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=dt(n[0],!1),s.path=="/"&&s.type!==UI)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function zI(e){var t=[Or];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function $y(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function WI(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function VI(e){var t=[Or];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push($y(e[r][0],e[r][1])),t.push(WI("",e[r][0]));return t.push($y("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function sk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Qc.version+"</meta:generator></office:meta></office:document-meta>"}var vs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],HI=(function(){for(var e=new Array(vs.length),t=0;t<vs.length;++t){var r=vs[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function ak(e){var t={};e=Xt(e);for(var r=0;r<vs.length;++r){var n=vs[r],s=e.match(HI[r]);s!=null&&s.length>0&&(t[n[1]]=Bt(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=fr(t[n[1]]))}return t}function lp(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Gt(t),n[n.length]=r?Be(e,t,r):fn(e,t))}function ik(e,t){var r=t||{},n=[Or,Be("cp:coreProperties",null,{"xmlns:cp":Xr.CORE_PROPS,"xmlns:dc":Xr.dc,"xmlns:dcterms":Xr.dcterms,"xmlns:dcmitype":Xr.dcmitype,"xmlns:xsi":Xr.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&lp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Xp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&lp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Xp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=vs.length;++a){var o=vs[a],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&lp(o[0],u,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Qi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ok=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function lk(e,t,r,n){var s=[];if(typeof e=="string")s=Dy(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(p){return{v:p}}));var o=typeof t=="string"?Dy(t,n).map(function(p){return p.v}):t,u=0,f=0;if(o.length>0)for(var d=0;d!==s.length;d+=2){switch(f=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=o.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=o.slice(u,u+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=o.slice(u,u+f);break}u+=f}}function GI(e,t,r){var n={};return t||(t={}),e=Xt(e),Qi.forEach(function(s){var a=(e.match(tu(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=Bt(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&lk(n.HeadingPairs,n.TitlesOfParts,t,r),t}function ck(e){var t=[],r=Be;return e||(e={}),e.Application="SheetJS",t[t.length]=Or,t[t.length]=Be("Properties",null,{xmlns:Xr.EXT_PROPS,"xmlns:vt":Xr.vt}),Qi.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Gt(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Gt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var XI=/<[^>]+>[^<]*/g;function KI(e,t){var r={},n="",s=e.match(XI);if(s)for(var a=0;a!=s.length;++a){var o=s[a],u=dt(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Bt(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var f=o.split(">"),d=f[0].slice(4),p=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Bt(p);break;case"bool":r[n]=cr(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=fr(p);break;case"cy":case"error":r[n]=Bt(p);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,f)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function uk(e){var t=[Or,Be("Properties",null,{xmlns:Xr.CUST_PROPS,"xmlns:vt":Xr.vt})];if(!e)return t.join("");var r=1;return Nr(e).forEach(function(s){++r,t[t.length]=Be("property",nI(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Gt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Qp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},cp;function qI(e,t,r){cp||(cp=zd(Qp)),t=cp[t]||t,e[t]=r}function YI(e,t){var r=[];return Nr(Qp).map(function(n){for(var s=0;s<vs.length;++s)if(vs[s][1]==n)return vs[s];for(s=0;s<Qi.length;++s)if(Qi[s][1]==n)return Qi[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(fn(Qp[n[1]]||n[1],s))}}),Be("DocumentProperties",r.join(""),{xmlns:Yn.o})}function JI(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Nr(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var o=0;o<vs.length;++o)if(a==vs[o][1])return;for(o=0;o<Qi.length;++o)if(a==Qi[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var u=e[a],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),s.push(Be(Cy(a),u,{"dt:dt":f}))}}),t&&Nr(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var o=t[a],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Be(Cy(a),o,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Yn.o+'">'+s.join("")+"</"+n+">"}function ax(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function QI(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var o=Ee(8);return o.write_shift(4,n),o.write_shift(4,s),o}function fk(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function dk(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function hk(e,t,r){return t===31?dk(e):fk(e,t,r)}function Zp(e,t,r){return hk(e,t,r===!1?0:4)}function ZI(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return hk(e,t,0)}function e8(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(kn,""),e.l-s&2&&(e.l+=2)}return r}function t8(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(kn,"");return r}function r8(e){var t=e.l,r=bd(e,tk);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=bd(e,Wn);return[r,n]}function n8(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(r8(e));return r}function zy(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(kn,"").replace(Ac,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function pk(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function s8(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function bd(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==By&&n!==t&&II.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===By?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return fk(e,n,4).replace(kn,"");case 31:return dk(e);case 64:return ax(e);case 65:return pk(e);case 71:return s8(e);case 80:return Zp(e,n,!a.raw).replace(kn,"");case 81:return ZI(e,n).replace(kn,"");case 4108:return n8(e);case 4126:case 4127:return n==4127?e8(e):t8(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Wy(e,t){var r=Ee(4),n=Ee(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ee(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=QI(t);break;case 31:case 80:for(n=Ee(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return nn([r,n])}function Vy(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],o=0,u=0,f=-1,d={};for(o=0;o!=s;++o){var p=e.read_shift(4),m=e.read_shift(4);a[o]=[p,m+r]}a.sort(function(A,b){return A[1]-b[1]});var g={};for(o=0;o!=s;++o){if(e.l!==a[o][1]){var y=!0;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,y=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],y=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],y=!1);break}if((!t||o==0)&&e.l<=a[o][1]&&(y=!1,e.l=a[o][1]),y)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var w=t[a[o][0]];if(g[w.n]=bd(e,w.t,{raw:!0}),w.p==="version"&&(g[w.n]=String(g[w.n]>>16)+"."+("0000"+String(g[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(g[w.n]){case 0:g[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:xs(u=g[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[w.n])}}else if(a[o][0]===1){if(u=g.CodePage=bd(e,nx),xs(u),f!==-1){var v=e.l;e.l=a[f][1],d=zy(e,u),e.l=v}}else if(a[o][0]===0){if(u===0){f=o,e.l=a[o+1][1];continue}d=zy(e,u)}else{var S=d[a[o][0]],E;switch(e[e.l]){case 65:e.l+=4,E=pk(e);break;case 30:e.l+=4,E=Zp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=Zp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=Ir(e,4);break;case 64:e.l+=4,E=fr(ax(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[S]=E}}return e.l=r+n,g}var mk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function a8(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Hy(e,t,r){var n=Ee(8),s=[],a=[],o=8,u=0,f=Ee(8),d=Ee(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),a.push(f),s.push(d),o+=8+f.length,!t){d=Ee(8),d.write_shift(4,0),s.unshift(d);var p=[Ee(4)];for(p[0].write_shift(4,e.length),u=0;u<e.length;++u){var m=e[u][0];for(f=Ee(8+2*(m.length+1)+(m.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,m.length+1),f.write_shift(0,m,"dbcs");f.l!=f.length;)f.write_shift(1,0);p.push(f)}f=nn(p),a.unshift(f),o+=8+f.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(mk.indexOf(e[u][0])>-1||ok.indexOf(e[u][0])>-1)&&e[u][1]!=null){var g=e[u][1],y=0;if(t){y=+t[e[u][0]];var w=r[y];if(w.p=="version"&&typeof g=="string"){var v=g.split(".");g=(+v[0]<<16)+(+v[1]||0)}f=Wy(w.t,g)}else{var S=a8(g);S==-1&&(S=31,g=String(g)),f=Wy(S,g)}a.push(f),d=Ee(8),d.write_shift(4,t?y:2+u),s.push(d),o+=8+f.length}var E=8*(a.length+1);for(u=0;u<a.length;++u)s[u].write_shift(4,E),E+=a[u].length;return n.write_shift(4,o),n.write_shift(4,a.length),nn([n].concat(s).concat(a))}function Gy(e,t,r){var n=e.content;if(!n)return{};un(n,0);var s,a,o,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),p=n.read_shift(16);if(p!==Ze.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),u=n.read_shift(4),s===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);s===2&&(o=n.read_shift(16),f=n.read_shift(4));var m=Vy(n,t),g={SystemIdentifier:d};for(var y in m)g[y]=m[y];if(g.FMTID=a,s===1)return g;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var w;try{w=Vy(n,null)}catch{}for(y in w)g[y]=w[y];return g.FMTID=[a,o],g}function Xy(e,t,r,n,s,a){var o=Ee(s?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ze.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var f=Hy(e,r,n);if(u.push(f),s){var d=Hy(s,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+f.length),u.push(d)}return nn(u)}function ii(e,t){return e.read_shift(t),null}function i8(e,t){t||(t=Ee(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function o8(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Ir(e,t){return e.read_shift(t)===1}function Rn(e,t){return t||(t=Ee(2)),t.write_shift(2,+!!e),t}function $r(e){return e.read_shift(2,"u")}function ms(e,t){return t||(t=Ee(2)),t.write_shift(2,e),t}function xk(e,t){return o8(e,t,$r)}function l8(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function gk(e,t,r){return r||(r=Ee(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function _u(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont",a=es;if(r&&r.biff>=8&&(es=1200),!r||r.biff==8){var o=e.read_shift(1);o&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var u=n?e.read_shift(n,s):"";return es=a,u}function c8(e){var t=es;es=1200;var r=e.read_shift(2),n=e.read_shift(1),s=n&4,a=n&8,o=1+(n&1),u=0,f,d={};a&&(u=e.read_shift(2)),s&&(f=e.read_shift(4));var p=o==2?"dbcs-cont":"sbcs-cont",m=r===0?"":e.read_shift(r,p);return a&&(e.l+=4*u),s&&(e.l+=f),d.t=m,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),es=t,d}function u8(e){var t=e.t||"",r=Ee(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ee(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return nn(s)}function ho(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Su(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ho(e,n,r)}function To(e,t,r){if(r.biff>5)return Su(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function vk(e,t,r){return r||(r=Ee(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function f8(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function d8(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(kn,"");return n&&(e.l+=24),s}function h8(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(kn,"");return r+o}function p8(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return d8(e);case"0303000000000000c000000000000046":return h8(e);default:throw new Error("Unsupported Moniker "+r)}}function qf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(kn,""):"";return r}function Ky(e,t){t||(t=Ee(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function m8(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,o,u,f,d="",p,m;s&16&&(a=qf(e,r-e.l)),s&128&&(o=qf(e,r-e.l)),(s&257)===257&&(u=qf(e,r-e.l)),(s&257)===1&&(f=p8(e,r-e.l)),s&8&&(d=qf(e,r-e.l)),s&32&&(p=e.read_shift(16)),s&64&&(m=ax(e)),e.l=r;var g=o||u||f||"";g&&d&&(g+="#"+d),g||(g="#"+d),s&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var y={Target:g};return p&&(y.guid=p),m&&(y.time=m),a&&(y.Tooltip=a),y}function x8(e){var t=Ee(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(a==28)n=n.slice(1),Ky(n,t);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var u=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),a&8&&Ky(s>-1?n.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(t.write_shift(2,f),t.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)t.write_shift(1,n.charCodeAt(r+3*f)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function yk(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function wk(e,t){var r=yk(e);return r[3]=0,r}function ha(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function po(e,t,r,n){return n||(n=Ee(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function g8(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function v8(e,t,r){return t===0?"":To(e,t,r)}function y8(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,a,o]}function _k(e){var t=e.read_shift(2),r=rx(e);return[t,r]}function w8(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=_u(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function Gd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function Sk(e,t){return t||(t=Ee(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function kk(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var _8=kk;function bk(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function S8(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function k8(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function vn(e){e.l+=2,e.l+=e.read_shift(2)}var b8={0:vn,4:vn,5:vn,6:vn,7:k8,8:vn,9:vn,10:vn,11:vn,12:vn,13:S8,14:vn,15:vn,16:vn,17:vn,18:vn,19:vn,20:vn,21:bk};function E8(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(b8[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Yf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function ix(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Ee(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function T8(e,t){return t===0||e.read_shift(2),1200}function C8(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=To(e,0,r);return e.read_shift(t+n-e.l),s}function N8(e,t){var r=!t||t.biff==8,n=Ee(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function A8(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function j8(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=_u(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:a,name:o}}function D8(e,t){var r=!t||t.biff>=8?2:1,n=Ee(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function F8(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],o=0;o!=s&&e.l<r;++o)a.push(c8(e));return a.Count=n,a.Unique=s,a}function R8(e,t){var r=Ee(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=u8(e[s]);var a=nn([r].concat(n));return a.parts=[r.length].concat(n.map(function(o){return o.length})),a}function P8(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function I8(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function O8(e){var t=g8(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function L8(e){return e.read_shift(2),e.read_shift(4)}function qy(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function M8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:o,FirstTab:u,Selected:f,TabRatio:d}}function B8(){var e=Ee(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function U8(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function $8(e){var t=Ee(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function z8(){}function W8(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=_u(e,0,r),n}function V8(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=Ee(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function H8(e){var t=ha(e);return t.isst=e.read_shift(4),t}function G8(e,t,r,n){var s=Ee(10);return po(e,t,n,s),s.write_shift(4,r),s}function X8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=ha(e);r.biff==2&&e.l++;var a=Su(e,n-e.l,r);return s.val=a,s}function K8(e,t,r,n,s){var a=!s||s.biff==8,o=Ee(8+ +a+(1+a)*r.length);return po(e,t,n,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function q8(e,t,r){var n=e.read_shift(2),s=To(e,0,r);return[n,s]}function Y8(e,t,r,n){var s=r&&r.biff==5;n||(n=Ee(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var J8=To;function Yy(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),o=e.read_shift(s),u=e.read_shift(2),f=e.read_shift(2);return e.l=n,{s:{r:a,c:u},e:{r:o,c:f}}}function Q8(e,t){var r=t.biff==8||!t.biff?4:2,n=Ee(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Z8(e){var t=e.read_shift(2),r=e.read_shift(2),n=_k(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function eO(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(_k(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:a}}function tO(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:a}}function rO(e,t,r,n){var s={},a=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(4),f=e.read_shift(2);return s.patternType=OI[u>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=f&127,s.icvBack=f>>7&127,s.fsxButton=f>>14&1),s}function nO(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=rO(e,t,n.fStyle,r),n}function Jy(e,t,r,n){var s=r&&r.biff==5;n||(n=Ee(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function sO(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function aO(e){var t=Ee(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Qy(e,t,r){var n=ha(e);(r.biff==2||t==9)&&++e.l;var s=l8(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function iO(e,t,r,n,s,a){var o=Ee(8);return po(e,t,n,o),gk(r,a,o),o}function oO(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ha(e),s=Sn(e);return n.val=s,n}function lO(e,t,r,n){var s=Ee(14);return po(e,t,n,s),fo(r,s),s}var Zy=v8;function cO(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=ho(e,a),u=[];n>e.l;)u.push(Su(e));return[a,s,o,u]}function ew(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=w8(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var uO=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function tw(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),f=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=ho(e,o,r);s&32&&(d=uO[d.charCodeAt(0)]);var p=n-e.l;r&&r.biff==2&&--p;var m=n==e.l||u===0||!(p>0)?[]:EM(e,p,r,u);return{chKey:a,Name:d,itab:f,rgce:m}}function Ek(e,t,r){if(r.biff<8)return fO(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(y8(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function fO(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=_u(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function dO(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=ho(e,n,r),o=ho(e,s,r);return[a,o]}function hO(e,t,r){var n=kk(e);e.l++;var s=e.read_shift(1);return t-=8,[TM(e,t,r),s,n]}function rw(e,t,r){var n=_8(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,kM(e,t,r)]}function pO(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function mO(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),u=To(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},u,o,a]}}function xO(e,t,r){return mO(e,t,r)}function gO(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Gd(e));return r}function vO(e){var t=Ee(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Sk(e[r],t);return t}function yO(e,t,r){if(r&&r.biff<8)return _O(e,t,r);var n=bk(e),s=E8(e,t-22,n[1]);return{cmo:n,ft:s}}var wO={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function _O(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((wO[n]||En)(e,t,r)),{cmo:[s,n,a],ft:o}}function SO(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=f8(e,6,r);var u=e.read_shift(2);e.read_shift(2),$r(e,2);var f=e.read_shift(2);e.l+=f;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var p=e[e.l],m=ho(e,e.lens[d+1]-e.lens[d]-1);if(s+=m,s.length>=(p?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function kO(e,t){var r=Gd(e);e.l+=16;var n=m8(e,t-24);return[r,n]}function bO(e){var t=Ee(24),r=vr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return nn([t,x8(e[1])])}function EO(e,t){e.read_shift(2);var r=Gd(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(kn,""),[r,n]}function TO(e){var t=e[1].Tooltip,r=Ee(10+2*(t.length+1));r.write_shift(2,2048);var n=vr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function CO(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Uy[r]||r,r=e.read_shift(2),t[1]=Uy[r]||r,t}function NO(e){return e||(e=Ee(4)),e.write_shift(2,1),e.write_shift(2,1),e}function AO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(wk(e));return r}function jO(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(wk(e));return r}function DO(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Tk(e,t,r){if(!r.cellStyles)return En(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var d={s,e:a,w:o,ixfe:u,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function FO(e,t){var r=Ee(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function RO(e,t){var r={};return t<32||(e.l+=16,r.header=Sn(e),r.footer=Sn(e),e.l+=2),r}function PO(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function IO(e){for(var t=Ee(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var OO=ha,LO=xk,MO=Su;function BO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function UO(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ha(e);++e.l;var s=To(e,t-7,r);return n.t="str",n.val=s,n}function $O(e){var t=ha(e);++e.l;var r=Sn(e);return t.t="n",t.val=r,t}function zO(e,t,r){var n=Ee(15);return Tu(n,e,t),n.write_shift(8,r,"f"),n}function WO(e){var t=ha(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function VO(e,t,r){var n=Ee(9);return Tu(n,e,t),n.write_shift(2,r),n}function HO(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function GO(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function XO(e,t,r){var n=e.l+t,s=ha(e),a=e.read_shift(2),o=ho(e,a,r);return e.l=n,s.t="str",s.val=o,s}var KO=[2,3,48,49,131,139,140,245],em=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=zd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,f){var d=[],p=yi(1);switch(f.type){case"base64":p=Jn(ts(u));break;case"binary":p=Jn(u);break;case"buffer":case"array":p=u;break}un(p,0);var m=p.read_shift(1),g=!!(m&136),y=!1,w=!1;switch(m){case 2:break;case 3:break;case 48:y=!0,g=!0;break;case 49:y=!0,g=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var v=0,S=521;m==2&&(v=p.read_shift(2)),p.l+=3,m!=2&&(v=p.read_shift(4)),v>1048576&&(v=1e6),m!=2&&(S=p.read_shift(2));var E=p.read_shift(2),A=f.codepage||1252;m!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(A=e[p[p.l]]),p.l+=1,p.l+=2),w&&(p.l+=36);for(var b=[],D={},O=Math.min(p.length,m==2?521:S-10-(y?264:0)),C=w?32:11;p.l<O&&p[p.l]!=13;)switch(D={},D.name=Ot.utils.decode(A,p.slice(p.l,p.l+C)).replace(/[\u0000\r\n].*$/g,""),p.l+=C,D.type=String.fromCharCode(p.read_shift(1)),m!=2&&!w&&(D.offset=p.read_shift(4)),D.len=p.read_shift(1),m==2&&(D.offset=p.read_shift(2)),D.dec=p.read_shift(1),D.name.length&&b.push(D),m!=2&&(p.l+=w?13:14),D.type){case"B":(!y||D.len!=8)&&f.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(p[p.l]!==13&&(p.l=S-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=S;var T=0,U=0;for(d[0]=[],U=0;U!=b.length;++U)d[0][U]=b[U].name;for(;v-- >0;){if(p[p.l]===42){p.l+=E;continue}for(++p.l,d[++T]=[],U=0,U=0;U!=b.length;++U){var z=p.slice(p.l,p.l+b[U].len);p.l+=b[U].len,un(z,0);var Z=Ot.utils.decode(A,z);switch(b[U].type){case"C":Z.trim().length&&(d[T][U]=Z.replace(/\s+$/,""));break;case"D":Z.length===8?d[T][U]=new Date(+Z.slice(0,4),+Z.slice(4,6)-1,+Z.slice(6,8)):d[T][U]=Z;break;case"F":d[T][U]=parseFloat(Z.trim());break;case"+":case"I":d[T][U]=w?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(Z.trim().toUpperCase()){case"Y":case"T":d[T][U]=!0;break;case"N":case"F":d[T][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Z+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[T][U]="##MEMO##"+(w?parseInt(Z.trim(),10):z.read_shift(4));break;case"N":Z=Z.replace(/\u0000/g,"").trim(),Z&&Z!="."&&(d[T][U]=+Z||0);break;case"@":d[T][U]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":d[T][U]=new Date((z.read_shift(4)-2440588)*864e5+z.read_shift(4));break;case"Y":d[T][U]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[T][U]=-z.read_shift(-8,"f");break;case"B":if(y&&b[U].len==8){d[T][U]=z.read_shift(8,"f");break}case"G":case"P":z.l+=b[U].len;break;case"0":if(b[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[U].type)}}}if(m!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=b,d}function n(u,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var p=Ul(r(u,d),d);return p["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,p}function s(u,f){try{return Ci(n(u,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,f){var d=f||{};if(+d.codepage>=0&&xs(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var p=Vn(),m=Cd(u,{header:1,raw:!0,cellDates:!0}),g=m[0],y=m.slice(1),w=u["!cols"]||[],v=0,S=0,E=0,A=1;for(v=0;v<g.length;++v){if(((w[v]||{}).DBF||{}).name){g[v]=w[v].DBF.name,++E;continue}if(g[v]!=null){if(++E,typeof g[v]=="number"&&(g[v]=g[v].toString(10)),typeof g[v]!="string")throw new Error("DBF Invalid column name "+g[v]+" |"+typeof g[v]+"|");if(g.indexOf(g[v])!==v){for(S=0;S<1024;++S)if(g.indexOf(g[v]+"_"+S)==-1){g[v]+="_"+S;break}}}}var b=Rt(u["!ref"]),D=[],O=[],C=[];for(v=0;v<=b.e.c-b.s.c;++v){var T="",U="",z=0,Z=[];for(S=0;S<y.length;++S)y[S][v]!=null&&Z.push(y[S][v]);if(Z.length==0||g[v]==null){D[v]="?";continue}for(S=0;S<Z.length;++S){switch(typeof Z[S]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=Z[S]instanceof Date?"D":"C";break;default:U="C"}z=Math.max(z,String(Z[S]).length),T=T&&T!=U?"C":U}z>250&&(z=250),U=((w[v]||{}).DBF||{}).type,U=="C"&&w[v].DBF.len>z&&(z=w[v].DBF.len),T=="B"&&U=="N"&&(T="N",C[v]=w[v].DBF.dec,z=w[v].DBF.len),O[v]=T=="C"||U=="N"?z:a[T]||0,A+=O[v],D[v]=T}var re=p.next(32);for(re.write_shift(4,318902576),re.write_shift(4,y.length),re.write_shift(2,296+32*E),re.write_shift(2,A),v=0;v<4;++v)re.write_shift(4,0);for(re.write_shift(4,0|(+t[lo]||3)<<8),v=0,S=0;v<g.length;++v)if(g[v]!=null){var P=p.next(32),se=(g[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,se,"sbcs"),P.write_shift(1,D[v]=="?"?"C":D[v],"sbcs"),P.write_shift(4,S),P.write_shift(1,O[v]||a[D[v]]||0),P.write_shift(1,C[v]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),S+=O[v]||a[D[v]]||0}var me=p.next(264);for(me.write_shift(4,13),v=0;v<65;++v)me.write_shift(4,0);for(v=0;v<y.length;++v){var ce=p.next(A);for(ce.write_shift(1,0),S=0;S<g.length;++S)if(g[S]!=null)switch(D[S]){case"L":ce.write_shift(1,y[v][S]==null?63:y[v][S]?84:70);break;case"B":ce.write_shift(8,y[v][S]||0,"f");break;case"N":var fe="0";for(typeof y[v][S]=="number"&&(fe=y[v][S].toFixed(C[S]||0)),E=0;E<O[S]-fe.length;++E)ce.write_shift(1,32);ce.write_shift(1,fe,"sbcs");break;case"D":y[v][S]?(ce.write_shift(4,("0000"+y[v][S].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(y[v][S].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+y[v][S].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var de=String(y[v][S]!=null?y[v][S]:"").slice(0,O[S]);for(ce.write_shift(1,de,"sbcs"),E=0;E<O[S]-de.length;++E)ce.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}})(),Ck=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Nr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,y){var w=e[y];return typeof w=="number"?Gp(w):w},n=function(g,y,w){var v=y.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return v==59?g:Gp(v)};e["|"]=254;function s(g,y){switch(y.type){case"base64":return a(ts(g),y);case"binary":return a(g,y);case"buffer":return a(_t&&Buffer.isBuffer(g)?g.toString("binary"):Ti(g),y);case"array":return a(uo(g),y)}throw new Error("Unrecognized type "+y.type)}function a(g,y){var w=g.split(/[\n\r]+/),v=-1,S=-1,E=0,A=0,b=[],D=[],O=null,C={},T=[],U=[],z=[],Z=0,re;for(+y.codepage>=0&&xs(+y.codepage);E!==w.length;++E){Z=0;var P=w[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),se=P.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),me=se[0],ce;if(P.length>0)switch(me){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":se[1].charAt(0)=="P"&&D.push(P.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,de=!1,he=!1,Q=!1,ee=-1,V=-1;for(A=1;A<se.length;++A)switch(se[A].charAt(0)){case"A":break;case"X":S=parseInt(se[A].slice(1))-1,de=!0;break;case"Y":for(v=parseInt(se[A].slice(1))-1,de||(S=0),re=b.length;re<=v;++re)b[re]=[];break;case"K":ce=se[A].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(Ps(ce))?isNaN(Al(ce).getDate())||(ce=fr(ce)):(ce=Ps(ce),O!==null&&wo(O)&&(ce=Vd(ce))),typeof Ot<"u"&&typeof ce=="string"&&(y||{}).type!="string"&&(y||{}).codepage&&(ce=Ot.utils.decode(y.codepage,ce)),fe=!0;break;case"E":Q=!0;var F=Sl(se[A].slice(1),{r:v,c:S});b[v][S]=[b[v][S],F];break;case"S":he=!0,b[v][S]=[b[v][S],"S5S"];break;case"G":break;case"R":ee=parseInt(se[A].slice(1))-1;break;case"C":V=parseInt(se[A].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+P)}if(fe&&(b[v][S]&&b[v][S].length==2?b[v][S][0]=ce:b[v][S]=ce,O=null),he){if(Q)throw new Error("SYLK shared formula cannot have own formula");var N=ee>-1&&b[ee][V];if(!N||!N[1])throw new Error("SYLK shared formula cannot find base");b[v][S][1]=Hk(N[1],{r:v-ee,c:S-V})}break;case"F":var L=0;for(A=1;A<se.length;++A)switch(se[A].charAt(0)){case"X":S=parseInt(se[A].slice(1))-1,++L;break;case"Y":for(v=parseInt(se[A].slice(1))-1,re=b.length;re<=v;++re)b[re]=[];break;case"M":Z=parseInt(se[A].slice(1))/20;break;case"F":break;case"G":break;case"P":O=D[parseInt(se[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(z=se[A].slice(1).split(" "),re=parseInt(z[0],10);re<=parseInt(z[1],10);++re)Z=parseInt(z[2],10),U[re-1]=Z===0?{hidden:!0}:{wch:Z},wi(U[re-1]);break;case"C":S=parseInt(se[A].slice(1))-1,U[S]||(U[S]={});break;case"R":v=parseInt(se[A].slice(1))-1,T[v]||(T[v]={}),Z>0?(T[v].hpt=Z,T[v].hpx=Dl(Z)):Z===0&&(T[v].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+P)}L<1&&(O=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+P)}}return T.length>0&&(C["!rows"]=T),U.length>0&&(C["!cols"]=U),y&&y.sheetRows&&(b=b.slice(0,y.sheetRows)),[b,C]}function o(g,y){var w=s(g,y),v=w[0],S=w[1],E=Ul(v,y);return Nr(S).forEach(function(A){E[A]=S[A]}),E}function u(g,y){return Ci(o(g,y),y)}function f(g,y,w,v){var S="C;Y"+(w+1)+";X"+(v+1)+";K";switch(g.t){case"n":S+=g.v||0,g.f&&!g.F&&(S+=";E"+dx(g.f,{r:w,c:v}));break;case"b":S+=g.v?"TRUE":"FALSE";break;case"e":S+=g.w||g.v;break;case"d":S+='"'+(g.w||g.v)+'"';break;case"s":S+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(g,y){y.forEach(function(w,v){var S="F;W"+(v+1)+" "+(v+1)+" ";w.hidden?S+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=iu(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=ou(w.wpx)),typeof w.wch=="number"&&(S+=Math.round(w.wch))),S.charAt(S.length-1)!=" "&&g.push(S)})}function p(g,y){y.forEach(function(w,v){var S="F;";w.hidden?S+="M0;":w.hpt?S+="M"+20*w.hpt+";":w.hpx&&(S+="M"+20*lu(w.hpx)+";"),S.length>2&&g.push(S+"R"+(v+1))})}function m(g,y){var w=["ID;PWXL;N;E"],v=[],S=Rt(g["!ref"]),E,A=Array.isArray(g),b=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),g["!cols"]&&d(w,g["!cols"]),g["!rows"]&&p(w,g["!rows"]),w.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var D=S.s.r;D<=S.e.r;++D)for(var O=S.s.c;O<=S.e.c;++O){var C=ut({r:D,c:O});E=A?(g[D]||[])[O]:g[C],!(!E||E.v==null&&(!E.f||E.F))&&v.push(f(E,g,D,O))}return w.join(b)+b+v.join(b)+b+"E"+b}return{to_workbook:u,to_sheet:o,from_sheet:m}})(),Nk=(function(){function e(a,o){switch(o.type){case"base64":return t(ts(a),o);case"binary":return t(a,o);case"buffer":return t(_t&&Buffer.isBuffer(a)?a.toString("binary"):Ti(a),o);case"array":return t(uo(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var u=a.split(`
`),f=-1,d=-1,p=0,m=[];p!==u.length;++p){if(u[p].trim()==="BOT"){m[++f]=[],d=0;continue}if(!(f<0)){var g=u[p].trim().split(","),y=g[0],w=g[1];++p;for(var v=u[p]||"";(v.match(/["]/g)||[]).length&1&&p<u.length-1;)v+=`
`+u[++p];switch(v=v.trim(),+y){case-1:if(v==="BOT"){m[++f]=[],d=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?m[f][d]=!0:v==="FALSE"?m[f][d]=!1:isNaN(Ps(w))?isNaN(Al(w).getDate())?m[f][d]=w:m[f][d]=fr(w):m[f][d]=Ps(w),++d;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),m[f][d++]=v!==""?v:null;break}if(v==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(a,o){return Ul(e(a,o),o)}function n(a,o){return Ci(r(a,o),o)}var s=(function(){var a=function(f,d,p,m,g){f.push(d),f.push(p+","+m),f.push('"'+g.replace(/"/g,'""')+'"')},o=function(f,d,p,m){f.push(d+","+p),f.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var d=[],p=Rt(f["!ref"]),m,g=Array.isArray(f);a(d,"TABLE",0,1,"sheetjs"),a(d,"VECTORS",0,p.e.r-p.s.r+1,""),a(d,"TUPLES",0,p.e.c-p.s.c+1,""),a(d,"DATA",0,0,"");for(var y=p.s.r;y<=p.e.r;++y){o(d,-1,0,"BOT");for(var w=p.s.c;w<=p.e.c;++w){var v=ut({r:y,c:w});if(m=g?(f[y]||[])[w]:f[v],!m){o(d,1,0,"");continue}switch(m.t){case"n":var S=m.w;!S&&m.v!=null&&(S=m.v),S==null?m.f&&!m.F?o(d,1,0,"="+m.f):o(d,1,0,""):o(d,0,S,"V");break;case"b":o(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=rs(m.z||st[14],Kr(fr(m.v)))),o(d,0,m.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var E=`\r
`,A=d.join(E);return A}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),Ak=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,g){for(var y=m.split(`
`),w=-1,v=-1,S=0,E=[];S!==y.length;++S){var A=y[S].trim().split(":");if(A[0]==="cell"){var b=vr(A[1]);if(E.length<=b.r)for(w=E.length;w<=b.r;++w)E[w]||(E[w]=[]);switch(w=b.r,v=b.c,A[2]){case"t":E[w][v]=e(A[3]);break;case"v":E[w][v]=+A[3];break;case"vtf":var D=A[A.length-1];case"vtc":switch(A[3]){case"nl":E[w][v]=!!+A[4];break;default:E[w][v]=+A[4];break}A[2]=="vtf"&&(E[w][v]=[E[w][v],D])}}}return g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),E}function n(m,g){return Ul(r(m,g),g)}function s(m,g){return Ci(n(m,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var g=[],y=[],w,v="",S=Pn(m["!ref"]),E=Array.isArray(m),A=S.s.r;A<=S.e.r;++A)for(var b=S.s.c;b<=S.e.c;++b)if(v=ut({r:A,c:b}),w=E?(m[A]||[])[b]:m[v],!(!w||w.v==null||w.t==="z")){switch(y=["cell",v,"t"],w.t){case"s":case"str":y.push(t(w.v));break;case"n":w.f?(y[2]="vtf",y[3]="n",y[4]=w.v,y[5]=t(w.f)):(y[2]="v",y[3]=w.v);break;case"b":y[2]="vt"+(w.f?"f":"c"),y[3]="nl",y[4]=w.v?"1":"0",y[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var D=Kr(fr(w.v));y[2]="vtc",y[3]="nd",y[4]=""+D,y[5]=w.w||rs(w.z||st[14],D);break;case"e":continue}g.push(y.join(":"))}return g.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function p(m){return[a,o,u,o,d(m),f].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:p}})(),jl=(function(){function e(p,m,g,y,w){w.raw?m[g][y]=p:p===""||(p==="TRUE"?m[g][y]=!0:p==="FALSE"?m[g][y]=!1:isNaN(Ps(p))?isNaN(Al(p).getDate())?m[g][y]=p:m[g][y]=fr(p):m[g][y]=Ps(p))}function t(p,m){var g=m||{},y=[];if(!p||p.length===0)return y;for(var w=p.split(/[\r\n]/),v=w.length-1;v>=0&&w[v].length===0;)--v;for(var S=10,E=0,A=0;A<=v;++A)E=w[A].indexOf(" "),E==-1?E=w[A].length:E++,S=Math.max(S,E);for(A=0;A<=v;++A){y[A]=[];var b=0;for(e(w[A].slice(0,S).trim(),y,A,b,g),b=1;b<=(w[A].length-S)/10+1;++b)e(w[A].slice(S+(b-1)*10,S+b*10).trim(),y,A,b,g)}return g.sheetRows&&(y=y.slice(0,g.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(p){for(var m={},g=!1,y=0,w=0;y<p.length;++y)(w=p.charCodeAt(y))==34?g=!g:!g&&w in r&&(m[w]=(m[w]||0)+1);w=[];for(y in m)Object.prototype.hasOwnProperty.call(m,y)&&w.push([m[y],y]);if(!w.length){m=n;for(y in m)Object.prototype.hasOwnProperty.call(m,y)&&w.push([m[y],y])}return w.sort(function(v,S){return v[0]-S[0]||n[v[1]]-n[S[1]]}),r[w.pop()[1]]||44}function a(p,m){var g=m||{},y="",w=g.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(y=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(y=p.charAt(4),p=p.slice(6)):y=s(p.slice(0,1024)):g&&g.FS?y=g.FS:y=s(p.slice(0,1024));var S=0,E=0,A=0,b=0,D=0,O=y.charCodeAt(0),C=!1,T=0,U=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var z=g.dateNF!=null?RP(g.dateNF):null;function Z(){var re=p.slice(b,D),P={};if(re.charAt(0)=='"'&&re.charAt(re.length-1)=='"'&&(re=re.slice(1,-1).replace(/""/g,'"')),re.length===0)P.t="z";else if(g.raw)P.t="s",P.v=re;else if(re.trim().length===0)P.t="s",P.v=re;else if(re.charCodeAt(0)==61)re.charCodeAt(1)==34&&re.charCodeAt(re.length-1)==34?(P.t="s",P.v=re.slice(2,-1).replace(/""/g,'"')):cL(re)?(P.t="n",P.f=re.slice(1)):(P.t="s",P.v=re);else if(re=="TRUE")P.t="b",P.v=!0;else if(re=="FALSE")P.t="b",P.v=!1;else if(!isNaN(A=Ps(re)))P.t="n",g.cellText!==!1&&(P.w=re),P.v=A;else if(!isNaN(Al(re).getDate())||z&&re.match(z)){P.z=g.dateNF||st[14];var se=0;z&&re.match(z)&&(re=PP(re,g.dateNF,re.match(z)||[]),se=1),g.cellDates?(P.t="d",P.v=fr(re,se)):(P.t="n",P.v=Kr(fr(re,se))),g.cellText!==!1&&(P.w=rs(P.z,P.v instanceof Date?Kr(P.v):P.v)),g.cellNF||delete P.z}else P.t="s",P.v=re;if(P.t=="z"||(g.dense?(w[S]||(w[S]=[]),w[S][E]=P):w[ut({c:E,r:S})]=P),b=D+1,U=p.charCodeAt(b),v.e.c<E&&(v.e.c=E),v.e.r<S&&(v.e.r=S),T==O)++E;else if(E=0,++S,g.sheetRows&&g.sheetRows<=S)return!0}e:for(;D<p.length;++D)switch(T=p.charCodeAt(D)){case 34:U===34&&(C=!C);break;case O:case 10:case 13:if(!C&&Z())break e;break}return D-b>0&&Z(),w["!ref"]=vt(v),w}function o(p,m){return!(m&&m.PRN)||m.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?a(p,m):Ul(t(p,m),m)}function u(p,m){var g="",y=m.type=="string"?[0,0,0,0]:_x(p,m);switch(m.type){case"base64":g=ts(p);break;case"binary":g=p;break;case"buffer":m.codepage==65001?g=p.toString("utf8"):m.codepage&&typeof Ot<"u"?g=Ot.utils.decode(m.codepage,p):g=_t&&Buffer.isBuffer(p)?p.toString("binary"):Ti(p);break;case"array":g=uo(p);break;case"string":g=p;break;default:throw new Error("Unrecognized type "+m.type)}return y[0]==239&&y[1]==187&&y[2]==191?g=Xt(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=Xt(g):m.type=="binary"&&typeof Ot<"u"&&m.codepage&&(g=Ot.utils.decode(m.codepage,Ot.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?Ak.to_sheet(m.type=="string"?g:Xt(g),m):o(g,m)}function f(p,m){return Ci(u(p,m),m)}function d(p){for(var m=[],g=Rt(p["!ref"]),y,w=Array.isArray(p),v=g.s.r;v<=g.e.r;++v){for(var S=[],E=g.s.c;E<=g.e.c;++E){var A=ut({r:v,c:E});if(y=w?(p[v]||[])[E]:p[A],!y||y.v==null){S.push("          ");continue}for(var b=(y.w||(ua(y),y.w)||"").slice(0,10);b.length<10;)b+=" ";S.push(b+(E===0?" ":""))}m.push(S.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:d}})();function qO(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=Ck.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return jl.to_workbook(e,t)}}var Zi=(function(){function e(F,N,L){if(F){un(F,F.l||0);for(var B=L.Enum||ee;F.l<F.length;){var q=F.read_shift(2),ne=B[q]||B[65535],Y=F.read_shift(2),oe=F.l+Y,le=ne.f&&ne.f(F,Y,L);if(F.l=oe,N(le,ne,q))return}}}function t(F,N){switch(N.type){case"base64":return r(Jn(ts(F)),N);case"binary":return r(Jn(F),N);case"buffer":case"array":return r(F,N)}throw"Unsupported type "+N.type}function r(F,N){if(!F)return F;var L=N||{},B=L.dense?[]:{},q="Sheet1",ne="",Y=0,oe={},le=[],te=[],I={s:{r:0,c:0},e:{r:0,c:0}},Ce=L.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)L.Enum=ee,e(F,function(_e,je,Ke){switch(Ke){case 0:L.vers=_e,_e>=4096&&(L.qpro=!0);break;case 6:I=_e;break;case 204:_e&&(ne=_e);break;case 222:ne=_e;break;case 15:case 51:L.qpro||(_e[1].v=_e[1].v.slice(1));case 13:case 14:case 16:Ke==14&&(_e[2]&112)==112&&(_e[2]&15)>1&&(_e[2]&15)<15&&(_e[1].z=L.dateNF||st[14],L.cellDates&&(_e[1].t="d",_e[1].v=Vd(_e[1].v))),L.qpro&&_e[3]>Y&&(B["!ref"]=vt(I),oe[q]=B,le.push(q),B=L.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},Y=_e[3],q=ne||"Sheet"+(Y+1),ne="");var ot=L.dense?(B[_e[0].r]||[])[_e[0].c]:B[ut(_e[0])];if(ot){ot.t=_e[1].t,ot.v=_e[1].v,_e[1].z!=null&&(ot.z=_e[1].z),_e[1].f!=null&&(ot.f=_e[1].f);break}L.dense?(B[_e[0].r]||(B[_e[0].r]=[]),B[_e[0].r][_e[0].c]=_e[1]):B[ut(_e[0])]=_e[1];break}},L);else if(F[2]==26||F[2]==14)L.Enum=V,F[2]==14&&(L.qpro=!0,F.l=0),e(F,function(_e,je,Ke){switch(Ke){case 204:q=_e;break;case 22:_e[1].v=_e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(_e[3]>Y&&(B["!ref"]=vt(I),oe[q]=B,le.push(q),B=L.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},Y=_e[3],q="Sheet"+(Y+1)),Ce>0&&_e[0].r>=Ce)break;L.dense?(B[_e[0].r]||(B[_e[0].r]=[]),B[_e[0].r][_e[0].c]=_e[1]):B[ut(_e[0])]=_e[1],I.e.c<_e[0].c&&(I.e.c=_e[0].c),I.e.r<_e[0].r&&(I.e.r=_e[0].r);break;case 27:_e[14e3]&&(te[_e[14e3][0]]=_e[14e3][1]);break;case 1537:te[_e[0]]=_e[1],_e[0]==Y&&(q=_e[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(B["!ref"]=vt(I),oe[ne||q]=B,le.push(ne||q),!te.length)return{SheetNames:le,Sheets:oe};for(var Ie={},ue=[],ge=0;ge<te.length;++ge)oe[le[ge]]?(ue.push(te[ge]||le[ge]),Ie[te[ge]]=oe[te[ge]]||oe[le[ge]]):(ue.push(te[ge]),Ie[te[ge]]={"!ref":"A1"});return{SheetNames:ue,Sheets:Ie}}function n(F,N){var L=N||{};if(+L.codepage>=0&&xs(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Vn(),q=Rt(F["!ref"]),ne=Array.isArray(F),Y=[];Ue(B,0,a(1030)),Ue(B,6,f(q));for(var oe=Math.min(q.e.r,8191),le=q.s.r;le<=oe;++le)for(var te=Tr(le),I=q.s.c;I<=q.e.c;++I){le===q.s.r&&(Y[I]=ur(I));var Ce=Y[I]+te,Ie=ne?(F[le]||[])[I]:F[Ce];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")(Ie.v|0)==Ie.v&&Ie.v>=-32768&&Ie.v<=32767?Ue(B,13,y(le,I,Ie.v)):Ue(B,14,v(le,I,Ie.v));else{var ue=ua(Ie);Ue(B,15,m(le,I,ue.slice(0,239)))}}return Ue(B,1),B.end()}function s(F,N){var L=N||{};if(+L.codepage>=0&&xs(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Vn();Ue(B,0,o(F));for(var q=0,ne=0;q<F.SheetNames.length;++q)(F.Sheets[F.SheetNames[q]]||{})["!ref"]&&Ue(B,27,Q(F.SheetNames[q],ne++));var Y=0;for(q=0;q<F.SheetNames.length;++q){var oe=F.Sheets[F.SheetNames[q]];if(!(!oe||!oe["!ref"])){for(var le=Rt(oe["!ref"]),te=Array.isArray(oe),I=[],Ce=Math.min(le.e.r,8191),Ie=le.s.r;Ie<=Ce;++Ie)for(var ue=Tr(Ie),ge=le.s.c;ge<=le.e.c;++ge){Ie===le.s.r&&(I[ge]=ur(ge));var _e=I[ge]+ue,je=te?(oe[Ie]||[])[ge]:oe[_e];if(!(!je||je.t=="z"))if(je.t=="n")Ue(B,23,Z(Ie,ge,Y,je.v));else{var Ke=ua(je);Ue(B,22,T(Ie,ge,Y,Ke.slice(0,239)))}}++Y}}return Ue(B,1),B.end()}function a(F){var N=Ee(2);return N.write_shift(2,F),N}function o(F){var N=Ee(26);N.write_shift(2,4096),N.write_shift(2,4),N.write_shift(4,0);for(var L=0,B=0,q=0,ne=0;ne<F.SheetNames.length;++ne){var Y=F.SheetNames[ne],oe=F.Sheets[Y];if(!(!oe||!oe["!ref"])){++q;var le=Pn(oe["!ref"]);L<le.e.r&&(L=le.e.r),B<le.e.c&&(B=le.e.c)}}return L>8191&&(L=8191),N.write_shift(2,L),N.write_shift(1,q),N.write_shift(1,B),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(1,1),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(4,0),N}function u(F,N,L){var B={s:{c:0,r:0},e:{c:0,r:0}};return N==8&&L.qpro?(B.s.c=F.read_shift(1),F.l++,B.s.r=F.read_shift(2),B.e.c=F.read_shift(1),F.l++,B.e.r=F.read_shift(2),B):(B.s.c=F.read_shift(2),B.s.r=F.read_shift(2),N==12&&L.qpro&&(F.l+=2),B.e.c=F.read_shift(2),B.e.r=F.read_shift(2),N==12&&L.qpro&&(F.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function f(F){var N=Ee(8);return N.write_shift(2,F.s.c),N.write_shift(2,F.s.r),N.write_shift(2,F.e.c),N.write_shift(2,F.e.r),N}function d(F,N,L){var B=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(B[0].c=F.read_shift(1),B[3]=F.read_shift(1),B[0].r=F.read_shift(2),F.l+=2):(B[2]=F.read_shift(1),B[0].c=F.read_shift(2),B[0].r=F.read_shift(2)),B}function p(F,N,L){var B=F.l+N,q=d(F,N,L);if(q[1].t="s",L.vers==20768){F.l++;var ne=F.read_shift(1);return q[1].v=F.read_shift(ne,"utf8"),q}return L.qpro&&F.l++,q[1].v=F.read_shift(B-F.l,"cstr"),q}function m(F,N,L){var B=Ee(7+L.length);B.write_shift(1,255),B.write_shift(2,N),B.write_shift(2,F),B.write_shift(1,39);for(var q=0;q<B.length;++q){var ne=L.charCodeAt(q);B.write_shift(1,ne>=128?95:ne)}return B.write_shift(1,0),B}function g(F,N,L){var B=d(F,N,L);return B[1].v=F.read_shift(2,"i"),B}function y(F,N,L){var B=Ee(7);return B.write_shift(1,255),B.write_shift(2,N),B.write_shift(2,F),B.write_shift(2,L,"i"),B}function w(F,N,L){var B=d(F,N,L);return B[1].v=F.read_shift(8,"f"),B}function v(F,N,L){var B=Ee(13);return B.write_shift(1,255),B.write_shift(2,N),B.write_shift(2,F),B.write_shift(8,L,"f"),B}function S(F,N,L){var B=F.l+N,q=d(F,N,L);if(q[1].v=F.read_shift(8,"f"),L.qpro)F.l=B;else{var ne=F.read_shift(2);D(F.slice(F.l,F.l+ne),q),F.l+=ne}return q}function E(F,N,L){var B=N&32768;return N&=-32769,N=(B?F:0)+(N>=8192?N-16384:N),(B?"":"$")+(L?ur(N):Tr(N))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(F,N){un(F,0);for(var L=[],B=0,q="",ne="",Y="",oe="";F.l<F.length;){var le=F[F.l++];switch(le){case 0:L.push(F.read_shift(8,"f"));break;case 1:ne=E(N[0].c,F.read_shift(2),!0),q=E(N[0].r,F.read_shift(2),!1),L.push(ne+q);break;case 2:{var te=E(N[0].c,F.read_shift(2),!0),I=E(N[0].r,F.read_shift(2),!1);ne=E(N[0].c,F.read_shift(2),!0),q=E(N[0].r,F.read_shift(2),!1),L.push(te+I+":"+ne+q)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(F.read_shift(2));break;case 6:{for(var Ce="";le=F[F.l++];)Ce+=String.fromCharCode(le);L.push('"'+Ce.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:oe=L.pop(),Y=L.pop(),L.push(["AND","OR"][le-20]+"("+Y+","+oe+")");break;default:if(le<32&&b[le])oe=L.pop(),Y=L.pop(),L.push(Y+b[le]+oe);else if(A[le]){if(B=A[le][1],B==69&&(B=F[F.l++]),B>L.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+L.join("|")+"|");return}var Ie=L.slice(-B);L.length-=B,L.push(A[le][0]+"("+Ie.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}L.length==1?N[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function O(F){var N=[{c:0,r:0},{t:"n",v:0},0];return N[0].r=F.read_shift(2),N[3]=F[F.l++],N[0].c=F[F.l++],N}function C(F,N){var L=O(F);return L[1].t="s",L[1].v=F.read_shift(N-4,"cstr"),L}function T(F,N,L,B){var q=Ee(6+B.length);q.write_shift(2,F),q.write_shift(1,L),q.write_shift(1,N),q.write_shift(1,39);for(var ne=0;ne<B.length;++ne){var Y=B.charCodeAt(ne);q.write_shift(1,Y>=128?95:Y)}return q.write_shift(1,0),q}function U(F,N){var L=O(F);L[1].v=F.read_shift(2);var B=L[1].v>>1;if(L[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return L[1].v=B,L}function z(F,N){var L=O(F),B=F.read_shift(4),q=F.read_shift(4),ne=F.read_shift(2);if(ne==65535)return B===0&&q===3221225472?(L[1].t="e",L[1].v=15):B===0&&q===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var Y=ne&32768;return ne=(ne&32767)-16446,L[1].v=(1-Y*2)*(q*Math.pow(2,ne+32)+B*Math.pow(2,ne)),L}function Z(F,N,L,B){var q=Ee(14);if(q.write_shift(2,F),q.write_shift(1,L),q.write_shift(1,N),B==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var ne=0,Y=0,oe=0,le=0;return B<0&&(ne=1,B=-B),Y=Math.log2(B)|0,B/=Math.pow(2,Y-31),le=B>>>0,(le&2147483648)==0&&(B/=2,++Y,le=B>>>0),B-=le,le|=2147483648,le>>>=0,B*=Math.pow(2,32),oe=B>>>0,q.write_shift(4,oe),q.write_shift(4,le),Y+=16383+(ne?32768:0),q.write_shift(2,Y),q}function re(F,N){var L=z(F);return F.l+=N-14,L}function P(F,N){var L=O(F),B=F.read_shift(4);return L[1].v=B>>6,L}function se(F,N){var L=O(F),B=F.read_shift(8,"f");return L[1].v=B,L}function me(F,N){var L=se(F);return F.l+=N-10,L}function ce(F,N){return F[F.l+N-1]==0?F.read_shift(N,"cstr"):""}function fe(F,N){var L=F[F.l++];L>N-1&&(L=N-1);for(var B="";B.length<L;)B+=String.fromCharCode(F[F.l++]);return B}function de(F,N,L){if(!(!L.qpro||N<21)){var B=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var q=F.read_shift(N-21,"cstr");return[B,q]}}function he(F,N){for(var L={},B=F.l+N;F.l<B;){var q=F.read_shift(2);if(q==14e3){for(L[q]=[0,""],L[q][0]=F.read_shift(2);F[F.l];)L[q][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return L}function Q(F,N){var L=Ee(5+F.length);L.write_shift(2,14e3),L.write_shift(2,N);for(var B=0;B<F.length;++B){var q=F.charCodeAt(B);L[L.l++]=q>127?95:q}return L[L.l++]=0,L}var ee={0:{n:"BOF",f:$r},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},V={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:C},23:{n:"NUMBER17",f:z},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:re},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:he},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:se},40:{n:"FORMULA28",f:me},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function YO(e){var t={},r=e.match(Tn),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=dt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Im[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var JO=(function(){var e=tu("t"),t=tu("rPr");function r(a){var o=a.match(e);if(!o)return{t:"s",v:""};var u={t:"s",v:Bt(o[1])},f=a.match(t);return f&&(u.s=YO(f[1])),u}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(u){return u.v})}})(),QO=(function(){var t=/(\r\n|\n)/g;function r(s,a,o){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),a.push('<span style="'+u.join("")+'">'),s.b&&(a.push("<b>"),o.push("</b>")),s.i&&(a.push("<i>"),o.push("</i>")),s.strike&&(a.push("<s>"),o.push("</s>"));var f=s.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(a.push("<"+f+">"),o.push("</"+f+">")),o.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),ZO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,e6=/<(?:\w+:)?r>/,t6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ox(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Bt(Xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Xt(e),r&&(n.h=Wm(n.t))):e.match(e6)&&(n.r=Xt(e),n.t=Bt(Xt((e.replace(t6,"").match(ZO)||[]).join("").replace(Tn,""))),r&&(n.h=QO(JO(n.r)))),n):{t:""}}var r6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,n6=/<(?:\w+:)?(?:si|sstItem)>/g,s6=/<\/(?:\w+:)?(?:si|sstItem)>/;function a6(e,t){var r=[],n="";if(!e)return r;var s=e.match(r6);if(s){n=s[2].replace(n6,"").split(s6);for(var a=0;a!=n.length;++a){var o=ox(n[a].trim(),t);o!=null&&(r[r.length]=o)}s=dt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var i6=/^\s|\s$|[\t\n\r]/;function jk(e,t){if(!t.bookSST)return"";var r=[Or];r[r.length]=Be("sst",null,{xmlns:_o[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(i6)&&(a+=' xml:space="preserve"'),a+=">"+Gt(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function o6(e){return[e.read_shift(4),e.read_shift(4)]}function l6(e,t){var r=[],n=!1;return Pa(e,function(a,o,u){switch(u){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function c6(e,t){return t||(t=Ee(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var u6=wI;function f6(e){var t=Vn();Ne(t,159,c6(e));for(var r=0;r<e.length;++r)Ne(t,19,u6(e[r]));return Ne(t,160),t.end()}function Dk(e){if(typeof Ot<"u")return Ot.utils.encode(lo,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ca(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function d6(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ca(e,4),t.U=Ca(e,4),t.W=Ca(e,4),t}function h6(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function p6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(h6(e));return t}function m6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function x6(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ca(e,4),t.U=Ca(e,4),t.W=Ca(e,4),t}function g6(e){var t=x6(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Fk(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Rk(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function v6(e){var t=Ca(e);switch(t.Minor){case 2:return[t.Minor,y6(e)];case 3:return[t.Minor,w6()];case 4:return[t.Minor,_6(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function y6(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Fk(e,r),s=Rk(e,e.length-e.l);return{t:"Std",h:n,v:s}}function w6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function _6(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Tn,function(a){var o=dt(a);switch(da(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function S6(e,t){var r={},n=r.EncryptionVersionInfo=Ca(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=Fk(e,s),t-=s,r.EncryptionVerifier=Rk(e,t),r}function k6(e){var t={},r=t.EncryptionVersionInfo=Ca(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function lx(e){var t=0,r,n=Dk(e),s=n.length+1,a,o,u,f,d;for(r=yi(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)o=r[a],u=(t&16384)===0?0:1,f=t<<1&32767,d=u|f,t=d^o;return t^52811}var Pk=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,u){return n(o^u)},a=function(o){for(var u=t[o.length-1],f=104,d=o.length-1;d>=0;--d)for(var p=o[d],m=0;m!=7;++m)p&64&&(u^=r[f]),p*=2,--f;return u};return function(o){for(var u=Dk(o),f=a(u),d=u.length,p=yi(16),m=0;m!=16;++m)p[m]=0;var g,y,w;for((d&1)===1&&(g=f>>8,p[d]=s(e[0],g),--d,g=f&255,y=u[u.length-1],p[d]=s(y,g));d>0;)--d,g=f>>8,p[d]=s(u[d],g),--d,g=f&255,p[d]=s(u[d],g);for(d=15,w=15-u.length;w>0;)g=f>>8,p[d]=s(e[w],g),--d,--w,g=f&255,p[d]=s(u[d],g),--d,--w;return p}})(),b6=function(e,t,r,n,s){s||(s=t),n||(n=Pk(e));var a,o;for(a=0;a!=t.length;++a)o=t[a],o^=n[r],o=(o>>5|o<<3)&255,s[a]=o,++r;return[s,r,n]},E6=function(e){var t=0,r=Pk(e);return function(n){var s=b6("",n,t,r);return t=s[1],s[0]}};function T6(e,t,r,n){var s={key:$r(e),verificationBytes:$r(e)};return r.password&&(s.verifier=lx(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=E6(r.password)),s}function C6(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=k6(e):n.Data=S6(e,t),n}function N6(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?C6(e,t-2,n):T6(e,r.biff>=8?t:t-2,r,n),n}var Ik=(function(){function e(s,a){switch(a.type){case"base64":return t(ts(s),a);case"binary":return t(s,a);case"buffer":return t(_t&&Buffer.isBuffer(s)?s.toString("binary"):Ti(s),a);case"array":return t(uo(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var o=a||{},u=o.dense?[]:{},f=s.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,m){Array.isArray(u)&&(u[m]=[]);for(var g=/\\\w+\b/g,y=0,w,v=-1;w=g.exec(p);){switch(w[0]){case"\\cell":var S=p.slice(y,g.lastIndex-w[0].length);if(S[0]==" "&&(S=S.slice(1)),++v,S.length){var E={v:S,t:"s"};Array.isArray(u)?u[m][v]=E:u[ut({r:m,c:v})]=E}break}y=g.lastIndex}v>d.e.c&&(d.e.c=v)}),u["!ref"]=vt(d),u}function r(s,a){return Ci(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],o=Rt(s["!ref"]),u,f=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){a.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)a.push("\\cellx"+(p+1));for(a.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var m=ut({r:d,c:p});u=f?(s[d]||[])[p]:s[m],!(!u||u.v==null&&(!u.f||u.F))&&(a.push(" "+(u.w||(ua(u),u.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function A6(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function au(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function j6(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),o=s-a;if(o===0)return[0,0,t];var u=0,f=0,d=s+a;switch(f=o/(d>1?2-d:d),s){case t:u=((r-n)/o+6)%6;break;case r:u=(n-t)/o+2;break;case n:u=(t-r)/o+4;break}return[u/6,f,d/2]}function D6(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,o=[a,a,a],u=6*t,f;if(r!==0)switch(u|0){case 0:case 6:f=s*u,o[0]+=s,o[1]+=f;break;case 1:f=s*(2-u),o[0]+=f,o[1]+=s;break;case 2:f=s*(u-2),o[1]+=s,o[2]+=f;break;case 3:f=s*(4-u),o[1]+=f,o[2]+=s;break;case 4:f=s*(u-4),o[2]+=s,o[0]+=f;break;case 5:f=s*(6-u),o[2]+=f,o[0]+=s;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Ed(e,t){if(t===0)return e;var r=j6(A6(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),au(D6(r))}var Ok=6,F6=15,R6=1,_n=Ok;function iu(e){return Math.floor((e+Math.round(128/_n)/256)*_n)}function ou(e){return Math.floor((e-5)/_n*100+.5)/100}function Td(e){return Math.round((e*_n+5)/_n*256)/256}function up(e){return Td(ou(iu(e)))}function cx(e){var t=Math.abs(e-up(e)),r=_n;if(t>.005)for(_n=R6;_n<F6;++_n)Math.abs(e-up(e))<=t&&(t=Math.abs(e-up(e)),r=_n);_n=r}function wi(e){e.width?(e.wpx=iu(e.width),e.wch=ou(e.wpx),e.MDW=_n):e.wpx?(e.wch=ou(e.wpx),e.width=Td(e.wch),e.MDW=_n):typeof e.wch=="number"&&(e.width=Td(e.wch),e.wpx=iu(e.width),e.MDW=_n),e.customWidth&&delete e.customWidth}var P6=96,Lk=P6;function lu(e){return e*96/Lk}function Dl(e){return e*Lk/96}var I6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function O6(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Tn)||[]).forEach(function(o){var u=dt(o);switch(da(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=cr(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=cr(u.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+u[0]+" in borders")}})}function L6(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Tn)||[]).forEach(function(o){var u=dt(o);switch(da(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+u[0]+" in fills")}})}function M6(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Tn)||[]).forEach(function(o){var u=dt(o);switch(da(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=Xt(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?cr(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?cr(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?cr(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?cr(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?cr(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?cr(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?cr(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Im[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=cr(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var f=Ji[s.color.index];s.color.index==81&&(f=Ji[1]),f||(f=Ji[1]),s.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Ed(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+u[0]+" in fonts")}})}function B6(e,t,r){t.NumberFmt=[];for(var n=Nr(st),s=0;s<n.length;++s)t.NumberFmt[n[s]]=st[n[s]];var a=e[0].match(Tn);if(a)for(s=0;s<a.length;++s){var o=dt(a[s]);switch(da(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Bt(Xt(o.formatCode)),f=parseInt(o.numFmtId,10);if(t.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&t.NumberFmt[f]!=null;--f);t.NumberFmt[f]=u}la(u,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function U6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:n,formatCode:Gt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Jf=["numFmtId","fillId","fontId","borderId","xfId"],Qf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function $6(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Tn)||[]).forEach(function(a){var o=dt(a),u=0;switch(da(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<Jf.length;++u)n[Jf[u]]&&(n[Jf[u]]=parseInt(n[Jf[u]],10));for(u=0;u<Qf.length;++u)n[Qf[u]]&&(n[Qf[u]]=cr(n[Qf[u]]));if(t.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[u]){n.numFmtId=u;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};o.vertical&&(f.vertical=o.vertical),o.horizontal&&(f.horizontal=o.horizontal),o.textRotation!=null&&(f.textRotation=o.textRotation),o.indent&&(f.indent=o.indent),o.wrapText&&(f.wrapText=cr(o.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function z6(e){var t=[];return t[t.length]=Be("cellXfs",null),e.forEach(function(r){t[t.length]=Be("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var W6=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,d){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=u.match(t))&&B6(m,p,d),(m=u.match(s))&&M6(m,p,f,d),(m=u.match(n))&&L6(m,p,f,d),(m=u.match(a))&&O6(m,p,f,d),(m=u.match(r))&&$6(m,p,d),p}})();function Mk(e,t){var r=[Or,Be("styleSheet",null,{xmlns:_o[0],"xmlns:vt":Xr.vt})],n;return e.SSF&&(n=U6(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=z6(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function V6(e,t){var r=e.read_shift(2),n=bn(e);return[r,n]}function H6(e,t,r){r||(r=Ee(6+4*t.length)),r.write_shift(2,e),sn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function G6(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=CI(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var u=e.read_shift(1);u>0&&(n.family=u);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=TI(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=bn(e),n}function X6(e,t){t||(t=Ee(153)),t.write_shift(2,e.sz*20),NI(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Sd(e.color,t);var n=0;return n=2,t.write_shift(1,n),sn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var K6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],fp,q6=En;function nw(e,t){t||(t=Ee(84)),fp||(fp=zd(K6));var r=fp[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Sd({auto:1},t),Sd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Y6(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function Bk(e,t,r){r||(r=Ee(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ec(e,t){return t||(t=Ee(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var J6=En;function Q6(e,t){return t||(t=Ee(51)),t.write_shift(1,0),Ec(null,t),Ec(null,t),Ec(null,t),Ec(null,t),Ec(null,t),t.length>t.l?t.slice(0,t.l):t}function Z6(e,t){return t||(t=Ee(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),_d(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function e5(e,t,r){var n=Ee(2052);return n.write_shift(4,e),_d(t,n),_d(r,n),n.length>n.l?n.slice(0,n.l):n}function t5(e,t,r){var n={};n.NumberFmt=[];for(var s in st)n.NumberFmt[s]=st[s];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return Pa(e,function(f,d,p){switch(p){case 44:n.NumberFmt[f[0]]=f[1],la(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(f.color.rgb=Ed(t.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(p),o=!0;break;case 38:a.pop(),o=!1;break;default:if(d.T>0)a.push(p);else if(d.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}function r5(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(Ne(e,615,Is(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Ne(e,44,H6(s,t[s]))}),Ne(e,616))}}function n5(e){var t=1;Ne(e,611,Is(t)),Ne(e,43,X6({sz:12,color:{theme:1},name:"Calibri",family:2})),Ne(e,612)}function s5(e){var t=2;Ne(e,603,Is(t)),Ne(e,45,nw({patternType:"none"})),Ne(e,45,nw({patternType:"gray125"})),Ne(e,604)}function a5(e){var t=1;Ne(e,613,Is(t)),Ne(e,46,Q6()),Ne(e,614)}function i5(e){var t=1;Ne(e,626,Is(t)),Ne(e,47,Bk({numFmtId:0},65535)),Ne(e,627)}function o5(e,t){Ne(e,617,Is(t.length)),t.forEach(function(r){Ne(e,47,Bk(r,0))}),Ne(e,618)}function l5(e){var t=1;Ne(e,619,Is(t)),Ne(e,48,Z6({xfId:0,name:"Normal"})),Ne(e,620)}function c5(e){var t=0;Ne(e,505,Is(t)),Ne(e,506)}function u5(e){var t=0;Ne(e,508,e5(t,"TableStyleMedium9","PivotStyleMedium4")),Ne(e,509)}function f5(e,t){var r=Vn();return Ne(r,278),r5(r,e.SSF),n5(r),s5(r),a5(r),i5(r),o5(r,t.cellXfs),l5(r),c5(r),u5(r),Ne(r,279),r.end()}var d5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function h5(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Tn)||[]).forEach(function(s){var a=dt(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[d5.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function p5(){}function m5(){}var x5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,g5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,v5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function y5(e,t,r){t.themeElements={};var n;[["clrScheme",x5,h5],["fontScheme",g5,p5],["fmtScheme",v5,m5]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var w5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Uk(e,t){(!e||e.length===0)&&(e=ux());var r,n={};if(!(r=e.match(w5)))throw new Error("themeElements not found in theme");return y5(r[0],n,t),n.raw=e,n}function ux(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Or];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function _5(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=OS(a,{type:"array"})}catch{return}var u=Qn(o,"theme/theme/theme1.xml",!0);if(u)return Uk(u,r)}}function S5(e){return e.read_shift(4)}function k5(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=b5(e,4);break;case 2:t.xclrValue=yk(e);break;case 3:t.xclrValue=S5(e);break;case 4:e.l+=4;break}return e.l+=8,t}function b5(e,t){return En(e,t)}function E5(e,t){return En(e,t)}function T5(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=k5(e);break;case 6:n[1]=E5(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function C5(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(T5(e,r-e.l));return{ixfe:n,ext:a}}function N5(e,t){t.forEach(function(r){r[0]})}function A5(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:bn(e)}}function j5(e){var t=Ee(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),sn(e.name,t),t.slice(0,t.l)}function D5(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function F5(e){var t=Ee(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function R5(e,t){var r=Ee(8+2*t.length);return r.write_shift(4,e),sn(t,r),r.slice(0,r.l)}function P5(e){return e.l+=4,e.read_shift(4)!=0}function I5(e,t){var r=Ee(8);return r.write_shift(4,e),r.write_shift(4,1),r}function O5(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],o=!1,u=2;return Pa(e,function(f,d,p){switch(p){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(m){u==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):u==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:a.push(p),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!d.T){if(!o||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function L5(){var e=Vn();return Ne(e,332),Ne(e,334,Is(1)),Ne(e,335,j5({name:"XLDAPR",version:12e4,flags:3496657072})),Ne(e,336),Ne(e,339,R5(1,"XLDAPR")),Ne(e,52),Ne(e,35,Is(514)),Ne(e,4096,Is(0)),Ne(e,4097,ms(1)),Ne(e,36),Ne(e,53),Ne(e,340),Ne(e,337,I5(1)),Ne(e,51,F5([[1,0]])),Ne(e,338),Ne(e,333),e.end()}function M5(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,o;return e.replace(Tn,function(u){var f=dt(u);switch(da(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):a==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+f.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function $k(){var e=[Or];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function B5(e){var t=[];if(!e)return t;var r=1;return(e.match(Tn)||[]).forEach(function(n){var s=dt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function U5(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ut(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function $5(e,t,r){var n=[];return Pa(e,function(a,o,u){switch(u){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function z5(e,t,r,n){if(!e)return e;var s=n||{},a=!1;Pa(e,function(u,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!f.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function W5(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var xl=1024;function zk(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Be("xml",null,{"xmlns:v":Yn.v,"xmlns:o":Yn.o,"xmlns:x":Yn.x,"xmlns:mv":Yn.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];xl<e*1e3;)xl+=1e3;return t.forEach(function(a){var o=vr(a[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Be("v:fill",f,u),p={on:"t",obscured:"t"};++xl,s=s.concat(["<v:shape"+ru({id:"_x0000_s"+xl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Be("v:shadow",null,p),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",fn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),fn("x:AutoFill","False"),fn("x:Row",String(o.r)),fn("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function sw(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(o){var u=vr(o.ref);if(s?(e[u.r]||(e[u.r]=[]),a=e[u.r][u.c]):a=e[o.ref],!a){a={t:"z"},s?e[u.r][u.c]=a:e[o.ref]=a;var f=Rt(e["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var d=vt(f);d!==e["!ref"]&&(e["!ref"]=d)}a.c||(a.c=[]);var p={a:o.author,t:o.t,r:o.r,T:r};o.h&&(p.h=o.h);for(var m=a.c.length-1;m>=0;--m){if(!r&&a.c[m].T)return;r&&!a.c[m].T&&a.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(p.a==n[m].id){p.a=n[m].name||p.a;break}}a.c.push(p)})}function V5(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=dt(u[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},p=vr(f.ref);if(!(t.sheetRows&&t.sheetRows<=p.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&ox(m[1])||{r:"",t:"",h:""};d.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),d.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=g.h),n.push(d)}}}}),n}function Wk(e){var t=[Or,Be("comments",null,{xmlns:_o[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=Gt(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(s=r.indexOf(Gt(f.a))),a.push(f.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(fn("t",Gt(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,u=1;u<a.length;++u)o+=`Reply:
    `+a[u]+`
`;t.push(fn("t",Gt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function H5(e,t){var r=[],n=!1,s={},a=0;return e.replace(Tn,function(u,f){var d=dt(u);switch(da(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=f+u.length;break;case"</text>":s.t=e.slice(a,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function G5(e,t,r){var n=[Or,Be("ThreadedComments",null,{xmlns:Xr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var f={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?a=f.id:f.parentId=a,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Be("threadedComment",fn("text",o.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function X5(e,t){var r=[],n=!1;return e.replace(Tn,function(a){var o=dt(a);switch(da(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function K5(e){var t=[Or,Be("personList",null,{xmlns:Xr.TCMNT,"xmlns:x":_o[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function q5(e){var t={};t.iauthor=e.read_shift(4);var r=Eo(e);return t.rfx=r.s,t.ref=ut(r.s),e.l+=16,t}function Y5(e,t){return t==null&&(t=Ee(36)),t.write_shift(4,e[1].iauthor),$l(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var J5=bn;function Q5(e){return sn(e.slice(0,54))}function Z5(e,t){var r=[],n=[],s={},a=!1;return Pa(e,function(u,f,d){switch(d){case 632:n.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function eL(e){var t=Vn(),r=[];return Ne(t,628),Ne(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Ne(t,632,Q5(s.a)))})}),Ne(t,631),Ne(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:vr(n[0]),e:vr(n[0])};Ne(t,635,Y5([a,s])),s.t&&s.t.length>0&&Ne(t,637,SI(s)),Ne(t,636),delete s.iauthor})}),Ne(t,634),Ne(t,629),t.end()}var tL="application/vnd.ms-office.vbaProject";function rL(e){var t=Ze.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ze.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Ze.write(t)}function nL(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ze.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var Vk=["xlsb","xlsm","xlam","biff8","xla"];function sL(){return{"!type":"dialog"}}function aL(){return{"!type":"dialog"}}function iL(){return{"!type":"macro"}}function oL(){return{"!type":"macro"}}var Sl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,o){var u=!1,f=!1;a.length==0?f=!0:a.charAt(0)=="["&&(f=!0,a=a.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var d=a.length>0?parseInt(a,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return u?p+=t.c:--p,f?d+=t.r:--d,s+(u?"":"$")+ur(p)+(f?"":"$")+Tr(d)}return function(s,a){return t=a,s.replace(e,r)}})(),fx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,dx=(function(){return function(t,r){return t.replace(fx,function(n,s,a,o,u,f){var d=Qm(o)-(a?0:r.c),p=Jm(f)-(u?0:r.r),m=p==0?"":u?p+1:"["+p+"]",g=d==0?"":a?d+1:"["+d+"]";return s+"R"+m+"C"+g})}})();function Hk(e,t){return e.replace(fx,function(r,n,s,a,o,u){return n+(s=="$"?s+a:ur(Qm(a)+t.c))+(o=="$"?o+u:Tr(Jm(u)+t.r))})}function lL(e,t,r){var n=Pn(t),s=n.s,a=vr(r),o={r:a.r-s.r,c:a.c-s.c};return Hk(e,o)}function cL(e){return e.length!=1}function aw(e){return e.replace(/_xlfn\./g,"")}function Br(e){e.l+=1}function _i(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Gk(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Xk(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),o=_i(e),u=_i(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:u[0],cRel:u[1],rRel:u[2]}}}function Xk(e){var t=_i(e),r=_i(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function uL(e,t,r){if(r.biff<8)return Xk(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=_i(e),o=_i(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Kk(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return fL(e);var n=e.read_shift(r&&r.biff==12?4:2),s=_i(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function fL(e){var t=_i(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function dL(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function hL(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return pL(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,u=(a&32768)>>15;if(a&=16383,u==1)for(;s>524287;)s-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:o,rRel:u}}function pL(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function mL(e,t,r){var n=(e[e.l++]&96)>>5,s=Gk(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function xL(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=Gk(e,a,r);return[n,s,o]}function gL(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function vL(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function yL(e,t,r){var n=(e[e.l++]&96)>>5,s=uL(e,t-1,r);return[n,s]}function wL(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function iw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function _L(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function SL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function kL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function bL(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function EL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function qk(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function TL(e){return e.read_shift(2),qk(e)}function CL(e){return e.read_shift(2),qk(e)}function NL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Kk(e,0,r);return[n,s]}function AL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=hL(e,0,r);return[n,s]}function jL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=Kk(e,0,r);return[n,s,a]}function DL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[PM[s],Qk[s],n]}function FL(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:RL(e);return[s,(a[0]===0?Qk:RM)[a[1]]]}function RL(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function PL(e,t,r){e.l+=r&&r.biff==2?3:4}function IL(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function OL(e){return e.l++,Ia[e.read_shift(1)]}function LL(e){return e.l++,e.read_shift(2)}function ML(e){return e.l++,e.read_shift(1)!==0}function BL(e){return e.l++,Sn(e)}function UL(e,t,r){return e.l++,_u(e,t-1,r)}function $L(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ir(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ia[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Sn(e);break;case 2:r[1]=To(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function zL(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?Eo:Gd)(e));return s}function WL(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var u=0;u!=s;++u)o[a][u]=$L(e,r.biff);return o}function VL(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function HL(e,t,r){if(r.biff==5)return GL(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function GL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function XL(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function KL(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function qL(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function YL(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var JL=En,QL=En,ZL=En;function ku(e,t,r){return e.l+=2,[dL(e)]}function hx(e){return e.l+=6,[]}var eM=ku,tM=hx,rM=hx,nM=ku;function Yk(e){return e.l+=2,[$r(e),e.read_shift(2)&1]}var sM=ku,aM=Yk,iM=hx,oM=ku,lM=ku,cM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uM(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),o=cM[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:a}}function fM(e){return e.l+=2,[e.read_shift(4)]}function dM(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function hM(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function pM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function mM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function xM(e){return e.l+=4,[0,0]}var ow={1:{n:"PtgExp",f:IL},2:{n:"PtgTbl",f:ZL},3:{n:"PtgAdd",f:Br},4:{n:"PtgSub",f:Br},5:{n:"PtgMul",f:Br},6:{n:"PtgDiv",f:Br},7:{n:"PtgPower",f:Br},8:{n:"PtgConcat",f:Br},9:{n:"PtgLt",f:Br},10:{n:"PtgLe",f:Br},11:{n:"PtgEq",f:Br},12:{n:"PtgGe",f:Br},13:{n:"PtgGt",f:Br},14:{n:"PtgNe",f:Br},15:{n:"PtgIsect",f:Br},16:{n:"PtgUnion",f:Br},17:{n:"PtgRange",f:Br},18:{n:"PtgUplus",f:Br},19:{n:"PtgUminus",f:Br},20:{n:"PtgPercent",f:Br},21:{n:"PtgParen",f:Br},22:{n:"PtgMissArg",f:Br},23:{n:"PtgStr",f:UL},26:{n:"PtgSheet",f:dM},27:{n:"PtgEndSheet",f:hM},28:{n:"PtgErr",f:OL},29:{n:"PtgBool",f:ML},30:{n:"PtgInt",f:LL},31:{n:"PtgNum",f:BL},32:{n:"PtgArray",f:wL},33:{n:"PtgFunc",f:DL},34:{n:"PtgFuncVar",f:FL},35:{n:"PtgName",f:VL},36:{n:"PtgRef",f:NL},37:{n:"PtgArea",f:mL},38:{n:"PtgMemArea",f:XL},39:{n:"PtgMemErr",f:JL},40:{n:"PtgMemNoMem",f:QL},41:{n:"PtgMemFunc",f:KL},42:{n:"PtgRefErr",f:qL},43:{n:"PtgAreaErr",f:gL},44:{n:"PtgRefN",f:AL},45:{n:"PtgAreaN",f:yL},46:{n:"PtgMemAreaN",f:pM},47:{n:"PtgMemNoMemN",f:mM},57:{n:"PtgNameX",f:HL},58:{n:"PtgRef3d",f:jL},59:{n:"PtgArea3d",f:xL},60:{n:"PtgRefErr3d",f:YL},61:{n:"PtgAreaErr3d",f:vL},255:{}},gM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},vM={1:{n:"PtgElfLel",f:Yk},2:{n:"PtgElfRw",f:oM},3:{n:"PtgElfCol",f:eM},6:{n:"PtgElfRwV",f:lM},7:{n:"PtgElfColV",f:nM},10:{n:"PtgElfRadical",f:sM},11:{n:"PtgElfRadicalS",f:iM},13:{n:"PtgElfColS",f:tM},15:{n:"PtgElfColSV",f:rM},16:{n:"PtgElfRadicalLel",f:aM},25:{n:"PtgList",f:uM},29:{n:"PtgSxName",f:fM},255:{}},yM={0:{n:"PtgAttrNoop",f:xM},1:{n:"PtgAttrSemi",f:EL},2:{n:"PtgAttrIf",f:kL},4:{n:"PtgAttrChoose",f:_L},8:{n:"PtgAttrGoto",f:SL},16:{n:"PtgAttrSum",f:PL},32:{n:"PtgAttrBaxcel",f:iw},33:{n:"PtgAttrBaxcel",f:iw},64:{n:"PtgAttrSpace",f:TL},65:{n:"PtgAttrSpaceSemi",f:CL},128:{n:"PtgAttrIfError",f:bL},255:{}};function bu(e,t,r,n){if(n.biff<8)return En(e,t);for(var s=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=WL(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=zL(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&a.push(En(e,t)),a}function Eu(e,t,r){for(var n=e.l+t,s,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],s=ow[a]||ow[gM[a]],(a===24||a===25)&&(s=(a===24?vM:yM)[e[e.l+1]]),!s||!s.f?En(e,t):o.push([s.n,s.f(e,t,r)]);return o}function wM(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var _M={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function SM(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Jk(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function lw(e,t,r){var n=Jk(e,t,r);return n=="#REF"?n:SM(n,r)}function wn(e,t,r,n,s){var a=s&&s.biff||8,o={s:{c:0,r:0}},u=[],f,d,p,m=0,g=0,y,w="";if(!e[0]||!e[0][0])return"";for(var v=-1,S="",E=0,A=e[0].length;E<A;++E){var b=e[0][E];switch(b[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),d=u.pop(),v>=0){switch(e[0][v][1][0]){case 0:S=Er(" ",e[0][v][1][1]);break;case 1:S=Er("\r",e[0][v][1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}d=d+S,v=-1}u.push(d+_M[b[0]]+f);break;case"PtgIsect":f=u.pop(),d=u.pop(),u.push(d+" "+f);break;case"PtgUnion":f=u.pop(),d=u.pop(),u.push(d+","+f);break;case"PtgRange":f=u.pop(),d=u.pop(),u.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Oc(b[1][1],o,s),u.push(Lc(p,a));break;case"PtgRefN":p=r?Oc(b[1][1],r,s):b[1][1],u.push(Lc(p,a));break;case"PtgRef3d":m=b[1][1],p=Oc(b[1][2],o,s),w=lw(n,m,s),u.push(w+"!"+Lc(p,a));break;case"PtgFunc":case"PtgFuncVar":var D=b[1][0],O=b[1][1];D||(D=0),D&=127;var C=D==0?[]:u.slice(-D);u.length-=D,O==="User"&&(O=C.shift()),u.push(O+"("+C.join(",")+")");break;case"PtgBool":u.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(b[1]);break;case"PtgNum":u.push(String(b[1]));break;case"PtgStr":u.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(b[1]);break;case"PtgAreaN":y=Ly(b[1][1],r?{s:r}:o,s),u.push(op(y,s));break;case"PtgArea":y=Ly(b[1][1],o,s),u.push(op(y,s));break;case"PtgArea3d":m=b[1][1],y=b[1][2],w=lw(n,m,s),u.push(w+"!"+op(y,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=b[1][2];var T=(n.names||[])[g-1]||(n[0]||[])[g],U=T?T.Name:"SH33TJSNAME"+String(g);U&&U.slice(0,6)=="_xlfn."&&!s.xlfn&&(U=U.slice(6)),u.push(U);break;case"PtgNameX":var z=b[1][1];g=b[1][2];var Z;if(s.biff<=5)z<0&&(z=-z),n[z]&&(Z=n[z][g]);else{var re="";if(((n[z]||[])[0]||[])[0]==14849||(((n[z]||[])[0]||[])[0]==1025?n[z][g]&&n[z][g].itab>0&&(re=n.SheetNames[n[z][g].itab-1]+"!"):re=n.SheetNames[g-1]+"!"),n[z]&&n[z][g])re+=n[z][g].Name;else if(n[0]&&n[0][g])re+=n[0][g].Name;else{var P=(Jk(n,z,s)||"").split(";;");P[g-1]?re=P[g-1]:re+="SH33TJSERRX"}u.push(re);break}Z||(Z={Name:"SH33TJSERRY"}),u.push(Z.Name);break;case"PtgParen":var se="(",me=")";if(v>=0){switch(S="",e[0][v][1][0]){case 2:se=Er(" ",e[0][v][1][1])+se;break;case 3:se=Er("\r",e[0][v][1][1])+se;break;case 4:me=Er(" ",e[0][v][1][1])+me;break;case 5:me=Er("\r",e[0][v][1][1])+me;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}u.push(se+u.pop()+me);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:b[1][1],r:b[1][0]};var ce={c:r.c,r:r.r};if(n.sharedf[ut(p)]){var fe=n.sharedf[ut(p)];u.push(wn(fe,o,ce,n,s))}else{var de=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(p.c<d[0].s.c||p.c>d[0].e.c)&&!(p.r<d[0].s.r||p.r>d[0].e.r)){u.push(wn(d[1],o,ce,n,s)),de=!0;break}de||u.push(b[1])}break;case"PtgArray":u.push("{"+wM(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var he=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&he.indexOf(e[0][E][0])==-1){b=e[0][v];var Q=!0;switch(b[1][0]){case 4:Q=!1;case 0:S=Er(" ",b[1][1]);break;case 5:Q=!1;case 1:S=Er("\r",b[1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}u.push((Q?S:"")+u.pop()+(Q?"":S)),v=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function kM(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,o=e.read_shift(s);if(o==65535)return[[],En(e,t-2)];var u=Eu(e,o,r);return t!==o+s&&(a=bu(e,t-o-s,u,r)),e.l=n,[u,a]}function bM(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,o=e.read_shift(s);if(o==65535)return[[],En(e,t-2)];var u=Eu(e,o,r);return t!==o+s&&(a=bu(e,t-o-s,u,r)),e.l=n,[u,a]}function EM(e,t,r,n){var s=e.l+t,a=Eu(e,n,r),o;return s!==e.l&&(o=bu(e,s-e.l,a,r)),[a,o]}function TM(e,t,r){var n=e.l+t,s,a=e.read_shift(2),o=Eu(e,a,r);return a==65535?[[],En(e,t-2)]:(t!==a+2&&(s=bu(e,n-a-2,o,r)),[o,s])}function CM(e){var t;if(ba(e,e.l+6)!==65535)return[Sn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function NM(e){if(e==null){var t=Ee(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return fo(e);return fo(0)}function dp(e,t,r){var n=e.l+t,s=ha(e);r.biff==2&&++e.l;var a=CM(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=bM(e,n-e.l,r);return{cell:s,val:a[0],formula:u,shared:o>>3&1,tt:a[1]}}function AM(e,t,r,n,s){var a=po(t,r,s),o=NM(e.v),u=Ee(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var d=Ee(e.bf.length),p=0;p<e.bf.length;++p)d[p]=e.bf[p];var m=nn([a,o,u,d]);return m}function Xd(e,t,r){var n=e.read_shift(4),s=Eu(e,n,r),a=e.read_shift(4),o=a>0?bu(e,a,s,r):null;return[s,o]}var jM=Xd,Kd=Xd,DM=Xd,FM=Xd,RM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Qk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},PM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function IM(e){var t="of:="+e.replace(fx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function hp(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function OM(e){return e.replace(/\./,"!")}var Bc={},kl={},Uc=typeof Map<"u";function px(e,t,r){var n=0,s=e.length;if(r){if(Uc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Uc?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Uc?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function qd(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(_n=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ou(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Td(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function eo(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ni(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){la(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function Zk(e,t,r,n,s,a){try{n.cellNF&&(e.z=st[t])}catch(u){if(n.WTF)throw u}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=fr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(st[t]==null&&la(FP[t]||"General",t),e.t==="e")e.w=e.w||Ia[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=eu(e.v);else if(e.t==="d"){var o=Kr(e.v);(o|0)===o?e.w=o.toString(10):e.w=eu(o)}else{if(e.v===void 0)return"";e.w=co(e.v,kl)}else e.t==="d"?e.w=rs(t,Kr(e.v),kl):e.w=rs(t,e.v,kl)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ed(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ed(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&a.Fills)throw u}}}function LM(e,t,r){if(e&&e["!ref"]){var n=Rt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function MM(e,t){var r=Rt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=vt(r))}var BM=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,UM=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,$M=/<(?:\w:)?hyperlink [^>]*>/mg,zM=/"(\w*:\w*)"/,WM=/<(?:\w:)?col\b[^>]*[\/]?>/g,VM=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,HM=/<(?:\w:)?pageMargins[^>]*\/>/g,eb=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,GM=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,XM=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function KM(e,t,r,n,s,a,o){if(!e)return e;n||(n={"!id":{}});var u=t.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",p="",m=e.match(UM);m?(d=e.slice(0,m.index),p=e.slice(m.index+m[0].length)):d=p=e;var g=d.match(eb);g?mx(g[0],u,s,r):(g=d.match(GM))&&YM(g[0],g[1]||"",u,s,r);var y=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var w=d.slice(y,y+50).match(zM);w&&MM(u,w[1])}var v=d.match(XM);v&&v[1]&&c7(v[1],s);var S=[];if(t.cellStyles){var E=d.match(WM);E&&s7(S,E)}m&&d7(m[1],u,t,f,a,o);var A=p.match(VM);A&&(u["!autofilter"]=i7(A[0]));var b=[],D=p.match(BM);if(D)for(y=0;y!=D.length;++y)b[y]=Rt(D[y].slice(D[y].indexOf('"')+1));var O=p.match($M);O&&t7(u,O,n);var C=p.match(HM);if(C&&(u["!margins"]=r7(dt(C[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=vt(f)),t.sheetRows>0&&u["!ref"]){var T=Rt(u["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>f.e.r&&(T.e.r=f.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>f.e.c&&(T.e.c=f.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),u["!fullref"]=u["!ref"],u["!ref"]=vt(T))}return S.length>0&&(u["!cols"]=S),b.length>0&&(u["!merges"]=b),u}function qM(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+vt(e[r])+'"/>';return t+"</mergeCells>"}function mx(e,t,r,n){var s=dt(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Bt(Xt(s.codeName)))}function YM(e,t,r,n,s){mx(e.slice(0,e.indexOf(">")),r,n,s)}function JM(e,t,r,n,s){var a=!1,o={},u=null;if(n.bookType!=="xlsx"&&t.vbaraw){var f=t.SheetNames[r];try{t.Workbook&&(f=t.Workbook.Sheets[r].CodeName||f)}catch{}a=!0,o.codeName=sa(Gt(f))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),u=(u||"")+Be("outlinePr",null,d)}!a&&!u||(s[s.length]=Be("sheetPr",u,o))}var QM=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ZM=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function e7(e){var t={sheet:1};return QM.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),ZM.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=lx(e.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function t7(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=dt(Xt(t[s]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+Bt(a.location))):(a.Target="#"+Bt(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var u=Rt(a.ref),f=u.s.r;f<=u.e.r;++f)for(var d=u.s.c;d<=u.e.c;++d){var p=ut({c:d,r:f});n?(e[f]||(e[f]=[]),e[f][d]||(e[f][d]={t:"z",v:void 0}),e[f][d].l=a):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=a)}}}function r7(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function n7(e){return eo(e),Be("pageMargins",null,e)}function s7(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=dt(t[n],!0);s.hidden&&(s.hidden=cr(s.hidden));var a=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,cx(s.width)),wi(s);a<=o;)e[a++]=Zt(s)}}function a7(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Be("col",null,qd(s,n)));return r[r.length]="</cols>",r.join("")}function i7(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function o7(e,t,r,n){var s=typeof e.ref=="string"?e.ref:vt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Pn(s);o.s.r==o.e.r&&(o.e.r=Pn(t["!ref"]).e.r,s=vt(o));for(var u=0;u<a.length;++u){var f=a[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return u==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Be("autoFilter",null,{ref:s})}var l7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function c7(e,t){t.Views||(t.Views=[{}]),(e.match(l7)||[]).forEach(function(r,n){var s=dt(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),cr(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function u7(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,s),{})}function f7(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Ia[e.v];break;case"d":n&&n.cellDates?s=fr(e.v,-1).toISOString():(e=Zt(e),e.t="n",s=""+(e.v=Kr(fr(e.v)))),typeof e.z>"u"&&(e.z=st[14]);break;default:s=e.v;break}var u=fn("v",Gt(s)),f={r:t},d=Ni(n.cellXfs,e,n);switch(d!==0&&(f.s=d),e.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=fn("v",""+px(n.Strings,e.v,n.revStrings)),f.t="s";break}f.t="str";break}if(e.t!=a&&(e.t=a,e.v=o),typeof e.f=="string"&&e.f){var p=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Be("f",Gt(e.f),p)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(f.cm=1),Be("c",u,f)}var d7=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=tu("v"),o=tu("f");return function(f,d,p,m,g,y){for(var w=0,v="",S=[],E=[],A=0,b=0,D=0,O="",C,T,U=0,z=0,Z,re,P=0,se=0,me=Array.isArray(y.CellXf),ce,fe=[],de=[],he=Array.isArray(d),Q=[],ee={},V=!1,F=!!p.sheetStubs,N=f.split(t),L=0,B=N.length;L!=B;++L){v=N[L].trim();var q=v.length;if(q!==0){var ne=0;e:for(w=0;w<q;++w)switch(v[w]){case">":if(v[w-1]!="/"){++w;break e}if(p&&p.cellStyles){if(T=dt(v.slice(ne,w),!0),U=T.r!=null?parseInt(T.r,10):U+1,z=-1,p.sheetRows&&p.sheetRows<U)continue;ee={},V=!1,T.ht&&(V=!0,ee.hpt=parseFloat(T.ht),ee.hpx=Dl(ee.hpt)),T.hidden=="1"&&(V=!0,ee.hidden=!0),T.outlineLevel!=null&&(V=!0,ee.level=+T.outlineLevel),V&&(Q[U-1]=ee)}break;case"<":ne=w;break}if(ne>=w)break;if(T=dt(v.slice(ne,w),!0),U=T.r!=null?parseInt(T.r,10):U+1,z=-1,!(p.sheetRows&&p.sheetRows<U)){m.s.r>U-1&&(m.s.r=U-1),m.e.r<U-1&&(m.e.r=U-1),p&&p.cellStyles&&(ee={},V=!1,T.ht&&(V=!0,ee.hpt=parseFloat(T.ht),ee.hpx=Dl(ee.hpt)),T.hidden=="1"&&(V=!0,ee.hidden=!0),T.outlineLevel!=null&&(V=!0,ee.level=+T.outlineLevel),V&&(Q[U-1]=ee)),S=v.slice(w).split(e);for(var Y=0;Y!=S.length&&S[Y].trim().charAt(0)=="<";++Y);for(S=S.slice(Y),w=0;w!=S.length;++w)if(v=S[w].trim(),v.length!==0){if(E=v.match(r),A=w,b=0,D=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,E!=null&&E.length===2){for(A=0,O=E[1],b=0;b!=O.length&&!((D=O.charCodeAt(b)-64)<1||D>26);++b)A=26*A+D;--A,z=A}else++z;for(b=0;b!=v.length&&v.charCodeAt(b)!==62;++b);if(++b,T=dt(v.slice(0,b),!0),T.r||(T.r=ut({r:U-1,c:z})),O=v.slice(b),C={t:""},(E=O.match(a))!=null&&E[1]!==""&&(C.v=Bt(E[1])),p.cellFormula){if((E=O.match(o))!=null&&E[1]!==""){if(C.f=Bt(Xt(E[1])).replace(/\r\n/g,`
`),p.xlfn||(C.f=aw(C.f)),E[0].indexOf('t="array"')>-1)C.F=(O.match(s)||[])[1],C.F.indexOf(":")>-1&&fe.push([Rt(C.F),C.F]);else if(E[0].indexOf('t="shared"')>-1){re=dt(E[0]);var oe=Bt(Xt(E[1]));p.xlfn||(oe=aw(oe)),de[parseInt(re.si,10)]=[re,oe,T.r]}}else(E=O.match(/<f[^>]*\/>/))&&(re=dt(E[0]),de[re.si]&&(C.f=lL(de[re.si][1],de[re.si][2],T.r)));var le=vr(T.r);for(b=0;b<fe.length;++b)le.r>=fe[b][0].s.r&&le.r<=fe[b][0].e.r&&le.c>=fe[b][0].s.c&&le.c<=fe[b][0].e.c&&(C.F=fe[b][1])}if(T.t==null&&C.v===void 0)if(C.f||C.F)C.v=0,C.t="n";else if(F)C.t="z";else continue;else C.t=T.t||"n";switch(m.s.c>z&&(m.s.c=z),m.e.c<z&&(m.e.c=z),C.t){case"n":if(C.v==""||C.v==null){if(!F)continue;C.t="z"}else C.v=parseFloat(C.v);break;case"s":if(typeof C.v>"u"){if(!F)continue;C.t="z"}else Z=Bc[parseInt(C.v,10)],C.v=Z.t,C.r=Z.r,p.cellHTML&&(C.h=Z.h);break;case"str":C.t="s",C.v=C.v!=null?Xt(C.v):"",p.cellHTML&&(C.h=Wm(C.v));break;case"inlineStr":E=O.match(n),C.t="s",E!=null&&(Z=ox(E[1]))?(C.v=Z.t,p.cellHTML&&(C.h=Z.h)):C.v="";break;case"b":C.v=cr(C.v);break;case"d":p.cellDates?C.v=fr(C.v,1):(C.v=Kr(fr(C.v,1)),C.t="n");break;case"e":(!p||p.cellText!==!1)&&(C.w=C.v),C.v=rk[C.v];break}if(P=se=0,ce=null,me&&T.s!==void 0&&(ce=y.CellXf[T.s],ce!=null&&(ce.numFmtId!=null&&(P=ce.numFmtId),p.cellStyles&&ce.fillId!=null&&(se=ce.fillId))),Zk(C,P,se,p,g,y),p.cellDates&&me&&C.t=="n"&&wo(st[P])&&(C.t="d",C.v=Vd(C.v)),T.cm&&p.xlmeta){var te=(p.xlmeta.Cell||[])[+T.cm-1];te&&te.type=="XLDAPR"&&(C.D=!0)}if(he){var I=vr(T.r);d[I.r]||(d[I.r]=[]),d[I.r][I.c]=C}else d[T.r]=C}}}}Q.length>0&&(d["!rows"]=Q)}})();function h7(e,t,r,n){var s=[],a=[],o=Rt(e["!ref"]),u="",f,d="",p=[],m=0,g=0,y=e["!rows"],w=Array.isArray(e),v={r:d},S,E=-1;for(g=o.s.c;g<=o.e.c;++g)p[g]=ur(g);for(m=o.s.r;m<=o.e.r;++m){for(a=[],d=Tr(m),g=o.s.c;g<=o.e.c;++g){f=p[g]+d;var A=w?(e[m]||[])[g]:e[f];A!==void 0&&(u=f7(A,f,e,t))!=null&&a.push(u)}(a.length>0||y&&y[m])&&(v={r:d},y&&y[m]&&(S=y[m],S.hidden&&(v.hidden=1),E=-1,S.hpx?E=lu(S.hpx):S.hpt&&(E=S.hpt),E>-1&&(v.ht=E,v.customHeight=1),S.level&&(v.outlineLevel=S.level)),s[s.length]=Be("row",a.join(""),v))}if(y)for(;m<y.length;++m)y&&y[m]&&(v={r:m+1},S=y[m],S.hidden&&(v.hidden=1),E=-1,S.hpx?E=lu(S.hpx):S.hpt&&(E=S.hpt),E>-1&&(v.ht=E,v.customHeight=1),S.level&&(v.outlineLevel=S.level),s[s.length]=Be("row","",v));return s.join("")}function tb(e,t,r,n){var s=[Or,Be("worksheet",null,{xmlns:_o[0],"xmlns:r":Xr.r})],a=r.SheetNames[e],o=0,u="",f=r.Sheets[a];f==null&&(f={});var d=f["!ref"]||"A1",p=Rt(d);if(p.e.c>16383||p.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),d=vt(p)}n||(n={}),f["!comments"]=[];var m=[];JM(f,r,e,t,s),s[s.length]=Be("dimension",null,{ref:d}),s[s.length]=u7(f,t,e,r),t.sheetFormat&&(s[s.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(s[s.length]=a7(f,f["!cols"])),s[o=s.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=h7(f,t),u.length>0&&(s[s.length]=u)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),f["!protect"]&&(s[s.length]=e7(f["!protect"])),f["!autofilter"]!=null&&(s[s.length]=o7(f["!autofilter"],f,r,e)),f["!merges"]!=null&&f["!merges"].length>0&&(s[s.length]=qM(f["!merges"]));var g=-1,y,w=-1;return f["!links"].length>0&&(s[s.length]="<hyperlinks>",f["!links"].forEach(function(v){v[1].Target&&(y={ref:v[0]},v[1].Target.charAt(0)!="#"&&(w=Ht(n,-1,Gt(v[1].Target).replace(/#.*$/,""),bt.HLINK),y["r:id"]="rId"+w),(g=v[1].Target.indexOf("#"))>-1&&(y.location=Gt(v[1].Target.slice(g+1))),v[1].Tooltip&&(y.tooltip=Gt(v[1].Tooltip)),s[s.length]=Be("hyperlink",null,y))}),s[s.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(s[s.length]=n7(f["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=fn("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:d}))),m.length>0&&(w=Ht(n,-1,"../drawings/drawing"+(e+1)+".xml",bt.DRAW),s[s.length]=Be("drawing",null,{"r:id":"rId"+w}),f["!drawing"]=m),f["!comments"].length>0&&(w=Ht(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",bt.VML),s[s.length]=Be("legacyDrawing",null,{"r:id":"rId"+w}),f["!legacy"]=w),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function p7(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function m7(e,t,r){var n=Ee(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=lu(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var d={r:e,c:0},p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var m=-1,g=-1,y=p<<10;y<p+1<<10;++y){d.c=y;var w=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ut(d)];w&&(m<0&&(m=y),g=y)}m<0||(++u,n.write_shift(4,m),n.write_shift(4,g))}var v=n.l;return n.l=f,n.write_shift(4,u),n.l=v,n.length>n.l?n.slice(0,n.l):n}function x7(e,t,r,n){var s=m7(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&Ne(e,0,s)}var g7=Eo,v7=$l;function y7(){}function w7(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=kI(e),r}function _7(e,t,r){r==null&&(r=Ee(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Sd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),JS(e,r),r.slice(0,r.l)}function S7(e){var t=ys(e);return[t]}function k7(e,t,r){return r==null&&(r=Ee(8)),So(t,r)}function b7(e){var t=ko(e);return[t]}function E7(e,t,r){return r==null&&(r=Ee(4)),bo(t,r)}function T7(e){var t=ys(e),r=e.read_shift(1);return[t,r,"b"]}function C7(e,t,r){return r==null&&(r=Ee(9)),So(t,r),r.write_shift(1,e.v?1:0),r}function N7(e){var t=ko(e),r=e.read_shift(1);return[t,r,"b"]}function A7(e,t,r){return r==null&&(r=Ee(5)),bo(t,r),r.write_shift(1,e.v?1:0),r}function j7(e){var t=ys(e),r=e.read_shift(1);return[t,r,"e"]}function D7(e,t,r){return r==null&&(r=Ee(9)),So(t,r),r.write_shift(1,e.v),r}function F7(e){var t=ko(e),r=e.read_shift(1);return[t,r,"e"]}function R7(e,t,r){return r==null&&(r=Ee(8)),bo(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function P7(e){var t=ys(e),r=e.read_shift(4);return[t,r,"s"]}function I7(e,t,r){return r==null&&(r=Ee(12)),So(t,r),r.write_shift(4,t.v),r}function O7(e){var t=ko(e),r=e.read_shift(4);return[t,r,"s"]}function L7(e,t,r){return r==null&&(r=Ee(8)),bo(t,r),r.write_shift(4,t.v),r}function M7(e){var t=ys(e),r=Sn(e);return[t,r,"n"]}function B7(e,t,r){return r==null&&(r=Ee(16)),So(t,r),fo(e.v,r),r}function rb(e){var t=ko(e),r=Sn(e);return[t,r,"n"]}function U7(e,t,r){return r==null&&(r=Ee(12)),bo(t,r),fo(e.v,r),r}function $7(e){var t=ys(e),r=rx(e);return[t,r,"n"]}function z7(e,t,r){return r==null&&(r=Ee(12)),So(t,r),QS(e.v,r),r}function W7(e){var t=ko(e),r=rx(e);return[t,r,"n"]}function V7(e,t,r){return r==null&&(r=Ee(8)),bo(t,r),QS(e.v,r),r}function H7(e){var t=ys(e),r=Zm(e);return[t,r,"is"]}function G7(e){var t=ys(e),r=bn(e);return[t,r,"str"]}function X7(e,t,r){return r==null&&(r=Ee(12+4*e.v.length)),So(t,r),sn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function K7(e){var t=ko(e),r=bn(e);return[t,r,"str"]}function q7(e,t,r){return r==null&&(r=Ee(8+4*e.v.length)),bo(t,r),sn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Y7(e,t,r){var n=e.l+t,s=ys(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"b"];if(r.cellFormula){e.l+=2;var u=Kd(e,n-e.l,r);o[3]=wn(u,null,s,r.supbooks,r)}else e.l=n;return o}function J7(e,t,r){var n=e.l+t,s=ys(e);s.r=r["!row"];var a=e.read_shift(1),o=[s,a,"e"];if(r.cellFormula){e.l+=2;var u=Kd(e,n-e.l,r);o[3]=wn(u,null,s,r.supbooks,r)}else e.l=n;return o}function Q7(e,t,r){var n=e.l+t,s=ys(e);s.r=r["!row"];var a=Sn(e),o=[s,a,"n"];if(r.cellFormula){e.l+=2;var u=Kd(e,n-e.l,r);o[3]=wn(u,null,s,r.supbooks,r)}else e.l=n;return o}function Z7(e,t,r){var n=e.l+t,s=ys(e);s.r=r["!row"];var a=bn(e),o=[s,a,"str"];if(r.cellFormula){e.l+=2;var u=Kd(e,n-e.l,r);o[3]=wn(u,null,s,r.supbooks,r)}else e.l=n;return o}var eB=Eo,tB=$l;function rB(e,t){return t==null&&(t=Ee(4)),t.write_shift(4,e),t}function nB(e,t){var r=e.l+t,n=Eo(e),s=ex(e),a=bn(e),o=bn(e),u=bn(e);e.l=r;var f={rfx:n,relId:s,loc:a,display:u};return o&&(f.Tooltip=o),f}function sB(e,t){var r=Ee(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));$l({s:vr(e[0]),e:vr(e[0])},r),tx("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return sn(s||"",r),sn(e[1].Tooltip||"",r),sn("",r),r.slice(0,r.l)}function aB(){}function iB(e,t,r){var n=e.l+t,s=ZS(e),a=e.read_shift(1),o=[s];if(o[2]=a,r.cellFormula){var u=jM(e,n-e.l,r);o[1]=u}else e.l=n;return o}function oB(e,t,r){var n=e.l+t,s=Eo(e),a=[s];if(r.cellFormula){var o=FM(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}function lB(e,t,r){r==null&&(r=Ee(18));var n=qd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var nb=["left","right","top","bottom","header","footer"];function cB(e){var t={};return nb.forEach(function(r){t[r]=Sn(e)}),t}function uB(e,t){return t==null&&(t=Ee(48)),eo(e),nb.forEach(function(r){fo(e[r],t)}),t}function fB(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function dB(e,t,r){r==null&&(r=Ee(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function hB(e){var t=Ee(24);return t.write_shift(4,4),t.write_shift(4,1),$l(e,t),t}function pB(e,t){return t==null&&(t=Ee(66)),t.write_shift(2,e.password?lx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function mB(){}function xB(){}function gB(e,t,r,n,s,a,o){if(!e)return e;var u=t||{};n||(n={"!id":{}});var f=u.dense?[]:{},d,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,y,w,v,S,E,A,b,D,O,C=[];u.biff=12,u["!row"]=0;var T=0,U=!1,z=[],Z={},re=u.supbooks||s.supbooks||[[]];if(re.sharedf=Z,re.arrayf=z,re.SheetNames=s.SheetNames||s.Sheets.map(function(he){return he.name}),!u.supbooks&&(u.supbooks=re,s.Names))for(var P=0;P<s.Names.length;++P)re[0][P+1]=s.Names[P];var se=[],me=[],ce=!1;cu[16]={n:"BrtShortReal",f:rb};var fe;if(Pa(e,function(Q,ee,V){if(!g)switch(V){case 148:d=Q;break;case 0:y=Q,u.sheetRows&&u.sheetRows<=y.r&&(g=!0),D=Tr(S=y.r),u["!row"]=y.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=Dl(Q.hpt)),me[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:Q[2]},Q[2]){case"n":w.v=Q[1];break;case"s":b=Bc[Q[1]],w.v=b.t,w.r=b.r;break;case"b":w.v=!!Q[1];break;case"e":w.v=Q[1],u.cellText!==!1&&(w.w=Ia[w.v]);break;case"str":w.t="s",w.v=Q[1];break;case"is":w.t="s",w.v=Q[1].t;break}if((v=o.CellXf[Q[0].iStyleRef])&&Zk(w,v.numFmtId,null,u,a,o),E=Q[0].c==-1?E+1:Q[0].c,u.dense?(f[S]||(f[S]=[]),f[S][E]=w):f[ur(E)+D]=w,u.cellFormula){for(U=!1,T=0;T<z.length;++T){var F=z[T];y.r>=F[0].s.r&&y.r<=F[0].e.r&&E>=F[0].s.c&&E<=F[0].e.c&&(w.F=vt(F[0]),U=!0)}!U&&Q.length>3&&(w.f=Q[3])}if(p.s.r>y.r&&(p.s.r=y.r),p.s.c>E&&(p.s.c=E),p.e.r<y.r&&(p.e.r=y.r),p.e.c<E&&(p.e.c=E),u.cellDates&&v&&w.t=="n"&&wo(st[v.numFmtId])){var N=fi(w.v);N&&(w.t="d",w.v=new Date(N.y,N.m-1,N.d,N.H,N.M,N.S,N.u))}fe&&(fe.type=="XLDAPR"&&(w.D=!0),fe=void 0);break;case 1:case 12:if(!u.sheetStubs||m)break;w={t:"z",v:void 0},E=Q[0].c==-1?E+1:Q[0].c,u.dense?(f[S]||(f[S]=[]),f[S][E]=w):f[ur(E)+D]=w,p.s.r>y.r&&(p.s.r=y.r),p.s.c>E&&(p.s.c=E),p.e.r<y.r&&(p.e.r=y.r),p.e.c<E&&(p.e.c=E),fe&&(fe.type=="XLDAPR"&&(w.D=!0),fe=void 0);break;case 176:C.push(Q);break;case 49:fe=((u.xlmeta||{}).Cell||[])[Q-1];break;case 494:var L=n["!id"][Q.relId];for(L?(Q.Target=L.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=L):Q.relId==""&&(Q.Target="#"+Q.loc),S=Q.rfx.s.r;S<=Q.rfx.e.r;++S)for(E=Q.rfx.s.c;E<=Q.rfx.e.c;++E)u.dense?(f[S]||(f[S]=[]),f[S][E]||(f[S][E]={t:"z",v:void 0}),f[S][E].l=Q):(A=ut({c:E,r:S}),f[A]||(f[A]={t:"z",v:void 0}),f[A].l=Q);break;case 426:if(!u.cellFormula)break;z.push(Q),O=u.dense?f[S][E]:f[ur(E)+D],O.f=wn(Q[1],p,{r:y.r,c:E},re,u),O.F=vt(Q[0]);break;case 427:if(!u.cellFormula)break;Z[ut(Q[0].s)]=Q[1],O=u.dense?f[S][E]:f[ur(E)+D],O.f=wn(Q[1],p,{r:y.r,c:E},re,u);break;case 60:if(!u.cellStyles)break;for(;Q.e>=Q.s;)se[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},ce||(ce=!0,cx(Q.w/256)),wi(se[Q.e+1]);break;case 161:f["!autofilter"]={ref:vt(Q)};break;case 476:f["!margins"]=Q;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),Q.name&&(s.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(f["!outline"]={above:Q.above,left:Q.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),Q.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!ee.T){if(!m||u.WTF)throw new Error("Unexpected record 0x"+V.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(p.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=vt(d||p)),u.sheetRows&&f["!ref"]){var de=Rt(f["!ref"]);u.sheetRows<=+de.e.r&&(de.e.r=u.sheetRows-1,de.e.r>p.e.r&&(de.e.r=p.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>p.e.c&&(de.e.c=p.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),f["!fullref"]=f["!ref"],f["!ref"]=vt(de))}return C.length>0&&(f["!merges"]=C),se.length>0&&(f["!cols"]=se),me.length>0&&(f["!rows"]=me),f}function vB(e,t,r,n,s,a,o){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Zt(t),t.z=t.z||st[14],t.v=Kr(fr(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var f={r,c:n};switch(f.s=Ni(s.cellXfs,t,s),t.l&&a["!links"].push([ut(f),t.l]),t.c&&a["!comments"].push([ut(f),t.c]),t.t){case"s":case"str":return s.bookSST?(u=px(s.Strings,t.v,s.revStrings),f.t="s",f.v=u,o?Ne(e,18,L7(t,f)):Ne(e,7,I7(t,f))):(f.t="str",o?Ne(e,17,q7(t,f)):Ne(e,6,X7(t,f))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Ne(e,13,V7(t,f)):Ne(e,2,z7(t,f)):o?Ne(e,16,U7(t,f)):Ne(e,5,B7(t,f)),!0;case"b":return f.t="b",o?Ne(e,15,A7(t,f)):Ne(e,4,C7(t,f)),!0;case"e":return f.t="e",o?Ne(e,14,R7(t,f)):Ne(e,3,D7(t,f)),!0}return o?Ne(e,12,E7(t,f)):Ne(e,1,k7(t,f)),!0}function yB(e,t,r,n){var s=Rt(t["!ref"]||"A1"),a,o="",u=[];Ne(e,145);var f=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var p=s.s.r;p<=d;++p){o=Tr(p),x7(e,t,s,p);var m=!1;if(p<=s.e.r)for(var g=s.s.c;g<=s.e.c;++g){p===s.s.r&&(u[g]=ur(g)),a=u[g]+o;var y=f?(t[p]||[])[g]:t[a];if(!y){m=!1;continue}m=vB(e,y,p,g,n,t,m)}}Ne(e,146)}function wB(e,t){!t||!t["!merges"]||(Ne(e,177,rB(t["!merges"].length)),t["!merges"].forEach(function(r){Ne(e,176,tB(r))}),Ne(e,178))}function _B(e,t){!t||!t["!cols"]||(Ne(e,390),t["!cols"].forEach(function(r,n){r&&Ne(e,60,lB(n,r))}),Ne(e,391))}function SB(e,t){!t||!t["!ref"]||(Ne(e,648),Ne(e,649,hB(Rt(t["!ref"]))),Ne(e,650))}function kB(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Ht(r,-1,n[1].Target.replace(/#.*$/,""),bt.HLINK);Ne(e,494,sB(n,s))}}),delete t["!links"]}function bB(e,t,r,n){if(t["!comments"].length>0){var s=Ht(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",bt.VML);Ne(e,551,tx("rId"+s)),t["!legacy"]=s}}function EB(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:vt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=Pn(a);u.s.r==u.e.r&&(u.e.r=Pn(t["!ref"]).e.r,a=vt(u));for(var f=0;f<o.length;++f){var d=o[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+a;break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ne(e,161,$l(Rt(a))),Ne(e,162)}}function TB(e,t,r){Ne(e,133),Ne(e,137,dB(t,r)),Ne(e,138),Ne(e,134)}function CB(e,t){t["!protect"]&&Ne(e,535,pB(t["!protect"]))}function NB(e,t,r,n){var s=Vn(),a=r.SheetNames[e],o=r.Sheets[a]||{},u=a;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var f=Rt(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ne(s,129),(r.vbaraw||o["!outline"])&&Ne(s,147,_7(u,o["!outline"])),Ne(s,148,v7(f)),TB(s,o,r.Workbook),_B(s,o),yB(s,o,e,t),CB(s,o),EB(s,o,r,e),wB(s,o),kB(s,o,n),o["!margins"]&&Ne(s,476,uB(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&SB(s,o),bB(s,o,e,n),Ne(s,130),s.end()}function AB(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=Bt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function jB(e,t,r,n,s,a){var o=a||{"!type":"chart"};if(!e)return a;var u=0,f=0,d="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=AB(m);p.s.r=p.s.c=0,p.e.c=u,d=ur(u),g[0].forEach(function(y,w){o[d+Tr(w)]={t:"n",v:y,z:g[1]},f=w}),p.e.r<f&&(p.e.r=f),++u}),u>0&&(o["!ref"]=vt(p)),o}function DB(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,u=e.match(eb);return u&&mx(u[0],a,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function FB(e,t){e.l+=10;var r=bn(e);return{name:r}}function RB(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Pa(e,function(f,d,p){switch(p){case 550:a["!rel"]=f;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),f.name&&(s.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var xx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],PB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],IB=[],OB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function uw(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=cr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function fw(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=cr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function sb(e){fw(e.WBProps,xx),fw(e.CalcPr,OB),uw(e.WBView,PB),uw(e.Sheets,IB),kl.date1904=cr(e.WBProps.date1904)}function LB(e){return!e.Workbook||!e.Workbook.WBProps?"false":cr(e.Workbook.WBProps.date1904)?"true":"false"}var MB="][*?/\\".split("");function ab(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return MB.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function BB(e,t,r){e.forEach(function(n,s){ab(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[s]&&t[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function ib(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];BB(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)LM(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var UB=/<\w+:workbook/;function $B(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},o=0;if(e.replace(Tn,function(f,d){var p=dt(f);switch(da(p[0])){case"<?xml":break;case"<workbook":f.match(UB)&&(s="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=p[s];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":xx.forEach(function(m){if(p[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=cr(p[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(p[m[0]],10);break;default:r.WBProps[m[0]]=p[m[0]]}}),p.codeName&&(r.WBProps.CodeName=Xt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Bt(Xt(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Xt(p.name),p.comment&&(a.Comment=p.comment),p.localSheetId&&(a.Sheet=+p.localSheetId),cr(p.hidden||"0")&&(a.Hidden=!0),o=d+f.length;break;case"</definedName>":a.Ref=Bt(Xt(e.slice(o,d))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return f}),_o.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return sb(r),r}function ob(e){var t=[Or];t[t.length]=Be("workbook",null,{xmlns:_o[0],"xmlns:r":Xr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(xx.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Be("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var o={name:Gt(e.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Be("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(t[t.length]=Be("definedName",Gt(u.Ref),f))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function zB(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Kp(e),r.name=bn(e),r}function WB(e,t){return t||(t=Ee(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),tx(e.strRelID,t),sn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function VB(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?bn(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function HB(e,t){t||(t=Ee(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),JS(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function GB(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function XB(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=bI(e),o=DM(e,0,r),u=ex(e);e.l=n;var f={Name:a,Ptg:o};return s<268435455&&(f.Sheet=s),u&&(f.Comment=u),f}function KB(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],cu[16]={n:"BrtFRTArchID$",f:GB},Pa(e,function(f,d,p){switch(p){case 156:o.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(t.SID=f.Sheet),f.Ref=wn(f.Ptg,null,null,o,t),delete t.SID,delete f.Ptg,a.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([p,f]):o[0]=[p,f],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(f),o.XTI=o.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(p),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},t),sb(r),r.Names=a,r.supbooks=o,r}function qB(e,t){Ne(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ne(e,156,WB(s))}Ne(e,144)}function YB(e,t){t||(t=Ee(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return sn("SheetJS",t),sn(Qc.version,t),sn(Qc.version,t),sn("7262",t),t.length>t.l?t.slice(0,t.l):t}function JB(e,t){t||(t=Ee(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function QB(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(Ne(e,135),Ne(e,158,JB(s)),Ne(e,136))}}function ZB(e,t){var r=Vn();return Ne(r,131),Ne(r,128,YB()),Ne(r,153,HB(e.Workbook&&e.Workbook.WBProps||null)),QB(r,e),qB(r,e),Ne(r,132),r.end()}function e9(e,t,r){return t.slice(-4)===".bin"?KB(e,r):$B(e,r)}function t9(e,t,r,n,s,a,o,u){return t.slice(-4)===".bin"?gB(e,n,r,s,a,o,u):KM(e,n,r,s,a,o,u)}function r9(e,t,r,n,s,a,o,u){return t.slice(-4)===".bin"?RB(e,n,r,s,a):DB(e,n,r,s,a)}function n9(e,t,r,n,s,a,o,u){return t.slice(-4)===".bin"?iL():oL()}function s9(e,t,r,n,s,a,o,u){return t.slice(-4)===".bin"?sL():aL()}function a9(e,t,r,n){return t.slice(-4)===".bin"?t5(e,r,n):W6(e,r,n)}function i9(e,t,r){return Uk(e,r)}function o9(e,t,r){return t.slice(-4)===".bin"?l6(e,r):a6(e,r)}function l9(e,t,r){return t.slice(-4)===".bin"?Z5(e,r):V5(e,r)}function c9(e,t,r){return t.slice(-4)===".bin"?$5(e):B5(e)}function u9(e,t,r,n){return r.slice(-4)===".bin"?z5(e,t,r,n):void 0}function f9(e,t,r){return t.slice(-4)===".bin"?O5(e,t,r):M5(e,t,r)}function d9(e,t,r){return(t.slice(-4)===".bin"?ZB:ob)(e)}function h9(e,t,r,n,s){return(t.slice(-4)===".bin"?NB:tb)(e,r,n,s)}function p9(e,t,r){return(t.slice(-4)===".bin"?f5:Mk)(e,r)}function m9(e,t,r){return(t.slice(-4)===".bin"?f6:jk)(e,r)}function x9(e,t,r){return(t.slice(-4)===".bin"?eL:Wk)(e)}function g9(e){return(e.slice(-4)===".bin"?L5:$k)()}var lb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,cb=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ns(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(lb),a,o,u,f;if(s)for(f=0;f!=s.length;++f)a=s[f].match(cb),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?u="xmlns"+a[1].slice(6):u=a[1].slice(o+1),n[u]=a[2].slice(1,a[2].length-1));return n}function v9(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(lb),s,a,o,u;if(n)for(u=0;u!=n.length;++u)s=n[u].match(cb),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),r[o]=s[2].slice(1,s[2].length-1));return r}var $c;function y9(e,t){var r=$c[e]||Bt(e);return r==="General"?co(t):rs(r,t)}function w9(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=cr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=fr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Bt(t)]=s}function _9(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ia[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=eu(e.v):e.w=co(e.v):e.w=y9(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=$c[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&wo(n)){var s=fi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function S9(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=I6[n.Pattern]||n.Pattern)}e[t.ID]=t}function k9(e,t,r,n,s,a,o,u,f,d){var p="General",m=n.StyleID,g={};d=d||{};var y=[],w=0;for(m===void 0&&u&&(m=u.StyleID),m===void 0&&o&&(m=o.StyleID);a[m]!==void 0&&(a[m].nf&&(p=a[m].nf),a[m].Interior&&y.push(a[m].Interior),!!a[m].Parent);)m=a[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=cr(e);break;case"String":n.t="s",n.r=Ny(Bt(e)),n.v=e.indexOf("<")>-1?Bt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(fr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Bt(e):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=rk[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Ny(t||e));break}if(_9(n,p,d),d.cellFormula!==!1)if(n.Formula){var v=Bt(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Sl(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Sl("RC:RC",s):n.ArrayRange&&(n.F=Sl(n.ArrayRange,s),f.push([Rt(n.F),n.F]))}else for(w=0;w<f.length;++w)s.r>=f[w][0].s.r&&s.r<=f[w][0].e.r&&s.c>=f[w][0].s.c&&s.c<=f[w][0].e.c&&(n.F=f[w][1]);d.cellStyles&&(y.forEach(function(S){!g.patternType&&S.patternType&&(g.patternType=S.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function b9(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function pp(e,t){var r=t||{};Ml();var n=ml(Vm(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Ot<"u"?n=Ot.utils.decode(65001,md(n)):n=Xt(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=Zt(r);return o.type="string",jl.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(je){s.indexOf("<"+je)>=0&&(a=!0)}),a)return iU(n,r);$c={"General Number":"General","General Date":st[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":st[15],"Short Date":st[14],"Long Time":st[19],"Medium Time":st[18],"Short Time":st[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:st[2],Standard:st[4],Percent:st[10],Scientific:st[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],d,p={},m=[],g=r.dense?[]:{},y="",w={},v={},S=Ns('<Data ss:Type="String">'),E=0,A=0,b=0,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},C={},T="",U=0,z=[],Z={},re={},P=0,se=[],me=[],ce={},fe=[],de,he=!1,Q=[],ee=[],V={},F=0,N=0,L={Sheets:[],WBProps:{date1904:!1}},B={};nu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var q="";u=nu.exec(n);)switch(u[3]=(q=u[3]).toLowerCase()){case"data":if(q=="data"){if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?k9(n.slice(E,u.index),T,S,f[f.length-1][0]=="comment"?ce:w,{c:A,r:b},O,fe[A],v,Q,r):(T="",S=Ns(u[0]),E=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(me.length>0&&(w.c=me),(!r.sheetRows||r.sheetRows>b)&&w.v!==void 0&&(r.dense?(g[b]||(g[b]=[]),g[b][A]=w):g[ur(A)+Tr(b)]=w),w.HRef&&(w.l={Target:Bt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(F=A+(parseInt(w.MergeAcross,10)|0),N=b+(parseInt(w.MergeDown,10)|0),z.push({s:{c:A,r:b},e:{c:F,r:N}})),!r.sheetStubs)w.MergeAcross?A=F+1:++A;else if(w.MergeAcross||w.MergeDown){for(var ne=A;ne<=F;++ne)for(var Y=b;Y<=N;++Y)(ne>A||Y>b)&&(r.dense?(g[Y]||(g[Y]=[]),g[Y][ne]={t:"z"}):g[ur(ne)+Tr(Y)]={t:"z"});A=F+1}else++A;else w=v9(u[0]),w.Index&&(A=+w.Index-1),A<D.s.c&&(D.s.c=A),A>D.e.c&&(D.e.c=A),u[0].slice(-2)==="/>"&&++A,me=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(b<D.s.r&&(D.s.r=b),b>D.e.r&&(D.e.r=b),u[0].slice(-2)==="/>"&&(v=Ns(u[0]),v.Index&&(b=+v.Index-1)),A=0,++b):(v=Ns(u[0]),v.Index&&(b=+v.Index-1),V={},(v.AutoFitHeight=="0"||v.Height)&&(V.hpx=parseInt(v.Height,10),V.hpt=lu(V.hpx),ee[b]=V),v.Hidden=="1"&&(V.hidden=!0,ee[b]=V));break;case"worksheet":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));m.push(y),D.s.r<=D.e.r&&D.s.c<=D.e.c&&(g["!ref"]=vt(D),r.sheetRows&&r.sheetRows<=D.e.r&&(g["!fullref"]=g["!ref"],D.e.r=r.sheetRows-1,g["!ref"]=vt(D))),z.length&&(g["!merges"]=z),fe.length>0&&(g["!cols"]=fe),ee.length>0&&(g["!rows"]=ee),p[y]=g}else D={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=A=0,f.push([u[3],!1]),d=Ns(u[0]),y=Bt(d.Name),g=r.dense?[]:{},z=[],Q=[],ee=[],B={name:y,Hidden:0},L.Sheets.push(B);break;case"table":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),fe=[],he=!1}break;case"style":u[1]==="/"?S9(O,C,r):C=Ns(u[0]);break;case"numberformat":C.nf=Bt(Ns(u[0]).Format||"General"),$c[C.nf]&&(C.nf=$c[C.nf]);for(var oe=0;oe!=392&&st[oe]!=C.nf;++oe);if(oe==392){for(oe=57;oe!=392;++oe)if(st[oe]==null){la(C.nf,oe);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(de=Ns(u[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!he&&de.wpx>10){he=!0,_n=Ok;for(var le=0;le<fe.length;++le)fe[le]&&wi(fe[le])}he&&wi(de),fe[de.Index-1||fe.length]=de;for(var te=0;te<+de.Span;++te)fe[fe.length]=Zt(de);break;case"namedrange":if(u[1]==="/")break;L.Names||(L.Names=[]);var I=dt(u[0]),Ce={Name:I.Name,Ref:Sl(I.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(Ce.Sheet=L.Sheets.length-1),L.Names.push(Ce);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?T+=n.slice(U,u.index):U=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;C.Interior=Ns(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?qI(Z,q,n.slice(P,u.index)):P=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));b9(ce),me.push(ce)}else f.push([u[3],!1]),d=Ns(u[0]),ce={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Ie=Ns(u[0]);g["!autofilter"]={ref:Sl(Ie.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return xw(n,r);var ue=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ue=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ue=!1}break;case"excelworkbook":switch(u[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ue=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:ue=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(P,u.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else P=u.index+u[0].length;break;case"header":g["!margins"]||eo(g["!margins"]={},"xlml"),isNaN(+dt(u[0]).Margin)||(g["!margins"].header=+dt(u[0]).Margin);break;case"footer":g["!margins"]||eo(g["!margins"]={},"xlml"),isNaN(+dt(u[0]).Margin)||(g["!margins"].footer=+dt(u[0]).Margin);break;case"pagemargins":var ge=dt(u[0]);g["!margins"]||eo(g["!margins"]={},"xlml"),isNaN(+ge.Top)||(g["!margins"].top=+ge.Top),isNaN(+ge.Left)||(g["!margins"].left=+ge.Left),isNaN(+ge.Right)||(g["!margins"].right=+ge.Right),isNaN(+ge.Bottom)||(g["!margins"].bottom=+ge.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ue=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ue=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ue=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ue=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ue=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ue=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ue=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ue=!1}break;case"smarttags":break;default:ue=!1;break}if(ue||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?w9(re,q,se,n.slice(P,u.index)):(se=u,P=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var _e={};return!r.bookSheets&&!r.bookProps&&(_e.Sheets=p),_e.SheetNames=m,_e.Workbook=L,_e.SSF=Zt(st),_e.Props=Z,_e.Custprops=re,_e}function tm(e,t){switch(yx(t=t||{}),t.type||"base64"){case"base64":return pp(ts(e),t);case"binary":case"buffer":case"file":return pp(e,t);case"array":return pp(Ti(e),t)}}function E9(e,t){var r=[];return e.Props&&r.push(YI(e.Props,t)),e.Custprops&&r.push(JI(e.Props,e.Custprops)),r.join("")}function T9(){return""}function C9(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Be("NumberFormat",null,{"ss:Format":Gt(st[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Be("Style",a.join(""),o))}),Be("Styles",r.join(""))}function ub(e){return Be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+dx(e.Ref,{r:0,c:0})})}function N9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(ub(s)))}return Be("Names",r.join(""))}function A9(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],o=0;o<s.length;++o){var u=s[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||a.push(ub(u)))}return a.join("")}function j9(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Be("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(fn("ProtectContents","True")),e["!protect"].objects&&s.push(fn("ProtectObjects","True")),e["!protect"].scenarios&&s.push(fn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(fn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(fn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Be("WorksheetOptions",s.join(""),{xmlns:Yn.x})}function D9(e){return e.map(function(t){var r=ZP(t.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":t.a})}).join("")}function F9(e,t,r,n,s,a,o){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Gt(dx(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var f=vr(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Gt(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Gt(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],p=0;p!=d.length;++p)d[p].s.c!=o.c||d[p].s.r!=o.r||(d[p].e.c>d[p].s.c&&(u["ss:MergeAcross"]=d[p].e.c-d[p].s.c),d[p].e.r>d[p].s.r&&(u["ss:MergeDown"]=d[p].e.r-d[p].s.r));var m="",g="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":m="Number",g=String(e.v);break;case"b":m="Boolean",g=e.v?"1":"0";break;case"e":m="Error",g=Ia[e.v];break;case"d":m="DateTime",g=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||st[14]);break;case"s":m="String",g=QP(e.v||"");break}var y=Ni(n.cellXfs,e,n);u["ss:StyleID"]="s"+(21+y),u["ss:Index"]=o.c+1;var w=e.v!=null?g:"",v=e.t=="z"?"":'<Data ss:Type="'+m+'">'+w+"</Data>";return(e.c||[]).length>0&&(v+=D9(e.c)),Be("Cell",v,u)}function R9(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Dl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function P9(e,t,r,n){if(!e["!ref"])return"";var s=Rt(e["!ref"]),a=e["!merges"]||[],o=0,u=[];e["!cols"]&&e["!cols"].forEach(function(S,E){wi(S);var A=!!S.width,b=qd(E,S),D={"ss:Index":E+1};A&&(D["ss:Width"]=iu(b.width)),S.hidden&&(D["ss:Hidden"]="1"),u.push(Be("Column",null,D))});for(var f=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var p=[R9(d,(e["!rows"]||[])[d])],m=s.s.c;m<=s.e.c;++m){var g=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>m)&&!(a[o].s.r>d)&&!(a[o].e.c<m)&&!(a[o].e.r<d)){(a[o].s.c!=m||a[o].s.r!=d)&&(g=!0);break}if(!g){var y={r:d,c:m},w=ut(y),v=f?(e[d]||[])[m]:e[w];p.push(F9(v,w,e,t,r,n,y))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function I9(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],o=a?A9(a,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?P9(a,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(j9(a,t,e,r)),n.join("")}function O9(e,t){t||(t={}),e.SSF||(e.SSF=Zt(st)),e.SSF&&(Ml(),yu(e.SSF),t.revssf=Wd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ni(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(E9(e,t)),r.push(T9()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Be("Worksheet",I9(n,t,e),{"ss:Name":Gt(e.SheetNames[n])}));return r[2]=C9(e,t),r[3]=N9(e),Or+Be("Workbook",r.join(""),{xmlns:Yn.ss,"xmlns:o":Yn.o,"xmlns:x":Yn.x,"xmlns:ss":Yn.ss,"xmlns:dt":Yn.dt,"xmlns:html":Yn.html})}function L9(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=AI(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=jI(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var M9=[60,1084,2066,2165,2175];function B9(e,t,r,n,s){var a=n,o=[],u=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}o.push(u),r.l+=a;for(var f=ba(r,r.l),d=rm[f],p=0;d!=null&&M9.indexOf(f)>-1;)a=ba(r,r.l+2),p=r.l+4,f==2066?p+=4:(f==2165||f==2175)&&(p+=12),u=r.slice(p,r.l+4+a),o.push(u),r.l+=4+a,d=rm[f=ba(r,r.l)];var m=nn(o);un(m,0);var g=0;m.lens=[];for(var y=0;y<o.length;++y)m.lens.push(g),g+=o[y].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,s)}function Js(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=st[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ia[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=eu(e.v):e.w=co(e.v):e.w=rs(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&wo(st[n]||String(n))){var s=fi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Zf(e,t,r){return{v:e,ixfe:t,t:r}}function U9(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},o={},u=null,f=[],d="",p={},m,g="",y,w,v,S,E={},A=[],b,D,O=[],C=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},U={},z=function(at){return at<8?Ji[at]:at<64&&C[at-8]||Ji[at]},Z=function(at,zt,Ar){var hr=zt.XF.data;if(!(!hr||!hr.patternType||!Ar||!Ar.cellStyles)){zt.s={},zt.s.patternType=hr.patternType;var ns;(ns=au(z(hr.icvFore)))&&(zt.s.fgColor={rgb:ns}),(ns=au(z(hr.icvBack)))&&(zt.s.bgColor={rgb:ns})}},re=function(at,zt,Ar){if(!(V>1)&&!(Ar.sheetRows&&at.r>=Ar.sheetRows)){if(Ar.cellStyles&&zt.XF&&zt.XF.data&&Z(at,zt,Ar),delete zt.ixfe,delete zt.XF,m=at,g=ut(at),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),at.r<o.s.r&&(o.s.r=at.r),at.c<o.s.c&&(o.s.c=at.c),at.r+1>o.e.r&&(o.e.r=at.r+1),at.c+1>o.e.c&&(o.e.c=at.c+1),Ar.cellFormula&&zt.f){for(var hr=0;hr<A.length;++hr)if(!(A[hr][0].s.c>at.c||A[hr][0].s.r>at.r)&&!(A[hr][0].e.c<at.c||A[hr][0].e.r<at.r)){zt.F=vt(A[hr][0]),(A[hr][0].s.c!=at.c||A[hr][0].s.r!=at.r)&&delete zt.f,zt.f&&(zt.f=""+wn(A[hr][1],o,at,Q,P));break}}Ar.dense?(s[at.r]||(s[at.r]=[]),s[at.r][at.c]=zt):s[g]=zt}},P={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var se,me=[],ce=[],fe=[],de=[],he=!1,Q=[];Q.SheetNames=P.snames,Q.sharedf=P.sharedf,Q.arrayf=P.arrayf,Q.names=[],Q.XTI=[];var ee=0,V=0,F=0,N=[],L=[],B;P.codepage=1200,xs(1200);for(var q=!1;e.l<e.length-1;){var ne=e.l,Y=e.read_shift(2);if(Y===0&&ee===10)break;var oe=e.l===e.length?0:e.read_shift(2),le=rm[Y];if(le&&le.f){if(t.bookSheets&&ee===133&&Y!==133)break;if(ee=Y,le.r===2||le.r==12){var te=e.read_shift(2);if(oe-=2,!P.enc&&te!==Y&&((te&255)<<8|te>>8)!==Y)throw new Error("rt mismatch: "+te+"!="+Y);le.r==12&&(e.l+=10,oe-=10)}var I={};if(Y===10?I=le.f(e,oe,P):I=B9(Y,le,e,oe,P),V==0&&[9,521,1033,2057].indexOf(ee)===-1)continue;switch(Y){case 34:r.opts.Date1904=T.WBProps.date1904=I;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=I,!t.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=I;break;case 66:var Ce=Number(I);switch(Ce){case 21010:Ce=1200;break;case 32768:Ce=1e4;break;case 32769:Ce=1252;break}xs(P.codepage=Ce),q=!0;break;case 317:P.rrtabid=I;break;case 25:P.winlocked=I;break;case 439:r.opts.RefreshAll=I;break;case 12:r.opts.CalcCount=I;break;case 16:r.opts.CalcDelta=I;break;case 17:r.opts.CalcIter=I;break;case 13:r.opts.CalcMode=I;break;case 14:r.opts.CalcPrecision=I;break;case 95:r.opts.CalcSaveRecalc=I;break;case 15:P.CalcRefMode=I;break;case 2211:r.opts.FullCalc=I;break;case 129:I.fDialog&&(s["!type"]="dialog"),I.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),I.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:O.push(I);break;case 430:Q.push([I]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(I);break;case 24:case 536:B={Name:I.Name,Ref:wn(I.rgce,o,null,Q,P)},I.itab>0&&(B.Sheet=I.itab-1),Q.names.push(B),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(L[I.itab-1]={ref:vt(I.rgce[0][0][1][2])});break;case 22:P.ExternCount=I;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(I),Q.XTI=Q.XTI.concat(I);break;case 2196:if(P.biff<8)break;B!=null&&(B.Comment=I[1]);break;case 18:s["!protect"]=I;break;case 19:I!==0&&P.WTF&&console.error("Password verifier: "+I);break;case 133:a[I.pos]=I,P.snames.push(I.name);break;case 10:{if(--V)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=vt(o),t.sheetRows&&t.sheetRows<=o.e.r){var Ie=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=vt(o),o.e.r=Ie}o.e.r++,o.e.c++}me.length>0&&(s["!merges"]=me),ce.length>0&&(s["!objects"]=ce),fe.length>0&&(s["!cols"]=fe),de.length>0&&(s["!rows"]=de),T.Sheets.push(U)}d===""?p=s:n[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Y]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),P.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(P.biff=5,q=!0,xs(P.codepage=28591)),P.biff==8&&I.BIFFVer==0&&I.dt==16&&(P.biff=2),V++)break;if(s=t.dense?[]:{},P.biff<8&&!q&&(q=!0,xs(P.codepage=t.codepage||1252)),P.biff<5||I.BIFFVer==0&&I.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ue={pos:e.l-oe,name:d};a[ue.pos]=ue,P.snames.push(d)}else d=(a[ne]||{name:""}).name;I.dt==32&&(s["!type"]="chart"),I.dt==64&&(s["!type"]="macro"),me=[],ce=[],P.arrayf=A=[],fe=[],de=[],he=!1,U={Hidden:(a[ne]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[I.r]||[])[I.c]:s[ut({c:I.c,r:I.r})])&&++I.c,b={ixfe:I.ixfe,XF:O[I.ixfe]||{},v:I.val,t:"n"},F>0&&(b.z=N[b.ixfe>>8&63]),Js(b,t,r.opts.Date1904),re({c:I.c,r:I.r},b,t);break;case 5:case 517:b={ixfe:I.ixfe,XF:O[I.ixfe],v:I.val,t:I.t},F>0&&(b.z=N[b.ixfe>>8&63]),Js(b,t,r.opts.Date1904),re({c:I.c,r:I.r},b,t);break;case 638:b={ixfe:I.ixfe,XF:O[I.ixfe],v:I.rknum,t:"n"},F>0&&(b.z=N[b.ixfe>>8&63]),Js(b,t,r.opts.Date1904),re({c:I.c,r:I.r},b,t);break;case 189:for(var ge=I.c;ge<=I.C;++ge){var _e=I.rkrec[ge-I.c][0];b={ixfe:_e,XF:O[_e],v:I.rkrec[ge-I.c][1],t:"n"},F>0&&(b.z=N[b.ixfe>>8&63]),Js(b,t,r.opts.Date1904),re({c:ge,r:I.r},b,t)}break;case 6:case 518:case 1030:{if(I.val=="String"){u=I;break}if(b=Zf(I.val,I.cell.ixfe,I.tt),b.XF=O[b.ixfe],t.cellFormula){var je=I.formula;if(je&&je[0]&&je[0][0]&&je[0][0][0]=="PtgExp"){var Ke=je[0][0][1][0],ot=je[0][0][1][1],ft=ut({r:Ke,c:ot});E[ft]?b.f=""+wn(I.formula,o,I.cell,Q,P):b.F=((t.dense?(s[Ke]||[])[ot]:s[ft])||{}).F}else b.f=""+wn(I.formula,o,I.cell,Q,P)}F>0&&(b.z=N[b.ixfe>>8&63]),Js(b,t,r.opts.Date1904),re(I.cell,b,t),u=I}break;case 7:case 519:if(u)u.val=I,b=Zf(I,u.cell.ixfe,"s"),b.XF=O[b.ixfe],t.cellFormula&&(b.f=""+wn(u.formula,o,u.cell,Q,P)),F>0&&(b.z=N[b.ixfe>>8&63]),Js(b,t,r.opts.Date1904),re(u.cell,b,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(I);var et=ut(I[0].s);if(y=t.dense?(s[I[0].s.r]||[])[I[0].s.c]:s[et],t.cellFormula&&y){if(!u||!et||!y)break;y.f=""+wn(I[1],o,I[0],Q,P),y.F=vt(I[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!u)break;E[ut(u.cell)]=I[0],y=t.dense?(s[u.cell.r]||[])[u.cell.c]:s[ut(u.cell)],(y||{}).f=""+wn(I[0],o,m,Q,P)}}break;case 253:b=Zf(f[I.isst].t,I.ixfe,"s"),f[I.isst].h&&(b.h=f[I.isst].h),b.XF=O[b.ixfe],F>0&&(b.z=N[b.ixfe>>8&63]),Js(b,t,r.opts.Date1904),re({c:I.c,r:I.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:I.ixfe,XF:O[I.ixfe],t:"z"},F>0&&(b.z=N[b.ixfe>>8&63]),Js(b,t,r.opts.Date1904),re({c:I.c,r:I.r},b,t));break;case 190:if(t.sheetStubs)for(var tt=I.c;tt<=I.C;++tt){var lt=I.ixfe[tt-I.c];b={ixfe:lt,XF:O[lt],t:"z"},F>0&&(b.z=N[b.ixfe>>8&63]),Js(b,t,r.opts.Date1904),re({c:tt,r:I.r},b,t)}break;case 214:case 516:case 4:b=Zf(I.val,I.ixfe,"s"),b.XF=O[b.ixfe],F>0&&(b.z=N[b.ixfe>>8&63]),Js(b,t,r.opts.Date1904),re({c:I.c,r:I.r},b,t);break;case 0:case 512:V===1&&(o=I);break;case 252:f=I;break;case 1054:if(P.biff==4){N[F++]=I[1];for(var Ye=0;Ye<F+163&&st[Ye]!=I[1];++Ye);Ye>=163&&la(I[1],F+163)}else la(I[1],I[0]);break;case 30:{N[F++]=I;for(var Tt=0;Tt<F+163&&st[Tt]!=I;++Tt);Tt>=163&&la(I,F+163)}break;case 229:me=me.concat(I);break;case 93:ce[I.cmo[0]]=P.lastobj=I;break;case 438:P.lastobj.TxO=I;break;case 127:P.lastobj.ImData=I;break;case 440:for(S=I[0].s.r;S<=I[0].e.r;++S)for(v=I[0].s.c;v<=I[0].e.c;++v)y=t.dense?(s[S]||[])[v]:s[ut({c:v,r:S})],y&&(y.l=I[1]);break;case 2048:for(S=I[0].s.r;S<=I[0].e.r;++S)for(v=I[0].s.c;v<=I[0].e.c;++v)y=t.dense?(s[S]||[])[v]:s[ut({c:v,r:S})],y&&y.l&&(y.l.Tooltip=I[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;y=t.dense?(s[I[0].r]||[])[I[0].c]:s[ut(I[0])];var dr=ce[I[2]];y||(t.dense?(s[I[0].r]||(s[I[0].r]=[]),y=s[I[0].r][I[0].c]={t:"z"}):y=s[ut(I[0])]={t:"z"},o.e.r=Math.max(o.e.r,I[0].r),o.s.r=Math.min(o.s.r,I[0].r),o.e.c=Math.max(o.e.c,I[0].c),o.s.c=Math.min(o.s.c,I[0].c)),y.c||(y.c=[]),w={a:I[1],t:dr.TxO.t},y.c.push(w)}break;case 2173:N5(O[I.ixfe],I.ext);break;case 125:{if(!P.cellStyles)break;for(;I.e>=I.s;)fe[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},he||(he=!0,cx(I.w/256)),wi(fe[I.e+1])}break;case 520:{var Kt={};I.level!=null&&(de[I.r]=Kt,Kt.level=I.level),I.hidden&&(de[I.r]=Kt,Kt.hidden=!0),I.hpt&&(de[I.r]=Kt,Kt.hpt=I.hpt,Kt.hpx=Dl(I.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||eo(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Y]]=I;break;case 161:s["!margins"]||eo(s["!margins"]={}),s["!margins"].header=I.header,s["!margins"].footer=I.footer;break;case 574:I.RTL&&(T.Views[0].RTL=!0);break;case 146:C=I;break;case 2198:se=I;break;case 140:D=I;break;case 442:d?U.CodeName=I||U.name:T.WBProps.CodeName=I||"ThisWorkbook";break}}else le||console.error("Missing Info for XLS Record 0x"+Y.toString(16)),e.l+=oe}return r.SheetNames=Nr(a).sort(function(an,at){return Number(an)-Number(at)}).map(function(an){return a[an].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&L.forEach(function(an,at){r.Sheets[r.SheetNames[at]]["!autofilter"]=an}),r.Strings=f,r.SSF=Zt(st),P.enc&&(r.Encryption=P.enc),se&&(r.Themes=se),r.Metadata={},D!==void 0&&(r.Metadata.Country=D),Q.names.length>0&&(T.Names=Q.names),r.Workbook=T,r}var zc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $9(e,t,r){var n=Ze.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=Gy(n,qp,zc.DSI);for(var a in s)t[a]=s[a]}catch(d){if(r.WTF)throw d}var o=Ze.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var u=Gy(o,Yp,zc.SI);for(var f in u)t[f]==null&&(t[f]=u[f])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(lk(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function z9(e,t){var r=[],n=[],s=[],a=0,o,u=Sy(qp,"n"),f=Sy(Yp,"n");if(e.Props)for(o=Nr(e.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(u,o[a])?r:Object.prototype.hasOwnProperty.call(f,o[a])?n:s).push([o[a],e.Props[o[a]]]);if(e.Custprops)for(o=Nr(e.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(u,o[a])?r:Object.prototype.hasOwnProperty.call(f,o[a])?n:s).push([o[a],e.Custprops[o[a]]]);var d=[];for(a=0;a<s.length;++a)mk.indexOf(s[a][0])>-1||ok.indexOf(s[a][0])>-1||s[a][1]!=null&&d.push(s[a]);n.length&&Ze.utils.cfb_add(t,"/SummaryInformation",Xy(n,zc.SI,f,Yp)),(r.length||d.length)&&Ze.utils.cfb_add(t,"/DocumentSummaryInformation",Xy(r,zc.DSI,u,qp,d.length?d:null,zc.UDI))}function gx(e,t){t||(t={}),yx(t),$d(),t.codepage&&Ud(t.codepage);var r,n;if(e.FullPaths){if(Ze.find(e,"/encryption"))throw new Error("File is password-protected");r=Ze.find(e,"!CompObj"),n=Ze.find(e,"/Workbook")||Ze.find(e,"/Book")}else{switch(t.type){case"base64":e=Jn(ts(e));break;case"binary":e=Jn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}un(e,0),n={content:e}}var s,a;if(r&&L9(r),t.bookProps&&!t.bookSheets)s={};else{var o=_t?"buffer":"array";if(n&&n.content)s=U9(n.content,t);else if((a=Ze.find(e,"PerfectOffice_MAIN"))&&a.content)s=Zi.to_workbook(a.content,(t.type=o,t));else if((a=Ze.find(e,"NativeContent_MAIN"))&&a.content)s=Zi.to_workbook(a.content,(t.type=o,t));else throw(a=Ze.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ze.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=rL(e))}var u={};return e.FullPaths&&$9(e,u,t),s.Props=s.Custprops=u,t.bookFiles&&(s.cfb=e),s}function W9(e,t){var r=t||{},n=Ze.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ze.utils.cfb_add(n,s,fb(e,r)),r.biff==8&&(e.Props||e.Custprops)&&z9(e,n),r.biff==8&&e.vbaraw&&nL(n,Ze.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var cu={0:{f:p7},1:{f:S7},2:{f:$7},3:{f:j7},4:{f:T7},5:{f:M7},6:{f:G7},7:{f:P7},8:{f:Z7},9:{f:Q7},10:{f:Y7},11:{f:J7},12:{f:b7},13:{f:W7},14:{f:F7},15:{f:N7},16:{f:rb},17:{f:K7},18:{f:O7},19:{f:Zm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:XB},40:{},42:{},43:{f:G6},44:{f:V6},45:{f:q6},46:{f:J6},47:{f:Y6},48:{},49:{f:gI},50:{},51:{f:D5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Tk},62:{f:H7},63:{f:U5},64:{f:mB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:En,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:fB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:w7},148:{f:g7,p:16},151:{f:aB},152:{},153:{f:VB},154:{},155:{},156:{f:zB},157:{},158:{},159:{T:1,f:o6},160:{T:-1},161:{T:1,f:Eo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:eB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:A5},336:{T:-1},337:{f:P5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Kp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ek},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:iB},427:{f:oB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:cB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:y7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:nB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Kp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:J5},633:{T:1},634:{T:-1},635:{T:1,f:q5},636:{T:-1},637:{f:_I},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:FB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},rm={6:{f:dp},10:{f:ii},12:{f:$r},13:{f:$r},14:{f:Ir},15:{f:Ir},16:{f:Sn},17:{f:Ir},18:{f:Ir},19:{f:$r},20:{f:Zy},21:{f:Zy},23:{f:Ek},24:{f:tw},25:{f:Ir},26:{},27:{},28:{f:xO},29:{},34:{f:Ir},35:{f:ew},38:{f:Sn},39:{f:Sn},40:{f:Sn},41:{f:Sn},42:{f:Ir},43:{f:Ir},47:{f:N6},49:{f:W8},51:{f:$r},60:{},61:{f:M8},64:{f:Ir},65:{f:z8},66:{f:$r},77:{},80:{},81:{},82:{},85:{f:$r},89:{},90:{},91:{},92:{f:C8},93:{f:yO},94:{},95:{f:Ir},96:{},97:{},99:{f:Ir},125:{f:Tk},128:{f:sO},129:{f:A8},130:{f:$r},131:{f:Ir},132:{f:Ir},133:{f:j8},134:{},140:{f:CO},141:{f:$r},144:{},146:{f:jO},151:{},152:{},153:{},154:{},155:{},156:{f:$r},157:{},158:{},160:{f:LO},161:{f:RO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:eO},190:{f:tO},193:{f:ii},197:{},198:{},199:{},200:{},201:{},202:{f:Ir},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:$r},220:{},221:{f:Ir},222:{},224:{f:nO},225:{f:T8},226:{f:ii},227:{},229:{f:gO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:F8},253:{f:H8},255:{f:P8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:xk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ir},353:{f:ii},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:cO},431:{f:Ir},432:{},433:{},434:{},437:{},438:{f:SO},439:{f:Ir},440:{f:kO},441:{},442:{f:Su},443:{},444:{f:$r},445:{},446:{},448:{f:ii},449:{f:L8,r:2},450:{f:ii},512:{f:Yy},513:{f:OO},515:{f:oO},516:{f:X8},517:{f:Qy},519:{f:MO},520:{f:I8},523:{},545:{f:rw},549:{f:qy},566:{},574:{f:U8},638:{f:Z8},659:{},1048:{},1054:{f:q8},1084:{},1212:{f:hO},2048:{f:EO},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Yf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ii},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:DO,r:12},2173:{f:C5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ir,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:dO,r:12},2197:{},2198:{f:_5,r:12},2199:{},2200:{},2201:{},2202:{f:pO,r:12},2203:{f:ii},2204:{},2205:{},2206:{},2207:{},2211:{f:O8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:$r},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:PO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:AO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Yy},1:{},2:{f:WO},3:{f:$O},4:{f:UO},5:{f:Qy},7:{f:HO},8:{},9:{f:Yf},11:{},22:{f:$r},30:{f:J8},31:{},32:{},33:{f:rw},36:{},37:{f:qy},50:{f:GO},62:{},52:{},67:{},68:{f:$r},69:{},86:{},126:{},127:{f:BO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:XO},223:{},234:{},354:{},421:{},518:{f:dp},521:{f:Yf},536:{f:tw},547:{f:ew},561:{},579:{},1030:{f:dp},1033:{f:Yf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ue(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,a),a>0&&Ym(r)&&e.push(r)}}function V9(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return Ue(e,t,r,s);var a=t;if(!isNaN(a)){for(var o=r.parts||[],u=0,f=0,d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;var p=e.next(4);for(p.write_shift(2,a),p.write_shift(2,d),e.push(r.slice(f,f+d)),f+=d;f<s;){for(p=e.next(4),p.write_shift(2,60),d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;p.write_shift(2,d),e.push(r.slice(f,f+d)),f+=d}}}function Tu(e,t,r){return e||(e=Ee(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function H9(e,t,r,n){var s=Ee(9);return Tu(s,e,t),gk(r,n||"b",s),s}function G9(e,t,r){var n=Ee(8+2*r.length);return Tu(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function X9(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Kr(fr(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Ue(e,2,VO(r,n,s)):Ue(e,3,zO(r,n,s));return;case"b":case"e":Ue(e,5,H9(r,n,t.v,t.t));return;case"s":case"str":Ue(e,4,G9(r,n,(t.v||"").slice(0,255)));return}Ue(e,1,Tu(null,r,n))}function K9(e,t,r,n){var s=Array.isArray(t),a=Rt(t["!ref"]||"A1"),o,u="",f=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=vt(a)}for(var d=a.s.r;d<=a.e.r;++d){u=Tr(d);for(var p=a.s.c;p<=a.e.c;++p){d===a.s.r&&(f[p]=ur(p)),o=f[p]+u;var m=s?(t[d]||[])[p]:t[o];m&&X9(e,m,d,p)}}}function q9(e,t){for(var r=t||{},n=Vn(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ue(n,r.biff==4?1033:r.biff==3?521:9,ix(e,16,r)),K9(n,e.Sheets[e.SheetNames[s]],s,r),Ue(n,10),n.end()}function Y9(e,t,r){Ue(e,49,V8({sz:12,name:"Arial"},r))}function J9(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Ue(e,1054,Y8(s,t[s],r))})}function Q9(e,t){var r=Ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ue(e,2151,r),r=Ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Sk(Rt(t["!ref"]||"A1"),r),r.write_shift(4,4),Ue(e,2152,r)}function Z9(e,t){for(var r=0;r<16;++r)Ue(e,224,Jy({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ue(e,224,Jy(n,0,t))})}function eU(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ue(e,440,bO(n)),n[1].Tooltip&&Ue(e,2048,TO(n))}delete t["!links"]}function tU(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Ue(e,125,FO(qd(s,n),s))})}}function rU(e,t,r,n,s){var a=16+Ni(s.cellXfs,t,s);if(t.v==null&&!t.bf){Ue(e,513,po(r,n,a));return}if(t.bf)Ue(e,6,AM(t,r,n,s,a));else switch(t.t){case"d":case"n":var o=t.t=="d"?Kr(fr(t.v)):t.v;Ue(e,515,lO(r,n,o,a));break;case"b":case"e":Ue(e,517,iO(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var u=px(s.Strings,t.v,s.revStrings);Ue(e,253,G8(r,n,u,a))}else Ue(e,516,K8(r,n,(t.v||"").slice(0,255),a,s));break;default:Ue(e,513,po(r,n,a))}}function nU(e,t,r){var n=Vn(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[e]||{},f=Array.isArray(a),d=t.biff==8,p,m="",g=[],y=Rt(a["!ref"]||"A1"),w=d?65536:16384;if(y.e.c>255||y.e.r>=w){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,w-1)}Ue(n,2057,ix(r,16,t)),Ue(n,13,ms(1)),Ue(n,12,ms(100)),Ue(n,15,Rn(!0)),Ue(n,17,Rn(!1)),Ue(n,16,fo(.001)),Ue(n,95,Rn(!0)),Ue(n,42,Rn(!1)),Ue(n,43,Rn(!1)),Ue(n,130,ms(1)),Ue(n,128,aO()),Ue(n,131,Rn(!1)),Ue(n,132,Rn(!1)),d&&tU(n,a["!cols"]),Ue(n,512,Q8(y,t)),d&&(a["!links"]=[]);for(var v=y.s.r;v<=y.e.r;++v){m=Tr(v);for(var S=y.s.c;S<=y.e.c;++S){v===y.s.r&&(g[S]=ur(S)),p=g[S]+m;var E=f?(a[v]||[])[S]:a[p];E&&(rU(n,E,v,S,t),d&&E.l&&a["!links"].push([p,E.l]))}}var A=u.CodeName||u.name||s;return d&&Ue(n,574,$8((o.Views||[])[0])),d&&(a["!merges"]||[]).length&&Ue(n,229,vO(a["!merges"])),d&&eU(n,a),Ue(n,442,vk(A)),d&&Q9(n,a),Ue(n,10),n.end()}function sU(e,t,r){var n=Vn(),s=(e||{}).Workbook||{},a=s.Sheets||[],o=s.WBProps||{},u=r.biff==8,f=r.biff==5;if(Ue(n,2057,ix(e,5,r)),r.bookType=="xla"&&Ue(n,135),Ue(n,225,u?ms(1200):null),Ue(n,193,i8(2)),f&&Ue(n,191),f&&Ue(n,192),Ue(n,226),Ue(n,92,N8("SheetJS",r)),Ue(n,66,ms(u?1200:1252)),u&&Ue(n,353,ms(0)),u&&Ue(n,448),Ue(n,317,IO(e.SheetNames.length)),u&&e.vbaraw&&Ue(n,211),u&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";Ue(n,442,vk(d))}Ue(n,156,ms(17)),Ue(n,25,Rn(!1)),Ue(n,18,Rn(!1)),Ue(n,19,ms(0)),u&&Ue(n,431,Rn(!1)),u&&Ue(n,444,ms(0)),Ue(n,61,B8()),Ue(n,64,Rn(!1)),Ue(n,141,ms(0)),Ue(n,34,Rn(LB(e)=="true")),Ue(n,14,Rn(!0)),u&&Ue(n,439,Rn(!1)),Ue(n,218,ms(0)),Y9(n,e,r),J9(n,e.SSF,r),Z9(n,r),u&&Ue(n,352,Rn(!1));var p=n.end(),m=Vn();u&&Ue(m,140,NO()),u&&r.Strings&&V9(m,252,R8(r.Strings)),Ue(m,10);var g=m.end(),y=Vn(),w=0,v=0;for(v=0;v<e.SheetNames.length;++v)w+=(u?12:11)+(u?2:1)*e.SheetNames[v].length;var S=p.length+w+g.length;for(v=0;v<e.SheetNames.length;++v){var E=a[v]||{};Ue(y,133,D8({pos:S,hs:E.Hidden||0,dt:0,name:e.SheetNames[v]},r)),S+=t[v].length}var A=y.end();if(w!=A.length)throw new Error("BS8 "+w+" != "+A.length);var b=[];return p.length&&b.push(p),A.length&&b.push(A),g.length&&b.push(g),nn(b)}function aU(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Zt(st)),e&&e.SSF&&(Ml(),yu(e.SSF),r.revssf=Wd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,wx(r),r.cellXfs=[],Ni(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=nU(s,r,e);return n.unshift(sU(e,n,r)),nn(n)}function fb(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Pn(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return aU(e,t);case 4:case 3:case 2:return q9(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function dw(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=s.index,u=a&&a.index||e.length,f=VP(e.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,p=0,m=0,g=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<f.length;++o){var v=f[o].trim(),S=v.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}p=0;continue}if(!(S!="<td"&&S!="<th")){var E=v.split(/<\/t[dh]>/i);for(u=0;u<E.length;++u){var A=E[u].trim();if(A.match(/<t[dh]/i)){for(var b=A,D=0;b.charAt(0)=="<"&&(D=b.indexOf(">"))>-1;)b=b.slice(D+1);for(var O=0;O<w.length;++O){var C=w[O];C.s.c==p&&C.s.r<d&&d<=C.e.r&&(p=C.e.c+1,O=-1)}var T=dt(A.slice(0,A.indexOf(">")));g=T.colspan?+T.colspan:1,((m=+T.rowspan)>1||g>1)&&w.push({s:{r:d,c:p},e:{r:d+(m||1)-1,c:p+g-1}});var U=T.t||T["data-t"]||"";if(!b.length){p+=g;continue}if(b=BS(b),y.s.r>d&&(y.s.r=d),y.e.r<d&&(y.e.r=d),y.s.c>p&&(y.s.c=p),y.e.c<p&&(y.e.c=p),!b.length){p+=g;continue}var z={t:"s",v:b};r.raw||!b.trim().length||U=="s"||(b==="TRUE"?z={t:"b",v:!0}:b==="FALSE"?z={t:"b",v:!1}:isNaN(Ps(b))?isNaN(Al(b).getDate())||(z={t:"d",v:fr(b)},r.cellDates||(z={t:"n",v:Kr(z.v)}),z.z=r.dateNF||st[14]):z={t:"n",v:Ps(b)}),r.dense?(n[d]||(n[d]=[]),n[d][p]=z):n[ut({r:d,c:p})]=z,p+=g}}}}return n["!ref"]=vt(y),w.length&&(n["!merges"]=w),n}function db(e,t,r,n){for(var s=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var u=0,f=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>o)&&!(s[d].e.r<r||s[d].e.c<o)){if(s[d].s.r<r||s[d].s.c<o){u=-1;break}u=s[d].e.r-s[d].s.r+1,f=s[d].e.c-s[d].s.c+1;break}if(!(u<0)){var p=ut({r,c:o}),m=n.dense?(e[r]||[])[o]:e[p],g=m&&m.v!=null&&(m.h||Wm(m.w||(ua(m),m.w)||""))||"",y={};u>1&&(y.rowspan=u),f>1&&(y.colspan=f),n.editable?g='<span contenteditable="true">'+g+"</span>":m&&(y["data-t"]=m&&m.t||"z",m.v!=null&&(y["data-v"]=m.v),m.z!=null&&(y["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),y.id=(n.id||"sjs")+"-"+p,a.push(Be("td",g,y))}}var w="<tr>";return w+a.join("")+"</tr>"}var hb='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',pb="</body></html>";function iU(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ci(dw(r[0],t),t);var n=Ex();return r.forEach(function(s,a){Tx(n,dw(s,t),"Sheet"+(a+1))}),n}function mb(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function xb(e,t){var r=t||{},n=r.header!=null?r.header:hb,s=r.footer!=null?r.footer:pb,a=[n],o=Pn(e["!ref"]);r.dense=Array.isArray(e),a.push(mb(e,o,r));for(var u=o.s.r;u<=o.e.r;++u)a.push(db(e,o,u,r));return a.push("</table>"+s),a.join("")}function gb(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?vr(n.origin):n.origin;s=o.r,a=o.c}var u=t.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var p=Pn(e["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),s==-1&&(d.e.r=s=p.e.r+1)}var m=[],g=0,y=e["!rows"]||(e["!rows"]=[]),w=0,v=0,S=0,E=0,A=0,b=0;for(e["!cols"]||(e["!cols"]=[]);w<u.length&&v<f;++w){var D=u[w];if(hw(D)){if(n.display)continue;y[v]={hidden:!0}}var O=D.children;for(S=E=0;S<O.length;++S){var C=O[S];if(!(n.display&&hw(C))){var T=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):BS(C.innerHTML),U=C.getAttribute("data-z")||C.getAttribute("z");for(g=0;g<m.length;++g){var z=m[g];z.s.c==E+a&&z.s.r<v+s&&v+s<=z.e.r&&(E=z.e.c+1-a,g=-1)}b=+C.getAttribute("colspan")||1,((A=+C.getAttribute("rowspan")||1)>1||b>1)&&m.push({s:{r:v+s,c:E+a},e:{r:v+s+(A||1)-1,c:E+a+(b||1)-1}});var Z={t:"s",v:T},re=C.getAttribute("data-t")||C.getAttribute("t")||"";T!=null&&(T.length==0?Z.t=re||"z":n.raw||T.trim().length==0||re=="s"||(T==="TRUE"?Z={t:"b",v:!0}:T==="FALSE"?Z={t:"b",v:!1}:isNaN(Ps(T))?isNaN(Al(T).getDate())||(Z={t:"d",v:fr(T)},n.cellDates||(Z={t:"n",v:Kr(Z.v)}),Z.z=n.dateNF||st[14]):Z={t:"n",v:Ps(T)})),Z.z===void 0&&U!=null&&(Z.z=U);var P="",se=C.getElementsByTagName("A");if(se&&se.length)for(var me=0;me<se.length&&!(se[me].hasAttribute("href")&&(P=se[me].getAttribute("href"),P.charAt(0)!="#"));++me);P&&P.charAt(0)!="#"&&(Z.l={Target:P}),n.dense?(e[v+s]||(e[v+s]=[]),e[v+s][E+a]=Z):e[ut({c:E+a,r:v+s})]=Z,d.e.c<E+a&&(d.e.c=E+a),E+=b}}++v}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,v-1+s),e["!ref"]=vt(d),v>=f&&(e["!fullref"]=vt((d.e.r=u.length-w+v-1+s,d))),e}function vb(e,t){var r=t||{},n=r.dense?[]:{};return gb(n,e,t)}function oU(e,t){return Ci(vb(e,t),t)}function hw(e){var t="",r=lU(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function lU(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function cU(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Bt(t.replace(/<[^>]*>/g,""));return[r]}var pw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function yb(e,t){var r=t||{},n=Vm(e),s=[],a,o,u={name:""},f="",d=0,p,m,g={},y=[],w=r.dense?[]:{},v,S,E={value:""},A="",b=0,D=[],O=-1,C=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},U=0,z={},Z=[],re={},P=0,se=0,me=[],ce=1,fe=1,de=[],he={Names:[]},Q={},ee=["",""],V=[],F={},N="",L=0,B=!1,q=!1,ne=0;for(nu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=nu.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?w["!ref"]=vt(T):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(w["!fullref"]=w["!ref"],T.e.r=r.sheetRows-1,w["!ref"]=vt(T)),Z.length&&(w["!merges"]=Z),me.length&&(w["!rows"]=me),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),y.push(p.name),g[p.name]=w,q=!1):v[0].charAt(v[0].length-2)!=="/"&&(p=dt(v[0],!1),O=C=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,w=r.dense?[]:{},Z=[],me=[],q=!0);break;case"table-row-group":v[1]==="/"?--U:++U;break;case"table-row":case"":if(v[1]==="/"){O+=ce,ce=1;break}if(m=dt(v[0],!1),m.?O=m.-1:O==-1&&(O=0),ce=+m["number-rows-repeated"]||1,ce<10)for(ne=0;ne<ce;++ne)U>0&&(me[O+ne]={level:U});C=-1;break;case"covered-table-cell":v[1]!=="/"&&++C,r.sheetStubs&&(r.dense?(w[O]||(w[O]=[]),w[O][C]={t:"z"}):w[ut({r:O,c:C})]={t:"z"}),A="",D=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++C,E=dt(v[0],!1),fe=parseInt(E["number-columns-repeated"]||"1",10),S={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(S.f=cw(Bt(E.formula))),(E.||E["value-type"])=="string"&&(S.t="s",S.v=Bt(E["string-value"]||""),r.dense?(w[O]||(w[O]=[]),w[O][C]=S):w[ut({r:O,c:C})]=S),C+=fe-1;else if(v[1]!=="/"){++C,A="",b=0,D=[],fe=1;var Y=ce?O+ce-1:O;if(C>T.e.c&&(T.e.c=C),C<T.s.c&&(T.s.c=C),O<T.s.r&&(T.s.r=O),Y>T.e.r&&(T.e.r=Y),E=dt(v[0],!1),V=[],F={},S={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=Bt(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(P=parseInt(E["number-matrix-rows-spanned"],10)||0,se=parseInt(E["number-matrix-columns-spanned"],10)||0,re={s:{r:O,c:C},e:{r:O+P-1,c:C+se-1}},S.F=vt(re),de.push([re,S.F])),E.formula)S.f=cw(E.formula);else for(ne=0;ne<de.length;++ne)O>=de[ne][0].s.r&&O<=de[ne][0].e.r&&C>=de[ne][0].s.c&&C<=de[ne][0].e.c&&(S.F=de[ne][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(P=parseInt(E["number-rows-spanned"],10)||0,se=parseInt(E["number-columns-spanned"],10)||0,re={s:{r:O,c:C},e:{r:O+P-1,c:C+se-1}},Z.push(re)),E["number-columns-repeated"]&&(fe=parseInt(E["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=cr(E["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(E.value);break;case"percentage":S.t="n",S.v=parseFloat(E.value);break;case"currency":S.t="n",S.v=parseFloat(E.value);break;case"date":S.t="d",S.v=fr(E["date-value"]),r.cellDates||(S.t="n",S.v=Kr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=$P(E["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Vd(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(E.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",E["string-value"]!=null&&(A=Bt(E["string-value"]),D=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(B=!1,S.t==="s"&&(S.v=A||"",D.length&&(S.R=D),B=b==0),Q.Target&&(S.l=Q),V.length>0&&(S.c=V,V=[]),A&&r.cellText!==!1&&(S.w=A),B&&(S.t="z",delete S.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var oe=0;oe<ce;++oe){if(fe=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(w[O+oe]||(w[O+oe]=[]),w[O+oe][C]=oe==0?S:Zt(S);--fe>0;)w[O+oe][C+fe]=Zt(S);else for(w[ut({r:O+oe,c:C})]=S;--fe>0;)w[ut({r:O+oe,c:C+fe})]=Zt(S);T.e.c<=C&&(T.e.c=C)}fe=parseInt(E["number-columns-repeated"]||"1",10),C+=fe-1,fe=0,S={},A="",D=[]}Q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;F.t=A,D.length&&(F.R=D),F.a=N,V.push(F)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);N="",L=0,A="",b=0,D=[];break;case"creator":v[1]==="/"?N=n.slice(L,v.index):L=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);A="",b=0,D=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(z[u.name]=f,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(f="",u=dt(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=dt(v[0],!1),f+=pw[v[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=dt(v[0],!1),f+=pw[v[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,v.index);break}else d=v.index+v[0].length;break;case"named-range":o=dt(v[0],!1),ee=hp(o["cell-range-address"]);var le={Name:o.name,Ref:ee[0]+"!"+ee[1]};q&&(le.Sheet=y.length),he.Names.push(le);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!E||!E["string-value"])){var te=cU(n.slice(b,v.index));A=(A.length>0?A+`
`:"")+te[0]}else dt(v[0],!1),b=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{ee=hp(dt(v[0])["target-range-address"]),g[ee[0]]["!autofilter"]={ref:ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(Q=dt(v[0],!1),!Q.href)break;Q.Target=Bt(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(ee=hp(Q.Target.slice(1)),Q.Target="#"+ee[0]+"!"+ee[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var I={Sheets:g,SheetNames:y,Workbook:he};return r.bookSheets&&delete I.Sheets,I}function mw(e,t){t=t||{},ps(e,"META-INF/manifest.xml")&&$I(Ur(e,"META-INF/manifest.xml"),t);var r=Qn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=yb(Xt(r),t);return ps(e,"meta.xml")&&(n.Props=ak(Ur(e,"meta.xml"))),n}function xw(e,t){return yb(e,t)}var uU=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ru({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Or+t}})(),gw=(function(){var e=function(a){return Gt(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,o,u){var f=[];f.push('      <table:table table:name="'+Gt(o.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,p=0,m=Pn(a["!ref"]||"A1"),g=a["!merges"]||[],y=0,w=Array.isArray(a);if(a["!cols"])for(p=0;p<=m.e.c;++p)f.push("        <table:table-column"+(a["!cols"][p]?' table:style-name="co'+a["!cols"][p].ods+'"':"")+`></table:table-column>
`);var v="",S=a["!rows"]||[];for(d=0;d<m.s.r;++d)v=S[d]?' table:style-name="ro'+S[d].ods+'"':"",f.push("        <table:table-row"+v+`></table:table-row>
`);for(;d<=m.e.r;++d){for(v=S[d]?' table:style-name="ro'+S[d].ods+'"':"",f.push("        <table:table-row"+v+`>
`),p=0;p<m.s.c;++p)f.push(t);for(;p<=m.e.c;++p){var E=!1,A={},b="";for(y=0;y!=g.length;++y)if(!(g[y].s.c>p)&&!(g[y].s.r>d)&&!(g[y].e.c<p)&&!(g[y].e.r<d)){(g[y].s.c!=p||g[y].s.r!=d)&&(E=!0),A["table:number-columns-spanned"]=g[y].e.c-g[y].s.c+1,A["table:number-rows-spanned"]=g[y].e.r-g[y].s.r+1;break}if(E){f.push(r);continue}var D=ut({r:d,c:p}),O=w?(a[d]||[])[p]:a[D];if(O&&O.f&&(A["table:formula"]=Gt(IM(O.f)),O.F&&O.F.slice(0,D.length)==D)){var C=Pn(O.F);A["table:number-matrix-columns-spanned"]=C.e.c-C.s.c+1,A["table:number-matrix-rows-spanned"]=C.e.r-C.s.r+1}if(!O){f.push(t);continue}switch(O.t){case"b":b=O.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=O.v?"true":"false";break;case"n":b=O.w||String(O.v||0),A["office:value-type"]="float",A["office:value"]=O.v||0;break;case"s":case"str":b=O.v==null?"":O.v,A["office:value-type"]="string";break;case"d":b=O.w||fr(O.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=fr(O.v).toISOString(),A["table:style-name"]="ce1";break;default:f.push(t);continue}var T=e(b);if(O.l&&O.l.Target){var U=O.l.Target;U=U.charAt(0)=="#"?"#"+OM(U.slice(1)):U,U.charAt(0)!="#"&&!U.match(/^\w+:/)&&(U="../"+U),T=Be("text:a",T,{"xlink:href":U.replace(/&/g,"&amp;")})}f.push("          "+Be("table:table-cell",Be("text:p",T,{}),A)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},s=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var m=d["!cols"][p];if(m.width==null&&m.wpx==null&&m.wch==null)continue;wi(m),m.ods=u;var g=d["!cols"][p].wpx+"px";a.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),a.push(`  </style:style>
`),++u}}});var f=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=f;var m=d["!rows"][p].hpx+"px";a.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),a.push(`  </style:style>
`),++f}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,u){var f=[Or],d=ru({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=ru({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+d+p+`>
`),f.push(sk().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),s(f,o),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var m=0;m!=o.SheetNames.length;++m)f.push(n(o.Sheets[o.SheetNames[m]],o,m));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function wb(e,t){if(t.bookType=="fods")return gw(e,t);var r=Um(),n="",s=[],a=[];return n="mimetype",yt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",yt(r,n,gw(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",yt(r,n,uU(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",yt(r,n,Or+sk()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",yt(r,n,VI(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",yt(r,n,zI(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function mo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function nm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Xt(Ti(e))}function fU(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Jn(sa(e))}function dU(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Si(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function vw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function hU(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function pU(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function uu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Vt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Cr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function $t(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=uu(e,r),a=s&7;s=Math.floor(s/8);var o=0,u;if(s==0)break;switch(a){case 0:{for(var f=r[0];e[r[0]++]>=128;);u=e.slice(f,r[0])}break;case 5:o=4,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=uu(e,r),u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var d={data:u,type:a};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function cn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Vt(n*8+s.type)),s.type==2&&t.push(Vt(s.data.length)),t.push(s.data))})}),Si(t)}function vx(e,t){return e?.map(function(r){return t(r.data)})||[]}function ds(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=uu(e,n),a=$t(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:Cr(a[1][0].data),messages:[]};a[2].forEach(function(u){var f=$t(u.data),d=Cr(f[3][0].data);o.messages.push({meta:f,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=a[3])!=null&&t[0]&&(o.merge=Cr(a[3][0].data)>>>0>0),r.push(o)}return r}function cl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Vt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Vt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Vt(o.data.length)}],n[2].push({data:cn(o.meta),type:2})});var a=cn(n);t.push(Vt(a.length)),t.push(a),s.forEach(function(o){return t.push(o)})}),Si(t)}function mU(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=uu(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=t[r[0]],u>1&&(o|=t[r[0]+1]<<8),u>2&&(o|=t[r[0]+2]<<16),u>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var f=0,d=0;if(a==1?(d=(t[r[0]]>>2&7)+4,f=(t[r[0]++]&224)<<3,f|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,a==2?(f=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(f=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Si(s)],f==0)throw new Error("Invalid offset 0");if(f>s[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(s.push(s[0].slice(-f)),d-=f;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-f,-f+d))}}var p=Si(s);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function hs(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(mU(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Si(t)}function ul(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=Vt(n),o=a.length;t.push(a),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return Si(t)}function xU(e,t,r,n){var s=mo(e),a=s.getUint32(4,!0),o=(n>1?12:8)+vw(a&(n>1?3470:398))*4,u=-1,f=-1,d=NaN,p=new Date(2001,0,1);a&512&&(u=s.getUint32(o,!0),o+=4),o+=vw(a&(n>1?12288:4096))*4,a&16&&(f=s.getUint32(o,!0),o+=4),a&32&&(d=s.getFloat64(o,!0),o+=8),a&64&&(p.setTime(p.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:t[f]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(u>-1)m={t:"s",v:r[u]};else if(f>-1)m={t:"s",v:t[f]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function gU(e,t,r){var n=mo(e),s=n.getUint32(8,!0),a=12,o=-1,u=-1,f=NaN,d=NaN,p=new Date(2001,0,1);s&1&&(f=hU(e,a),a+=16),s&2&&(d=n.getFloat64(a,!0),a+=8),s&4&&(p.setTime(p.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(u=n.getUint32(a,!0),a+=4),s&16&&(o=n.getUint32(a,!0),a+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return m}function mp(e,t){var r=new Uint8Array(32),n=mo(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,pU(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function xp(e,t){var r=new Uint8Array(32),n=mo(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function vU(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return xU(e,t,r,e[0]);case 5:return gU(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function yn(e){var t=$t(e);return uu(t[1][0].data)}function yw(e,t){var r=$t(t.data),n=Cr(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(o){var u=$t(o.data),f=Cr(u[1][0].data)>>>0;switch(n){case 1:a[f]=nm(u[3][0].data);break;case 8:{var d=e[yn(u[9][0].data)][0],p=$t(d.data),m=e[yn(p[1][0].data)][0],g=Cr(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var y=$t(m.data);a[f]=y[3].map(function(w){return nm(w.data)}).join("")}break}}),a}function yU(e,t){var r,n,s,a,o,u,f,d,p,m,g,y,w,v,S=$t(e),E=Cr(S[1][0].data)>>>0,A=Cr(S[2][0].data)>>>0,b=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&Cr(S[8][0].data)>0||!1,D,O;if((a=(s=S[7])==null?void 0:s[0])!=null&&a.data&&t!=0)D=(u=(o=S[7])==null?void 0:o[0])==null?void 0:u.data,O=(d=(f=S[6])==null?void 0:f[0])==null?void 0:d.data;else if((m=(p=S[4])==null?void 0:p[0])!=null&&m.data&&t!=1)D=(y=(g=S[4])==null?void 0:g[0])==null?void 0:y.data,O=(v=(w=S[3])==null?void 0:w[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var C=b?4:1,T=mo(D),U=[],z=0;z<D.length/2;++z){var Z=T.getUint16(z*2,!0);Z<65535&&U.push([z,Z])}if(U.length!=A)throw"Expected ".concat(A," cells, found ").concat(U.length);var re=[];for(z=0;z<U.length-1;++z)re[U[z][0]]=O.subarray(U[z][1]*C,U[z+1][1]*C);return U.length>=1&&(re[U[U.length-1][0]]=O.subarray(U[U.length-1][1]*C)),{R:E,cells:re}}function wU(e,t){var r,n=$t(t.data),s=(r=n?.[7])!=null&&r[0]?Cr(n[7][0].data)>>>0>0?1:0:-1,a=vx(n[5],function(o){return yU(o,s)});return{nrows:Cr(n[4][0].data)>>>0,data:a.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(f,d){if(o[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));o[u.R][d]=f}),o},[])}}function _U(e,t,r){var n,s=$t(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Cr(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Cr(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=vt(a);var o=$t(s[4][0].data),u=yw(e,e[yn(o[4][0].data)][0]),f=(n=o[17])!=null&&n[0]?yw(e,e[yn(o[17][0].data)][0]):[],d=$t(o[3][0].data),p=0;d[1].forEach(function(m){var g=$t(m.data),y=e[yn(g[2][0].data)][0],w=Cr(y.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var v=wU(e,y);v.data.forEach(function(S,E){S.forEach(function(A,b){var D=ut({r:p+E,c:b}),O=vU(A,u,f);O&&(r[D]=O)})}),p+=v.nrows})}function SU(e,t){var r=$t(t.data),n={"!ref":"A1"},s=e[yn(r[2][0].data)],a=Cr(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return _U(e,s[0],n),n}function kU(e,t){var r,n=$t(t.data),s={name:(r=n[1])!=null&&r[0]?nm(n[1][0].data):"",sheets:[]},a=vx(n[2],yn);return a.forEach(function(o){e[o].forEach(function(u){var f=Cr(u.meta[1][0].data);f==6e3&&s.sheets.push(SU(e,u))})}),s}function bU(e,t){var r=Ex(),n=$t(t.data),s=vx(n[1],yn);if(s.forEach(function(a){e[a].forEach(function(o){var u=Cr(o.meta[1][0].data);if(u==2){var f=kU(e,o);f.sheets.forEach(function(d,p){Tx(r,d,p==0?f.name:f.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function gp(e){var t,r,n,s,a={},o=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=hs(f.content)}catch(m){return console.log("?? "+f.content.length+" "+(m.message||m))}var p;try{p=ds(d)}catch(m){return console.log("## "+(m.message||m))}p.forEach(function(m){a[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var u=((s=(n=(r=(t=a?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Cr(a[1][0].meta[1][0].data)==1&&a[1][0];if(u||o.forEach(function(f){a[f].forEach(function(d){var p=Cr(d.meta[1][0].data)>>>0;if(p==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return bU(a,u)}function EU(e,t,r){var n,s,a,o;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(a=e[8])==null?void 0:a[0])==null?void 0:o.data)&&Cr(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,d=mo(e[7][0].data),p=0,m=[],g=mo(e[4][0].data),y=0,w=[],v=0;v<t.length;++v){if(t[v]==null){d.setUint16(v*2,65535,!0),g.setUint16(v*2,65535);continue}d.setUint16(v*2,p,!0),g.setUint16(v*2,y,!0);var S,E;switch(typeof t[v]){case"string":S=mp({t:"s",v:t[v]},r),E=xp({t:"s",v:t[v]},r);break;case"number":S=mp({t:"n",v:t[v]},r),E=xp({t:"n",v:t[v]},r);break;case"boolean":S=mp({t:"b",v:t[v]},r),E=xp({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}m.push(S),p+=S.length,w.push(E),y+=E.length,++f}for(e[2][0].data=Vt(f);v<e[7][0].data.length/2;++v)d.setUint16(v*2,65535,!0),g.setUint16(v*2,65535,!0);return e[6][0].data=Si(m),e[3][0].data=Si(w),f}function TU(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Pn(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(vt(n)));var a=Cd(r,{range:n,header:1}),o=["~Sh33tJ5~"];a.forEach(function(N){return N.forEach(function(L){typeof L=="string"&&o.push(L)})});var u={},f=[],d=Ze.read(t.numbers,{type:"base64"});d.FileIndex.map(function(N,L){return[N,d.FullPaths[L]]}).forEach(function(N){var L=N[0],B=N[1];if(L.type==2&&L.name.match(/\.iwa/)){var q=L.content,ne=hs(q),Y=ds(ne);Y.forEach(function(oe){f.push(oe.id),u[oe.id]={deps:[],location:B,type:Cr(oe.messages[0].meta[1][0].data)}})}}),f.sort(function(N,L){return N-L});var p=f.filter(function(N){return N>1}).map(function(N){return[N,Vt(N)]});d.FileIndex.map(function(N,L){return[N,d.FullPaths[L]]}).forEach(function(N){var L=N[0];if(N[1],!!L.name.match(/\.iwa/)){var B=ds(hs(L.content));B.forEach(function(q){q.messages.forEach(function(ne){p.forEach(function(Y){q.messages.some(function(oe){return Cr(oe.meta[1][0].data)!=11006&&dU(oe.data,Y[1])})&&u[Y[0]].deps.push(q.id)})})})}});for(var m=Ze.find(d,u[1].location),g=ds(hs(m.content)),y,w=0;w<g.length;++w){var v=g[w];v.id==1&&(y=v)}var S=yn($t(y.messages[0].data)[1][0].data);for(m=Ze.find(d,u[S].location),g=ds(hs(m.content)),w=0;w<g.length;++w)v=g[w],v.id==S&&(y=v);for(S=yn($t(y.messages[0].data)[2][0].data),m=Ze.find(d,u[S].location),g=ds(hs(m.content)),w=0;w<g.length;++w)v=g[w],v.id==S&&(y=v);for(S=yn($t(y.messages[0].data)[2][0].data),m=Ze.find(d,u[S].location),g=ds(hs(m.content)),w=0;w<g.length;++w)v=g[w],v.id==S&&(y=v);var E=$t(y.messages[0].data);{E[6][0].data=Vt(n.e.r+1),E[7][0].data=Vt(n.e.c+1);var A=yn(E[46][0].data),b=Ze.find(d,u[A].location),D=ds(hs(b.content));{for(var O=0;O<D.length&&D[O].id!=A;++O);if(D[O].id!=A)throw"Bad ColumnRowUIDMapArchive";var C=$t(D[O].messages[0].data);C[1]=[],C[2]=[],C[3]=[];for(var T=0;T<=n.e.c;++T){var U=[];U[1]=U[2]=[{type:0,data:Vt(T+420690)}],C[1].push({type:2,data:cn(U)}),C[2].push({type:0,data:Vt(T)}),C[3].push({type:0,data:Vt(T)})}C[4]=[],C[5]=[],C[6]=[];for(var z=0;z<=n.e.r;++z)U=[],U[1]=U[2]=[{type:0,data:Vt(z+726270)}],C[4].push({type:2,data:cn(U)}),C[5].push({type:0,data:Vt(z)}),C[6].push({type:0,data:Vt(z)});D[O].messages[0].data=cn(C)}b.content=ul(cl(D)),b.size=b.content.length,delete E[46];var Z=$t(E[4][0].data);{Z[7][0].data=Vt(n.e.r+1);var re=$t(Z[1][0].data),P=yn(re[2][0].data);b=Ze.find(d,u[P].location),D=ds(hs(b.content));{if(D[0].id!=P)throw"Bad HeaderStorageBucket";var se=$t(D[0].messages[0].data);for(z=0;z<a.length;++z){var me=$t(se[2][0].data);me[1][0].data=Vt(z),me[4][0].data=Vt(a[z].length),se[2][z]={type:se[2][0].type,data:cn(me)}}D[0].messages[0].data=cn(se)}b.content=ul(cl(D)),b.size=b.content.length;var ce=yn(Z[2][0].data);b=Ze.find(d,u[ce].location),D=ds(hs(b.content));{if(D[0].id!=ce)throw"Bad HeaderStorageBucket";for(se=$t(D[0].messages[0].data),T=0;T<=n.e.c;++T)me=$t(se[2][0].data),me[1][0].data=Vt(T),me[4][0].data=Vt(n.e.r+1),se[2][T]={type:se[2][0].type,data:cn(me)};D[0].messages[0].data=cn(se)}b.content=ul(cl(D)),b.size=b.content.length;var fe=yn(Z[4][0].data);(function(){for(var N=Ze.find(d,u[fe].location),L=ds(hs(N.content)),B,q=0;q<L.length;++q){var ne=L[q];ne.id==fe&&(B=ne)}var Y=$t(B.messages[0].data);{Y[3]=[];var oe=[];o.forEach(function(I,Ce){oe[1]=[{type:0,data:Vt(Ce)}],oe[2]=[{type:0,data:Vt(1)}],oe[3]=[{type:2,data:fU(I)}],Y[3].push({type:2,data:cn(oe)})})}B.messages[0].data=cn(Y);var le=cl(L),te=ul(le);N.content=te,N.size=N.content.length})();var de=$t(Z[3][0].data);{var he=de[1][0];delete de[2];var Q=$t(he.data);{var ee=yn(Q[2][0].data);(function(){for(var N=Ze.find(d,u[ee].location),L=ds(hs(N.content)),B,q=0;q<L.length;++q){var ne=L[q];ne.id==ee&&(B=ne)}var Y=$t(B.messages[0].data);{delete Y[6],delete de[7];var oe=new Uint8Array(Y[5][0].data);Y[5]=[];for(var le=0,te=0;te<=n.e.r;++te){var I=$t(oe);le+=EU(I,a[te],o),I[1][0].data=Vt(te),Y[5].push({data:cn(I),type:2})}Y[1]=[{type:0,data:Vt(n.e.c+1)}],Y[2]=[{type:0,data:Vt(n.e.r+1)}],Y[3]=[{type:0,data:Vt(le)}],Y[4]=[{type:0,data:Vt(n.e.r+1)}]}B.messages[0].data=cn(Y);var Ce=cl(L),Ie=ul(Ce);N.content=Ie,N.size=N.content.length})()}he.data=cn(Q)}Z[3][0].data=cn(de)}E[4][0].data=cn(Z)}y.messages[0].data=cn(E);var V=cl(g),F=ul(V);return m.content=F,m.size=m.content.length,d}function _b(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function yx(e){_b([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function wx(e){_b([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function CU(e){return bt.WS.indexOf(e)>-1?"sheet":e==bt.CS?"chart":e==bt.DS?"dialog":e==bt.MS?"macro":e&&e.length?e:"sheet"}function NU(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,CU(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function AU(e,t,r,n,s,a,o,u,f,d,p,m){try{a[n]=Mc(Qn(e,r,!0),t);var g=Ur(e,t),y;switch(u){case"sheet":y=t9(g,t,s,f,a[n],d,p,m);break;case"chart":if(y=r9(g,t,s,f,a[n],d,p,m),!y||!y["!drawel"])break;var w=jc(y["!drawel"].Target,t),v=su(w),S=W5(Qn(e,w,!0),Mc(Qn(e,v,!0),w)),E=jc(S,w),A=su(E);y=jB(Qn(e,E,!0),E,f,Mc(Qn(e,A,!0),E),d,y);break;case"macro":y=n9(g,t,s,f,a[n],d,p,m);break;case"dialog":y=s9(g,t,s,f,a[n],d,p,m);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=y;var b=[];a&&a[n]&&Nr(a[n]).forEach(function(D){var O="";if(a[n][D].Type==bt.CMNT){O=jc(a[n][D].Target,t);var C=l9(Ur(e,O,!0),O,f);if(!C||!C.length)return;sw(y,C,!1)}a[n][D].Type==bt.TCMNT&&(O=jc(a[n][D].Target,t),b=b.concat(H5(Ur(e,O,!0),f)))}),b&&b.length&&sw(y,b,!0,f.people||[])}catch(D){if(f.WTF)throw D}}function us(e){return e.charAt(0)=="/"?e.slice(1):e}function Sb(e,t){if(Ml(),t=t||{},yx(t),ps(e,"META-INF/manifest.xml")||ps(e,"objectdata.xml"))return mw(e,t);if(ps(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof gp<"u"){if(e.FileIndex)return gp(e);var r=Ze.utils.cfb_new();return Ey(e).forEach(function(me){yt(r,me,GP(e,me))}),gp(r)}throw new Error("Unsupported NUMBERS file")}if(!ps(e,"[Content_Types].xml"))throw ps(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ps(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Ey(e),s=BI(Qn(e,"[Content_Types].xml")),a=!1,o,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",Ur(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!Ur(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var f={},d={};if(!t.bookSheets&&!t.bookProps){if(Bc=[],s.sst)try{Bc=o9(Ur(e,us(s.sst)),s.sst,t)}catch(me){if(t.WTF)throw me}t.cellStyles&&s.themes.length&&(f=i9(Qn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=a9(Ur(e,us(s.style)),s.style,f,t))}s.links.map(function(me){try{var ce=Mc(Qn(e,su(us(me))),me);return u9(Ur(e,us(me)),ce,me,t)}catch{}});var p=e9(Ur(e,us(s.workbooks[0])),s.workbooks[0],t),m={},g="";s.coreprops.length&&(g=Ur(e,us(s.coreprops[0]),!0),g&&(m=ak(g)),s.extprops.length!==0&&(g=Ur(e,us(s.extprops[0]),!0),g&&GI(g,m,t)));var y={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(g=Qn(e,us(s.custprops[0]),!0),g&&(y=KI(g,t)));var w={};if((t.bookSheets||t.bookProps)&&(p.Sheets?o=p.Sheets.map(function(ce){return ce.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(w.Props=m,w.Custprops=y),t.bookSheets&&typeof o<"u"&&(w.SheetNames=o),t.bookSheets?w.SheetNames:t.bookProps))return w;o={};var v={};t.bookDeps&&s.calcchain&&(v=c9(Ur(e,us(s.calcchain)),s.calcchain));var S=0,E={},A,b;{var D=p.Sheets;m.Worksheets=D.length,m.SheetNames=[];for(var O=0;O!=D.length;++O)m.SheetNames[O]=D[O].name}var C=a?"bin":"xml",T=s.workbooks[0].lastIndexOf("/"),U=(s.workbooks[0].slice(0,T+1)+"_rels/"+s.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");ps(e,U)||(U="xl/_rels/workbook."+C+".rels");var z=Mc(Qn(e,U,!0),U.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=f9(Ur(e,us(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=X5(Ur(e,us(s.people[0])),t)),z&&(z=NU(z,p.Sheets));var Z=Ur(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=m.Worksheets;++S){var re="sheet";if(z&&z[S]?(A="xl/"+z[S][1].replace(/[\/]?xl\//,""),ps(e,A)||(A=z[S][1]),ps(e,A)||(A=U.replace(/_rels\/.*$/,"")+z[S][1]),re=z[S][2]):(A="xl/worksheets/sheet"+(S+1-Z)+"."+C,A=A.replace(/sheet0\./,"sheet.")),b=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(m.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,se=0;se!=t.sheets.length;++se)typeof t.sheets[se]=="number"&&t.sheets[se]==S&&(P=1),typeof t.sheets[se]=="string"&&t.sheets[se].toLowerCase()==m.SheetNames[S].toLowerCase()&&(P=1);if(!P)continue e}}AU(e,A,b,m.SheetNames[S],S,E,o,re,t,p,f,d)}return w={Directory:s,Workbook:p,Props:m,Custprops:y,Deps:v,Sheets:o,SheetNames:m.SheetNames,Strings:Bc,Styles:d,Themes:f,SSF:Zt(st)},t&&t.bookFiles&&(e.files?(w.keys=n,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(me,ce){me=me.replace(/^Root Entry[\/]/,""),w.keys.push(me),w.files[me]=e.FileIndex[ce]}))),t&&t.bookVBA&&(s.vba.length>0?w.vbaraw=Ur(e,us(s.vba[0]),!0):s.defaults&&s.defaults.bin===tL&&(w.vbaraw=Ur(e,"xl/vbaProject.bin",!0))),w}function jU(e,t){var r=t||{},n="Workbook",s=Ze.find(e,n);try{if(n="/!DataSpaces/Version",s=Ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(d6(s.content),n="/!DataSpaces/DataSpaceMap",s=Ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=p6(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=m6(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);g6(s.content)}catch{}if(n="/EncryptionInfo",s=Ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=v6(s.content);if(n="/EncryptedPackage",s=Ze.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function DU(e,t){return t.bookType=="ods"?wb(e,t):t.bookType=="numbers"?TU(e,t):t.bookType=="xlsb"?FU(e,t):kb(e,t)}function FU(e,t){xl=1024,e&&!e.SSF&&(e.SSF=Zt(st)),e&&e.SSF&&(Ml(),yu(e.SSF),t.revssf=Wd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Uc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Vk.indexOf(t.bookType)>-1,s=sx();wx(t=t||{});var a=Um(),o="",u=0;if(t.cellXfs=[],Ni(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",yt(a,o,ik(e.Props,t)),s.coreprops.push(o),Ht(t.rels,2,o,bt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}for(e.Props.Worksheets=e.Props.SheetNames.length,yt(a,o,ck(e.Props)),s.extprops.push(o),Ht(t.rels,3,o,bt.EXT_PROPS),e.Custprops!==e.Props&&Nr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",yt(a,o,uk(e.Custprops)),s.custprops.push(o),Ht(t.rels,4,o,bt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var p={"!id":{}},m=e.Sheets[e.SheetNames[u-1]],g=(m||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,yt(a,o,h9(u-1,o,t,e,p)),s.sheets.push(o),Ht(t.wbrels,-1,"worksheets/sheet"+u+"."+r,bt.WS[0])}if(m){var y=m["!comments"],w=!1,v="";y&&y.length>0&&(v="xl/comments"+u+"."+r,yt(a,v,x9(y,v)),s.comments.push(v),Ht(p,-1,"../comments"+u+"."+r,bt.CMNT),w=!0),m["!legacy"]&&w&&yt(a,"xl/drawings/vmlDrawing"+u+".vml",zk(u,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&yt(a,su(o),_l(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,yt(a,o,m9(t.Strings,o,t)),s.strs.push(o),Ht(t.wbrels,-1,"sharedStrings."+r,bt.SST)),o="xl/workbook."+r,yt(a,o,d9(e,o)),s.workbooks.push(o),Ht(t.rels,1,o,bt.WB),o="xl/theme/theme1.xml",yt(a,o,ux(e.Themes,t)),s.themes.push(o),Ht(t.wbrels,-1,"theme/theme1.xml",bt.THEME),o="xl/styles."+r,yt(a,o,p9(e,o,t)),s.styles.push(o),Ht(t.wbrels,-1,"styles."+r,bt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",yt(a,o,e.vbaraw),s.vba.push(o),Ht(t.wbrels,-1,"vbaProject.bin",bt.VBA)),o="xl/metadata."+r,yt(a,o,g9(o)),s.metadata.push(o),Ht(t.wbrels,-1,"metadata."+r,bt.XLMETA),yt(a,"[Content_Types].xml",nk(s,t)),yt(a,"_rels/.rels",_l(t.rels)),yt(a,"xl/_rels/workbook."+r+".rels",_l(t.wbrels)),delete t.revssf,delete t.ssf,a}function kb(e,t){xl=1024,e&&!e.SSF&&(e.SSF=Zt(st)),e&&e.SSF&&(Ml(),yu(e.SSF),t.revssf=Wd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Uc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Vk.indexOf(t.bookType)>-1,s=sx();wx(t=t||{});var a=Um(),o="",u=0;if(t.cellXfs=[],Ni(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",yt(a,o,ik(e.Props,t)),s.coreprops.push(o),Ht(t.rels,2,o,bt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,yt(a,o,ck(e.Props)),s.extprops.push(o),Ht(t.rels,3,o,bt.EXT_PROPS),e.Custprops!==e.Props&&Nr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",yt(a,o,uk(e.Custprops)),s.custprops.push(o),Ht(t.rels,4,o,bt.CUST_PROPS));var p=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var m={"!id":{}},g=e.Sheets[e.SheetNames[u-1]],y=(g||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,yt(a,o,tb(u-1,t,e,m)),s.sheets.push(o),Ht(t.wbrels,-1,"worksheets/sheet"+u+"."+r,bt.WS[0])}if(g){var w=g["!comments"],v=!1,S="";if(w&&w.length>0){var E=!1;w.forEach(function(A){A[1].forEach(function(b){b.T==!0&&(E=!0)})}),E&&(S="xl/threadedComments/threadedComment"+u+"."+r,yt(a,S,G5(w,p,t)),s.threadedcomments.push(S),Ht(m,-1,"../threadedComments/threadedComment"+u+"."+r,bt.TCMNT)),S="xl/comments"+u+"."+r,yt(a,S,Wk(w)),s.comments.push(S),Ht(m,-1,"../comments"+u+"."+r,bt.CMNT),v=!0}g["!legacy"]&&v&&yt(a,"xl/drawings/vmlDrawing"+u+".vml",zk(u,g["!comments"])),delete g["!comments"],delete g["!legacy"]}m["!id"].rId1&&yt(a,su(o),_l(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,yt(a,o,jk(t.Strings,t)),s.strs.push(o),Ht(t.wbrels,-1,"sharedStrings."+r,bt.SST)),o="xl/workbook."+r,yt(a,o,ob(e)),s.workbooks.push(o),Ht(t.rels,1,o,bt.WB),o="xl/theme/theme1.xml",yt(a,o,ux(e.Themes,t)),s.themes.push(o),Ht(t.wbrels,-1,"theme/theme1.xml",bt.THEME),o="xl/styles."+r,yt(a,o,Mk(e,t)),s.styles.push(o),Ht(t.wbrels,-1,"styles."+r,bt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",yt(a,o,e.vbaraw),s.vba.push(o),Ht(t.wbrels,-1,"vbaProject.bin",bt.VBA)),o="xl/metadata."+r,yt(a,o,$k()),s.metadata.push(o),Ht(t.wbrels,-1,"metadata."+r,bt.XLMETA),p.length>1&&(o="xl/persons/person.xml",yt(a,o,K5(p)),s.people.push(o),Ht(t.wbrels,-1,"persons/person.xml",bt.PEOPLE)),yt(a,"[Content_Types].xml",nk(s,t)),yt(a,"_rels/.rels",_l(t.rels)),yt(a,"xl/_rels/workbook."+r+".rels",_l(t.wbrels)),delete t.revssf,delete t.ssf,a}function _x(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ts(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function RU(e,t){return Ze.find(e,"EncryptedPackage")?jU(e,t):gx(e,t)}function PU(e,t){var r,n=e,s=t||{};return s.type||(s.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r=OS(n,s),Sb(r,s)}function bb(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return tm(e.slice(r),t);default:break e}return jl.to_workbook(e,t)}function IU(e,t){var r="",n=_x(e,t);switch(t.type){case"base64":r=ts(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=uo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Xt(r)),t.type="binary",bb(r,t)}function OU(e,t){var r=e;return t.type=="base64"&&(r=ts(r)),r=Ot.utils.decode(1200,r.slice(2),"str"),t.type="binary",bb(r,t)}function LU(e){return e.match(/[^\x00-\x7F]/)?sa(e):e}function vp(e,t,r,n){return n?(r.type="string",jl.to_workbook(e,r)):jl.to_workbook(t,r)}function fu(e,t){$d();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return fu(new Uint8Array(e),(r=Zt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),kl={},r.dateNF&&(kl.dateNF=r.dateNF),r.type||(r.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=_t?"buffer":"binary",n=MP(e),typeof Uint8Array<"u"&&!_t&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=LU(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=Zt(r),r.type="array",fu(Om(n),r)}switch((s=_x(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return RU(Ze.read(n,r),r);break;case 9:if(s[1]<=8)return gx(n,r);break;case 60:return tm(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return qO(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Nk.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?PU(n,r):vp(e,n,r,a);case 239:return s[3]===60?tm(n,r):vp(e,n,r,a);case 255:if(s[1]===254)return OU(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Zi.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Zi.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return em.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Ik.to_workbook(n,r);break;case 10:case 13:case 32:return IU(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return KO.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?em.to_workbook(n,r):vp(e,n,r,a)}function ww(e,t){var r=t||{};return r.type="file",fu(e,r)}function Eb(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return wu(t.file,Ze.write(e,{type:_t?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ze.write(e,t)}function MU(e,t){var r=Zt(t||{}),n=DU(e,r);return Tb(n,r)}function BU(e,t){var r=Zt(t||{}),n=kb(e,r);return Tb(n,r)}function Tb(e,t){var r={},n=_t?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Ze.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(vu(s))}return t.password&&typeof encrypt_agile<"u"?Eb(encrypt_agile(s,t.password),t):t.type==="file"?wu(t.file,s):t.type=="string"?Xt(s):s}function UU(e,t){var r=t||{},n=W9(e,r);return Eb(n,r)}function Zs(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Zc(sa(n));case"binary":return sa(n);case"string":return e;case"file":return wu(t.file,n,"utf8");case"buffer":return _t?Ra(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Zs(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $U(e,t){switch(t.type){case"base64":return Zc(e);case"binary":return e;case"string":return e;case"file":return wu(t.file,e,"binary");case"buffer":return _t?Ra(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ed(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Zc(r):t.type=="string"?Xt(r):r;case"file":return wu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Sx(e,t){$d(),ib(e);var r=Zt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Sx(e,r);return r.type="array",vu(n)}return BU(e,r)}function Yd(e,t){$d(),ib(e);var r=Zt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Yd(e,r);return r.type="array",vu(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Zs(O9(e,r),r);case"slk":case"sylk":return Zs(Ck.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Zs(xb(e.Sheets[e.SheetNames[s]],r),r);case"txt":return $U(Ab(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Zs(bx(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Zs(Nk.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return ed(em.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Zs(jl.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Zs(Ik.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Zs(Ak.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Zs(wb(e,r),r);case"wk1":return ed(Zi.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return ed(Zi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ed(fb(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),UU(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return MU(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function kx(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function _w(e,t,r){var n=r||{};return n.type="file",n.file=t,kx(n),Yd(e,n)}function zU(e,t,r){var n=r||{};return n.type="file",n.file=t,kx(n),Sx(e,n)}function WU(e,t,r,n){var s=r||{};s.type="file",s.file=e,kx(s),s.type="buffer";var a=n;return a instanceof Function||(a=r),hi.writeFile(e,Yd(t,s),a)}function Cb(e,t,r,n,s,a,o,u){var f=Tr(r),d=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),m=!0,g=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!o||e[r])for(var y=t.s.c;y<=t.e.c;++y){var w=o?e[r][y]:e[n[y]+f];if(w===void 0||w.t===void 0){if(d===void 0)continue;a[y]!=null&&(g[a[y]]=d);continue}var v=w.v;switch(w.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(a[y]!=null){if(v==null)if(w.t=="e"&&v===null)g[a[y]]=null;else if(d!==void 0)g[a[y]]=d;else if(p&&v===null)g[a[y]]=null;else continue;else g[a[y]]=p&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?v:ua(w,v,u);v!=null&&(m=!1)}}return{row:g,isempty:m}}function Cd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],o=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},p=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof p){case"string":f=Rt(p);break;case"number":f=Rt(e["!ref"]),f.s.r=p;break;default:f=p}n>0&&(s=0);var m=Tr(f.s.r),g=[],y=[],w=0,v=0,S=Array.isArray(e),E=f.s.r,A=0,b={};S&&!e[E]&&(e[E]=[]);var D=d.skipHidden&&e["!cols"]||[],O=d.skipHidden&&e["!rows"]||[];for(A=f.s.c;A<=f.e.c;++A)if(!(D[A]||{}).hidden)switch(g[A]=ur(A),r=S?e[E][A]:e[g[A]+m],n){case 1:a[A]=A-f.s.c;break;case 2:a[A]=g[A];break;case 3:a[A]=d.header[A-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=ua(r,null,d),v=b[o]||0,!v)b[o]=1;else{do u=o+"_"+v++;while(b[u]);b[o]=v,b[u]=1}a[A]=u}for(E=f.s.r+s;E<=f.e.r;++E)if(!(O[E]||{}).hidden){var C=Cb(e,f,E,g,n,a,S,d);(C.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(y[w++]=C.row)}return y.length=w,y}var Sw=/"/g;function Nb(e,t,r,n,s,a,o,u){for(var f=!0,d=[],p="",m=Tr(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var y=u.dense?(e[r]||[])[g]:e[n[g]+m];if(y==null)p="";else if(y.v!=null){f=!1,p=""+(u.rawNumbers&&y.t=="n"?y.v:ua(y,null,u));for(var w=0,v=0;w!==p.length;++w)if((v=p.charCodeAt(w))===s||v===a||v===34||u.forceQuotes){p='"'+p.replace(Sw,'""')+'"';break}p=="ID"&&(p='"ID"')}else y.f!=null&&!y.F?(f=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(Sw,'""')+'"')):p="";d.push(p)}return u.blankrows===!1&&f?null:d.join(o)}function bx(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Rt(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),d=new RegExp((a=="|"?"\\|":a)+"+$"),p="",m=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],y=n.skipHidden&&e["!rows"]||[],w=s.s.c;w<=s.e.c;++w)(g[w]||{}).hidden||(m[w]=ur(w));for(var v=0,S=s.s.r;S<=s.e.r;++S)(y[S]||{}).hidden||(p=Nb(e,s,S,m,o,f,a,n),p!=null&&(n.strip&&(p=p.replace(d,"")),(p||n.blankrows!==!1)&&r.push((v++?u:"")+p)));return delete n.dense,r.join("")}function Ab(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=bx(e,t);if(typeof Ot>"u"||t.type=="string")return r;var n=Ot.utils.encode(1200,r,"str");return""+n}function VU(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Rt(e["!ref"]),a="",o=[],u,f=[],d=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)o[u]=ur(u);for(var p=s.s.r;p<=s.e.r;++p)for(a=Tr(p),u=s.s.c;u<=s.e.c;++u)if(t=o[u]+a,r=d?(e[p]||[])[u]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=t+"="+n}return f}function jb(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},o=0,u=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?vr(n.origin):n.origin;o=f.r,u=f.c}var d,p={s:{c:0,r:0},e:{c:u,r:o+t.length-1+s}};if(a["!ref"]){var m=Rt(a["!ref"]);p.e.c=Math.max(p.e.c,m.e.c),p.e.r=Math.max(p.e.r,m.e.r),o==-1&&(o=m.e.r+1,p.e.r=o+t.length-1+s)}else o==-1&&(o=0,p.e.r=t.length-1+s);var g=n.header||[],y=0;t.forEach(function(v,S){Nr(v).forEach(function(E){(y=g.indexOf(E))==-1&&(g[y=g.length]=E);var A=v[E],b="z",D="",O=ut({c:u+y,r:o+S+s});d=du(a,O),A&&typeof A=="object"&&!(A instanceof Date)?a[O]=A:(typeof A=="number"?b="n":typeof A=="boolean"?b="b":typeof A=="string"?b="s":A instanceof Date?(b="d",n.cellDates||(b="n",A=Kr(A)),D=n.dateNF||st[14]):A===null&&n.nullError&&(b="e",A=0),d?(d.t=b,d.v=A,delete d.w,delete d.R,D&&(d.z=D)):a[O]=d={t:b,v:A},D&&(d.z=D))})}),p.e.c=Math.max(p.e.c,u+g.length-1);var w=Tr(o);if(s)for(y=0;y<g.length;++y)a[ur(y+u)+w]={t:"s",v:g[y]};return a["!ref"]=vt(p),a}function HU(e,t){return jb(null,e,t)}function du(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=vr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?du(e,ut(t)):du(e,ut({r:t,c:r||0}))}function GU(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ex(){return{SheetNames:[],Sheets:{}}}function Tx(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var o=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(ab(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function XU(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=GU(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function KU(e,t){return e.z=t,e}function Db(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function qU(e,t,r){return Db(e,"#"+t,r)}function YU(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function JU(e,t,r,n){for(var s=typeof t!="string"?t:Rt(t),a=typeof t=="string"?t:vt(t),o=s.s.r;o<=s.e.r;++o)for(var u=s.s.c;u<=s.e.c;++u){var f=du(e,o,u);f.t="n",f.F=a,delete f.v,o==s.s.r&&u==s.s.c&&(f.f=r,n&&(f.D=!0))}return e}var Fb={encode_col:ur,encode_row:Tr,encode_cell:ut,encode_range:vt,decode_col:Qm,decode_row:Jm,split_cell:xI,decode_cell:vr,decode_range:Pn,format_cell:ua,sheet_add_aoa:YS,sheet_add_json:jb,sheet_add_dom:gb,aoa_to_sheet:Ul,json_to_sheet:HU,table_to_sheet:vb,table_to_book:oU,sheet_to_csv:bx,sheet_to_txt:Ab,sheet_to_json:Cd,sheet_to_html:xb,sheet_to_formulae:VU,sheet_to_row_object_array:Cd,sheet_get_cell:du,book_new:Ex,book_append_sheet:Tx,book_set_sheet_visibility:XU,cell_set_number_format:KU,cell_set_hyperlink:Db,cell_set_internal_link:qU,cell_add_comment:YU,sheet_set_array_formula:JU,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Jd;function QU(e){Jd=e}function ZU(e,t){var r=Jd(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var s=Rt(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),d=new RegExp((a=="|"?"\\|":a)+"+$"),p="",m=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],y=n.skipHidden&&e["!rows"]||[],w=s.s.c;w<=s.e.c;++w)(g[w]||{}).hidden||(m[w]=ur(w));var v=s.s.r,S=!1,E=0;return r._read=function(){if(!S)return S=!0,r.push("\uFEFF");for(;v<=s.e.r;)if(++v,!(y[v-1]||{}).hidden&&(p=Nb(e,s,v-1,m,o,f,a,n),p!=null&&(n.strip&&(p=p.replace(d,"")),p||n.blankrows!==!1)))return r.push((E++?u:"")+p);return r.push(null)},r}function e$(e,t){var r=Jd(),n=t||{},s=n.header!=null?n.header:hb,a=n.footer!=null?n.footer:pb;r.push(s);var o=Pn(e["!ref"]);n.dense=Array.isArray(e),r.push(mb(e,o,n));var u=o.s.r,f=!1;return r._read=function(){if(u>o.e.r)return f||(f=!0,r.push("</table>"+a)),r.push(null);for(;u<=o.e.r;){r.push(db(e,o,u,n)),++u;break}},r}function t$(e,t){var r=Jd({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},s=0,a=1,o=[],u=0,f="",d={s:{r:0,c:0},e:{r:0,c:0}},p=t||{},m=p.range!=null?p.range:e["!ref"];switch(p.header===1?s=1:p.header==="A"?s=2:Array.isArray(p.header)&&(s=3),typeof m){case"string":d=Rt(m);break;case"number":d=Rt(e["!ref"]),d.s.r=m;break;default:d=m}s>0&&(a=0);var g=Tr(d.s.r),y=[],w=0,v=Array.isArray(e),S=d.s.r,E=0,A={};v&&!e[S]&&(e[S]=[]);var b=p.skipHidden&&e["!cols"]||[],D=p.skipHidden&&e["!rows"]||[];for(E=d.s.c;E<=d.e.c;++E)if(!(b[E]||{}).hidden)switch(y[E]=ur(E),n=v?e[S][E]:e[y[E]+g],s){case 1:o[E]=E-d.s.c;break;case 2:o[E]=y[E];break;case 3:o[E]=p.header[E-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),f=u=ua(n,null,p),w=A[u]||0,!w)A[u]=1;else{do f=u+"_"+w++;while(A[f]);A[u]=w,A[f]=1}o[E]=f}return S=d.s.r+a,r._read=function(){for(;S<=d.e.r;)if(!(D[S-1]||{}).hidden){var O=Cb(e,d,S,y,s,o,v,p);if(++S,O.isempty===!1||(s===1?p.blankrows!==!1:p.blankrows)){r.push(O.row);return}}return r.push(null)},r}var r$={to_json:t$,to_html:e$,to_csv:ZU,set_readable:QU};const n$=Qc.version,s$=Object.freeze(Object.defineProperty({__proto__:null,CFB:Ze,SSF:jS,parse_xlscfb:gx,parse_zip:Sb,read:fu,readFile:ww,readFileSync:ww,set_cptable:oP,set_fs:OP,stream:r$,utils:Fb,version:n$,write:Yd,writeFile:_w,writeFileAsync:WU,writeFileSync:_w,writeFileXLSX:zU,writeXLSX:Sx},Symbol.toStringTag,{value:"Module"})),a$=[{field:"familyCode",variations:["family code","familycode","family_code"]},{field:"familyName",variations:["family name","familyname","family_name"]},{field:"classCode",variations:["class code","classcode","class_code"]},{field:"className",variations:["class name","classname","class_name"]},{field:"brandCode",variations:["brand code","brandcode","brand_code"]},{field:"brandName",variations:["brand name","brandname","brand_name"]},{field:"articleCode",variations:["article code","articlecode","article_code"]},{field:"articleDescription",variations:["article description","articledescription","article_description"]}],i$="Family Code,Family Name,Class Code,Class Name,Brand Code,Brand Name,Article Code,Article Description",o$=["familyCode","familyName","classCode","className","brandCode","brandName","articleCode","articleDescription"],l$={familyCode:"Family code",familyName:"Family name",classCode:"Class code",className:"Class name",brandCode:"Brand code",brandName:"Brand name",articleCode:"Article code",articleDescription:"Article description"},kw=e=>e.toLowerCase().replace(/[^a-z]/g,"").trim(),c$=(e,t)=>{const r=kw(t);return e.findIndex(n=>kw(n)===r)},u$=e=>{const t={},r=[];for(const n of a$){let s=-1;for(const a of n.variations)if(s=c$(e,a),s!==-1)break;s!==-1?t[n.field]=s:r.push(n.variations[0])}return{mapping:t,missingHeaders:r}},f$=e=>{const t=[];for(const r of o$)e[r]||t.push(`${l$[r]} is required`);return t},d$=(e,t)=>{const r={familyCode:String(e[t.familyCode]||"").trim(),familyName:String(e[t.familyName]||"").trim(),classCode:String(e[t.classCode]||"").trim(),className:String(e[t.className]||"").trim(),brandCode:String(e[t.brandCode]||"").trim(),brandName:String(e[t.brandName]||"").trim(),articleCode:String(e[t.articleCode]||"").trim(),articleDescription:String(e[t.articleDescription]||"").trim(),errors:[]};return r.errors=f$(r),r},h$=e=>{const t=e.split(`
`).filter(s=>s.trim());if(t.length<2)throw new Error("CSV file must contain header and at least one data row");const r=t[0].split(",").map(s=>s.trim()),n=[];for(let s=1;s<t.length;s++)t[s].trim()!==""&&n.push(t[s].split(",").map(a=>a.trim()));return{headers:r,dataRows:n}},p$=e=>{const t=fu(e,{type:"array"}),r=t.SheetNames[0];if(!r)throw new Error("Excel file contains no sheets");const n=t.Sheets[r],s=Fb.sheet_to_json(n,{header:1});if(s.length<2)throw new Error("Excel file must contain header and at least one data row");const a=s[0].map(u=>String(u||"").trim()),o=[];for(let u=1;u<s.length;u++){const f=s[u];f&&f.some(d=>String(d||"").trim())&&o.push(f.map(d=>String(d||"").trim()))}return{headers:a,dataRows:o}},m$=(e,t)=>{const{mapping:r,missingHeaders:n}=u$(e);if(n.length>0)throw new Error(`Missing required columns: ${n.join(", ")}`);const s=[],a=[];for(let o=0;o<t.length;o++){const u=t[o];if(u.length<Math.max(...Object.values(r))+1){a.push(`Row ${o+2}: Insufficient columns`);continue}const f=d$(u,r);s.push(f)}return{data:s,errors:a}},x$=e=>{const t=[...new Set(e.map(f=>f.familyName))].sort(),r=[...new Set(e.map(f=>f.className))].sort(),n=[...new Set(e.map(f=>f.brandName))].sort(),s={};e.forEach(f=>{s[f.familyName]||(s[f.familyName]=[]),s[f.familyName].includes(f.className)||s[f.familyName].push(f.className)});const a={};e.forEach(f=>{a[f.familyName]||(a[f.familyName]=[]),a[f.familyName].includes(f.brandName)||a[f.familyName].push(f.brandName)});const o={};e.forEach(f=>{o[f.className]||(o[f.className]=[]),o[f.className].includes(f.brandName)||o[f.className].push(f.brandName)});const u={};return e.forEach(f=>{u[f.articleCode]={familyName:f.familyName,className:f.className,brandName:f.brandName,familyCode:f.familyCode,classCode:f.classCode,brandCode:f.brandCode,articleDescription:f.articleDescription}}),{families:t,classes:r,brands:n,familyClassMapping:s,familyBrandMapping:a,classBrandMapping:o,articleMappings:u}},g$=e=>{try{const t=new Date(e);return{date:t.toLocaleDateString(),time:t.toLocaleTimeString(),relative:v$(t)}}catch{return{date:"Unknown",time:"Unknown",relative:"Unknown"}}},v$=e=>{const r=new Date().getTime()-e.getTime(),n=Math.floor(r/(1e3*60)),s=Math.floor(r/(1e3*60*60)),a=Math.floor(r/(1e3*60*60*24));return n<1?"just now":n<60?`${n} minutes ago`:s<24?`${s} hours ago`:`${a} days ago`},y$=async()=>{try{const e=Date.now(),t=Math.random().toString(36).substr(2,9),r=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/category-data?t=${e}&r=${t}`;console.log("Fetching category data with authentication...");const n=await jt.makeAuthenticatedRequest(r,{method:"GET"});if(n.ok){const s=await n.json();if(s.success&&s.categoryData)return console.log("Successfully fetched category data for authenticated user"),s.categoryData}else n.status!==404&&console.error("Failed to fetch category data:",n.status,n.statusText);return null}catch(e){return console.error("Error fetching current category data:",e),null}},w$=async()=>{try{const e=Date.now(),t=Math.random().toString(36).substr(2,9),r=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/category-data-raw?t=${e}&r=${t}`;console.log("Fetching raw category data with authentication...");const n=await jt.makeAuthenticatedRequest(r,{method:"GET"});if(n.ok){const s=await n.json();if(s.success&&s.rawData)return{rawData:s.rawData,fileName:s.fileName||"Unknown",uploadedAt:s.uploadedAt||new Date().toISOString()}}else n.status!==404&&console.error("Failed to fetch raw category data:",n.status,n.statusText);return null}catch(e){return console.error("Error fetching raw category data:",e),null}},_$=async e=>{try{console.log("Uploading category data with authentication...");const r=await(await jt.makeAuthenticatedRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/upload-category-data`,{method:"POST",body:JSON.stringify(e)})).json();return console.log("Category data upload response:",r),r}catch(t){return console.error("Error uploading category data:",t),{success:!1,error:t instanceof Error?t.message:"Upload failed"}}},S$=async()=>{try{console.log("Deleting category data with authentication...");const e=await jt.makeAuthenticatedRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/category-data`,{method:"DELETE"});if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return await e.json()}catch(e){throw console.error("Error deleting category data:",e),e}},k$=async()=>{try{const e=Date.now(),t=Math.random().toString(36).substr(2,9),r=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/category-data-raw?t=${e}&r=${t}`;console.log("Downloading category data with authentication...");const n=await jt.makeAuthenticatedRequest(r,{method:"GET"});if(!n.ok)throw n.status===404?new Error("No category data available to download. Please upload category data first."):new Error(`HTTP ${n.status}: ${n.statusText}`);const s=await n.json();if(!s.success||!s.rawData||s.rawData.length===0)throw new Error("No category data available to download");return{rawData:s.rawData,fileName:s.fileName}}catch(e){throw console.error("Error downloading category data:",e),e}},b$=async()=>{try{const e=Date.now(),t=Math.random().toString(36).substr(2,9),r=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/debug/category-state?t=${e}&r=${t}`;console.log("Debugging category state with authentication...");const n=await jt.makeAuthenticatedRequest(r,{method:"GET"});if(!n.ok)throw new Error("Failed to fetch debug info");return await n.json()}catch(e){throw console.error("Error debugging category state:",e),e}},E$=(e,t)=>{const r=e.map(d=>[d.familyCode||"",d.familyName||"",d.classCode||"",d.className||"",d.brandCode||"",d.brandName||"",d.articleCode||"",d.articleDescription||""].join(",")),n=[i$,...r].join(`
`),s=new Blob([n],{type:"text/csv"}),a=window.URL.createObjectURL(s),o=document.createElement("a");o.href=a;const u=t?.replace(/\.[^/.]+$/,"")||"category_data",f=new Date().toISOString().split("T")[0];o.download=`${u}_downloaded_${f}.csv`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(a)};function T$({onCategoryDataUploaded:e,onCategoryDataDeleted:t}){const[r,n]=j.useState(null),[s,a]=j.useState(!1),[o,u]=j.useState(!1),[f,d]=j.useState("idle"),[p,m]=j.useState([]),[g,y]=j.useState([]),[w,v]=j.useState(null),[S,E]=j.useState(null),[A,b]=j.useState(0),[D,O]=j.useState(!1),[C,T]=j.useState(!1),U=j.useRef(null);j.useEffect(()=>{z(),Z()},[]);const z=async(ee=!1)=>{try{const V=Date.now();if(!ee&&V-A<1e3){console.log("Skipping fetch - too recent");return}if(D&&!ee){console.log("Manual refresh in progress - skipping automatic fetch");return}console.log("Fetching current category data with cache busting..."),v(null);const F=await y$();F?(console.log("Setting current category data:",{families:F.families?.length||0,classes:F.classes?.length||0,brands:F.brands?.length||0,articles:Object.keys(F.articleMappings||{}).length,uploadId:F.uploadId}),v(F),b(V)):(console.log("No category data available"),v(null))}catch(V){console.error("Error fetching current category data:",V),v(null)}},Z=async(ee=!1)=>{try{if(D&&!ee){console.log("Manual refresh in progress - skipping automatic raw data fetch");return}console.log("Fetching raw category data with cache busting..."),E(null);const V=await w$();V?(console.log("Setting raw category data:",{fileName:V.fileName,recordCount:V.rawData.length,uploadedAt:V.uploadedAt}),E(V)):(console.log("No raw category data available"),E(null))}catch(V){console.error("Error fetching raw category data:",V),E(null)}},re=async()=>{u(!0);try{console.log("Downloading current category data...");const{rawData:ee,fileName:V}=await k$();E$(ee,V),be.success(`Category data downloaded! (${ee.length} records from ${V})`)}catch(ee){console.error("Error downloading category data:",ee),be.error(ee instanceof Error?ee.message:"Failed to download category data. Please try again.")}finally{u(!1)}},P=async()=>{console.log("Force refreshing all category data..."),O(!0);try{v(null),E(null),b(0),await new Promise(ee=>setTimeout(ee,100)),await Promise.all([z(!0),Z(!0)]),be.success("Category data refreshed")}finally{O(!1)}},se=async()=>{try{console.log("Debugging backend category state...");const ee=await b$();console.log("=== BACKEND DEBUG RESPONSE ==="),console.log(JSON.stringify(ee.debugInfo,null,2)),be.success(c.jsxs("div",{className:"max-w-md",children:[c.jsx("p",{className:"font-medium",children:"Backend State Debug"}),c.jsxs("div",{className:"text-xs mt-1 space-y-1",children:[c.jsxs("div",{children:["Main Data Families: ",ee.debugInfo.mainCategoryData.families.join(", ")||"None"]}),c.jsxs("div",{children:["Upload ID: ",ee.debugInfo.mainCategoryData.uploadId||"None"]}),c.jsxs("div",{children:["Total Uploads: ",ee.debugInfo.totalUploads]})]})]}),{duration:8e3})}catch(ee){console.error("Debug error:",ee),be.error("Debug request failed")}},me=async()=>{T(!0);try{console.log("=== STARTING CATEGORY DATA DELETION ===");const ee=await S$();if(console.log("Delete category data response:",ee),ee.success)v(null),E(null),b(0),be.success(c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"All Category Data Deleted Successfully!"}),c.jsxs("div",{className:"text-sm mt-1",children:[ee.deletedUploadsCount," category uploads removed from database"]}),c.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Deleted at: ",new Date(ee.deletedAt).toLocaleString()]})]}),{duration:5e3}),t&&(console.log("Notifying parent component about category data deletion..."),t()),console.log("=== CATEGORY DATA DELETION COMPLETED ===");else throw new Error(ee.error||"Unknown deletion error")}catch(ee){console.error("Error deleting category data:",ee),be.error(c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Failed to Delete Category Data"}),c.jsx("p",{className:"text-sm",children:ee instanceof Error?ee.message:"Unknown error occurred"})]}))}finally{T(!1)}},ce=ee=>{const V=ee.target.files?.[0];V&&(n(V),d("idle"),m([]),y([]),V.name.endsWith(".csv")?fe(V):V.name.endsWith(".xlsx")||V.name.endsWith(".xls")?de(V):be.error("Please upload a CSV or Excel file"))},fe=ee=>{const V=new FileReader;V.onload=F=>{try{const N=F.target?.result,{headers:L,dataRows:B}=h$(N);console.log("CSV headers found:",L),he(L,B)}catch(N){console.error("Error parsing CSV file:",N),be.error(N instanceof Error?N.message:"Failed to parse CSV file. Please check the file format.")}},V.onerror=()=>{be.error("Error reading CSV file")},V.readAsText(ee)},de=ee=>{const V=new FileReader;V.onload=F=>{try{const N=new Uint8Array(F.target?.result),{headers:L,dataRows:B}=p$(N);console.log("Excel headers found:",L),he(L,B)}catch(N){console.error("Error parsing Excel file:",N),be.error(N instanceof Error?N.message:"Failed to parse Excel file. Please check the file format.")}},V.onerror=()=>{be.error("Error reading Excel file")},V.readAsArrayBuffer(ee)},he=(ee,V)=>{try{const{data:F,errors:N}=m$(ee,V),L=[...N,...F.filter(B=>B.errors.length>0).map((B,q)=>`Row ${q+2}: ${B.errors.join(", ")}`)];m(F),y(L),L.length===0?be.success(`Successfully parsed ${F.length} category records from ${r?.name}`):be.warning(`Parsed ${F.length} records with ${L.length} validation errors from ${r?.name}`)}catch(F){console.error("Error processing file data:",F),be.error(F instanceof Error?F.message:"Failed to process file data"),y([F instanceof Error?F.message:"Unknown processing error"])}},Q=async()=>{if(!r||p.length===0){be.error("Please select a valid file with category data");return}const ee=p.filter(V=>V.errors.length===0);if(ee.length===0){be.error("No valid records found. Please fix the errors and try again.");return}a(!0);try{console.log("Starting category data upload...");const V=x$(ee);console.log("Processed upload data:",{totalRecords:ee.length,families:V.families.length,classes:V.classes.length,brands:V.brands.length,familiesList:V.families,classesList:V.classes,brandsList:V.brands});const F={fileName:r.name,...V,rawData:ee,totalRecords:p.length,validRecords:ee.length,errorCount:g.length};console.log("Sending upload request to backend...");const N=await _$(F);console.log("Upload response from backend:",N),N.success?(d("success"),console.log("Upload successful, uploadId:",N.uploadId),be.success(c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{className:"h-5 w-5 text-green-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Category Data Uploaded Successfully!"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[ee.length," records processed  ",V.families.length," families  ",V.classes.length," classes  ",V.brands.length," brands"]}),c.jsxs("p",{className:"text-xs text-blue-600 font-mono mt-1",children:["Upload ID: ",N.uploadId]})]})]}),{duration:6e3}),setTimeout(async()=>{console.log("Refreshing data after upload..."),await Promise.all([z(!0),Z(!0)])},2e3),n(null),m([]),y([]),U.current&&(U.current.value=""),e&&(console.log("Notifying parent about category data upload..."),setTimeout(()=>{e()},2500))):(d("error"),be.error(`Upload failed: ${N.error}`))}catch(V){console.error("Upload error:",V),d("error"),be.error("Upload failed. Please check your connection and try again.")}finally{a(!1)}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Upload Category Data"}),c.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Upload a CSV or Excel file containing family, class, brand, and article information. This data will be used for creating booster schemes with hierarchical filtering."})]}),c.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx(oa,{className:"h-10 w-10 mx-auto text-gray-400 mb-4"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Qt,{ref:U,type:"file",accept:".csv,.xlsx,.xls",onChange:ce,className:"hidden",id:"category-file-upload"}),c.jsxs("label",{htmlFor:"category-file-upload",className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[c.jsx(Cl,{className:"h-4 w-4 mr-2"}),"Choose File"]}),c.jsx("p",{className:"text-xs text-gray-500",children:"CSV or Excel files only"})]})]}),r&&c.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Cl,{className:"h-4 w-4 text-blue-500"}),c.jsx("span",{className:"text-sm font-medium text-blue-900",children:r.name}),c.jsxs(Mt,{variant:"secondary",className:"text-xs",children:[(r.size/1024).toFixed(1)," KB"]})]}),f==="success"&&c.jsx(gs,{className:"h-4 w-4 text-green-500"}),f==="error"&&c.jsx(ja,{className:"h-4 w-4 text-red-500"})]})})]}),g.length>0&&c.jsxs(sr,{className:"border-red-200 bg-red-50",children:[c.jsx(ia,{className:"h-4 w-4 text-red-600"}),c.jsx(ar,{children:c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"font-medium text-red-800",children:"Validation Errors Found:"}),c.jsxs("ul",{className:"text-sm text-red-700 space-y-1",children:[g.slice(0,10).map((ee,V)=>c.jsx("li",{className:"list-disc list-inside",children:ee},V)),g.length>10&&c.jsxs("li",{className:"text-xs text-red-600",children:["... and ",g.length-10," more errors"]})]})]})})]}),p.length>0&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("h4",{className:"font-medium",children:"Parsed Data Preview"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[p.length," total records  ",p.filter(ee=>ee.errors.length===0).length," valid  ",p.filter(ee=>ee.errors.length>0).length," with errors"]})]}),c.jsxs($e,{onClick:Q,disabled:s||p.filter(ee=>ee.errors.length===0).length===0,className:"flex items-center space-x-2",children:[s?c.jsx(zr,{className:"h-4 w-4 animate-spin"}):c.jsx(oa,{className:"h-4 w-4"}),c.jsx("span",{children:s?"Uploading...":"Upload Data"})]})]}),c.jsx("div",{className:"border rounded-lg max-h-64 overflow-auto",children:c.jsxs(qc,{children:[c.jsx(Yc,{children:c.jsxs(Fs,{children:[c.jsx(It,{children:"Family Code"}),c.jsx(It,{children:"Family Name"}),c.jsx(It,{children:"Class Code"}),c.jsx(It,{children:"Class Name"}),c.jsx(It,{children:"Brand Code"}),c.jsx(It,{children:"Brand Name"}),c.jsx(It,{children:"Article Code"}),c.jsx(It,{children:"Article Description"}),c.jsx(It,{children:"Status"})]})}),c.jsxs(Jc,{children:[p.slice(0,10).map((ee,V)=>c.jsxs(Fs,{className:ee.errors.length>0?"bg-red-50":"",children:[c.jsx(Pt,{className:"font-mono text-xs",children:ee.familyCode}),c.jsx(Pt,{children:ee.familyName}),c.jsx(Pt,{className:"font-mono text-xs",children:ee.classCode}),c.jsx(Pt,{children:ee.className}),c.jsx(Pt,{className:"font-mono text-xs",children:ee.brandCode}),c.jsx(Pt,{children:ee.brandName}),c.jsx(Pt,{className:"font-mono text-xs",children:ee.articleCode}),c.jsx(Pt,{className:"truncate max-w-32",children:ee.articleDescription}),c.jsx(Pt,{children:ee.errors.length===0?c.jsx(Mt,{variant:"secondary",className:"bg-green-100 text-green-800",children:"Valid"}):c.jsxs(Mt,{variant:"destructive",className:"text-xs",children:[ee.errors.length," error",ee.errors.length>1?"s":""]})})]},V)),p.length>10&&c.jsx(Fs,{children:c.jsxs(Pt,{colSpan:9,className:"text-center text-gray-500 text-sm",children:["... and ",p.length-10," more records"]})})]})]})})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Current Category Data"}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs($e,{onClick:P,variant:"outline",size:"sm",disabled:D,className:"flex items-center space-x-2",children:[c.jsx(zr,{className:`h-4 w-4 ${D?"animate-spin":""}`}),c.jsx("span",{children:"Refresh Data"})]}),c.jsxs($e,{onClick:se,variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[c.jsx(ia,{className:"h-4 w-4"}),c.jsx("span",{children:"Debug State"})]})]})]}),w?c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(io,{className:"h-5 w-5 text-green-600"}),c.jsx("span",{children:"Active Category Data"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs($e,{onClick:re,variant:"outline",size:"sm",disabled:o,className:"flex items-center space-x-2",children:[o?c.jsx(zr,{className:"h-4 w-4 animate-spin"}):c.jsx(pi,{className:"h-4 w-4"}),c.jsx("span",{children:"Download"})]}),c.jsxs(XR,{children:[c.jsx(KR,{asChild:!0,children:c.jsxs($e,{variant:"destructive",size:"sm",disabled:C,className:"flex items-center space-x-2",children:[C?c.jsx(zr,{className:"h-4 w-4 animate-spin"}):c.jsx(xu,{className:"h-4 w-4"}),c.jsx("span",{children:"Delete"})]})}),c.jsxs(JR,{children:[c.jsxs(QR,{children:[c.jsx(eP,{children:"Delete All Category Data"}),c.jsx(tP,{children:"This will permanently delete all category data from the database. This action cannot be undone and will affect all schemes that depend on this data."})]}),c.jsxs(ZR,{children:[c.jsx(nP,{children:"Cancel"}),c.jsx(rP,{onClick:me,className:"bg-red-600 hover:bg-red-700",children:"Delete All Data"})]})]})]})]})]})}),c.jsxs(Qe,{children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-600",children:w.families.length}),c.jsx("div",{className:"text-sm text-blue-700",children:"Families"})]}),c.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-green-600",children:w.classes.length}),c.jsx("div",{className:"text-sm text-green-700",children:"Classes"})]}),c.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-purple-600",children:w.brands.length}),c.jsx("div",{className:"text-sm text-purple-700",children:"Brands"})]}),c.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-orange-600",children:Object.keys(w.articleMappings||{}).length}),c.jsx("div",{className:"text-sm text-orange-700",children:"Articles"})]})]}),S&&c.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"font-medium text-gray-900",children:["Last Upload: ",S.fileName]}),c.jsxs("div",{className:"text-gray-600",children:[S.rawData.length," records  ",g$(S.uploadedAt).relative]})]}),w.uploadId&&c.jsx(Mt,{variant:"secondary",className:"font-mono text-xs",children:w.uploadId})]})})]})]}):c.jsx(Je,{children:c.jsxs(Qe,{className:"text-center py-8",children:[c.jsx(io,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),c.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Category Data"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Upload a CSV or Excel file to get started with category data management."})]})})]})]})}const yp=[{code:"P1",name:"National Distributor"},{code:"P2",name:"Regional Distributor"},{code:"P3",name:"Large Format Retailer"},{code:"P4",name:"Regional Retailer"},{code:"P5",name:"Direct Dealer"},{code:"P6",name:"PBG_Liquidation"},{code:"P7",name:"Advance Dealer-PBG"},{code:"P8",name:"Advance Dist-PBG"},{code:"P9",name:"Advance FOMT-PBG"},{code:"PD",name:"PBG DD Prime Partner"},{code:"PC",name:"PBG CDG Group"}],wp=["East","West","North1","North2","South"];function C$(){const[e,t]=j.useState("onboard"),[r,n]=j.useState([]),[s,a]=j.useState([]),[o,u]=j.useState(""),[f,d]=j.useState(!1),[p,m]=j.useState(null),[g,y]=j.useState({}),[w,v]=j.useState(null),[S,E]=j.useState(!1),[A,b]=j.useState("idle"),[D,O]=j.useState([]),[C,T]=j.useState([]),U=j.useRef(null),[z,Z]=j.useState({id:"",name:"",type:"",zone:"",state:""});j.useEffect(()=>{P(),re()},[]);const re=async()=>{try{const ue=await jt.makePublicRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/zone-state-mapping`,{method:"GET"}),ge=await ue.text();if(console.log("Raw zone-state mapping response:",ge),!ue.ok){console.error("Zone-state mapping response not ok:",ue.status,ge);return}let _e;try{_e=JSON.parse(ge)}catch(je){console.error("Zone-state mapping JSON parse error:",je,"Raw text:",ge);return}_e.success?y(_e.mapping||{}):console.error("Zone-state mapping API returned error:",_e.error)}catch(ue){console.error("Error fetching zone-state mapping:",ue)}},P=async()=>{try{console.log("Loading distributors...");const ue=await jt.makeAuthenticatedRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/distributors`,{method:"GET"}),ge=await ue.text();if(console.log("Raw distributor response:",ge),!ue.ok){console.error("Distributor response not ok:",ue.status,ge),be.error(`Failed to load distributors: ${ue.status} ${ue.statusText}`);return}let _e;try{_e=JSON.parse(ge)}catch(je){console.error("Distributor JSON parse error:",je,"Raw text:",ge),be.error("Failed to parse distributors response");return}if(_e.success){const je=_e.distributors?.map(Ke=>Ke.value)||[];console.log("Loaded distributors:",je.length),n(je),a(je)}else console.error("API returned error:",_e.error),be.error(`Failed to load distributors: ${_e.error}`)}catch(ue){console.error("Error fetching distributors:",ue),be.error("Failed to load distributors")}},se=()=>!z.zone||z.zone==="all-zones"?Object.values(g).flat():g[z.zone]||[],me=ue=>{if(u(ue),!ue.trim()){a(r);return}const ge=ue.toLowerCase().trim(),_e=r.filter(je=>je.id?.toLowerCase().includes(ge)||je.code?.toLowerCase().includes(ge)||je.name?.toLowerCase().includes(ge));a(_e)};j.useEffect(()=>{o?me(o):a(r)},[r]);const ce=(ue,ge)=>{Z(_e=>{const je={..._e,[ue]:ge};return ue==="zone"&&(je.state=""),je})},fe=(ue,ge,_e="")=>{const je=ge||"DIST",Ke=ue.replace(/\s+/g,"").substring(0,3).toUpperCase(),ot=_e||Date.now().toString().slice(-4);return`${je}_${Ke}_${ot}`},de=async ue=>{ue.preventDefault(),d(!0);try{const ge={id:z.id||`dist_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:z.name,code:fe(z.name,z.type,z.id),type:z.type,zone:z.zone,state:z.state,status:"active"},_e=p?`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/distributors/${p.id}`:`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/distributors`,Ke=await(await jt.makeAuthenticatedRequest(_e,{method:p?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ge)})).json();Ke.success?(be.success(p?"Distributor updated successfully!":"Distributor added successfully!"),he(),P(),t("manage")):be.error(`Failed to ${p?"update":"add"} distributor: ${Ke.error}`)}catch(ge){console.error("Error submitting distributor:",ge),be.error("Failed to process distributor data")}finally{d(!1)}},he=()=>{Z({id:"",name:"",type:"",zone:"",state:""}),m(null)},Q=ue=>{Z({id:ue.code||ue.id,name:ue.name,type:ue.type,zone:ue.zone,state:ue.state}),m(ue),t("onboard")},ee=async ue=>{if(confirm("Are you sure you want to delete this distributor?"))try{const _e=await(await jt.makeAuthenticatedRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/distributors/${ue}`,{method:"DELETE"})).json();_e.success?(be.success("Distributor deleted successfully!"),P()):be.error(`Failed to delete distributor: ${_e.error}`)}catch(ge){console.error("Error deleting distributor:",ge),be.error("Failed to delete distributor")}},V=async(ue,ge)=>{const _e=ge==="active"?"inactive":"active";try{const Ke=await(await jt.makeAuthenticatedRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/distributors/${ue}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:_e})})).json();Ke.success?(be.success(`Distributor ${_e==="active"?"activated":"deactivated"} successfully!`),P()):be.error(`Failed to update distributor status: ${Ke.error}`)}catch(je){console.error("Error updating distributor status:",je),be.error("Failed to update distributor status")}},F=()=>{const ue=["Distributor ID,Distributor Name,Type,Zone,State","DIST001,ABC Electronics Pvt Ltd,P1,North1,Delhi","DIST002,XYZ Distributors,P2,West,Maharashtra","DIST003,Regional Sales Corp,P3,South,Karnataka","DIST004,Metro Retail Chain,P4,East,West Bengal","DIST005,Direct Dealer Hub,P5,North2,Punjab"].join(`
`),ge=new Blob([ue],{type:"text/csv"}),_e=window.URL.createObjectURL(ge),je=document.createElement("a");je.href=_e,je.download="distributor_bulk_upload_template.csv",je.click(),window.URL.revokeObjectURL(_e),be.success("Template downloaded successfully!")},N=ue=>ue.toLowerCase().replace(/[^a-z]/g,"").trim(),L=(ue,ge)=>{const _e=N(ge);return ue.findIndex(je=>N(je)===_e)},B=ue=>{console.log("Parsing CSV file:",ue.name);const ge=new FileReader;ge.onload=_e=>{try{const je=_e.target?.result;console.log("CSV file content length:",je.length);const Ke=je.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`).filter(tt=>tt.trim());if(console.log("Total lines found:",Ke.length),Ke.length<2){be.error("CSV file must contain header row and at least one data row");return}const ot=tt=>{const lt=[];let Ye="",Tt=!1;for(let dr=0;dr<tt.length;dr++){const Kt=tt[dr];Kt==='"'?Tt=!Tt:Kt===","&&!Tt?(lt.push(Ye.trim().replace(/^"|"$/g,"")),Ye=""):Ye+=Kt}return lt.push(Ye.trim().replace(/^"|"$/g,"")),lt},ft=ot(Ke[0]);console.log("CSV headers found:",ft);const et=Ke.slice(1).filter(tt=>tt.trim()).map(tt=>ot(tt)).filter(tt=>tt.some(lt=>lt.trim()!==""));if(console.log("CSV rows parsed:",et.length),console.log("Sample row:",et[0]),et.length===0){be.error("No valid data rows found in CSV file");return}oe(ft,et)}catch(je){console.error("CSV parsing error:",je),be.error("Failed to parse CSV file. Please check the file format.")}},ge.onerror=_e=>{console.error("FileReader error:",_e),be.error("Error reading CSV file")},ge.readAsText(ue,"UTF-8")},q=async ue=>{try{console.log("Attempting to parse Excel file:",ue.name);let ge=null;try{ge=await Ol(()=>Promise.resolve().then(()=>s$),void 0),console.log("Successfully loaded XLSX via dynamic import"),ne(ue,ge)}catch{console.log("Dynamic import failed, trying alternative approaches");try{const je=document.createElement("script");je.src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js",je.onload=()=>{console.log("XLSX loaded from CDN"),ge=window.XLSX,ge?ne(ue,ge):Y()},je.onerror=()=>{console.error("Failed to load XLSX from CDN"),Y()},document.head.appendChild(je);return}catch(je){console.error("CDN loading failed:",je),Y();return}}}catch(ge){console.error("Excel parsing setup error:",ge),Y()}},ne=(ue,ge)=>{const _e=new FileReader;_e.onload=je=>{try{console.log("Reading Excel file data...");const Ke=new Uint8Array(je.target?.result),ot=ge.read(Ke,{type:"array"});if(!ot.SheetNames||ot.SheetNames.length===0){be.error("Excel file contains no worksheets");return}const ft=ot.SheetNames[0],et=ot.Sheets[ft];console.log(`Processing worksheet: ${ft}`);const tt=ge.utils.sheet_to_json(et,{header:1,defval:""});if(console.log("Raw Excel data:",tt),!tt||tt.length<2){be.error("Excel file must contain header row and at least one data row");return}const lt=tt[0].map(Tt=>{const dr=String(Tt||"").trim();return console.log("Header:",dr),dr}),Ye=tt.slice(1).filter(Tt=>Tt&&Tt.some(dr=>String(dr||"").trim()!=="")).map(Tt=>Tt.map(dr=>String(dr||"").trim()));if(console.log("Parsed Excel headers:",lt),console.log("Parsed Excel rows:",Ye.length),console.log("Sample row:",Ye[0]),Ye.length===0){be.error("No valid data rows found in Excel file");return}oe(lt,Ye)}catch(Ke){console.error("Excel parsing error:",Ke),be.error("Failed to parse Excel file. Please check the file format and try again.")}},_e.onerror=je=>{console.error("FileReader error:",je),be.error("Error reading Excel file")},_e.readAsArrayBuffer(ue)},Y=()=>{be.error("Excel parsing is not available. Please convert your file to CSV format and upload again.")},oe=(ue,ge)=>{console.log("Processing file data with headers:",ue),console.log("Processing file data with rows:",ge.length);const _e=[{field:"id",variations:["distributor id","distributorid","distributor_id","id"]},{field:"name",variations:["distributor name","distributorname","distributor_name","name"]},{field:"type",variations:["type","distributor type","distributortype","distributor_type"]},{field:"zone",variations:["zone"]},{field:"state",variations:["state"]}],je={},Ke=[];for(const tt of _e){let lt=-1;for(const Ye of tt.variations)if(lt=L(ue,Ye),lt!==-1)break;lt!==-1?(je[tt.field]=lt,console.log(`Mapped ${tt.field} to column ${lt} (${ue[lt]})`)):Ke.push(tt.variations[0])}if(console.log("Header mapping:",je),console.log("Missing headers:",Ke),Ke.length>0){be.error(`Missing required columns: ${Ke.join(", ")}`),T([`Missing columns: ${Ke.join(", ")}`]);return}const ot=[],ft=[];for(let tt=0;tt<ge.length;tt++){const lt=ge[tt];if(!lt||lt.every(Tt=>!Tt||Tt.trim()===""))continue;if(lt.length<Math.max(...Object.values(je))+1){ft.push(`Row ${tt+2}: Insufficient columns`);continue}const Ye={id:lt[je.id]||"",name:lt[je.name]||"",type:lt[je.type]||"",zone:lt[je.zone]||"",state:lt[je.state]||"",errors:[]};console.log(`Processing record ${tt+1}:`,Ye),Ye.id||Ye.errors.push("Distributor ID is required"),Ye.name||Ye.errors.push("Distributor name is required"),Ye.type||Ye.errors.push("Type is required"),Ye.zone||Ye.errors.push("Zone is required"),Ye.state||Ye.errors.push("State is required"),Ye.type&&!yp.find(Tt=>Tt.code===Ye.type)&&Ye.errors.push(`Invalid type: ${Ye.type}. Valid types: ${yp.map(Tt=>Tt.code).join(", ")}`),Ye.zone&&!wp.includes(Ye.zone)&&Ye.errors.push(`Invalid zone: ${Ye.zone}. Valid zones: ${wp.join(", ")}`),Ye.zone&&Ye.state&&g[Ye.zone]&&(g[Ye.zone].includes(Ye.state)||Ye.errors.push(`State ${Ye.state} is not valid for zone ${Ye.zone}. Valid states: ${g[Ye.zone].join(", ")}`)),ot.push(Ye)}const et=[...ft,...ot.filter(tt=>tt.errors.length>0).map((tt,lt)=>`Row ${lt+2}: ${tt.errors.join(", ")}`)];console.log("Processed records:",ot.length),console.log("Validation errors:",et.length),O(ot),T(et),et.length===0?be.success(`Successfully parsed ${ot.length} distributor records`):be.warning(`Parsed ${ot.length} records with ${et.length} validation errors`)},le=ue=>{const ge=ue.target.files?.[0];ge&&(console.log("File selected:",ge.name,"Size:",ge.size,"Type:",ge.type),v(ge),b("idle"),O([]),T([]),ge.name.endsWith(".csv")?(console.log("Processing as CSV file"),B(ge)):ge.name.endsWith(".xlsx")||ge.name.endsWith(".xls")?(console.log("Processing as Excel file"),q(ge)):be.error("Please upload a CSV or Excel file"))},te=async()=>{if(console.log("=== STARTING BULK UPLOAD ==="),console.log("Selected file:",w?.name),console.log("Parsed data length:",D.length),console.log("Validation errors:",C.length),!w||D.length===0){be.error("Please select a valid file with distributor data");return}const ue=D.filter(ge=>ge.errors.length===0);if(console.log("Valid records:",ue.length),console.log("Valid records sample:",ue.slice(0,2)),ue.length===0){be.error("No valid records found. Please fix the errors and try again.");return}E(!0);try{console.log("Preparing distributors for upload...");const ge=ue.map(ft=>({id:ft.id,name:ft.name,code:fe(ft.name,ft.type,ft.id),type:ft.type,zone:ft.zone,state:ft.state,status:"active"}));console.log("Distributors to upload:",ge.length),console.log("Sample distributor to upload:",ge[0]);const _e=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/distributors/bulk`;console.log("Uploading to URL:",_e);const je=await jt.makeAuthenticatedRequest(_e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({distributors:ge})});console.log("Upload response status:",je.status),console.log("Upload response ok:",je.ok);const Ke=await je.text();console.log("Raw response:",Ke);let ot;try{ot=JSON.parse(Ke)}catch(ft){throw console.error("Failed to parse response JSON:",ft),console.error("Raw response text:",Ke),new Error("Server returned invalid JSON response")}console.log("Parsed result:",ot),ot.success?(b("success"),console.log(" Bulk upload successful!"),be.success(c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(gs,{className:"h-5 w-5 text-green-600"}),c.jsxs("div",{children:[c.jsx("p",{children:"Distributors Uploaded Successfully!"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[ue.length," distributors processed and added to the system"]})]})]}),{duration:6e3}),v(null),O([]),T([]),U.current&&(U.current.value=""),console.log("Reloading distributors after successful upload..."),await P(),t("manage")):(b("error"),console.error(" Bulk upload failed:",ot.error||ot.message),be.error(`Failed to upload distributors: ${ot.error||ot.message||"Unknown error"}`))}catch(ge){console.error(" Error during bulk upload:",ge),b("error"),ge instanceof Error?be.error(`Upload failed: ${ge.message}`):be.error("Failed to upload distributors - unknown error occurred")}finally{E(!1),console.log("=== BULK UPLOAD COMPLETED ===")}},I=ue=>{const ge={active:"bg-green-100 text-green-800",inactive:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800"};return c.jsx(Mt,{className:ge[ue],children:ue.charAt(0).toUpperCase()+ue.slice(1)})},Ce=D.filter(ue=>ue.errors.length===0),Ie=D.filter(ue=>ue.errors.length>0);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs(sr,{children:[c.jsx(Hc,{className:"h-4 w-4"}),c.jsxs(ar,{children:[c.jsx("strong",{children:"Distributor Management for Scheme Calculations:"})," Upload distributors with essential information. Required fields: ID, Name, Type, Zone, and State. This data is used for scheme calculations and commission distribution."]})]}),c.jsxs(go,{value:e,onValueChange:t,className:"space-y-6",children:[c.jsxs(vo,{className:"grid w-full grid-cols-3",children:[c.jsxs(Yt,{value:"onboard",className:"flex items-center space-x-2",children:[c.jsx(Gc,{className:"h-4 w-4"}),c.jsx("span",{children:p?"Edit Distributor":"Add Distributor"})]}),c.jsxs(Yt,{value:"bulk-upload",className:"flex items-center space-x-2",children:[c.jsx(oa,{className:"h-4 w-4"}),c.jsx("span",{children:"Bulk Upload"})]}),c.jsxs(Yt,{value:"manage",className:"flex items-center space-x-2",children:[c.jsx(mi,{className:"h-4 w-4"}),c.jsxs("span",{children:["Manage (",s.length,o?`/${r.length}`:"",")"]})]})]}),c.jsx(Jt,{value:"onboard",className:"space-y-6",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx($j,{className:"h-5 w-5"}),c.jsx("span",{children:p?"Edit Distributor":"Add New Distributor"})]})}),c.jsx(Qe,{children:c.jsxs("form",{onSubmit:de,className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"id",children:"Distributor ID"}),c.jsx(Qt,{id:"id",value:z.id,onChange:ue=>ce("id",ue.target.value),placeholder:"Enter distributor ID (e.g., DIST001)"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used for scheme calculations and sales data mapping"})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"name",children:"Distributor Name"}),c.jsx(Qt,{id:"name",value:z.name,onChange:ue=>ce("name",ue.target.value),placeholder:"Enter distributor name",required:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"type",children:"Distributor Type"}),c.jsxs(_r,{value:z.type,onValueChange:ue=>ce("type",ue),children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select type"})}),c.jsx(br,{children:yp.map(ue=>c.jsxs(wt,{value:ue.code,children:[ue.code,": ",ue.name]},ue.code))})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"zone",children:"Zone"}),c.jsxs(_r,{value:z.zone,onValueChange:ue=>ce("zone",ue),children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select zone"})}),c.jsx(br,{children:wp.map(ue=>c.jsx(wt,{value:ue,children:ue},ue))})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"state",children:"State"}),c.jsxs(_r,{value:z.state,onValueChange:ue=>ce("state",ue),disabled:!z.zone,children:[c.jsx(kr,{children:c.jsx(Sr,{placeholder:"Select state"})}),c.jsx(br,{children:se().map(ue=>c.jsx(wt,{value:ue,children:ue},ue))})]})]})]}),c.jsxs("div",{className:"flex justify-end space-x-4",children:[p&&c.jsx($e,{type:"button",onClick:he,variant:"outline",children:"Cancel"}),c.jsx($e,{type:"submit",disabled:f,children:f?"Processing...":p?"Update Distributor":"Add Distributor"})]})]})})]})}),c.jsx(Jt,{value:"bulk-upload",className:"space-y-6",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(oa,{className:"h-5 w-5"}),c.jsx("span",{children:"Bulk Upload Distributors"})]})}),c.jsxs(Qe,{className:"space-y-6",children:[c.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Cl,{className:"mx-auto h-12 w-12 text-gray-400"}),c.jsxs("div",{className:"mt-4",children:[c.jsx(ct,{htmlFor:"bulk-file-upload",className:"cursor-pointer",children:c.jsx("span",{className:"mt-2 block text-sm font-medium text-gray-900",children:"Upload CSV or Excel file"})}),c.jsx(Qt,{ref:U,id:"bulk-file-upload",type:"file",className:"hidden",accept:".csv,.xlsx,.xls",onChange:le}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"CSV, XLSX or XLS files up to 10MB"})]}),c.jsx("div",{className:"mt-4 flex justify-center",children:c.jsxs($e,{type:"button",onClick:()=>U.current?.click(),variant:"outline",children:[c.jsx(oa,{className:"h-4 w-4 mr-2"}),"Choose File"]})}),c.jsx("div",{className:"mt-4 flex justify-center",children:c.jsxs($e,{type:"button",onClick:F,variant:"outline",size:"sm",children:[c.jsx(pi,{className:"h-4 w-4 mr-2"}),"Download Template"]})})]})}),w&&c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Cl,{className:"h-5 w-5 text-blue-600"}),c.jsx("span",{className:"text-sm font-medium text-blue-900",children:w.name}),c.jsxs(Mt,{variant:"secondary",children:[(w.size/1024).toFixed(1),"KB"]})]})}),D.length>0&&c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center justify-between",children:[c.jsx("span",{children:"Validation Results"}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs(Mt,{className:"bg-green-100 text-green-800",children:["Valid: ",Ce.length]}),Ie.length>0&&c.jsxs(Mt,{className:"bg-red-100 text-red-800",children:["Invalid: ",Ie.length]})]})]})}),c.jsxs(Qe,{children:[C.length>0&&c.jsxs(sr,{className:"mb-4",children:[c.jsx(ja,{className:"h-4 w-4"}),c.jsxs(ar,{children:[c.jsx("strong",{children:"Validation Errors:"}),c.jsx("ul",{className:"mt-2 list-disc list-inside text-sm",children:C.map((ue,ge)=>c.jsx("li",{children:ue},ge))})]})]}),c.jsx("div",{className:"max-h-64 overflow-y-auto",children:c.jsxs(qc,{children:[c.jsx(Yc,{children:c.jsxs(Fs,{children:[c.jsx(It,{children:"Status"}),c.jsx(It,{children:"ID"}),c.jsx(It,{children:"Name"}),c.jsx(It,{children:"Type"}),c.jsx(It,{children:"Zone"}),c.jsx(It,{children:"State"})]})}),c.jsx(Jc,{children:D.map((ue,ge)=>c.jsxs(Fs,{children:[c.jsx(Pt,{children:ue.errors.length===0?c.jsx(gs,{className:"h-4 w-4 text-green-600"}):c.jsx(ja,{className:"h-4 w-4 text-red-600"})}),c.jsx(Pt,{children:ue.id}),c.jsx(Pt,{children:ue.name}),c.jsx(Pt,{children:ue.type}),c.jsx(Pt,{children:ue.zone}),c.jsx(Pt,{children:ue.state})]},ge))})]})}),c.jsxs("div",{className:"flex justify-between items-center mt-4",children:[c.jsxs("div",{className:"text-sm text-gray-600",children:[Ce.length," valid record(s) ready for upload"]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx($e,{onClick:()=>{v(null),O([]),T([]),U.current&&(U.current.value="")},variant:"outline",disabled:S,children:"Clear"}),c.jsx($e,{onClick:te,disabled:S||Ce.length===0,children:S?"Uploading...":`Upload ${Ce.length} Distributors`})]})]})]})]}),A==="success"&&c.jsxs(sr,{className:"border-green-200 bg-green-50",children:[c.jsx(gs,{className:"h-4 w-4 text-green-600"}),c.jsx(ar,{className:"text-green-800",children:"Distributors uploaded successfully! Check the 'Manage' tab to view them."})]})]})]})}),c.jsx(Jt,{value:"manage",className:"space-y-6",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(mi,{className:"h-5 w-5"}),c.jsxs("span",{children:["Manage Distributors (",s.length,")"]})]}),c.jsx("div",{className:"flex items-center space-x-2",children:c.jsxs("div",{className:"relative",children:[c.jsx(P3,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-400"}),c.jsx(Qt,{placeholder:"Search distributors...",value:o,onChange:ue=>me(ue.target.value),className:"pl-8 w-64"})]})})]})}),c.jsx(Qe,{children:s.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(mi,{className:"mx-auto h-12 w-12 text-gray-400"}),c.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No distributors found"}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:o?"No distributors match your search criteria.":"Get started by adding your first distributor."}),c.jsx("div",{className:"mt-6",children:c.jsxs($e,{onClick:()=>t("onboard"),children:[c.jsx(Gc,{className:"h-4 w-4 mr-2"}),"Add Distributor"]})})]}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(qc,{children:[c.jsx(Yc,{children:c.jsxs(Fs,{children:[c.jsx(It,{children:"ID"}),c.jsx(It,{children:"Code"}),c.jsx(It,{children:"Name"}),c.jsx(It,{children:"Type"}),c.jsx(It,{children:"Zone"}),c.jsx(It,{children:"State"}),c.jsx(It,{children:"Status"}),c.jsx(It,{children:"Onboarded"}),c.jsx(It,{className:"text-right",children:"Actions"})]})}),c.jsx(Jc,{children:s.map(ue=>c.jsxs(Fs,{children:[c.jsx(Pt,{className:"font-mono text-sm",children:ue.id}),c.jsx(Pt,{className:"font-mono text-sm",children:ue.code}),c.jsx(Pt,{children:ue.name}),c.jsx(Pt,{children:ue.type}),c.jsx(Pt,{children:ue.zone}),c.jsx(Pt,{children:ue.state}),c.jsx(Pt,{children:I(ue.status)}),c.jsx(Pt,{children:new Date(ue.onboardedAt).toLocaleDateString()}),c.jsx(Pt,{className:"text-right",children:c.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[c.jsx($e,{size:"sm",variant:"outline",onClick:()=>Q(ue),children:c.jsx(W3,{className:"h-4 w-4"})}),c.jsx($e,{size:"sm",variant:ue.status==="active"?"outline":"default",onClick:()=>V(ue.id,ue.status),children:ue.status==="active"?c.jsx(fd,{className:"h-4 w-4"}):c.jsx(bm,{className:"h-4 w-4"})}),c.jsx($e,{size:"sm",variant:"outline",onClick:()=>ee(ue.id),className:"text-red-600 hover:text-red-700",children:c.jsx(xu,{className:"h-4 w-4"})})]})})]},ue.id))})]})})})]})})]})]})}var Qd="Collapsible",[N$,fz]=Da(Qd),[A$,Cx]=N$(Qd),Rb=j.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:s,disabled:a,onOpenChange:o,...u}=e,[f,d]=ro({prop:n,defaultProp:s??!1,onChange:o,caller:Qd});return c.jsx(A$,{scope:r,disabled:a,contentId:Ea(),open:f,onOpenToggle:j.useCallback(()=>d(p=>!p),[d]),children:c.jsx(St.div,{"data-state":Ax(f),"data-disabled":a?"":void 0,...u,ref:t})})});Rb.displayName=Qd;var Pb="CollapsibleTrigger",j$=j.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,s=Cx(Pb,r);return c.jsx(St.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":Ax(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...n,ref:t,onClick:Nt(e.onClick,s.onOpenToggle)})});j$.displayName=Pb;var Nx="CollapsibleContent",Ib=j.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=Cx(Nx,e.__scopeCollapsible);return c.jsx(Fl,{present:r||s.open,children:({present:a})=>c.jsx(D$,{...n,ref:t,present:a})})});Ib.displayName=Nx;var D$=j.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:s,...a}=e,o=Cx(Nx,r),[u,f]=j.useState(n),d=j.useRef(null),p=er(t,d),m=j.useRef(0),g=m.current,y=j.useRef(0),w=y.current,v=o.open||u,S=j.useRef(v),E=j.useRef(void 0);return j.useEffect(()=>{const A=requestAnimationFrame(()=>S.current=!1);return()=>cancelAnimationFrame(A)},[]),hn(()=>{const A=d.current;if(A){E.current=E.current||{transitionDuration:A.style.transitionDuration,animationName:A.style.animationName},A.style.transitionDuration="0s",A.style.animationName="none";const b=A.getBoundingClientRect();m.current=b.height,y.current=b.width,S.current||(A.style.transitionDuration=E.current.transitionDuration,A.style.animationName=E.current.animationName),f(n)}},[o.open,n]),c.jsx(St.div,{"data-state":Ax(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!v,...a,ref:p,style:{"--radix-collapsible-content-height":g?`${g}px`:void 0,"--radix-collapsible-content-width":w?`${w}px`:void 0,...e.style},children:v&&s})});function Ax(e){return e?"open":"closed"}var F$=Rb;function R$({...e}){return c.jsx(F$,{"data-slot":"collapsible",...e})}function P$({...e}){return c.jsx(Ib,{"data-slot":"collapsible-content",...e})}const Ob=j.forwardRef(({shouldRefresh:e},t)=>{const[r,n]=j.useState([]),[s,a]=j.useState([]),[o,u]=j.useState([]),[f,d]=j.useState([]),[p,m]=j.useState(!1),[g,y]=j.useState(new Set),[w,v]=j.useState({}),[S,E]=j.useState({}),[A,b]=j.useState(""),[D,O]=j.useState([]),[C,T]=j.useState(null),U=async()=>{console.log("=== ManageSchemes: Starting fetchAllData ==="),m(!0),O([]);const N=new Date().toISOString();b(N);const L={fetchStartTime:N,projectId:pt,baseUrl:`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43`,authToken:await jt.getAccessToken()?"Present":"Missing"};try{const B=await Promise.allSettled([z(),Z(),re()]);L.fetchResults=B.map((Y,oe)=>({endpoint:["schemes","uploads","calculations"][oe],status:Y.status,...Y.status==="rejected"?{error:Y.reason}:{}}));let q=0,ne=0;B.forEach((Y,oe)=>{const le=["schemes","uploads","calculations"][oe];if(Y.status==="rejected"){ne++;const te=`Failed to fetch ${le}: ${Y.reason}`;console.error(te),O(I=>[...I,te])}else q++,console.log(` Successfully fetched ${le}`)}),console.log(`Fetch summary: ${q} successful, ${ne} failed`),B[0].status==="fulfilled"?console.log("Core scheme data loaded successfully"):console.error("Failed to load core scheme data")}catch(B){console.error("Error in fetchAllData:",B),L.fetchError=B?.toString()||"Unknown error",O(q=>[...q,`General fetch error: ${B}`])}finally{L.fetchEndTime=new Date().toISOString(),L.processingTimeMs=new Date().getTime()-new Date(N).getTime(),E(L),m(!1),console.log(`=== ManageSchemes: Completed fetchAllData in ${L.processingTimeMs}ms ===`,L)}};j.useImperativeHandle(t,()=>({refresh:U})),j.useEffect(()=>{console.log("ManageSchemes mounted, fetching data..."),U()},[]),j.useEffect(()=>{e&&(console.log("shouldRefresh prop changed, fetching data..."),U())},[e]),j.useEffect(()=>{console.log("Dependencies changed, organizing scheme data..."),P()},[r,o]);const z=async()=>{try{console.log("Fetching schemes with authentication...");const N=`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/schemes`,L=await jt.makeAuthenticatedRequest(N,{method:"GET"});if(!L.ok){const q=await L.text();throw new Error(`HTTP ${L.status}: ${q}`)}const B=await L.json();if(B.success&&B.schemes){const q=B.schemes.map(ne=>ne.value||ne).filter(Boolean);return n(q),q}else return n([]),[]}catch(N){throw console.error("Error fetching schemes:",N),n([]),N}},Z=async()=>{try{console.log("Fetching sales data with authentication...");const N=await jt.makeAuthenticatedRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/sales-data`,{method:"GET"});if(!N.ok)throw new Error(`HTTP ${N.status}: ${N.statusText}`);const L=await N.json();if(L.success){if(!L.salesData||!Array.isArray(L.salesData)||L.salesData.length===0)return a([]),[];const B=[],q=new Map;L.salesData.forEach(Y=>{const oe=Y.uploadMonth||"Unknown",le=Y.uploadYear||new Date().getFullYear(),te=Y.fileName||"sales_data.csv",I=Y.uploadedAt?Y.uploadedAt.split("T")[0]:new Date().toISOString().split("T")[0],Ce=`${oe}_${le}_${te}_${I}`;q.has(Ce)||q.set(Ce,[]),q.get(Ce).push(Y)});let ne=0;return q.forEach((Y,oe)=>{const le=Y[0]||{},te={id:`upload_${ne}_${le.uploadMonth||"unknown"}_${le.uploadYear||"unknown"}`,fileName:le.fileName||"sales_data.csv",month:le.uploadMonth||"Unknown",year:Number(le.uploadYear)||new Date().getFullYear(),uploadedAt:le.uploadedAt||new Date().toISOString(),data:Y};B.push(te),ne++}),a(B),B}else return a([]),[]}catch(N){throw console.error("Error fetching sales data:",N),a([]),N}},re=async(N=0)=>{try{const q=new AbortController,ne=setTimeout(()=>q.abort(),3e4);console.log(`Fetching calculations (attempt ${N+1}/4)...`);const Y=await jt.makeAuthenticatedRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/calculations`,{method:"GET",signal:q.signal});if(clearTimeout(ne),!Y.ok)throw new Error(`HTTP ${Y.status}: ${Y.statusText}`);const oe=await Y.json();if(console.log("Raw calculations response:",oe),oe.success&&Array.isArray(oe.calculations)){const le=oe.calculations.filter(te=>te&&typeof te=="object").map(te=>{const I=te.value||te;if(!I||typeof I!="object")return console.warn("Invalid calculation item:",I),null;let Ce=0;return typeof I.totalCommission=="number"?Ce=I.totalCommission:I.summary?.totalCommission&&typeof I.summary.totalCommission=="number"?Ce=I.summary.totalCommission:I.calculations&&Array.isArray(I.calculations)&&(Ce=I.calculations.reduce((Ie,ue)=>Ie+(Number(ue?.commission)||0),0)),console.log(`Calculation ${I.id||"unknown"}: totalCommission = ${Ce}`),{...I,id:I.id||`calc_${Date.now()}_${Math.random()}`,schemeId:I.schemeId||"unknown",uploadId:I.uploadId||"all-sales-data",calculations:Array.isArray(I.calculations)?I.calculations:[],totalCommission:Ce||0,calculatedAt:I.calculatedAt||I.createdAt||new Date().toISOString()}}).filter(Boolean);return console.log("Processed calculations:",le),u(le),le}else return console.log("No calculations found or invalid response format"),u([]),[]}catch(q){return console.error("Error fetching calculations:",q),q.name==="AbortError"&&console.log(`Fetch calculations was aborted due to timeout (attempt ${N+1})`),N<3&&(q.name==="AbortError"||q.message.includes("500")||q.message.includes("timeout"))?(console.log(`Retrying calculations fetch in ${(N+1)*2} seconds...`),await new Promise(ne=>setTimeout(ne,(N+1)*2e3)),re(N+1)):(console.error("All calculation fetch attempts failed, continuing with empty calculations"),u([]),[])}},P=()=>{console.log("Organizing scheme data..."),console.log("Schemes:",r.length),console.log("Calculations:",o.length);const N=r.map(L=>{r.indexOf(L)<2&&F(L);const B=o.filter(Y=>Y.schemeId===L.id);console.log(`Scheme ${L.name} (${L.id}): Found ${B.length} calculations`);const q=B.reduce((Y,oe)=>{const le=oe.totalCommission||0;return console.log(`  Calculation ${oe.id}: adding ${le} to total`),Y+le},0);console.log(`Scheme ${L.name}: Total commission = ${q}`);const ne=B.length>0?B.sort((Y,oe)=>new Date(oe.calculatedAt).getTime()-new Date(Y.calculatedAt).getTime())[0]?.calculatedAt:void 0;return{...L,calculations:B,totalCommission:q||0,lastCalculated:ne}}).sort((L,B)=>new Date(B.createdAt).getTime()-new Date(L.createdAt).getTime());console.log("Final organized schemes:",N.map(L=>({name:L.name,totalCommission:L.totalCommission}))),d(N)},se=N=>{y(L=>{const B=new Set(L);return B.has(N)?B.delete(N):B.add(N),B})},me=async(N,L)=>{if(s.length===0){be.error("No sales data available. Please upload sales data first.");return}T(N);const B=Date.now();try{const q={schemeId:N};L&&L!=="all-sales-data"&&(q.uploadId=L),console.log("Starting scheme calculation with increased timeout...");const ne=new AbortController,oe=setTimeout(()=>{console.log("Calculation timeout reached, aborting request..."),ne.abort()},6e4),le=await jt.makeAuthenticatedRequest(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/calculate`,{method:"POST",body:JSON.stringify(q),signal:ne.signal});if(clearTimeout(oe),!le.ok){const I=await le.text();throw new Error(`HTTP ${le.status}: ${I}`)}const te=await le.json();if(te.success){const I=Date.now()-B,Ce=r.find(ue=>ue.id===N),Ie=te.summary?.totalCommission||0;be.success(c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(na,{className:"h-5 w-5 text-green-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Calculation Completed!"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[Ce?.name,"  Commission: ",Ie.toLocaleString()," ",te.calculations?.length||0," records  ",(I/1e3).toFixed(1),"s"]})]})]}),{duration:6e3}),await re()}else be.error(`Calculation failed: ${te.error}`)}catch(q){console.error("Error calculating scheme:",q);let ne="Failed to calculate scheme",Y=!1;q instanceof Error?(ne=q.message,Y=q.name==="AbortError"||q.message.includes("timeout")):typeof q=="string"&&(ne=q,Y=q.includes("timeout")),Y?be.error(c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Calculation Timeout"}),c.jsx("p",{className:"text-sm text-gray-600",children:"The calculation is taking longer than expected. This may be due to large datasets. Try reducing the dataset size or try again later."})]}),{duration:1e4}):be.error(c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:"Calculation Error"}),c.jsx("p",{className:"text-sm text-gray-600",children:ne})]}),{duration:8e3})}finally{T(null)}},ce=N=>{if(N.calculations.length===0){be.error("No calculations found for this scheme");return}const B=["Scheme Name,Calculation Date,Distributor ID,Distributor Name,Product,Article ID,Quantity,Value,Commission,Scheme Type",...N.calculations.flatMap(oe=>oe.calculations||[]).map(oe=>`${N.name},${N.lastCalculated||""},${oe.distributorId||""},${oe.distributorName||""},${oe.product||""},${oe.articleId||""},${oe.quantity||0},${oe.value||0},${oe.commission||0},${oe.schemeType||""}`)].join(`
`),q=new Blob([B],{type:"text/csv"}),ne=window.URL.createObjectURL(q),Y=document.createElement("a");Y.href=ne,Y.download=`scheme_${N.name.replace(/\s+/g,"_")}_calculations.csv`,Y.click(),window.URL.revokeObjectURL(ne)},fe=N=>{const L=new Date,B=new Date(N.startDate),q=new Date(N.endDate);return L<B?{status:"upcoming",label:"Upcoming",color:"bg-blue-100 text-blue-800"}:L>q?{status:"expired",label:"Expired",color:"bg-gray-100 text-gray-800"}:{status:"active",label:"Active",color:"bg-green-100 text-green-800"}},de=N=>{const L=[];if(N.distIds?.type==="other"&&N.distIds?.specificIds?.length>0)L.push(`Specific Distributors: ${N.distIds.specificIds.length} IDs`);else{const B=N.distributorData||N.basicInfo||{},q=oe=>oe!=null&&oe!==""&&oe.toString().trim()!=="";q(B.zone)&&L.push(`Zone: ${B.zone}`);const ne=B.state||B.stateData||B.stateName;q(ne)&&L.push(`State: ${ne}`);const Y=B.distributorType||B.partnerType||B.type||B.distributorTypeData||B.partnerTypeData;q(Y)&&L.push(`Type: ${Y}`),B.allDistributors===!0&&L.push("Selection: All Distributors")}return N.articles?.type==="other"&&N.articles?.specificIds?.length>0?L.push(`Specific Articles: ${N.articles.specificIds.length} IDs`):(N.catalogType?.family&&L.push(`Family: ${N.catalogType.family}`),N.catalogType?.class&&L.push(`Class: ${N.catalogType.class}`),N.catalogType?.brand&&L.push(`Brand: ${N.catalogType.brand}`)),L.length>0?L.join("  "):"All criteria"},he=(N,L,B)=>{if(N.from!==void 0&&N.to!==void 0){const q=Number(N.from)||0,ne=Number(N.to)||0;return`${q} to ${ne}`}if(N.minQuantity!==void 0&&N.maxQuantity!==void 0){const q=Number(N.minQuantity)||0,ne=Number(N.maxQuantity)||0;return`${q} to ${ne}`}if(N.min!==void 0&&N.max!==void 0){const q=Number(N.min)||0,ne=N.max===null?"":Number(N.max)||0;return ne===""?`${q}+`:`${q} to ${ne}`}if(N.quantity!==void 0){const q=Number(N.quantity)||0;return L===0?`0 to ${q}`:L===B-1?`${q}+`:`${q}+`}return"Range not specified"},Q=(N,L)=>N.rate!==void 0?L==="percentage"?`${N.rate}%`:L==="fixed"?`${N.rate.toLocaleString()}`:L==="absolute_per_unit"||L==="absolute(per unit)"?`${N.rate}/unit`:`${N.rate}`:N.commission!==void 0?L==="percentage"?`${N.commission}%`:L==="fixed"?`${N.commission.toLocaleString()}`:L==="absolute_per_unit"||L==="absolute(per unit)"?`${N.commission}/unit`:`${N.commission}`:"Not specified",ee=N=>{const L=[];N.distIds?.type==="other"&&N.distIds?.specificIds?.length>0&&L.push({title:"Specific Distributors",ids:N.distIds.specificIds,count:N.distIds.specificIds.length});const B=[],q=N.distributorData||N.basicInfo||{};console.log("Distributor data debug:",{schemeName:N.name,distributorData:q,basicInfo:N.basicInfo,rawScheme:N});const ne=le=>le!=null&&le!==""&&le.toString().trim()!=="";ne(q.zone)&&B.push(`Zone: ${q.zone}`);const Y=q.state||q.stateData||q.stateName;ne(Y)&&B.push(`State: ${Y}`);const oe=q.distributorType||q.partnerType||q.type||q.distributorTypeData||q.partnerTypeData;return ne(oe)&&B.push(`Type: ${oe}`),q.allDistributors===!0&&B.push("Selection: All Distributors"),B.length>0?L.push({title:"Distributor Criteria",criteria:B.join("  "),count:"All matching"}):console.warn("No distributor criteria found for scheme:",N.name,{distributorData:q,availableKeys:Object.keys(q)}),L.length>0?L:[{title:"All Distributors",count:"No restrictions"}]},V=N=>{const L=[];if(N.articles?.type==="other"&&N.articles?.specificIds?.length>0&&L.push({title:"Specific Articles (Excel Upload)",ids:N.articles.specificIds,count:N.articles.specificIds.length}),N.articles?.articleCommissions&&Array.isArray(N.articles.articleCommissions)&&N.articles.articleCommissions.length>0){const q=N.articles.articleCommissions.map(ne=>ne.articleId||ne.Article_ID).filter(Boolean);L.push({title:"Article Commission Data",ids:q,count:q.length})}const B=[];return N.catalogType?.family&&B.push(`Family: ${N.catalogType.family}`),N.catalogType?.class&&B.push(`Class: ${N.catalogType.class}`),N.catalogType?.brand&&B.push(`Brand: ${N.catalogType.brand}`),B.length>0&&L.push({title:"Catalog Criteria",criteria:B.join("  "),count:"All matching"}),L.length>0?L:[{title:"All Articles",count:"No restrictions"}]},F=N=>{console.log("=== Scheme Data Debug ===",{schemeName:N.name,schemeId:N.id,topLevelKeys:Object.keys(N),distributorData:{exists:!!N.distributorData,keys:N.distributorData?Object.keys(N.distributorData):[],values:N.distributorData},basicInfo:{exists:!!N.basicInfo,keys:N.basicInfo?Object.keys(N.basicInfo):[],values:N.basicInfo},distIds:N.distIds,catalogType:N.catalogType})};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold",children:"Scheme Management"}),c.jsx("p",{className:"text-gray-600",children:"Manage your schemes and view calculation outputs"})]}),c.jsx("div",{className:"flex items-center space-x-2",children:c.jsxs($e,{onClick:U,disabled:p,variant:"outline",children:[c.jsx(zr,{className:`h-4 w-4 mr-2 ${p?"animate-spin":""}`}),"Refresh Data"]})})]}),D.some(N=>N.includes("timeout")||N.includes("AbortError"))&&c.jsxs(sr,{className:"border-amber-200 bg-amber-50 mb-4",children:[c.jsx(ja,{className:"h-4 w-4 text-amber-600"}),c.jsx(ar,{className:"text-amber-800",children:c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"font-medium",children:"Performance Notice: Database Timeout Detected"}),c.jsxs("div",{className:"text-sm",children:["The system is experiencing longer response times due to large datasets. This may affect:",c.jsxs("ul",{className:"mt-1 ml-4 space-y-1",children:[c.jsx("li",{children:" Loading calculation results"}),c.jsx("li",{children:" Running new calculations"}),c.jsx("li",{children:" Fetching scheme data"})]})]}),c.jsxs("div",{className:"text-sm",children:[c.jsx("strong",{children:"Recommendations:"}),c.jsxs("ul",{className:"mt-1 ml-4 space-y-1",children:[c.jsx("li",{children:" Try refreshing the page after a few moments"}),c.jsx("li",{children:" For new calculations, consider using smaller datasets"}),c.jsx("li",{children:" The system will automatically retry failed operations"})]})]})]})})]}),(D.length>0||Object.keys(S).length>0)&&c.jsxs(Je,{className:"border-orange-200 bg-orange-50",children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2 text-orange-800",children:[c.jsx(km,{className:"h-5 w-5"}),c.jsx("span",{children:"System Information"})]})}),c.jsxs(Qe,{className:"space-y-2",children:[D.length>0&&c.jsxs(sr,{className:"border-red-200 bg-red-50",children:[c.jsx(ja,{className:"h-4 w-4"}),c.jsxs(ar,{className:"text-red-800",children:[c.jsx("strong",{children:"Connection Issues:"}),c.jsx("ul",{className:"mt-1 space-y-1",children:D.map((N,L)=>c.jsxs("li",{className:"text-sm",children:[" ",N.includes("timeout")?"Database timeout - operations taking longer than expected":N]},L))})]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-xs",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Last Fetch:"}),c.jsx("br",{}),A?new Date(A).toLocaleTimeString():"Never"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Schemes Found:"}),c.jsx("br",{}),r.length]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Sales Data Uploads:"}),c.jsx("br",{}),s.length]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Auth Token:"}),c.jsx("br",{}),S.authToken||"Missing"]})]}),c.jsx("div",{className:"mt-4 p-3 bg-yellow-50 rounded-md border border-yellow-200",children:c.jsxs("div",{className:"text-xs space-y-1",children:[c.jsx("div",{children:c.jsx("strong",{children:"Commission Debug:"})}),c.jsxs("div",{children:["Total schemes with calculations: ",f.filter(N=>N.calculations.length>0).length]}),c.jsxs("div",{children:["Individual scheme commissions: ",f.map(N=>`${N.name}: ${N.totalCommission?.toLocaleString()||0}`).join(", ")]}),c.jsxs("div",{children:["Overall total: ",f.reduce((N,L)=>N+(L.totalCommission||0),0).toLocaleString()]})]})})]})]}),s.length===0&&c.jsxs(sr,{className:"border-blue-200 bg-blue-50",children:[c.jsx(oa,{className:"h-4 w-4 text-blue-600"}),c.jsxs(ar,{className:"text-blue-800",children:[c.jsx("strong",{children:"No Sales Data Available:"}),' You need to upload sales data before you can run calculations. Please go to the "Upload Data" tab to upload your sales data first.']})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Tl,{className:"h-5 w-5 text-blue-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Total Schemes"}),c.jsx("p",{className:"text-2xl font-bold",children:r.length})]})]})})}),c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(H3,{className:"h-5 w-5 text-green-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Active Schemes"}),c.jsx("p",{className:"text-2xl font-bold",children:f.filter(N=>fe(N).status==="active").length})]})]})})}),c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(na,{className:"h-5 w-5 text-purple-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Total Calculations"}),c.jsx("p",{className:"text-2xl font-bold",children:o.length})]})]})})}),c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(v_,{className:"h-5 w-5 text-orange-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Total Commission"}),c.jsxs("p",{className:"text-2xl font-bold",children:["",f.reduce((N,L)=>N+(L.totalCommission||0),0).toLocaleString()]})]})]})})})]}),s.length>0&&c.jsxs(Je,{className:"border-green-200 bg-green-50",children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2 text-green-800",children:[c.jsx(pl,{className:"h-5 w-5"}),c.jsx("span",{children:"Available Sales Data"})]})}),c.jsx(Qe,{children:c.jsxs("div",{className:"text-sm text-green-700",children:[c.jsxs("p",{className:"mb-2",children:[c.jsx("strong",{children:"Ready for calculation:"})," ",s.length," sales data upload(s) available"]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:s.map(N=>c.jsxs("div",{className:"bg-white rounded-md p-3 border border-green-200",children:[c.jsxs("div",{className:"font-medium",children:[N.month," ",N.year]}),c.jsxs("div",{className:"text-xs text-gray-600",children:[N.data?.length||0," records"]}),c.jsxs("div",{className:"text-xs text-gray-500",children:["Uploaded: ",new Date(N.uploadedAt).toLocaleDateString()]})]},N.id))})]})})]}),p&&r.length===0?c.jsx(Je,{children:c.jsxs(Qe,{className:"p-8 text-center",children:[c.jsx(zr,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),c.jsx("p",{children:"Loading schemes..."})]})}):r.length===0?c.jsx(Je,{children:c.jsxs(Qe,{className:"p-8 text-center",children:[c.jsx(Tl,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"No schemes found. Create your first scheme to get started."})]})}):c.jsx("div",{className:"space-y-4",children:f.map(N=>{const L=fe(N),B=g.has(N.id),q=ee(N),ne=V(N);return c.jsxs(Je,{className:`${B?"ring-2 ring-blue-200":""}`,children:[c.jsx(At,{className:"pb-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex items-center space-x-3",children:c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("h3",{className:"text-lg font-semibold",children:N.name}),c.jsx(Mt,{className:L.color,children:L.label}),c.jsx(Mt,{variant:"outline",className:"capitalize",children:N.type})]}),c.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-500",children:[c.jsxs("span",{children:["ID: ",N.id]}),c.jsx("span",{children:""}),c.jsx("span",{children:de(N)})]})]})}),c.jsxs("div",{className:"flex items-center space-x-2",children:[N.totalCommission>0&&c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-lg font-bold text-green-600",children:["",N.totalCommission.toLocaleString()]}),c.jsx("div",{className:"text-xs text-gray-500",children:"Total Commission"})]}),c.jsx($e,{variant:"ghost",size:"sm",onClick:()=>se(N.id),children:B?c.jsx(h_,{className:"h-4 w-4"}):c.jsx(Em,{className:"h-4 w-4"})})]})]})}),c.jsx(R$,{open:B,onOpenChange:()=>se(N.id),children:c.jsx(P$,{children:c.jsx(Qe,{className:"pt-0",children:c.jsxs(go,{defaultValue:"details",className:"w-full",children:[c.jsxs(vo,{className:"grid w-full grid-cols-4",children:[c.jsx(Yt,{value:"details",children:"Details"}),c.jsx(Yt,{value:"distributors",children:"Distributors"}),c.jsx(Yt,{value:"articles",children:"Articles"}),c.jsx(Yt,{value:"calculations",children:"Calculations"})]}),c.jsxs(Jt,{value:"details",className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Start Date"}),c.jsx("p",{children:new Date(N.startDate).toLocaleDateString()})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-500",children:"End Date"}),c.jsx("p",{children:new Date(N.endDate).toLocaleDateString()})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Slab Type"}),c.jsx("p",{className:"capitalize",children:N.slabType})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Commission Type"}),c.jsx("p",{className:"capitalize",children:N.commissionType})]})]}),N.slabs&&N.slabs.length>0&&c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium mb-3",children:"Commission Slabs"}),c.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:c.jsxs(qc,{children:[c.jsx(Yc,{children:c.jsxs(Fs,{children:[c.jsx(It,{children:"Range"}),c.jsx(It,{children:"Commission"})]})}),c.jsx(Jc,{children:N.slabs.map((Y,oe)=>c.jsxs(Fs,{children:[c.jsx(Pt,{children:he(Y,oe,N.slabs.length)}),c.jsx(Pt,{children:Q(Y,N.commissionType)})]},oe))})]})})]}),c.jsxs("div",{className:"flex items-center space-x-2 pt-4",children:[c.jsxs(_r,{value:w[N.id]||"all-sales-data",onValueChange:Y=>v(oe=>({...oe,[N.id]:Y})),children:[c.jsx(kr,{className:"w-48",children:c.jsx(Sr,{placeholder:"Select sales data"})}),c.jsxs(br,{children:[c.jsx(wt,{value:"all-sales-data",children:"All Sales Data"}),s.map(Y=>c.jsxs(wt,{value:Y.id,children:[Y.month," ",Y.year," (",Y.data?.length||0," records)"]},Y.id))]})]}),c.jsxs($e,{onClick:()=>me(N.id,w[N.id]),disabled:C===N.id||s.length===0,children:[C===N.id?c.jsx(zr,{className:"h-4 w-4 mr-2 animate-spin"}):c.jsx(m_,{className:"h-4 w-4 mr-2"}),"Calculate"]}),N.calculations.length>0&&c.jsxs($e,{variant:"outline",onClick:()=>ce(N),children:[c.jsx(pi,{className:"h-4 w-4 mr-2"}),"Export Results"]})]})]}),c.jsx(Jt,{value:"distributors",className:"space-y-4",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(mi,{className:"h-5 w-5 text-blue-600"}),c.jsx("h4",{className:"font-medium",children:"Distributor Configuration"})]}),q.map((Y,oe)=>c.jsx(Je,{className:"bg-gray-50",children:c.jsxs(Qe,{className:"p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h5",{className:"font-medium text-gray-800",children:Y.title}),c.jsx(Mt,{variant:"secondary",children:typeof Y.count=="string"?Y.count:`${Y.count} IDs`})]}),Y.criteria&&c.jsx("p",{className:"text-sm text-gray-600 mb-3",children:Y.criteria}),Y.ids&&Y.ids.length>0&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Distributor IDs:"}),c.jsx("div",{className:"bg-white rounded border p-3 max-h-32 overflow-y-auto",children:c.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-2",children:[Y.ids.slice(0,24).map((le,te)=>c.jsx(Mt,{variant:"outline",className:"text-xs",children:le},te)),Y.ids.length>24&&c.jsxs(Mt,{variant:"secondary",className:"text-xs",children:["+",Y.ids.length-24," more"]})]})})]})]})},oe))]})}),c.jsx(Jt,{value:"articles",className:"space-y-4",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[c.jsx(b3,{className:"h-5 w-5 text-green-600"}),c.jsx("h4",{className:"font-medium",children:"Article Configuration"})]}),ne.map((Y,oe)=>c.jsx(Je,{className:"bg-gray-50",children:c.jsxs(Qe,{className:"p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h5",{className:"font-medium text-gray-800",children:Y.title}),c.jsx(Mt,{variant:"secondary",children:typeof Y.count=="string"?Y.count:`${Y.count} Articles`})]}),Y.criteria&&c.jsx("p",{className:"text-sm text-gray-600 mb-3",children:Y.criteria}),Y.ids&&Y.ids.length>0&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Article IDs:"}),c.jsx("div",{className:"bg-white rounded border p-3 max-h-32 overflow-y-auto",children:c.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-5 gap-2",children:[Y.ids.slice(0,20).map((le,te)=>c.jsx(Mt,{variant:"outline",className:"text-xs",children:le},te)),Y.ids.length>20&&c.jsxs(Mt,{variant:"secondary",className:"text-xs",children:["+",Y.ids.length-20," more"]})]})})]})]})},oe))]})}),c.jsxs(Jt,{value:"calculations",className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h4",{className:"font-medium",children:"Calculation Results"}),N.calculations.length>0&&c.jsxs(Mt,{variant:"secondary",children:[N.calculations.length," calculation(s)"]})]}),N.calculations.length===0?c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx(na,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"No calculations performed yet"}),c.jsx("p",{className:"text-sm",children:"Run a calculation to see results here"})]}):c.jsx("div",{className:"space-y-4",children:N.calculations.map(Y=>c.jsx(Je,{className:"bg-gray-50",children:c.jsxs(Qe,{className:"p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-sm font-medium",children:"Calculation ID:"}),c.jsx("code",{className:"text-xs bg-white px-2 py-1 rounded",children:Y.id})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"font-medium text-green-600",children:["",Y.totalCommission.toLocaleString()]}),c.jsxs("div",{className:"text-xs text-gray-500",children:[Y.calculations?.length||0," records"]})]})]}),c.jsxs("div",{className:"text-xs text-gray-500",children:["Calculated: ",new Date(Y.calculatedAt).toLocaleString()]})]})},Y.id))})]})]})})})})]},N.id)})})]})});Ob.displayName="ManageSchemes";var Zd="Switch",[I$,dz]=Da(Zd),[O$,L$]=I$(Zd),Lb=j.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:s,defaultChecked:a,required:o,disabled:u,value:f="on",onCheckedChange:d,form:p,...m}=e,[g,y]=j.useState(null),w=er(t,b=>y(b)),v=j.useRef(!1),S=g?p||!!g.closest("form"):!0,[E,A]=ro({prop:s,defaultProp:a??!1,onChange:d,caller:Zd});return c.jsxs(O$,{scope:r,checked:E,disabled:u,children:[c.jsx(St.button,{type:"button",role:"switch","aria-checked":E,"aria-required":o,"data-state":$b(E),"data-disabled":u?"":void 0,disabled:u,value:f,...m,ref:w,onClick:Nt(e.onClick,b=>{A(D=>!D),S&&(v.current=b.isPropagationStopped(),v.current||b.stopPropagation())})}),S&&c.jsx(Ub,{control:g,bubbles:!v.current,name:n,value:f,checked:E,required:o,disabled:u,form:p,style:{transform:"translateX(-100%)"}})]})});Lb.displayName=Zd;var Mb="SwitchThumb",Bb=j.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,s=L$(Mb,r);return c.jsx(St.span,{"data-state":$b(s.checked),"data-disabled":s.disabled?"":void 0,...n,ref:t})});Bb.displayName=Mb;var M$="SwitchBubbleInput",Ub=j.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:n=!0,...s},a)=>{const o=j.useRef(null),u=er(o,a),f=A2(r),d=v2(t);return j.useEffect(()=>{const p=o.current;if(!p)return;const m=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(m,"checked").set;if(f!==r&&y){const w=new Event("click",{bubbles:n});y.call(p,r),p.dispatchEvent(w)}},[f,r,n]),c.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:u,style:{...s.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Ub.displayName=M$;function $b(e){return e?"checked":"unchecked"}var B$=Lb,U$=Bb;function ad({className:e,...t}){return c.jsx(B$,{"data-slot":"switch",className:Et("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-switch-background focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:c.jsx(U$,{"data-slot":"switch-thumb",className:Et("bg-card dark:data-[state=unchecked]:bg-card-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var $$="Separator",bw="horizontal",z$=["horizontal","vertical"],zb=j.forwardRef((e,t)=>{const{decorative:r,orientation:n=bw,...s}=e,a=W$(n)?n:bw,u=r?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return c.jsx(St.div,{"data-orientation":a,...u,...s,ref:t})});zb.displayName=$$;function W$(e){return z$.includes(e)}var V$=zb;function to({className:e,orientation:t="horizontal",decorative:r=!0,...n}){return c.jsx(V$,{"data-slot":"separator-root",decorative:r,orientation:t,className:Et("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...n})}const H$=[{id:"article-scheme",name:"article-scheme",label:"Article Scheme",description:"Schemes focused on specific article management through Excel upload",enabled:!0,fields:[{id:"scheme-name",name:"schemeName",label:"Scheme Name",type:"text",required:!0,validation:{minLength:3,maxLength:100},description:"Unique name for the scheme",group:"basic"},{id:"description",name:"description",label:"Description",type:"textarea",required:!1,validation:{maxLength:500},description:"Optional description for the scheme",group:"basic"},{id:"commission-type",name:"commissionType",label:"Commission Type",type:"select",required:!0,options:["Fixed","Absolute (per unit)","Percentage"],description:"Type of commission calculation",group:"commission"}],workflow:["Basic Info","Distributor Criteria","Article Scheme Definition"],commissionTypes:["Fixed","Absolute (per unit)","Percentage"],slabSupported:!1,excelRequired:!0},{id:"booster-scheme",name:"booster-scheme",label:"Booster Scheme",description:"Schemes using hierarchical dropdown filtering with slab-based calculations",enabled:!0,fields:[{id:"scheme-name",name:"schemeName",label:"Scheme Name",type:"text",required:!0,validation:{minLength:3,maxLength:100},description:"Unique name for the scheme",group:"basic"},{id:"description",name:"description",label:"Description",type:"textarea",required:!1,validation:{maxLength:500},description:"Optional description for the scheme",group:"basic"},{id:"commission-type",name:"commissionType",label:"Commission Type",type:"select",required:!0,options:["Fixed","Percentage","Absolute Per Unit"],description:"Type of commission calculation",group:"commission"},{id:"slab-type",name:"slabType",label:"Slab Type",type:"select",required:!0,options:["Quantity","Value"],description:"Type of slab calculation",group:"slab"}],workflow:["Basic Info","Distributor Criteria","Catalog Criteria","Slab Configuration"],commissionTypes:["Fixed","Percentage","Absolute Per Unit"],slabSupported:!0,excelRequired:!1}],G$=[{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"select",label:"Select Dropdown"},{value:"multiselect",label:"Multi-Select"},{value:"boolean",label:"Boolean (Switch)"},{value:"textarea",label:"Text Area"},{value:"file",label:"File Upload"}];function X$(){const[e,t]=j.useState(H$),[r,n]=j.useState(null),[s,a]=j.useState(null),[o,u]=j.useState(!1),[f,d]=j.useState(!1),[p,m]=j.useState(!1);j.useEffect(()=>{g()},[]);const g=async()=>{d(!0);try{const C=await fetch(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/moderation/config`,{method:"GET",headers:{Authorization:`Bearer ${dn}`,"Content-Type":"application/json"}});if(C.ok){const T=await C.json();T.schemeTypes&&T.schemeTypes.length>0&&t(T.schemeTypes),be.success("Configuration loaded successfully")}else console.log("No existing configuration found, using defaults")}catch(C){console.error("Error loading configuration:",C),be.error("Failed to load configuration")}finally{d(!1)}},y=async()=>{m(!0);try{if((await fetch(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/moderation/config`,{method:"POST",headers:{Authorization:`Bearer ${dn}`,"Content-Type":"application/json"},body:JSON.stringify({schemeTypes:e})})).ok)be.success("Configuration saved successfully");else throw new Error("Failed to save configuration")}catch(C){console.error("Error saving configuration:",C),be.error("Failed to save configuration")}finally{m(!1)}},w=()=>{const C={id:`custom-scheme-${Date.now()}`,name:`custom-scheme-${Date.now()}`,label:"New Scheme Type",description:"Custom scheme type",enabled:!0,fields:[],workflow:["Basic Info"],commissionTypes:["Fixed"],slabSupported:!1,excelRequired:!1};t([...e,C]),n(C.id)},v=(C,T)=>{t(U=>U.map(z=>z.id===C?{...z,...T}:z))},S=C=>{t(T=>T.filter(U=>U.id!==C)),r===C&&n(null)},E=(C,T)=>{v(C,{fields:[...e.find(U=>U.id===C)?.fields||[],T]}),u(!1),a(null)},A=(C,T,U)=>{const z=e.find(Z=>Z.id===C);if(z){const Z=z.fields.map(re=>re.id===T?{...re,...U}:re);v(C,{fields:Z})}a(null)},b=(C,T)=>{const U=e.find(z=>z.id===C);if(U){const z=U.fields.filter(Z=>Z.id!==T);v(C,{fields:z})}},D=C=>{const T=e.find(U=>U.id===C);if(T){const U={...T,id:`${T.id}-copy-${Date.now()}`,name:`${T.name}-copy`,label:`${T.label} (Copy)`};t([...e,U])}},O=e.find(C=>C.id===r);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Moderation Panel"}),c.jsx("p",{className:"text-gray-600",children:"Configure scheme types and their associated fields"})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs($e,{onClick:y,disabled:p,children:[c.jsx(x_,{className:"h-4 w-4 mr-2"}),p?"Saving...":"Save Configuration"]}),c.jsxs($e,{variant:"outline",onClick:g,disabled:f,children:[c.jsx(io,{className:"h-4 w-4 mr-2"}),f?"Loading...":"Reload"]})]})]}),c.jsxs(go,{defaultValue:"scheme-types",className:"space-y-6",children:[c.jsxs(vo,{children:[c.jsx(Yt,{value:"scheme-types",children:"Scheme Types"}),c.jsx(Yt,{value:"field-management",children:"Field Management"}),c.jsx(Yt,{value:"export-import",children:"Export/Import"})]}),c.jsx(Jt,{value:"scheme-types",className:"space-y-6",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsx("div",{className:"lg:col-span-1",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(d3,{className:"h-5 w-5"}),c.jsx("span",{children:"Scheme Types"})]}),c.jsx($e,{size:"sm",onClick:w,children:c.jsx(Gc,{className:"h-4 w-4"})})]})}),c.jsx(Qe,{className:"space-y-2",children:e.map(C=>c.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${r===C.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,onClick:()=>n(C.id),children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-medium",children:C.label}),!C.enabled&&c.jsx(Mt,{variant:"secondary",children:"Disabled"})]}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:C.description})]}),c.jsxs("div",{className:"flex space-x-1",children:[c.jsx($e,{size:"sm",variant:"ghost",onClick:T=>{T.stopPropagation(),D(C.id)},children:c.jsx(sd,{className:"h-3 w-3"})}),c.jsx($e,{size:"sm",variant:"ghost",onClick:T=>{T.stopPropagation(),S(C.id)},children:c.jsx(xu,{className:"h-3 w-3"})})]})]})},C.id))})]})}),c.jsx("div",{className:"lg:col-span-2",children:O?c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{children:["Configure: ",O.label]})}),c.jsxs(Qe,{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Basic Settings"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"type-name",children:"Type Name"}),c.jsx(Qt,{id:"type-name",value:O.name,onChange:C=>v(O.id,{name:C.target.value})})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"type-label",children:"Display Label"}),c.jsx(Qt,{id:"type-label",value:O.label,onChange:C=>v(O.id,{label:C.target.value})})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"type-description",children:"Description"}),c.jsx(Xc,{id:"type-description",value:O.description,onChange:C=>v(O.id,{description:C.target.value})})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ad,{checked:O.enabled,onCheckedChange:C=>v(O.id,{enabled:C})}),c.jsx(ct,{children:"Enabled"})]})]}),c.jsx(to,{}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Advanced Settings"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ad,{checked:O.slabSupported,onCheckedChange:C=>v(O.id,{slabSupported:C})}),c.jsx(ct,{children:"Slab Support"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ad,{checked:O.excelRequired,onCheckedChange:C=>v(O.id,{excelRequired:C})}),c.jsx(ct,{children:"Excel Required"})]})]})]}),c.jsx(to,{}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Commission Types"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:O.commissionTypes.map((C,T)=>c.jsx(Mt,{variant:"outline",children:C},T))})]}),c.jsx(to,{}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Workflow Steps"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:O.workflow.map((C,T)=>c.jsx(Mt,{children:C},T))})]})]})]}):c.jsx(Je,{children:c.jsx(Qe,{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"text-center",children:[c.jsx(M3,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Select a scheme type to configure"})]})})})})]})}),c.jsx(Jt,{value:"field-management",className:"space-y-6",children:O?c.jsx(K$,{schemeType:O,onAddField:C=>E(O.id,C),onUpdateField:(C,T)=>A(O.id,C,T),onDeleteField:C=>b(O.id,C),editingField:s,setEditingField:a,isAddingField:o,setIsAddingField:u}):c.jsxs(sr,{children:[c.jsx(ja,{className:"h-4 w-4"}),c.jsx(ar,{children:"Please select a scheme type from the Scheme Types tab to manage its fields."})]})}),c.jsx(Jt,{value:"export-import",className:"space-y-6",children:c.jsx(Y$,{schemeTypes:e,onImport:t})})]})]})}function K$({schemeType:e,onAddField:t,onUpdateField:r,onDeleteField:n,editingField:s,setEditingField:a,isAddingField:o,setIsAddingField:u}){return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h3",{className:"text-xl font-semibold",children:["Fields for ",e.label]}),c.jsxs($e,{onClick:()=>u(!0),children:[c.jsx(Gc,{className:"h-4 w-4 mr-2"}),"Add Field"]})]}),c.jsx("div",{className:"space-y-4",children:e.fields.map(f=>c.jsx(Je,{children:c.jsx(Qe,{className:"p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-medium",children:f.label}),c.jsx(Mt,{variant:"outline",children:f.type}),f.required&&c.jsx(Mt,{variant:"destructive",children:"Required"}),f.group&&c.jsx(Mt,{variant:"secondary",children:f.group})]}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:f.description}),c.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Name: ",f.name]})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx($e,{size:"sm",variant:"ghost",onClick:()=>a(f),children:c.jsx(T3,{className:"h-4 w-4"})}),c.jsx($e,{size:"sm",variant:"ghost",onClick:()=>n(f.id),children:c.jsx(xu,{className:"h-4 w-4"})})]})]})})},f.id))}),(o||s)&&c.jsx(q$,{field:s,onSave:f=>{s?r(s.id,f):t({...f,id:`field-${Date.now()}`})},onCancel:()=>{u(!1),a(null)}})]})}function q$({field:e,onSave:t,onCancel:r}){const[n,s]=j.useState(e||{name:"",label:"",type:"text",required:!1,description:"",group:"basic"}),a=()=>{if(!n.name||!n.label){be.error("Name and label are required");return}t(n)};return c.jsxs(Je,{children:[c.jsx(At,{children:c.jsx(Ft,{children:e?"Edit Field":"Add New Field"})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"field-name",children:"Field Name"}),c.jsx(Qt,{id:"field-name",value:n.name||"",onChange:o=>s({...n,name:o.target.value}),placeholder:"fieldName"})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"field-label",children:"Display Label"}),c.jsx(Qt,{id:"field-label",value:n.label||"",onChange:o=>s({...n,label:o.target.value}),placeholder:"Field Label"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"field-type",children:"Field Type"}),c.jsxs(_r,{value:n.type||"text",onValueChange:o=>s({...n,type:o}),children:[c.jsx(kr,{children:c.jsx(Sr,{})}),c.jsx(br,{children:G$.map(o=>c.jsx(wt,{value:o.value,children:o.label},o.value))})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"field-group",children:"Group"}),c.jsx(Qt,{id:"field-group",value:n.group||"",onChange:o=>s({...n,group:o.target.value}),placeholder:"basic"})]})]}),c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"field-description",children:"Description"}),c.jsx(Xc,{id:"field-description",value:n.description||"",onChange:o=>s({...n,description:o.target.value}),placeholder:"Field description"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ad,{checked:n.required||!1,onCheckedChange:o=>s({...n,required:o})}),c.jsx(ct,{children:"Required Field"})]}),(n.type==="select"||n.type==="multiselect")&&c.jsxs("div",{children:[c.jsx(ct,{htmlFor:"field-options",children:"Options (one per line)"}),c.jsx(Xc,{id:"field-options",value:n.options?.join(`
`)||"",onChange:o=>s({...n,options:o.target.value.split(`
`).filter(u=>u.trim())}),placeholder:`Option 1
Option 2
Option 3`})]}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsxs($e,{variant:"outline",onClick:r,children:[c.jsx(fd,{className:"h-4 w-4 mr-2"}),"Cancel"]}),c.jsxs($e,{onClick:a,children:[c.jsx(x_,{className:"h-4 w-4 mr-2"}),"Save Field"]})]})]})]})}function Y$({schemeTypes:e,onImport:t}){const r=()=>{const s=JSON.stringify(e,null,2),a=new Blob([s],{type:"application/json"}),o=URL.createObjectURL(a),u=document.createElement("a");u.href=o,u.download="scheme-configuration.json",document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(o),be.success("Configuration exported successfully")},n=s=>{const a=s.target.files?.[0];if(!a)return;const o=new FileReader;o.onload=u=>{try{const f=JSON.parse(u.target?.result);t(f),be.success("Configuration imported successfully")}catch{be.error("Invalid configuration file")}},o.readAsText(a)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs(Je,{children:[c.jsx(At,{children:c.jsx(Ft,{children:"Export Configuration"})}),c.jsxs(Qe,{children:[c.jsx("p",{className:"text-gray-600 mb-4",children:"Export your current scheme configuration as a JSON file for backup or sharing."}),c.jsxs($e,{onClick:r,children:[c.jsx(io,{className:"h-4 w-4 mr-2"}),"Export Configuration"]})]})]}),c.jsxs(Je,{children:[c.jsx(At,{children:c.jsx(Ft,{children:"Import Configuration"})}),c.jsxs(Qe,{children:[c.jsx("p",{className:"text-gray-600 mb-4",children:"Import a previously exported configuration file. This will replace your current configuration."}),c.jsx(Qt,{type:"file",accept:".json",onChange:n})]})]}),c.jsxs(sr,{children:[c.jsx(ja,{className:"h-4 w-4"}),c.jsx(ar,{children:"Remember to save your configuration after importing to persist the changes."})]})]})}function J$(){const[e,t]=j.useState([]),[r,n]=j.useState(!1),[s,a]=j.useState("test@example.com"),[o,u]=j.useState("password123"),f=(y,w,v)=>{t(S=>[...S,{test:y,success:w,data:v,timestamp:new Date().toISOString()}])},d=async()=>{try{const y=await fetch(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/auth/health`,{headers:{Authorization:`Bearer ${dn}`,"Content-Type":"application/json"}}),w=await y.json();f("Auth Health Check",y.ok,{status:y.status,result:w})}catch(y){f("Auth Health Check",!1,{error:y instanceof Error?y.message:"Unknown error"})}},p=async()=>{try{const y=await fetch(`https://${pt}.supabase.co/functions/v1/make-server-ce8ebc43/auth/signup`,{method:"POST",headers:{Authorization:`Bearer ${dn}`,"Content-Type":"application/json"},body:JSON.stringify({email:`test_${Date.now()}@example.com`,password:"testpassword123",name:"Test User"})}),w=y.headers.get("content-type");let v;w&&w.includes("application/json")?v=await y.json():v=await y.text(),f("Server Signup Test",y.ok,{status:y.status,contentType:w,result:typeof v=="string"?v.substring(0,500):v})}catch(y){f("Server Signup Test",!1,{error:y instanceof Error?y.message:"Unknown error"})}},m=async()=>{try{const y=await jt.signUpWithServerAutoConfirm(`test_${Date.now()}@example.com`,"testpassword123","Test User");f("AuthService Signup Test",!y.error,y)}catch(y){f("AuthService Signup Test",!1,{error:y instanceof Error?y.message:"Unknown error"})}},g=async()=>{n(!0),t([]),await d(),await new Promise(y=>setTimeout(y,1e3)),await p(),await new Promise(y=>setTimeout(y,1e3)),await m(),n(!1)};return c.jsxs("div",{className:"p-4 space-y-4",children:[c.jsxs(Je,{children:[c.jsx(At,{children:c.jsx(Ft,{children:"Authentication Debug Tests"})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm mb-1",children:"Test Email"}),c.jsx(Qt,{value:s,onChange:y=>a(y.target.value),placeholder:"test@example.com"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm mb-1",children:"Test Password"}),c.jsx(Qt,{type:"password",value:o,onChange:y=>u(y.target.value),placeholder:"password123"})]})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx($e,{onClick:g,disabled:r,children:r?"Running Tests...":"Run All Tests"}),c.jsx($e,{variant:"outline",onClick:d,disabled:r,children:"Test Health"}),c.jsx($e,{variant:"outline",onClick:p,disabled:r,children:"Test Signup"})]}),c.jsxs("div",{className:"text-sm space-y-2",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Project ID:"})," ",pt]}),c.jsxs("div",{children:[c.jsx("strong",{children:"API Key:"})," ",dn.substring(0,20),"..."]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Signup URL:"})," https://",pt,".supabase.co/functions/v1/make-server-ce8ebc43/auth/signup"]})]})]})]}),c.jsx("div",{className:"space-y-2",children:e.map((y,w)=>c.jsx(sr,{className:y.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:c.jsx(ar,{children:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("strong",{children:y.test}),c.jsx("span",{className:y.success?"text-green-600":"text-red-600",children:y.success?" SUCCESS":" FAILED"})]}),c.jsx("pre",{className:"text-xs overflow-auto bg-white p-2 rounded border",children:JSON.stringify(y.data,null,2)}),c.jsx("div",{className:"text-xs text-gray-500",children:y.timestamp})]})})},w))})]})}function Q$(){const[e,t]=j.useState(!1),[r,n]=j.useState([]),s=async(o,u={})=>{const f=Date.now();try{console.log(`Testing endpoint: ${o}`);const d=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",...u.headers},...u}),p=Date.now()-f;let m;try{m=await d.json()}catch{m=await d.text()}return{endpoint:o,method:u.method||"GET",status:d.status,success:d.ok,responseTime:p,response:m}}catch(d){const p=Date.now()-f;return{endpoint:o,method:u.method||"GET",success:!1,responseTime:p,error:d instanceof Error?d.message:"Unknown error"}}},a=async()=>{t(!0),n([]);const o=Yi,u=`${o}/health`,f=`${o}/test`;console.log("=== COMPREHENSIVE CONNECTION TEST ==="),console.log("Backend URL:",o),console.log("Project ID:",pt);const d=[];console.log("Test 1: Health endpoint (no auth)");const p=await s(u);d.push(p),console.log("Test 2: Test endpoint (no auth)");const m=await s(f);d.push(m),console.log("Test 3: Test endpoint (with anon key)");const g=await s(f,{headers:{Authorization:`Bearer ${dn}`}});d.push(g),console.log("Test 4: Basic connectivity test");const y=await s(o.replace(/\/[^/]*$/,""));d.push(y),n(d),t(!1)};return c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(Hc,{className:"h-5 w-5"}),c.jsx("span",{children:"Connection Test Debug"})]})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"This tool tests various connection scenarios to help diagnose backend connectivity issues."}),c.jsxs("div",{className:"text-xs space-y-1",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Backend URL:"})," ",Yi]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Project ID:"})," ",pt]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Anon Key Length:"})," ",dn?.length||0," characters"]})]})]}),c.jsx($e,{onClick:a,disabled:e,className:"w-full",children:e?c.jsxs(c.Fragment,{children:[c.jsx(zr,{className:"h-4 w-4 mr-2 animate-spin"}),"Testing Connection..."]}):c.jsxs(c.Fragment,{children:[c.jsx(zr,{className:"h-4 w-4 mr-2"}),"Run Connection Test"]})}),r.length>0&&c.jsxs("div",{className:"space-y-3",children:[c.jsx("h4",{className:"font-medium",children:"Test Results:"}),r.map((o,u)=>c.jsx(sr,{className:o.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[o.success?c.jsx(gs,{className:"h-4 w-4 text-green-600"}):c.jsx(ia,{className:"h-4 w-4 text-red-600"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("span",{className:"font-medium text-sm",children:[o.method," ",o.endpoint]}),o.status&&c.jsx(Mt,{variant:o.success?"default":"destructive",children:o.status}),c.jsxs(Mt,{variant:"outline",children:[o.responseTime,"ms"]})]}),o.error&&c.jsxs(ar,{className:"text-red-700 mt-1",children:["Error: ",o.error]}),o.response&&o.success&&c.jsxs("div",{className:"text-xs mt-1 text-gray-600",children:["Response: ",typeof o.response=="string"?o.response.substring(0,100)+(o.response.length>100?"...":""):JSON.stringify(o.response).substring(0,100)]})]})]})},u)),c.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[c.jsx("h5",{className:"font-medium text-blue-900",children:"Diagnosis:"}),c.jsx("div",{className:"text-sm text-blue-800 mt-1",children:(()=>{const o=r.find(d=>d.endpoint.includes("/health"))?.success,u=r.some(d=>d.endpoint.includes("/test")&&d.success),f=r.some(d=>d.success);return o?" Backend is healthy and accessible. Connection should work properly.":u?" Health endpoint failed but test endpoint works. This is normal for some configurations.":f?" Some connectivity detected but API endpoints may not be configured correctly.":" No successful connections. Backend may not be deployed or URL is incorrect."})()})]})]})]})]})}function Z$(){const[e,t]=j.useState([]),[r,n]=j.useState({}),[s,a]=j.useState(!1),o=["/make-server-ce8ebc43/health","/make-server-ce8ebc43/test","/make-server-ce8ebc43/auth/health","/make-server-ce8ebc43/distributors","/make-server-ce8ebc43/schemes","/make-server-ce8ebc43/category-data","/make-server-ce8ebc43/moderation/config"];j.useEffect(()=>{u(),f()},[]);const u=()=>{const w={userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,url:window.location.href,origin:window.location.origin,timestamp:new Date().toISOString(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,projectId:pt,hasApiKey:!0,apiKeyPrefix:`${dn.substring(0,20)}...`};n(w)},f=()=>{const w=o.map(v=>({endpoint:v,status:"pending"}));t(w)},d=async w=>{const v=Date.now(),S=`https://${pt}.supabase.co/functions/v1${w}`;try{console.log(`Testing endpoint: ${S}`);const E={"Content-Type":"application/json"};w.includes("/health")||(E.Authorization=`Bearer ${dn}`);const A=fetch(S,{method:"GET",headers:E}),b=new Promise((C,T)=>{setTimeout(()=>T(new Error("Request timeout after 10 seconds")),1e4)}),D=await Promise.race([A,b]),O=Date.now()-v;if(D.ok){let C;try{C=await D.json()}catch{C=await D.text()}return{endpoint:w,status:"success",response:C,duration:O}}else{let C=D.statusText;try{C=await D.text()}catch{}return{endpoint:w,status:"error",error:`HTTP ${D.status}: ${C}`,duration:O}}}catch(E){const A=Date.now()-v;return{endpoint:w,status:"error",error:E instanceof Error?E.message:"Unknown error",duration:A}}},p=async()=>{a(!0);const w=[];for(const E of o){const A=await d(E);w.push(A),t(b=>b.map(D=>D.endpoint===E?A:D))}a(!1);const v=w.filter(E=>E.status==="success").length,S=w.filter(E=>E.status==="error").length;v===w.length?be.success(`All ${v} endpoints are working correctly!`):v>0?be.warning(`${v} endpoints working, ${S} failing`):be.error(`All ${S} endpoints are failing - backend may not be deployed`)},m=w=>{navigator.clipboard.writeText(w),be.success("Copied to clipboard")},g=()=>{const w=JSON.stringify(r,null,2);m(w)},y=()=>{const w=JSON.stringify(e,null,2);m(w)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Debug Panel"}),c.jsx("p",{className:"text-gray-600",children:"Troubleshoot backend connectivity and system information"})]}),c.jsxs($e,{onClick:p,disabled:s,children:[c.jsx(zr,{className:`h-4 w-4 mr-2 ${s?"animate-spin":""}`}),s?"Testing...":"Test All Endpoints"]})]}),c.jsxs(go,{defaultValue:"connection-tests",className:"space-y-6",children:[c.jsxs(vo,{children:[c.jsx(Yt,{value:"connection-tests",children:"Connection Tests"}),c.jsx(Yt,{value:"auth-tests",children:"Auth Tests"}),c.jsx(Yt,{value:"system-info",children:"System Info"}),c.jsx(Yt,{value:"deployment-guide",children:"Deployment Guide"}),c.jsx(Yt,{value:"troubleshooting",children:"Troubleshooting"})]}),c.jsx(Jt,{value:"auth-tests",className:"space-y-6",children:c.jsx(J$,{})}),c.jsxs(Jt,{value:"connection-tests",className:"space-y-6",children:[c.jsx(Q$,{}),c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(x3,{className:"h-5 w-5"}),c.jsx("span",{children:"Endpoint Connection Tests"})]}),c.jsxs($e,{variant:"outline",size:"sm",onClick:y,children:[c.jsx(sd,{className:"h-4 w-4 mr-2"}),"Copy Results"]})]})}),c.jsx(Qe,{className:"space-y-4",children:e.map((w,v)=>c.jsxs("div",{className:"border rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs(Mt,{variant:w.status==="success"?"default":w.status==="error"?"destructive":"secondary",children:[w.status==="success"&&c.jsx(Dc,{className:"h-3 w-3 mr-1"}),w.status==="error"&&c.jsx(ia,{className:"h-3 w-3 mr-1"}),w.status==="pending"&&c.jsx(Zj,{className:"h-3 w-3 mr-1"}),w.status.toUpperCase()]}),c.jsx("code",{className:"text-sm bg-gray-100 px-2 py-1 rounded",children:w.endpoint}),w.duration&&c.jsxs("span",{className:"text-xs text-gray-500",children:["(",w.duration,"ms)"]})]}),c.jsx($e,{variant:"ghost",size:"sm",onClick:()=>m(`https://${pt}.supabase.co/functions/v1${w.endpoint}`),children:c.jsx(sd,{className:"h-3 w-3"})})]}),w.error&&c.jsxs(sr,{className:"mt-2",children:[c.jsx(ia,{className:"h-4 w-4"}),c.jsxs(ar,{children:[c.jsx("strong",{children:"Error:"})," ",w.error]})]}),w.response&&c.jsx("div",{className:"mt-2",children:c.jsxs("details",{className:"bg-gray-50 rounded p-2",children:[c.jsx("summary",{className:"cursor-pointer text-sm font-medium",children:"Response Data"}),c.jsx("pre",{className:"mt-2 text-xs overflow-auto",children:JSON.stringify(w.response,null,2)})]})})]},v))})]})]}),c.jsx(Jt,{value:"system-info",className:"space-y-6",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(Hc,{className:"h-5 w-5"}),c.jsx("span",{children:"System Information"})]}),c.jsxs($e,{variant:"outline",size:"sm",onClick:g,children:[c.jsx(sd,{className:"h-4 w-4 mr-2"}),"Copy Info"]})]})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"Application Info"}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Project ID:"})," ",r.projectId]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Has API Key:"})," ",r.hasApiKey?"Yes":"No"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"API Key:"})," ",r.apiKeyPrefix]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Current URL:"})," ",r.url]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Origin:"})," ",r.origin]})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"Browser Info"}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Platform:"})," ",r.platform]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Language:"})," ",r.language]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Timezone:"})," ",r.timezone]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Online:"})," ",r.onLine?"Yes":"No"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Cookies:"})," ",r.cookieEnabled?"Enabled":"Disabled"]})]})]})]}),c.jsx(to,{}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"User Agent"}),c.jsx("code",{className:"text-xs bg-gray-100 p-2 rounded block break-all",children:r.userAgent})]})]})]})}),c.jsx(Jt,{value:"deployment-guide",className:"space-y-6",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(O3,{className:"h-5 w-5"}),c.jsx("span",{children:"Supabase Edge Function Deployment"})]})}),c.jsxs(Qe,{className:"space-y-4",children:[c.jsxs(sr,{children:[c.jsx(Hc,{className:"h-4 w-4"}),c.jsx(ar,{children:"If you're seeing connection errors, the Supabase Edge Function may not be deployed."})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"1. Install Supabase CLI"}),c.jsx("code",{className:"bg-gray-100 p-2 rounded block",children:"npm install -g supabase"})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"2. Login to Supabase"}),c.jsx("code",{className:"bg-gray-100 p-2 rounded block",children:"supabase login"})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"3. Link to your project"}),c.jsxs("code",{className:"bg-gray-100 p-2 rounded block",children:["supabase link --project-ref ",pt]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"4. Deploy the Edge Function"}),c.jsx("code",{className:"bg-gray-100 p-2 rounded block",children:"supabase functions deploy server"})]})]}),c.jsx("div",{className:"mt-4",children:c.jsx($e,{variant:"outline",asChild:!0,children:c.jsxs("a",{href:"https://supabase.com/docs/guides/functions/quickstart",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2",children:[c.jsx(Kh,{className:"h-4 w-4"}),c.jsx("span",{children:"View Official Documentation"})]})})})]})]})}),c.jsx(Jt,{value:"troubleshooting",className:"space-y-6",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(km,{className:"h-5 w-5"}),c.jsx("span",{children:"Common Issues & Solutions"})]})}),c.jsxs(Qe,{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"border-l-4 border-red-500 pl-4",children:[c.jsx("h4",{className:"font-semibold text-red-700",children:"404 Not Found"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"The Edge Function is not deployed or the function name is incorrect."}),c.jsxs("ul",{className:"text-sm text-gray-600 mt-2 list-disc list-inside",children:[c.jsx("li",{children:"Deploy the Edge Function using the deployment guide above"}),c.jsx("li",{children:'Verify the function name matches "server"'}),c.jsx("li",{children:"Check the Supabase Dashboard Functions section"})]})]}),c.jsxs("div",{className:"border-l-4 border-yellow-500 pl-4",children:[c.jsx("h4",{className:"font-semibold text-yellow-700",children:"Connection Timeout"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"The function is deployed but taking too long to respond."}),c.jsxs("ul",{className:"text-sm text-gray-600 mt-2 list-disc list-inside",children:[c.jsx("li",{children:"The function might be cold starting (first request)"}),c.jsx("li",{children:"Check the function logs in Supabase Dashboard"}),c.jsx("li",{children:"Verify environment variables are set correctly"})]})]}),c.jsxs("div",{className:"border-l-4 border-orange-500 pl-4",children:[c.jsx("h4",{className:"font-semibold text-orange-700",children:"403 Forbidden"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Authentication or permission issues."}),c.jsxs("ul",{className:"text-sm text-gray-600 mt-2 list-disc list-inside",children:[c.jsx("li",{children:"Check if the API key is valid and not expired"}),c.jsx("li",{children:"Verify RLS policies allow function access"}),c.jsx("li",{children:"Ensure the function has proper CORS configuration"})]})]}),c.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[c.jsx("h4",{className:"font-semibold text-blue-700",children:"Network Error"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Unable to reach the Supabase servers."}),c.jsxs("ul",{className:"text-sm text-gray-600 mt-2 list-disc list-inside",children:[c.jsx("li",{children:"Check your internet connection"}),c.jsx("li",{children:"Verify the project ID is correct"}),c.jsx("li",{children:"Try accessing the Supabase Dashboard directly"}),c.jsx("li",{children:"Check if your network blocks Supabase domains"})]})]})]}),c.jsx(to,{}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"Environment Variables Required"}),c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Make sure these environment variables are set in your Supabase project:"}),c.jsxs("div",{className:"bg-gray-100 p-3 rounded text-sm font-mono space-y-1",children:[c.jsx("div",{children:"SUPABASE_URL"}),c.jsx("div",{children:"SUPABASE_ANON_KEY"}),c.jsx("div",{children:"SUPABASE_SERVICE_ROLE_KEY"}),c.jsx("div",{children:"SUPABASE_DB_URL"})]})]}),c.jsx(to,{}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2 text-green-700",children:"Email Authentication Configuration"}),c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"This application uses server-side signup with automatic email confirmation:"}),c.jsxs("ul",{className:"text-sm text-gray-600 mb-3 list-disc list-inside space-y-1",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"No email verification required:"})," New user accounts are automatically confirmed"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Server-side signup:"})," Uses admin API to create accounts with email_confirm: true"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Immediate access:"})," Users can sign in immediately after account creation"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Secure:"})," Uses service role key on backend, public key on frontend"]})]}),c.jsxs(sr,{className:"mt-3 mb-6",children:[c.jsx(Dc,{className:"h-4 w-4"}),c.jsxs(ar,{children:[c.jsx("strong",{children:"Email confirmation is disabled by design."})," This simplifies the user onboarding process by eliminating the need for email server setup and verification steps."]})]}),c.jsx("h4",{className:"font-semibold mb-2 text-purple-700",children:"SMS Authentication Setup"}),c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Phone authentication requires SMS provider configuration in Supabase:"}),c.jsxs("ul",{className:"text-sm text-gray-600 mb-3 list-disc list-inside space-y-1",children:[c.jsx("li",{children:"Go to your Supabase Dashboard  Authentication  Settings"}),c.jsx("li",{children:'Navigate to the "Phone Auth" section'}),c.jsx("li",{children:"Configure an SMS provider (Twilio, MessageBird, Textlocal, Vonage)"}),c.jsx("li",{children:"Add your provider credentials and enable phone authentication"}),c.jsx("li",{children:'Enable phone authentication in the "Providers" section'})]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx($e,{variant:"outline",size:"sm",asChild:!0,children:c.jsxs("a",{href:"https://supabase.com/docs/guides/auth/phone-login",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2",children:[c.jsx(Kh,{className:"h-3 w-3"}),c.jsx("span",{children:"Phone Auth Setup Guide"})]})}),c.jsx($e,{variant:"outline",size:"sm",asChild:!0,children:c.jsxs("a",{href:"https://supabase.com/docs/guides/auth/phone-login/twilio",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2",children:[c.jsx(Kh,{className:"h-3 w-3"}),c.jsx("span",{children:"Twilio Setup"})]})})]})]})]})]})})]})]})}function ez(){const e=Yi,t=e.includes("workers.dev")||e.includes("pages.dev"),r=e.includes("supabase.co"),n=e.includes("your-subdomain")||e.includes("your_");return r&&!n?c.jsx("div",{className:"bg-blue-50 border-b border-blue-200",children:c.jsx("div",{className:"container mx-auto px-4 py-2",children:c.jsxs(sr,{className:"border-blue-200 bg-blue-50",children:[c.jsx(Dc,{className:"h-4 w-4 text-blue-600"}),c.jsx(ar,{className:"text-blue-800",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1 mr-4",children:[c.jsx("strong",{children:" Using Supabase Backend"})," - Ready to upgrade to Cloudflare for better performance!",c.jsxs("div",{className:"text-xs opacity-75 mt-1",children:["Current: ",e]})]}),c.jsxs($e,{onClick:()=>{navigator.clipboard.writeText("npm run deploy-now"),alert('Deployment command copied! Run "npm run deploy-now" in your terminal to upgrade to Cloudflare.')},variant:"outline",size:"sm",className:"text-blue-700 border-blue-300 hover:bg-blue-100",children:[c.jsx(Yh,{className:"h-4 w-4 mr-1"}),"Upgrade to Cloudflare"]})]})})]})})}):t&&!n?c.jsx("div",{className:"bg-green-50 border-b border-green-200",children:c.jsx("div",{className:"container mx-auto px-4 py-2",children:c.jsxs("div",{className:"flex items-center text-green-800 text-sm",children:[c.jsx(Dc,{className:"h-4 w-4 mr-2 text-green-600"}),c.jsx("span",{children:" Powered by Cloudflare Workers"}),c.jsx("div",{className:"ml-4 text-xs opacity-75",children:"Edge computing for optimal performance"})]})})}):n?c.jsx("div",{className:"bg-blue-50 border-b border-blue-200",children:c.jsx("div",{className:"container mx-auto px-4 py-3",children:c.jsxs(sr,{className:"border-blue-200 bg-blue-50",children:[c.jsx(Yh,{className:"h-4 w-4 text-blue-600"}),c.jsx(ar,{className:"text-blue-800",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1 mr-4",children:[c.jsx("strong",{children:" Ready to Deploy to Cloudflare!"}),c.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[c.jsx("div",{children:"Your app is configured to use Cloudflare Workers + Pages for better performance."}),c.jsxs("div",{className:"text-xs opacity-75",children:["Current backend: ",e]}),c.jsx("div",{className:"text-xs opacity-75",children:"Run the deployment command to get your app live on Cloudflare's edge network!"})]})]}),c.jsxs("div",{className:"flex flex-col space-y-2",children:[c.jsxs($e,{onClick:async()=>{try{(await fetch("/setup-for-figma.sh")).ok?(navigator.clipboard.writeText("npm run setup-local"),alert('Setup command copied! Run "npm run setup-local" in your terminal to configure for current environment.')):(navigator.clipboard.writeText("npm run setup-local"),alert('Setup command copied! Run "npm run setup-local" to configure for current environment.'))}catch{navigator.clipboard.writeText("npm run setup-local"),alert('Setup command copied! Run "npm run setup-local" to configure for current environment.')}},variant:"default",size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:[c.jsx(Dc,{className:"h-4 w-4 mr-2"}),"Quick Fix"]}),c.jsxs($e,{onClick:()=>{navigator.clipboard.writeText("npm run deploy-now"),alert('Deployment command copied! Run "npm run deploy-now" for full Cloudflare deployment.')},variant:"outline",size:"sm",children:[c.jsx(Yh,{className:"h-4 w-4 mr-2"}),"Deploy to Cloudflare"]})]})]})})]})})}):null}function tz({onLoginSuccess:e}){const[t,r]=j.useState("email"),[n,s]=j.useState(!1),[a,o]=j.useState(!1),[u,f]=j.useState(""),[d,p]=j.useState(!1),[m,g]=j.useState(!1),[y,w]=j.useState({email:"",password:"",confirmPassword:"",name:""}),[v,S]=j.useState({phone:"",otp:"",otpSent:!1}),E=async C=>{C.preventDefault(),f(""),s(!0);try{if(m){if(y.password!==y.confirmPassword){f("Passwords do not match");return}if(y.password.length<6){f("Password must be at least 6 characters long");return}const T=await jt.signUpWithServerAutoConfirm(y.email,y.password,y.name);if(T.error){console.log("Server signup failed, trying client-side fallback:",T.error);try{const{data:U,error:z}=await jt.signUpWithEmail(y.email,y.password,y.name);if(z){f(`Account creation failed: ${T.error}. Fallback method also failed: ${z}`);return}be.success("Account created! Please check your email to confirm your account before signing in."),g(!1),w({email:"",password:"",confirmPassword:"",name:""});return}catch(U){console.error("Client-side signup fallback failed:",U),f(`Account creation failed: ${T.error}`);return}}be.success(T.message||"Account created successfully! You are now signed in."),w({email:"",password:"",confirmPassword:"",name:""}),e()}else{const{data:T,error:U}=await jt.signInWithEmail(y.email,y.password);if(U){U.toLowerCase().includes("email not confirmed")?(f("This account requires email confirmation. You can resend the confirmation email or create a new account with the improved signup system."),p(!0)):U.toLowerCase().includes("invalid login credentials")?f("Invalid email or password. Please check your credentials and try again. If you just created an account, try using the new signup system above."):(f(U),p(!1));return}p(!1),be.success("Login successful!"),e()}}catch(T){console.error("Email auth error:",T),f(T instanceof Error?T.message:"Authentication failed")}finally{s(!1)}},A=async()=>{f(""),s(!0);try{let C=v.phone.trim();C.startsWith("+")||(C=`+${C}`);const{data:T,error:U}=await jt.sendPhoneOTP(C);if(U){U.toLowerCase().includes("unsupported phone provider")||U.toLowerCase().includes("sms provider")||U.toLowerCase().includes("phone provider not configured")||U.toLowerCase().includes("sms authentication is not set up")?(f("SMS authentication is not configured for this application. Please use email authentication instead or contact your administrator to set up an SMS provider."),setTimeout(()=>{r("email"),f("")},3e3)):U.toLowerCase().includes("invalid phone number")||U.toLowerCase().includes("phone number")?f("Please enter a valid phone number with country code (e.g., +1234567890, +91987654321)"):U.toLowerCase().includes("rate limit")||U.toLowerCase().includes("too many")?f("Too many attempts. Please wait a few minutes before trying again."):f(U);return}S(z=>({...z,otpSent:!0,phone:C})),be.success("OTP sent to your phone number!")}catch(C){console.error("Send OTP error:",C);const T=C instanceof Error?C.message:"Failed to send OTP";T.toLowerCase().includes("unsupported phone provider")||T.toLowerCase().includes("sms provider")||T.toLowerCase().includes("sms authentication is not set up")?(f("SMS authentication is not configured for this application. Please use email authentication instead."),setTimeout(()=>{r("email"),f("")},3e3)):T.toLowerCase().includes("network")?f("Network error occurred. Please check your connection and try again."):f(T)}finally{s(!1)}},b=async C=>{C.preventDefault(),f(""),s(!0);try{const{data:T,error:U}=await jt.verifyPhoneOTP(v.phone,v.otp);if(U){f(U);return}be.success("Phone verification successful!"),e()}catch(T){console.error("Verify OTP error:",T),f(T instanceof Error?T.message:"OTP verification failed")}finally{s(!1)}},D=()=>{S({phone:"",otp:"",otpSent:!1}),f("")},O=async()=>{if(!y.email){f("Please enter your email address first");return}s(!0),f("");try{const{error:C}=await jt.resendConfirmationEmail(y.email);if(C){f(C);return}be.success("Confirmation email sent! Please check your inbox."),p(!1)}catch(C){console.error("Resend confirmation error:",C),f(C instanceof Error?C.message:"Failed to resend confirmation email")}finally{s(!1)}};return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:c.jsxs(Je,{className:"w-full max-w-md shadow-xl",children:[c.jsxs(At,{className:"text-center space-y-2",children:[c.jsx("div",{className:"flex items-center justify-center mb-4",children:c.jsx(g_,{className:"h-12 w-12 text-blue-600"})}),c.jsx(Ft,{className:"text-2xl",children:"Schemes Management Platform"}),c.jsx("p",{className:"text-muted-foreground",children:"Sign in to access your distribution schemes"})]}),c.jsxs(Qe,{className:"space-y-6",children:[u&&c.jsx(sr,{className:"border-red-200 bg-red-50",children:c.jsxs(ar,{className:"text-red-800",children:[u,d&&c.jsx("div",{className:"mt-3",children:c.jsxs($e,{variant:"outline",size:"sm",onClick:O,disabled:n||!y.email,className:"w-full",children:[c.jsx(z1,{className:"h-4 w-4 mr-2"}),"Resend Confirmation Email"]})})]})}),c.jsxs(go,{value:t,onValueChange:r,className:"w-full",children:[c.jsxs(vo,{className:"grid w-full grid-cols-2",children:[c.jsxs(Yt,{value:"email",className:"flex items-center space-x-2",children:[c.jsx(z1,{className:"h-4 w-4"}),c.jsx("span",{children:"Email"})]}),c.jsxs(Yt,{value:"phone",className:"flex items-center space-x-2",children:[c.jsx(W1,{className:"h-4 w-4"}),c.jsx("span",{children:"Phone"})]})]}),c.jsxs(Jt,{value:"email",className:"space-y-4 mt-6",children:[c.jsxs("form",{onSubmit:E,className:"space-y-4",children:[m&&c.jsxs("div",{className:"space-y-2",children:[c.jsx(ct,{htmlFor:"name",children:"Full Name"}),c.jsx(Qt,{id:"name",type:"text",placeholder:"Enter your full name",value:y.name,onChange:C=>w(T=>({...T,name:C.target.value})),required:m,disabled:n})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(ct,{htmlFor:"email",children:"Email Address"}),c.jsx(Qt,{id:"email",type:"email",placeholder:"Enter your email",value:y.email,onChange:C=>w(T=>({...T,email:C.target.value})),required:!0,disabled:n})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(ct,{htmlFor:"password",children:"Password"}),c.jsxs("div",{className:"relative",children:[c.jsx(Qt,{id:"password",type:a?"text":"password",placeholder:"Enter your password",value:y.password,onChange:C=>w(T=>({...T,password:C.target.value})),required:!0,disabled:n,className:"pr-10"}),c.jsx($e,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8 p-0",onClick:()=>o(!a),disabled:n,children:a?c.jsx(a3,{className:"h-4 w-4"}):c.jsx(o3,{className:"h-4 w-4"})})]})]}),m&&c.jsxs("div",{className:"space-y-2",children:[c.jsx(ct,{htmlFor:"confirmPassword",children:"Confirm Password"}),c.jsx(Qt,{id:"confirmPassword",type:"password",placeholder:"Confirm your password",value:y.confirmPassword,onChange:C=>w(T=>({...T,confirmPassword:C.target.value})),required:m,disabled:n})]}),c.jsxs($e,{type:"submit",className:"w-full",disabled:n,children:[n?c.jsx(qh,{className:"h-4 w-4 animate-spin mr-2"}):c.jsx($1,{className:"h-4 w-4 mr-2"}),m?"Create Account":"Sign In"]})]}),c.jsx(to,{}),c.jsx("div",{className:"text-center",children:c.jsx($e,{variant:"link",onClick:()=>{g(!m),f(""),p(!1),w({email:"",password:"",confirmPassword:"",name:""})},disabled:n,className:"text-sm",children:m?"Already have an account? Sign in":"Don't have an account? Sign up"})})]}),c.jsxs(Jt,{value:"phone",className:"space-y-4 mt-6",children:[c.jsx(sr,{className:"border-amber-200 bg-amber-50",children:c.jsxs(ar,{className:"text-amber-800 text-sm",children:[c.jsx("strong",{children:"Notice:"})," Phone authentication requires SMS provider setup in Supabase Dashboard.",c.jsx("br",{}),"If you see errors, please use email authentication or contact your administrator."]})}),v.otpSent?c.jsxs("form",{onSubmit:b,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(ct,{htmlFor:"otp",children:"Enter OTP"}),c.jsx(Qt,{id:"otp",type:"text",placeholder:"Enter 6-digit OTP",value:v.otp,onChange:C=>S(T=>({...T,otp:C.target.value})),required:!0,disabled:n,maxLength:6}),c.jsxs("p",{className:"text-xs text-muted-foreground",children:["OTP sent to ",v.phone]})]}),c.jsxs($e,{type:"submit",className:"w-full",disabled:n||v.otp.length!==6,children:[n?c.jsx(qh,{className:"h-4 w-4 animate-spin mr-2"}):c.jsx($1,{className:"h-4 w-4 mr-2"}),"Verify & Sign In"]}),c.jsx($e,{type:"button",variant:"outline",onClick:D,disabled:n,className:"w-full",children:"Use Different Number"})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(ct,{htmlFor:"phone",children:"Phone Number"}),c.jsx(Qt,{id:"phone",type:"tel",placeholder:"Enter phone number (e.g., +1234567890)",value:v.phone,onChange:C=>S(T=>({...T,phone:C.target.value})),required:!0,disabled:n}),c.jsx("p",{className:"text-xs text-muted-foreground",children:"Include country code. Examples: +1234567890 (US), +919876543210 (India), +447890123456 (UK)"})]}),c.jsxs($e,{onClick:A,className:"w-full",disabled:n||!v.phone.trim(),children:[n?c.jsx(qh,{className:"h-4 w-4 animate-spin mr-2"}):c.jsx(W1,{className:"h-4 w-4 mr-2"}),"Send OTP"]}),c.jsx("div",{className:"text-center",children:c.jsx($e,{variant:"link",onClick:()=>r("email"),disabled:n,className:"text-sm text-blue-600",children:"Use Email Authentication Instead"})})]})]})]})]})]})})}function rz(){const[e,t]=j.useState("create-scheme"),[r,n]=j.useState("unknown"),[s,a]=j.useState(""),[o,u]=j.useState(0),f=j.useRef(null),d=j.useRef(null),[p,m]=j.useState({user:null,session:null,loading:!0}),[g,y]=j.useState(null),w=()=>{console.log("Scheme created, switching to manage-schemes and refreshing data"),t("manage-schemes"),f.current&&(console.log("Refreshing ManageSchemes to show newly created scheme..."),setTimeout(()=>{f.current&&f.current.refresh()},100))},v=()=>{console.log("=== CATEGORY DATA UPLOADED SUCCESSFULLY ==="),d.current&&(console.log("Refreshing CreateScheme category data after upload..."),d.current.refresh())},S=()=>{console.log("=== CATEGORY DATA DELETED SUCCESSFULLY ==="),d.current&&(console.log("Clearing CreateScheme category data after deletion..."),d.current.clearCategoryData())},E=async(C=!1)=>{n("checking"),C||(a(""),u(0));const T=Yi,U=`${T}/health`,z=`${T}/test`,Z=T.includes("workers.dev")||T.includes("pages.dev"),re=T.includes("supabase.co");console.log("=== CONNECTION CHECK DEBUG INFO ==="),console.log("Backend URL:",T),console.log("Health URL:",U),console.log("Test URL:",z),console.log("Using Cloudflare:",Z),console.log("Using Supabase:",re),console.log("User ID:",p.user?.id),console.log("Access Token Length:",g?.length||0),console.log("Public Anon Key Length:",dn?.length||0);try{console.log(`Checking backend connection... ${C?`(Retry attempt ${o+1})`:""}`),console.log("Connecting to health check:",U),console.log("Fallback test URL:",z),console.log("Project ID:",pt),console.log("Access Token Available:",!!g),console.log("User Authenticated:",!!p.user);let P;const se=Date.now();try{console.log("Trying simple health check...");const ce=await fetch(U,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(ce&&ce.ok){console.log("Health check successful!");const fe=await ce.json();console.log("Health check response:",fe),n("connected"),u(0),a("");return}else ce&&ce.status===401?console.log("Health check requires authentication, skipping to authenticated test..."):ce&&ce.status===404?console.log("Health endpoint not found, trying test endpoint..."):ce?console.log("Health check failed with status:",ce.status):console.log("Health check returned no response")}catch(ce){ce instanceof Error&&ce.message.includes("Failed to fetch")?console.warn("Health check network error, trying authenticated test endpoint...",ce):console.warn("Health check failed, trying authenticated test endpoint...",ce)}if(!P||!P.ok){const ce=new AbortController,fe=setTimeout(()=>{console.log("Test endpoint timeout reached, aborting..."),ce.abort()},6e3);try{p.user&&g?(console.log("Making authenticated test request with user token..."),P=await jt.makeAuthenticatedRequest(z,{method:"GET",signal:ce.signal})):(console.log("Making public test request with anon key..."),P=await jt.makePublicRequest(z,{method:"GET",signal:ce.signal})),clearTimeout(fe)}catch(de){clearTimeout(fe),console.warn("Auth service test failed, trying direct fetch...",de);const he=new AbortController,Q=setTimeout(()=>{console.log("Direct fetch timeout reached, aborting..."),he.abort()},6e3);try{const ee=g||dn;console.log("Making direct fetch with auth token:",ee?"present":"missing"),P=await fetch(z,{method:"GET",signal:he.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${ee}`,Accept:"application/json"}}),clearTimeout(Q)}catch(ee){clearTimeout(Q),console.warn("Direct fetch also failed, trying without authorization...",ee);try{P=await fetch(z,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}})}catch(V){console.error("Even request without auth failed:",V),P=void 0}}}}const me=Date.now()-se;if(console.log(`Connection test completed in ${me}ms`),!P){console.error("Response is undefined - all connection attempts failed"),n("error"),a("All connection attempts failed. The backend may not be accessible.");return}if(console.log("Response received:",{status:P.status,statusText:P.statusText,ok:P.ok,headers:Object.fromEntries(P.headers.entries())}),P.ok)try{const ce=await P.json();console.log("Connection test successful:",ce),n("connected"),u(0),a("")}catch(ce){console.error("Failed to parse JSON response:",ce),a("Server returned invalid JSON response. The Edge Function may be misconfigured."),n("error")}else{let ce="Unknown error";try{const fe=P.headers.get("content-type");if(fe&&fe.includes("application/json")){const de=await P.json();ce=de.message||de.error||JSON.stringify(de)}else ce=await P.text()}catch(fe){console.error("Failed to read error response:",fe),ce=`Failed to read error response: ${fe}`}console.error("Connection test failed:",{status:P.status,statusText:P.statusText,errorText:ce}),n("error"),P.status===500?a(`Server error (${P.status}). The backend may be experiencing issues. Details: ${ce}`):P.status===404?a(Z?`Endpoint not found (${P.status}). The Cloudflare Worker may not be deployed yet. Run 'npm run deploy-now' to deploy.`:`Endpoint not found (${P.status}). The Supabase Edge Function 'make-server-ce8ebc43' may not be deployed or the '/test' route is missing.`):P.status===403?a(`Access forbidden (${P.status}). Check your API keys and configuration.`):P.status===401?a(Z?`Unauthorized (${P.status}). The Cloudflare Worker may not be properly configured with Supabase credentials or the endpoint requires authentication.`:`Unauthorized (${P.status}). The Supabase API key may be invalid, expired, or the endpoint requires user authentication. Try logging in again.`):P.status===429?a(`Rate limited (${P.status}). Too many requests. Please wait before retrying.`):a(`HTTP ${P.status} ${P.statusText}: ${ce}`)}}catch(P){if(console.error("Connection test error:",P),n("error"),P instanceof Error)if(console.error("Error details:",{name:P.name,message:P.message,stack:P.stack}),P.message.includes("timeout")||P.name==="AbortError"){console.log("Timeout detected, trying one more simple fetch without auth...");try{const se=await fetch(z,{method:"GET",headers:{Authorization:`Bearer ${dn}`,"Content-Type":"application/json"}});if(se&&se.ok){console.log("Simple fetch succeeded, the issue was with timeout handling"),n("connected"),a("");return}else se?console.log("Simple fetch failed with status:",se.status):console.log("Simple fetch returned no response")}catch(se){console.log("Simple fetch also failed:",se)}a(Z?"Connection timeout - the Cloudflare Worker took too long to respond. This usually means the worker is not deployed or there are network issues. Run 'npm run deploy-now' to deploy.":"Connection timeout - the server took more than 8 seconds to respond. This usually means the Supabase Edge Function is not deployed, not running, or there are network issues. Please check the Debug tab for deployment instructions.")}else if(P.message.includes("Failed to fetch")){let se="";Z?se=`Cloudflare Worker connection failed. This could mean:
1. The Cloudflare Worker is not deployed yet
2. Run 'npm run deploy-now' to deploy to Cloudflare
3. The worker URL is incorrect: ${T}
4. Environment variables not configured
Please check the Debug tab or run the Cloudflare deployment.`:se=`Supabase connection failed. This could mean:
1. The Supabase Edge Function is not deployed
2. The project URL is incorrect: ${T}
3. Network connectivity issues
4. CORS configuration problems
Please check the Debug tab for deployment instructions.`,a(se)}else P.message.includes("NetworkError")||P.message.includes("network")?a(`Network error: ${P.message}. Please check if the Supabase Edge Function is deployed and accessible.`):P.message.includes("CORS")?a(`CORS error: ${P.message}. The backend may not be properly configured for cross-origin requests.`):a(`Connection error: ${P.message}`);else a("Unknown connection error occurred. Please check your network and try again.");response||(console.error("No response received from any connection attempt"),a("Unable to establish connection to backend. All connection attempts failed. Please check if the backend is deployed and accessible."))}},A=async()=>{o<5?(u(C=>C+1),await new Promise(C=>setTimeout(C,1e3)),await E(!0)):a(C=>`${C} (Maximum retry attempts reached - 5/5)`)};j.useEffect(()=>{(async()=>{console.log("Initializing authentication...");try{const{session:U,error:z}=await jt.getSession();if(z){console.error("Failed to get session:",z),m(Z=>({...Z,loading:!1}));return}U?(console.log("Found existing session:",{userId:U.user.id,email:U.user.email,hasAccessToken:!!U.access_token,accessTokenLength:U.access_token?.length||0,tokenPrefix:U.access_token?.substring(0,20)||"none"}),m({user:U.user,session:U,loading:!1}),y(U.access_token)):(console.log("No existing session found"),m(Z=>({...Z,loading:!1})))}catch(U){console.error("Auth initialization error:",U),m(z=>({...z,loading:!1}))}})();const{data:{subscription:T}}=jt.onAuthStateChange((U,z)=>{console.log("Auth state changed:",U,z?.user?.id),z?(console.log("Setting new session in auth state change:",{event:U,userId:z.user.id,hasAccessToken:!!z.access_token,tokenLength:z.access_token?.length||0}),m({user:z.user,session:z,loading:!1}),y(z.access_token)):(console.log("Clearing auth state:",U),m({user:null,session:null,loading:!1}),y(null))});return()=>{T.unsubscribe()}},[]),j.useEffect(()=>{if(!p.loading&&p.user){const C=setTimeout(()=>{E()},500);return()=>clearTimeout(C)}},[p.loading,p.user,g]);const b=C=>{console.log("Tab changed to:",C),t(C)};j.useEffect(()=>{if(e==="debug"&&r!=="connected"&&p.user){console.log("Checking connection when opening debug tab...");const C=setTimeout(()=>{E()},300);return()=>clearTimeout(C)}},[e,p.user]),j.useEffect(()=>{if(r==="connected"&&p.user){const C=setInterval(()=>{console.log("Performing periodic health check..."),E()},3e5);return()=>clearInterval(C)}},[r,p.user]);const D=()=>{console.log("Login successful, user authenticated"),be.success("Welcome to Schemes Management Platform!")},O=async()=>{try{m(T=>({...T,loading:!0}));const{error:C}=await jt.signOut();if(C){console.error("Logout error:",C),be.error("Failed to logout: "+C),m(T=>({...T,loading:!1}));return}m({user:null,session:null,loading:!1}),y(null),n("unknown"),t("create-scheme"),be.success("Logged out successfully")}catch(C){console.error("Logout error:",C),be.error("Failed to logout"),m(T=>({...T,loading:!1}))}};return p.loading?c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:c.jsxs("div",{className:"text-center space-y-4",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"text-gray-600",children:"Initializing authentication..."})]})}):p.user?c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("header",{className:"bg-blue-600 text-white shadow-lg",children:c.jsx("div",{className:"container mx-auto px-4 py-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(U3,{className:"h-8 w-8"}),c.jsx("h1",{className:"text-2xl font-bold",children:"Schemes Management Platform"})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[c.jsx(Jj,{className:"h-4 w-4"}),c.jsx("span",{children:p.user.user_metadata?.name||p.user.email||p.user.phone||"User"})]}),c.jsxs($e,{size:"sm",onClick:O,className:"bg-blue-700 hover:bg-blue-800 text-white border-blue-800 hover:border-blue-900 transition-all duration-200",children:[c.jsx(_3,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]})})}),c.jsx(ez,{}),r==="error"&&c.jsx("div",{className:"bg-red-50 border-b border-red-200",children:c.jsx("div",{className:"container mx-auto px-4 py-3",children:c.jsxs(sr,{className:"border-red-200 bg-red-50",children:[c.jsx(ia,{className:"h-4 w-4 text-red-600"}),c.jsx(ar,{className:"text-red-800",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1 mr-4",children:[c.jsx("strong",{children:"Backend Connection Failed:"})," ",s,c.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[c.jsx("div",{children:"Check the Debug tab for deployment instructions and troubleshooting."}),c.jsxs("div",{className:"text-xs opacity-75",children:["Backend: ",(()=>{const C=Yi,T=C.includes("workers.dev")||C.includes("pages.dev"),U=C.includes("supabase.co");return T?"Cloudflare Worker":U?"Supabase Edge Function":"Unknown"})()," | Project: ",pt]}),c.jsxs("div",{className:"text-xs opacity-75",children:["Backend URL: ",Yi]}),Yi.includes("workers.dev")&&c.jsx("div",{className:"text-xs opacity-75 text-blue-600",children:" Deploy with: npm run deploy-now"})]})]}),c.jsxs("div",{className:"flex flex-col space-y-2",children:[c.jsxs($e,{onClick:()=>E(!1),variant:"outline",size:"sm",disabled:r==="checking",children:[c.jsx(zr,{className:`h-4 w-4 mr-2 ${r==="checking"?"animate-spin":""}`}),"Test Connection"]}),o>0&&o<5&&c.jsxs($e,{onClick:A,variant:"secondary",size:"sm",disabled:r==="checking",children:["Auto Retry (",o,"/5)"]})]})]})})]})})}),r==="connected"&&c.jsx("div",{className:"bg-green-50 border-b border-green-200",children:c.jsx("div",{className:"container mx-auto px-4 py-2",children:c.jsxs("div",{className:"flex items-center text-green-800 text-sm",children:[c.jsx(gs,{className:"h-4 w-4 mr-2 text-green-600"}),c.jsx("span",{children:"Backend connected successfully"}),c.jsxs("div",{className:"ml-4 text-xs opacity-75",children:["Project: ",pt," | Health check every 5 minutes"]})]})})}),r==="checking"&&c.jsx("div",{className:"bg-blue-50 border-b border-blue-200",children:c.jsx("div",{className:"container mx-auto px-4 py-2",children:c.jsxs("div",{className:"flex items-center text-blue-800 text-sm",children:[c.jsx(zr,{className:"h-4 w-4 mr-2 text-blue-600 animate-spin"}),c.jsx("span",{children:"Checking backend connection..."}),o>0&&c.jsxs("div",{className:"ml-4 text-xs opacity-75",children:["Retry attempt ",o,"/5"]})]})})}),c.jsxs("main",{className:"container mx-auto px-4 py-8",children:[c.jsx("div",{className:"mb-8",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Manage Your Distribution Schemes"}),c.jsx("p",{className:"text-gray-600",children:"Create schemes, upload sales data, and verify calculations all in one place"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[r==="connected"&&c.jsxs("div",{className:"flex items-center text-green-600 text-sm",children:[c.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"Backend Connected"]}),r==="checking"&&c.jsxs("div",{className:"flex items-center text-blue-600 text-sm",children:[c.jsx(zr,{className:"w-4 h-4 animate-spin mr-2"}),"Checking Connection"]}),r==="error"&&c.jsxs("div",{className:"flex items-center text-red-600 text-sm",children:[c.jsx(ia,{className:"w-4 h-4 mr-2"}),"Connection Failed"]}),r==="unknown"&&c.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[c.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full mr-2"}),"Connection Unknown"]})]})]})}),c.jsxs(go,{value:e,onValueChange:b,className:"space-y-6",children:[c.jsxs(vo,{className:"grid w-full grid-cols-8 lg:w-auto lg:grid-cols-8",children:[c.jsxs(Yt,{value:"category-data-upload",className:"flex items-center space-x-2",children:[c.jsx(io,{className:"h-4 w-4"}),c.jsx("span",{children:"Category Data"})]}),c.jsxs(Yt,{value:"distributor-manager",className:"flex items-center space-x-2",children:[c.jsx(mi,{className:"h-4 w-4"}),c.jsx("span",{children:"Distributors"})]}),c.jsxs(Yt,{value:"create-scheme",className:"flex items-center space-x-2",children:[c.jsx(Tl,{className:"h-4 w-4"}),c.jsx("span",{children:"Create Scheme"})]}),c.jsxs(Yt,{value:"manage-schemes",className:"flex items-center space-x-2",children:[c.jsx(p_,{className:"h-4 w-4"}),c.jsx("span",{children:"Manage Schemes"})]}),c.jsxs(Yt,{value:"upload-data",className:"flex items-center space-x-2",children:[c.jsx(oa,{className:"h-4 w-4"}),c.jsx("span",{children:"Upload Data"})]}),c.jsxs(Yt,{value:"view-calculations",className:"flex items-center space-x-2",children:[c.jsx(na,{className:"h-4 w-4"}),c.jsx("span",{children:"View Calculations"})]}),c.jsxs(Yt,{value:"moderation",className:"flex items-center space-x-2",children:[c.jsx(g_,{className:"h-4 w-4"}),c.jsx("span",{children:"Moderation"})]}),c.jsxs(Yt,{value:"debug",className:"flex items-center space-x-2",children:[c.jsx(km,{className:"h-4 w-4"}),c.jsx("span",{children:"Debug"})]})]}),c.jsx(Jt,{value:"category-data-upload",className:"space-y-6",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(io,{className:"h-5 w-5"}),c.jsx("span",{children:"Category Data Management"})]})}),c.jsx(Qe,{children:c.jsx(T$,{onCategoryDataUploaded:v,onCategoryDataDeleted:S})})]})}),c.jsx(Jt,{value:"distributor-manager",className:"space-y-6",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(mi,{className:"h-5 w-5"}),c.jsx("span",{children:"Distributor Management"})]})}),c.jsx(Qe,{children:c.jsx(C$,{})})]})}),c.jsx(Jt,{value:"create-scheme",className:"space-y-6",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(Tl,{className:"h-5 w-5"}),c.jsx("span",{children:"Create New Scheme"})]})}),c.jsx(Qe,{children:c.jsx(L_,{ref:d,onSchemeCreated:w})})]})}),c.jsx(Jt,{value:"manage-schemes",className:"space-y-6",children:c.jsx(Ob,{ref:f})}),c.jsx(Jt,{value:"upload-data",className:"space-y-6",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(oa,{className:"h-5 w-5"}),c.jsx("span",{children:"Upload Sales Data"})]})}),c.jsx(Qe,{children:c.jsx(aR,{})})]})}),c.jsx(Jt,{value:"view-calculations",className:"space-y-6",children:c.jsxs(Je,{children:[c.jsx(At,{children:c.jsxs(Ft,{className:"flex items-center space-x-2",children:[c.jsx(na,{className:"h-5 w-5"}),c.jsx("span",{children:"Scheme Calculations"})]})}),c.jsx(Qe,{children:c.jsx(fR,{})})]})}),c.jsx(Jt,{value:"moderation",className:"space-y-6",children:c.jsx(X$,{})}),c.jsx(Jt,{value:"debug",className:"space-y-6",children:c.jsx(Z$,{})})]})]}),c.jsx(TC,{position:"top-right",richColors:!0,expand:!0,duration:4e3})]}):c.jsx(tz,{onLoginSuccess:D})}LT.createRoot(document.getElementById("root")).render(c.jsx(Oe.StrictMode,{children:c.jsx(rz,{})}));
